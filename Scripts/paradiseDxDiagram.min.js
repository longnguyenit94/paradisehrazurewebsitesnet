!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.diagram=t():(n.DevExpress=n.DevExpress||{},n.DevExpress.diagram=t())}(window,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=4)}([function(n,t){"use strict";var f,i,o,u,s,h,c,r,e;Object.defineProperty(t,"__esModule",{value:!0});f=function(){function n(n,t){this.width=n;this.height=t}return n.prototype.clone=function(){return new n(this.width,this.height)},n.prototype.toString=function(){return JSON.stringify(this)},n.prototype.offset=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),new n(Math.max(0,this.width+t),Math.max(0,this.height+i))},n.prototype.multiply=function(t,i){return void 0===t&&(t=1),void 0===i&&(i=t),new n(this.width*t,this.height*i)},n.prototype.equals=function(n){return n.width===this.width&&n.height===this.height},n.prototype.transform=function(t){return new n(t(this.width),t(this.height))},n}();t.Size=f;i=function(){function n(n,t){this.x=n;this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.toString=function(){return JSON.stringify(this)},n.prototype.offset=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),new n(this.x+t,this.y+i)},n.prototype.multiply=function(t,i){return void 0===t&&(t=1),void 0===i&&(i=t),new n(this.x*t,this.y*i)},n.prototype.equals=function(n){return n.x===this.x&&n.y===this.y},n.prototype.transform=function(t){return new n(t(this.x),t(this.y))},n.empty=function(){return new n(0,0)},n.plus=function(t,i){return new n(t.x+i.x,t.y+i.y)},n.minus=function(t,i){return new n(t.x-i.x,t.y-i.y)},n}();t.Point=i;o=function(){function n(n,t,i,r){this.left=n;this.top=t;this.right=i;this.bottom=r}return Object.defineProperty(n.prototype,"horizontal",{get:function(){return this.left+this.right},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vertical",{get:function(){return this.top+this.bottom},enumerable:!0,configurable:!0}),n.prototype.clone=function(){return new n(this.left,this.top,this.right,this.bottom)},n.prototype.transform=function(t){return new n(t(this.left),t(this.top),t(this.right),t(this.bottom))},n.prototype.offset=function(n,t){var i=this.clone();return t?(i.left+=n.left,i.right+=n.right,i.top+=n.top,i.bottom+=n.bottom):(i.left-=n.left,i.right-=n.right,i.top-=n.top,i.bottom-=n.bottom),i},n.prototype.multiply=function(t,i){return void 0===t&&(t=1),void 0===i&&(i=t),new n(this.left*t,this.top*i,this.right*t,this.bottom*i)},n.prototype.isEmpty=function(){return 0===this.left&&0===this.right&&0===this.top&&0===this.bottom},n.prototype.equals=function(n){return this.left===n.left&&this.top===n.top&&this.right===n.right&&this.bottom===n.bottom},n.prototype.toString=function(){return"left: "+this.left+" top: "+this.top+" right: "+this.right+" bottom: "+this.bottom},n.empty=function(){return new n(0,0,0,0)},n.fromNumber=function(t){return new n(t,t,t,t)},n.fromSide=function(t,i){return new n(t,i,t,i)},n}();t.Offset=o;u=function(){function n(n,t){this.position=n;this.size=t}return Object.defineProperty(n.prototype,"left",{get:function(){return this.position.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.position.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.position.x+this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.position.y+this.size.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{get:function(){return new i(this.position.x+this.size.width/2,this.position.y+this.size.height/2)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.size.height},enumerable:!0,configurable:!0}),n.prototype.clone=function(){return new n(this.position.clone(),this.size.clone())},n.prototype.toString=function(){return JSON.stringify(this)},n.prototype.contains=function(n){return this.left<=n.x&&n.x<=this.right&&this.top<=n.y&&n.y<=this.bottom},n.prototype.intersectX=function(n){return!(this.left>n.right||n.left>this.right)},n.prototype.intersectY=function(n){return!(this.top>n.bottom||n.top>this.bottom)},n.prototype.intersect=function(n){return this.intersectX(n)&&this.intersectY(n)},n.prototype.inflate=function(t,i){return i=void 0===i?t:i,new n(this.position.offset(-t,-i),this.size.offset(2*t,2*i))},n.prototype.resize=function(t,i){return new n(this.position,this.size.offset(t,i))},n.prototype.offset=function(t,i){return new n(this.position.offset(t,i),this.size)},n.prototype.multiply=function(t){return new n(this.position.multiply(t),this.size.multiply(t))},n.prototype.equals=function(n){return this.left===n.left&&this.top===n.top&&this.width===n.width&&this.height===n.height},n.prototype.transform=function(t){return new n(this.position.transform(t),this.size.transform(t))},n.create=function(t,r,u,e){return new n(new i(t,r),new f(u,e))},n.createByPoints=function(t,i){return n.createByPositions(t.x,t.y,i.x,i.y)},n.createByPositions=function(t,i,r,u){var f=Math.min(t,r),e=Math.min(i,u),o=Math.abs(r-t),s=Math.abs(u-i);return n.create(f,e,o,s)},n}();t.Rectangle=u;s=function(){function n(n,t){this.from=n;this.to=void 0!==t?t:n}return Object.defineProperty(n.prototype,"length",{get:function(){return Math.abs(this.to-this.from)},enumerable:!0,configurable:!0}),n.prototype.extend=function(n){this.from=Math.min(n.from,this.from);this.to=Math.max(n.to,this.to)},n.fromLength=function(t,i){return new n(t,t+i)},n}();t.Range=s;h=function(){function n(n,t){this.startPoint=n;this.endPoint=t}return Object.defineProperty(n.prototype,"distance",{get:function(){return e.getDistance(this.startPoint,this.endPoint)},enumerable:!0,configurable:!0}),n.prototype.intersect=function(n){return!!(this.startPoint.equals(n.startPoint)||this.endPoint.equals(n.startPoint)||this.startPoint.equals(n.endPoint)||this.endPoint.equals(n.endPoint))||this.intersectCore(n)&&n.intersectCore(this)},n.prototype.intersectRect=function(t){var r=t.position,u=new i(t.left,t.bottom),f=new i(t.right,t.top),e=new i(t.right,t.bottom);return t.contains(this.startPoint)||t.contains(this.endPoint)||this.intersect(new n(r,u))||this.intersect(new n(u,e))||this.intersect(new n(e,f))||this.intersect(new n(f,r))},n.prototype.intersectCore=function(n){if(this.startPoint.x===this.endPoint.x){if(this.startPoint.x-n.endPoint.x!=0)return(this.startPoint.x-n.startPoint.x)/(this.startPoint.x-n.endPoint.x)<=0;if(n.endPoint.y-this.endPoint.y!=0)return(n.endPoint.y-this.startPoint.y)/(n.endPoint.y-this.endPoint.y)<=0}if(this.startPoint.y===this.endPoint.y){if(this.startPoint.y-n.endPoint.y!=0)return(this.startPoint.y-n.startPoint.y)/(this.startPoint.y-n.endPoint.y)<=0;if(n.endPoint.x-this.endPoint.x!=0)return(n.endPoint.x-this.startPoint.x)/(n.endPoint.x-this.endPoint.x)<=0}var f=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x),t=this.startPoint.y+(n.startPoint.x-this.startPoint.x)*f,i=this.startPoint.y+(n.endPoint.x-this.startPoint.x)*f,r=n.startPoint.y-t,u=n.endPoint.y-i;return 0===r&&0===u?(this.startPoint.y-t)/(this.endPoint.y-t)<=0||(this.startPoint.y-i)/(this.endPoint.y-i)<=0:0===r||0===u||r/u<0},n.create=function(t,r,u,f){return new n(new i(t,r),new i(u,f))},n.createByPoints=function(t,i){return n.create(t.x,t.y,i.x,i.y)},n}();t.Segment=h;c=function(){function n(){this.listeners=[]}return n.prototype.add=function(n){if(!n)throw new Error("Not Implemented");this.hasEventListener(n)||this.listeners.push(n)},n.prototype.remove=function(n){for(var i,t=0;i=this.listeners[t];t++)if(i===n){this.listeners.splice(t,1);break}},n.prototype.raise=function(n){for(var r,u,f,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];for(u=0;r=this.listeners[u];u++)f=r[n],f&&f.apply(r,i)},n.prototype.raise1=function(n){for(var t,i=0;t=this.listeners[i];i++)n(t)},n.prototype.hasEventListener=function(n){for(var t=0,i=this.listeners.length;t<i;t++)if(this.listeners[t]===n)return!0;return!1},n}();t.EventDispatcher=c;r=function(){function n(){}return n.binaryIndexOf=function(n,t,i,r){var e,u,f;for(void 0===i&&(i=0),void 0===r&&(r=-2),e=0==i,-2==r&&(r=n.length-1);i<=r;)if(u=i+(r-i>>1),f=t(n[u]),f<0)i=u+1;else{if(!(f>0))return u;r=u-1}return e?~i:-1},n.normedBinaryIndexOf=function(t,i,r,u){void 0===r&&(r=0);void 0===u&&(u=-2);var f=n.binaryIndexOf(t,i,r,u);return n.binaryIndexNormalizator(f)},n.binaryIndexNormalizator=function(n){return n<0?~n-1:n},n}();t.Utils=r;e=function(){function n(){}return n.getCommonRectangle=function(n){if(!n.length)return u.create(0,0,0,0);var t=Number.MAX_VALUE,r=-Number.MAX_VALUE,i=Number.MAX_VALUE,f=-Number.MAX_VALUE;return n.forEach(function(n){t=Math.min(t,n.left);r=Math.max(r,n.right);i=Math.min(i,n.top);f=Math.max(f,n.bottom)}),u.create(t,i,r-t,f-i)},n.findFreeSpace=function(n,t,u,f){var e=[f?f.left:0],o=[f?f.top:0],h,s,c;n.forEach(function(n){e.push(n.left);e.push(n.right);o.push(n.top);o.push(n.bottom)});e=e.sort(function(n,t){return n-t}).reduce(function(n,t,i){return e[i-1]!==t&&n.push(t)&&n||n},[]);for(var l=(o=o.sort(function(n,t){return n-t}).reduce(function(n,t,i){return o[i-1]!==t&&n.push(t)&&n||n},[])).map(function(){return e.map(function(n,t){return e[t+1]-n})}),y=function(n,t){for(var i,f=r.binaryIndexOf(e,function(n){return n-t.left}),s=r.binaryIndexOf(e,function(n){return n-t.right}),h=r.binaryIndexOf(o,function(n){return n-t.top}),c=r.binaryIndexOf(o,function(n){return n-t.bottom}),u=h;u<c;u++)for(i=f;i<s;i++)l[u][i]*=-1},a=0,v=void 0;v=n[a];a++)y(0,v);for(h=0;h<o.length;h++)for(s=0;s<e.length-1;s++)if(c=this.checkRect(l,o,e,h,s,t,u),c>0)s=c;else if(0===c)return new i(e[s],o[h]);return null},n.checkRect=function(n,t,i,r,u,f,e){for(var o,h=0,c=0,l=i.length-2,s=r;s<t.length;s++)for(h=t[s+1]-t[r],o=u;o<=l;o++){if(n[s][o]<0)return 0===o?-1:o;if(c=i[o+1]-i[u],f.width<=c||!e&&o===i.length-2&&f.width/2<=c){if(f.height<=h||!e&&s===t.length-2&&f.height/2<=h)return 0;l=o}}},n.getArrowPoints=function(n,t,r,u){if(n.x===t.x&&n.y===t.y)return{point1:n.clone(),point2:n.clone(),point3:n.clone()};var o=t.x-n.x,s=t.y-n.y,h=Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),f=o/h,e=s/h,c=n.x+r*f+u*e,l=n.y+r*e-u*f,a=n.x+r*f-u*e,v=n.y+r*e+u*f,y=n.x+r*f,p=n.y+r*e;return{point1:new i(c,l),point2:new i(a,v),point3:new i(y,p)}},n.removeUnnecessaryLinePoints=function(n,t,i){void 0===i&&(i=function(n){return void 0!==n});this.removeDuplicatedPoints(n,t,i);this.removeOneLinePoints(n,t,i);this.removeBackwardPoints(n,t,i)},n.removeBackwardPoints=function(n,t,i){var r,u,f,e;for(void 0===i&&(i=function(n){return void 0!==n}),u=0;(r=n[u])&&!(n.length<=2);){if(f=this.getNextPoint(n,u,!0,i),e=this.getNextPoint(n,u,!1,i),e&&f){if(r.x==e.x&&r.x==f.x&&(r.y>e.y&&r.y>f.y||r.y<e.y&&r.y<f.y)&&t(n[u],u))continue;if(r.y==e.y&&r.y==f.y&&(r.x>e.x&&r.x>f.x||r.x<e.x&&r.x<f.x)&&t(n[u],u))continue}u++}},n.removeOneLinePoints=function(n,t,i){var e,r,u,f,o;for(void 0===i&&(i=function(n){return void 0!==n}),r=0;(e=n[r])&&!(n.length<=2);){if(u=this.getNextPoint(n,r,!0,i),f=this.getNextPoint(n,r,!1,i),f&&u){if((e.x==f.x&&e.x==u.x||e.y==f.y&&e.y==u.y)&&t(n[r],r))continue;if(o=(u.y-f.y)/(u.x-f.x),u.y-n[r].y==(u.x-n[r].x)*o&&t(n[r],r))continue}r++}},n.removeDuplicatedPoints=function(n,t,i){var e,r,f,u;for(void 0===i&&(i=function(n){return void 0!==n}),r=0;(e=n[r])&&!(n.length<=2);)(f=this.getNextPoint(n,r,!0,i),f&&e.x==f.x&&e.y==f.y&&(u=r+1,u===n.length-1&&u--,t(n[u],u)))||r++},n.getNextPoint=function(n,t,i,r){for(var u,f=t+(i?1:-1);u=n[f];){if(r(u))return u;f+=i?1:-1}},n.getDistance=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},n.getPathLength=function(t){var i,r=0;return t.forEach(function(t){if(void 0!==i){var u=n.getDistance(t,i);r+=u}i=t}),r},n.getPathPointByPosition=function(t,r){var e,f;if(!t.length)throw new Error("Invalid points");if(0>r||r>1)throw new Error("Invalid relative position");if(e=this.getPathLength(t),t.length<=2&&0===e||0===r)return[t[0],0];for(var s=e*r,o=0,u=1;u<t.length;u++){if(f=n.getDistance(t[u],t[u-1]),o+f>=s){var h=s-o,c=(t[u].x-t[u-1].x)/f,l=(t[u].y-t[u-1].y)/f;return[new i(t[u-1].x+c*h,t[u-1].y+l*h),u]}o+=f}return[t[t.length-1],t.length-1]},n.getLineAngle=function(n,t){return Math.atan2(t.y-n.y,t.x-n.x)},n.getTriangleBeginAngle=function(n,t,i){var r=this.getLineAngle(n,t),u=this.getLineAngle(n,i);return Math.abs(u-r)},n.getTriangleEndAngle=function(n,t,i){var r=this.getLineAngle(n,t),u=this.getLineAngle(i,t);return Math.abs(r-u)},n.getPathPointByPoint=function(t,i){var o,v,s,u,f;if(!t.length)throw new Error("Invalid points");if(1===t.length)return t[0];for(v=Number.MAX_VALUE,s=1;s<t.length;s++){if(u=t[s-1],f=t[s],i.equals(u)){o=u.clone();break}if(i.equals(f)){o=f.clone();break}var h=this.getTriangleBeginAngle(u,f,i),a=this.getTriangleEndAngle(u,f,i),w=n.getDistance(i,u),k=n.getDistance(i,f),y=w*Math.sin(h),b=void 0;if((b=Math.PI/2<=h&&h<=3*Math.PI/2?w:Math.PI/2<=a&&a<=3*Math.PI/2?k:Math.abs(y))<v)if(v=b,Math.PI/2<=h&&h<=3*Math.PI/2)o=u.clone();else if(Math.PI/2<=a&&a<=3*Math.PI/2)o=f.clone();else{var p=Math.fround||Math.round,r=this.getLineAngle(u,f),c=p(Math.abs(y*Math.sin(r))),l=p(Math.abs(y*Math.cos(r))),e=i.y-u.y<p((i.x-u.x)*Math.tan(r));0<=r&&r<=Math.PI/2?(c*=e?-1:1,l*=e?1:-1):Math.PI/2<=r&&r<=Math.PI?(c*=e?1:-1,l*=e?1:-1):0>=r&&r>=-Math.PI/2?(c*=e?1:-1,l*=e?1:-1):-Math.PI/2>=r&&r>=-Math.PI&&(c*=e?-1:1,l*=e?1:-1);o=i.offset(c,l)}}return o},n.getPathPositionByPoint=function(t,i,r){void 0===r&&(r=100);i=this.getPathPointByPoint(t,i);for(var c=this.getPathLength(t),o=0,e=1;e<t.length;e++){var u=t[e-1],f=t[e],l=n.getDistance(f,u),s=Math.atan((f.y-u.y)/(f.x-u.x)),h=Math.fround||Math.round;if(i.x===f.x&&i.x===u.x||i.y===f.y&&i.y===u.y||h(i.y-u.y)===h((i.x-u.x)*Math.tan(s)))return o+=0!==Math.sin(s)?Math.abs((i.y-u.y)/Math.sin(s)):Math.abs(i.x-u.x),Math.round(o*r/c)/r;o+=l}return 1},n.arePointsEqual=function(n,t){var r=n.length,i;if(r!=t.length)return!1;for(i=0;i<r;i++)if(!n[i].equals(t[i]))return!1;return!0},n}();t.GeometryUtils=e},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0});i=function(){function n(){}return n.General="general",n.Flowchart="flowchart",n.OrgChart="orgChart",n.Containers="containers",n.Custom="custom",n}();t.ShapeCategories=i;r=function(){function n(){}return n.Text="text",n.Rectangle="rectangle",n.Ellipse="ellipse",n.Cross="cross",n.Triangle="triangle",n.Diamond="diamond",n.Heart="heart",n.Pentagon="pentagon",n.Hexagon="hexagon",n.Octagon="octagon",n.Star="star",n.ArrowLeft="arrowLeft",n.ArrowUp="arrowTop",n.ArrowRight="arrowRight",n.ArrowDown="arrowBottom",n.ArrowUpDown="arrowNorthSouth",n.ArrowLeftRight="arrowEastWest",n.Process="process",n.Decision="decision",n.Terminator="terminator",n.PredefinedProcess="predefinedProcess",n.Document="document",n.MultipleDocuments="multipleDocuments",n.ManualInput="manualInput",n.Preparation="preparation",n.Data="data",n.Database="database",n.HardDisk="hardDisk",n.InternalStorage="internalStorage",n.PaperTape="paperTape",n.ManualOperation="manualOperation",n.Delay="delay",n.StoredData="storedData",n.Display="display",n.Merge="merge",n.Connector="connector",n.Or="or",n.SummingJunction="summingJunction",n.Container="container",n.VerticalContainer="verticalContainer",n.HorizontalContainer="horizontalContainer",n.Card="card",n.CardWithImageOnLeft="cardWithImageOnLeft",n.CardWithImageOnTop="cardWithImageOnTop",n.CardWithImageOnRight="cardWithImageOnRight",n}();t.ShapeTypes=r,function(n){n[n.text=0]="text";n[n.rectangle=1]="rectangle";n[n.ellipse=2]="ellipse";n[n.cross=3]="cross";n[n.triangle=4]="triangle";n[n.diamond=5]="diamond";n[n.heart=6]="heart";n[n.pentagon=7]="pentagon";n[n.hexagon=8]="hexagon";n[n.octagon=9]="octagon";n[n.star=10]="star";n[n.arrowLeft=11]="arrowLeft";n[n.arrowTop=12]="arrowTop";n[n.arrowRight=13]="arrowRight";n[n.arrowBottom=14]="arrowBottom";n[n.arrowNorthSouth=15]="arrowNorthSouth";n[n.arrowEastWest=16]="arrowEastWest";n[n.process=17]="process";n[n.decision=18]="decision";n[n.terminator=19]="terminator";n[n.predefinedProcess=20]="predefinedProcess";n[n.document=21]="document";n[n.multipleDocuments=22]="multipleDocuments";n[n.manualInput=23]="manualInput";n[n.preparation=24]="preparation";n[n.data=25]="data";n[n.database=26]="database";n[n.hardDisk=27]="hardDisk";n[n.internalStorage=28]="internalStorage";n[n.paperTape=29]="paperTape";n[n.manualOperation=30]="manualOperation";n[n.delay=31]="delay";n[n.storedData=32]="storedData";n[n.display=33]="display";n[n.merge=34]="merge";n[n.connector=35]="connector";n[n.or=36]="or";n[n.summingJunction=37]="summingJunction";n[n.verticalContainer=38]="verticalContainer";n[n.horizontalContainer=39]="horizontalContainer";n[n.cardWithImageOnLeft=40]="cardWithImageOnLeft";n[n.cardWithImageOnTop=41]="cardWithImageOnTop";n[n.cardWithImageOnRight=42]="cardWithImageOnRight"}(t.ShapeType||(t.ShapeType={}))},function(n,t,i){"use strict";var f,r=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,e,o,s,h,c,l;Object.defineProperty(t,"__esModule",{value:!0});var a=i(12),v=i(21),y=i(87),p=function(n){function t(t,i,r,u,f){var e=n.call(this,i,r,u,f)||this;return e.commands=t.map(function(n){return n.style=i,n}),e}return r(t,n),t.prototype.createMainElement=function(){return document.createElementNS(a.svgNS,"path")},t.prototype.applyElementProperties=function(t,i){t.setAttribute("d",this.commands.map(function(n){return n.toString()}).join(" "));this.setPositionCorrectionAttribute(t);n.prototype.applyElementProperties.call(this,t,i)},t}(v.SvgPrimitive);t.PathPrimitive=p;u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t}(y.PrimitiveObject);t.PathPrimitiveCommand=u;e=function(n){function t(t,i){var r=n.call(this)||this;return r.x=t,r.y=i,r}return r(t,n),t.prototype.toString=function(){return"M "+this.getUnitVaue(this.x)+" "+this.getUnitVaue(this.y)},t.fromPoint=function(n){return new t(n.x,n.y)},t}(u);t.PathPrimitiveMoveToCommand=e;o=function(n){function t(t,i){var r=n.call(this)||this;return r.x=t,r.y=i,r}return r(t,n),t.prototype.toString=function(){return"L "+this.getUnitVaue(this.x)+" "+this.getUnitVaue(this.y)},t.fromPoint=function(n){return new t(n.x,n.y)},t}(u);t.PathPrimitiveLineToCommand=o;s=function(n){function t(t,i,r,u,f,e){var o=n.call(this)||this;return o.x1=t,o.y1=i,o.x2=r,o.y2=u,o.x3=f,o.y3=e,o}return r(t,n),t.prototype.toString=function(){return"C "+this.getUnitVaue(this.x1)+" "+this.getUnitVaue(this.y1)+","+this.getUnitVaue(this.x2)+" "+this.getUnitVaue(this.y2)+","+this.getUnitVaue(this.x3)+" "+this.getUnitVaue(this.y3)},t}(u);t.PathPrimitiveCubicCurveToCommand=s;h=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f.x1=t,f.y1=i,f.x2=r,f.y2=u,f}return r(t,n),t.prototype.toString=function(){return"Q "+this.getUnitVaue(this.x1)+" "+this.getUnitVaue(this.y1)+","+this.getUnitVaue(this.x2)+" "+this.getUnitVaue(this.y2)},t}(u);t.PathPrimitiveQuadraticCurveToCommand=h;c=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this)||this;return s.rx=t,s.ry=i,s.xAxisRotation=r,s.largeArcFlag=u,s.sweepFag=f,s.x=e,s.y=o,s}return r(t,n),t.prototype.toString=function(){return"A "+this.getUnitVaue(this.rx)+" "+this.getUnitVaue(this.ry)+" "+this.getUnitVaue(this.xAxisRotation)+" "+(this.largeArcFlag?"1":"0")+" "+(this.sweepFag?"1":"0")+this.getUnitVaue(this.x)+","+this.getUnitVaue(this.y)},t}(u);t.PathPrimitiveArcToCommand=c;l=function(n){function t(){return n.call(this)||this}return r(t,n),t.prototype.toString=function(){return"z"},t}(u);t.PathPrimitiveClosePathCommand=l},function(n,t){"use strict";var i,f=this&&this.__extends||(i=function(n,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function r(){this.constructor=n}i(n,t);n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),r,u;Object.defineProperty(t,"__esModule",{value:!0});r=function(){function n(){this.uniqueId=-1}return n.prototype.changeModified=function(){return!0},n.prototype.getName=function(){return this.constructor.name},n}();t.HistoryItem=r;u=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.historyItems=[],t}return f(t,n),t.prototype.changeModified=function(){for(var n,t=0;n=this.historyItems[t];t++)if(n.changeModified())return!0;return!1},t.prototype.redo=function(n){for(var t,i=0;t=this.historyItems[i];i++)t.redo(n)},t.prototype.undo=function(n){for(var t,i=this.historyItems.length-1;t=this.historyItems[i];i--)t.undo(n)},t.prototype.add=function(n){if(null==n)throw new Error("cannot be null");this.historyItems.push(n)},t}(r);t.CompositionHistoryItem=u},function(n,t,i){"use strict";var s,h,r,u,c,l,a,v,y,f,e,p,w,o,b,k;Object.defineProperty(t,"__esModule",{value:!0});s=i(45);t.DiagramCommand=s.DiagramCommand;h=i(265);t.DiagramControl=h.DiagramControl;r=i(0);t.EventDispatcher=r.EventDispatcher;t.Size=r.Size;t.Point=r.Point;u=i(1);t.ShapeTypes=u.ShapeTypes;t.ShapeCategories=u.ShapeCategories;t.ShapeType=u.ShapeType;c=i(14);t.UnitConverter=c.UnitConverter;l=i(24);t.Browser=l.Browser;a=i(34);t.AutoZoomMode=a.AutoZoomMode;v=i(119);t.DataLayoutType=v.DataLayoutType;y=i(17);t.DataLayoutOrientation=y.DataLayoutOrientation;i(319);f=i(19);t.DiagramUnit=f.DiagramUnit;t.PageOrientation=f.PageOrientation;e=i(25);t.ConnectorLineEnding=e.ConnectorLineEnding;t.ConnectorLineOption=e.ConnectorLineOption;p=i(36);t.ColorHelper=p.ColorHelper;w=i(64);t.Diagnostics=w.Diagnostics;o=i(66);t.NativeShape=o.NativeShape;t.NativeConnector=o.NativeConnector;b=i(320);t.DiagramLocalizationService=b.DiagramLocalizationService;k=i(12);t.RenderHelper=k.RenderHelper},function(n,t,i){"use strict";var r,f,u,e;Object.defineProperty(t,"__esModule",{value:!0});f=i(0);u=i(23);!function(n){n[n.Undefined=-1]="Undefined";n[n.North=0]="North";n[n.East=1]="East";n[n.South=2]="South";n[n.West=3]="West"}(r=t.ConnectionPointSide||(t.ConnectionPointSide={}));t.DEFAULT_ZINDEX=0;e=function(){function n(){this.key=void 0;this.dataKey=void 0;this.attachedConnectors=[];this.zIndex=t.DEFAULT_ZINDEX;this.locked=!1;this.container=void 0;this.style=new u.Style;this.styleText=new u.TextStyle}return n.prototype.assign=function(n){n.key=this.key;n.dataKey=this.dataKey;n.locked=this.locked;n.attachedConnectors=this.attachedConnectors.slice();n.style=this.style.clone();n.styleText=this.styleText.clone();n.zIndex=this.zIndex;n.container=this.container},n.prototype.invalidatePrimitives=function(){this.primitives&&this.primitives.forEach(function(n){n.dispose()});delete this.primitives;delete this.selectorPrimitives},n.prototype.getPrimitives=function(){return this.primitives||(this.primitives=this.createPrimitives()),this.primitives},n.prototype.getSelectorPrimitives=function(){return this.selectorPrimitives||(this.selectorPrimitives=this.createSelectorPrimitives()),this.selectorPrimitives},n.prototype.getConnectionPointPosition=function(n,t){return this.getConnectionPoint(n,t).toPoint()},n.prototype.getConnectionPoint=function(n,t){n<0&&t&&(n=this.getNearestConnectionPoint(t));var i=this.getConnectionPoints();return i[n]||i[0]},n.prototype.getNearestConnectionPoint=function(n){var t,i=Number.MAX_VALUE;return this.getConnectionPoints().forEach(function(r,u){var e=f.GeometryUtils.getDistance(r,n);e<i&&(i=e,t=u)}),t},n.prototype.getConnectionPointIndex=function(n){var t=this.getConnectionPoints();return t.reduce(function(i,u,f){return n===r.North&&u.y<t[i].y?f:n===r.South&&u.y>t[i].y?f:n===r.West&&u.x<t[i].x?f:n===r.East&&u.x>t[i].x?f:i},0)},n.prototype.getConnectionPointSideByIndex=function(n,t){var i=this.getConnectionPoint(n,t);return this.getConnectionPointSide(i,t)},n.prototype.getConnectionPointIndexForSide=function(n){return n},Object.defineProperty(n.prototype,"enableText",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowEditText",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enableChildren",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLocked",{get:function(){return this.locked||this.container&&this.container.isLocked},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowResizeHorizontally",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowResizeVertically",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeWidth",{get:function(){return this.style.strokeWidth},enumerable:!0,configurable:!0}),n.prototype.intersectedByRect=function(n){return this.rectangle.intersect(n)},n}();t.DiagramItem=e},function(n,t,i){"use strict";var s,v=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}s(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a;Object.defineProperty(t,"__esModule",{value:!0});var e,c=i(5),r=i(0),h=i(14),y=i(140),p=i(141),u=i(25),l=i(147),w=i(46),b=i(10),k=i(15),d=i(32),g=i(66),f=i(2),nt=i(48),o=i(151);!function(n){n[n.Begin=0]="Begin";n[n.End=1]="End"}(e=t.ConnectorPosition||(t.ConnectorPosition={}));t.CONNECTOR_DEFAULT_TEXT_POSITION=.5;a=function(n){function i(t){var i=n.call(this)||this;if(i.beginConnectionPointIndex=-1,i.endConnectionPointIndex=-1,i.properties=new u.ConnectorProperties,i.points=t.map(function(n){return n.clone()}),t.length<2)throw Error("Points count should be greater than 1");return i.texts=new l.ConnectorTexts,i}return v(i,n),i.prototype.assign=function(t){n.prototype.assign.call(this,t);t.beginItem=this.beginItem;t.beginConnectionPointIndex=this.beginConnectionPointIndex;t.endItem=this.endItem;t.endConnectionPointIndex=this.endConnectionPointIndex;t.properties=this.properties.clone();t.texts=this.texts.clone()},i.prototype.clone=function(){var n=new i(this.points);return this.assign(n),n},i.prototype.getRenderPoints=function(n){return void 0===n&&(n=!1),void 0===this.renderPoints&&(this.renderPoints=this.getCalculator().getPoints(),this.renderPointsWithoutSkipped=this.renderPoints.filter(function(n){return!n.skipped})),n?this.renderPoints:this.renderPointsWithoutSkipped},i.prototype.getText=function(n){void 0===n&&(n=t.CONNECTOR_DEFAULT_TEXT_POSITION);var i=this.texts.get(n);return i?i.value:""},i.prototype.setText=function(n,i){void 0===i&&(i=t.CONNECTOR_DEFAULT_TEXT_POSITION);n&&""!==n?this.texts.set(i,new l.ConnectorText(i,n)):this.texts.remove(i)},i.prototype.getTextPoint=function(n){var t=this.getRenderPoints();return r.GeometryUtils.getPathPointByPosition(t,n)[0]},i.prototype.getTextPositionByPoint=function(n){var f=this.getRenderPoints(),t=r.GeometryUtils.getPathLength(f),u=r.GeometryUtils.getPathPositionByPoint(f,n),i=h.UnitConverter.pointsToTwips(parseInt(this.styleText["font-size"]));return i>u*t?i/t:i>t-u*t?(t-i)/t:u},i.prototype.getTextRectangle=function(n){return new r.Rectangle(this.getTextPoint(n),new r.Size(0,0))},i.prototype.getCalculator=function(){return this.properties.lineOption===u.ConnectorLineOption.Straight?new y.ConnectorPointsCalculator(this):new p.ConnectorPointsOrthogonalCalculator(this)},i.prototype.invalidateRenderPoints=function(){delete this.renderPoints;delete this.renderPointsWithoutSkipped;this.invalidatePrimitives()},i.prototype.createPrimitives=function(){var n=[],t=this.getRenderPoints(),i=new f.PathPrimitive(t.map(function(n,t){return 0==t?new f.PathPrimitiveMoveToCommand(n.x,n.y):new f.PathPrimitiveLineToCommand(n.x,n.y)}),this.style);return n.push(i),n=(n=n.concat(this.createLineEndingPrimitives(t,i))).concat(this.createTextPrimitives())},i.prototype.createLineEndingPrimitives=function(n,t){var i=[];return n.length>1&&[{strategy:this.createLineEndingStrategy(this.properties.startLineEnding),point1:n[0],point2:n[1]},{strategy:this.createLineEndingStrategy(this.properties.endLineEnding),point1:n[n.length-1],point2:n[n.length-2]}].forEach(function(n){var r=n.strategy,u;r.hasCommands()&&(u=t,r.needCreateSeparatePrimitive()&&i.push(u=r.createPrimitive()),u.commands=u.commands.concat(r.createCommands(n.point1,n.point2)))}),i},i.prototype.createLineEndingStrategy=function(n){switch(n){case u.ConnectorLineEnding.None:return new o.ConnectorLineEndingNoneStrategy(this.style);case u.ConnectorLineEnding.Arrow:return new o.ConnectorLineEndingArrowStrategy(this.style);case u.ConnectorLineEnding.OutlinedTriangle:return new o.ConnectorLineEndingOutlinedTriangleStrategy(this.style);case u.ConnectorLineEnding.FilledTriangle:return new o.ConnectorLineEndingFilledTriangleStrategy(this.style);default:return new o.ConnectorLineEndingStrategy(this.style)}},i.prototype.createSelectorPrimitives=function(){var n=[],t=this.getRenderPoints();return n.push(new f.PathPrimitive(t.map(function(n,t){return 0==t?new f.PathPrimitiveMoveToCommand(n.x,n.y):new f.PathPrimitiveLineToCommand(n.x,n.y)}),null,"selector")),n},i.prototype.createTextPrimitives=function(){var n=this,t;return this.enableText?(t=[],this.texts.forEach(function(i){var r=n.getText(i.position),u;r&&""!==r&&(u=n.getTextPoint(i.position),t=t.concat([new w.TextPrimitive(u.x,u.y,r,nt.TextOwner.Connector,void 0,void 0,void 0,n.styleText,!0,null,d.PAGE_BG_TEXTFLOOR_FILTER_ID,void 0,function(t){k.RenderUtils.setElementEventData(t,b.MouseEventElementType.ConnectorText,n.key,i.position)})]))}),t):[]},i.prototype.getExtremeItem=function(n){return n===e.Begin?this.beginItem:n===e.End?this.endItem:null},i.prototype.getExtremeConnectionPointIndex=function(n){return n===e.Begin?this.beginConnectionPointIndex:n===e.End?this.endConnectionPointIndex:-1},Object.defineProperty(i.prototype,"rectangle",{get:function(){var n=this.getRenderPoints(),t=n.map(function(n){return n.x}),i=n.map(function(n){return n.y}),u=t.reduce(function(n,t){return Math.min(n,t)},Number.MAX_VALUE),e=t.reduce(function(n,t){return Math.max(n,t)},-Number.MAX_VALUE),f=i.reduce(function(n,t){return Math.min(n,t)},Number.MAX_VALUE),o=i.reduce(function(n,t){return Math.max(n,t)},-Number.MAX_VALUE);return r.Rectangle.create(u,f,e-u,o-f)},enumerable:!0,configurable:!0}),i.prototype.getMinX=function(){return this.getRenderPoints().map(function(n){return n.x}).reduce(function(n,t){return Math.min(n,t)},Number.MAX_VALUE)},i.prototype.getMinY=function(){return this.getRenderPoints().map(function(n){return n.y}).reduce(function(n,t){return Math.min(n,t)},Number.MAX_VALUE)},i.prototype.getConnectionPoints=function(){return[]},i.prototype.getConnectionPointSide=function(){return c.ConnectionPointSide.Undefined},i.prototype.getSegments=function(){var n=this.getRenderPoints(),t=[];return n.forEach(function(i,u){u>0&&t.push(r.Segment.createByPoints(n[u-1],i))}),t},i.prototype.intersectedByRect=function(n){var t=!1;return this.getSegments().forEach(function(i){i.intersectRect(n)&&(t=!0)}),t},i.prototype.toNative=function(){var n=new g.NativeConnector(this.key,this.dataKey);return n.fromKey=this.beginItem&&this.beginItem.dataKey,n.toKey=this.endItem&&this.endItem.dataKey,n.texts=this.texts.map(function(n){return n}).sort(function(n,t){return n.position-t.position}).map(function(n){return n.value}),n},i.minOffset=h.UnitConverter.pixelsToTwips(24),i.minTextHeight=h.UnitConverter.pixelsToTwips(12),i}(c.DiagramItem);t.Connector=a},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=i(138),h=i(35),c=i(49),g=i(152),nt=i(153),u=i(19),r=i(6),e=i(0),a=i(154),w=i(155),o=i(90),tt=i(91),it=i(156),v=i(41),s=i(11),rt=i(25),f=i(14),ut=i(42),ft=i(50),et=i(51),ot=i(18),b=i(157),l=i(158),st=i(92),y=i(68),p=i(52),ht=i(53),k=i(69),ct=i(94),lt=i(159),at=i(29),vt=function(){function n(){}return n.setShapePosition=function(n,t,i,r){i.position.equals(r)||n.addAndRedo(new d.MoveShapeHistoryItem(i.key,r))},n.setShapeSize=function(n,t,i,r,u){i.size.equals(u)&&i.position.equals(r)||n.addAndRedo(new w.ResizeShapeHistoryItem(i.key,r,u))},n.setConnectorPoint=function(n,t,i,r,u){i.points[r].equals(u)||n.addAndRedo(new c.MoveConnectorPointHistoryItem(i.key,r,u))},n.updateConnectorAttachedPoints=function(n,t,i){n.beginTransaction();var u=i.beginItem&&t.findItemCollapsedContainer(i.beginItem),e=u&&(!i.endItem||!t.isContainerItem(u,i.endItem)),r=i.endItem&&t.findItemCollapsedContainer(i.endItem),f=r&&(!i.beginItem||!t.isContainerItem(r,i.beginItem));e?this.updateConnectorBeginPoint(n,i,u,f&&r||i.endItem,function(n){return u.getConnectionPointIndexForItem(i.beginItem,n)}):this.updateConnectorBeginPoint(n,i,i.beginItem,f&&r||i.endItem);f?this.updateConnectorEndPoint(n,i,r,function(n){return r.getConnectionPointIndexForItem(i.beginItem,n)}):this.updateConnectorEndPoint(n,i,i.endItem);n.endTransaction()},n.updateConnectorBeginPoint=function(n,t,i,r,u){var s,f,o;i&&(s=void 0!==u?u(t.beginConnectionPointIndex):t.beginConnectionPointIndex,f=t.points[1],r&&2===t.points.length&&(f=-1!==t.endConnectionPointIndex?r.getConnectionPointPosition(t.endConnectionPointIndex,e.Point.empty()):r.rectangle.center),o=i.getConnectionPointPosition(s,f),t.points[0].equals(o)||n.addAndRedo(new c.MoveConnectorPointHistoryItem(t.key,0,o)))},n.updateConnectorEndPoint=function(n,t,i,r){if(i){var f=void 0!==r?r(t.endConnectionPointIndex):t.endConnectionPointIndex,u=i.getConnectionPointPosition(f,t.points[t.points.length-2]);t.points[t.points.length-1].equals(u)||n.addAndRedo(new c.MoveConnectorPointHistoryItem(t.key,t.points.length-1,u))}},n.updateContainerConnectorsAttachedPoints=function(n,t,i,r){var u=this;void 0===r&&(r=i);n.beginTransaction();t.getChildren(r).forEach(function(f){f instanceof s.Shape&&(f.attachedConnectors.forEach(function(f){var s=f.beginItem&&t.isContainerItem(r,f.beginItem),h=f.endItem&&t.isContainerItem(r,f.endItem),e,o;s&&!h&&(e=t.findItemTopCollapsedContainer(f.beginItem),o=f.endItem&&t.findItemTopCollapsedContainer(f.endItem),e?u.updateConnectorBeginPoint(n,f,e,o||f.endItem,function(n){return i.getConnectionPointIndexForItem(f.beginItem,n)}):u.updateConnectorBeginPoint(n,f,f.beginItem,o||f.endItem));h&&!s&&((e=t.findItemTopCollapsedContainer(f.endItem))?u.updateConnectorEndPoint(n,f,e,function(n){return i.getConnectionPointIndexForItem(f.endItem,n)}):u.updateConnectorEndPoint(n,f,f.endItem))}),u.updateContainerConnectorsAttachedPoints(n,t,i,f))});n.endTransaction()},n.getConnectorsWithoutBeginItemInfo=function(n){return n.findConnectorsWithoutBeginItem().map(function(n){return{connector:n,point:n.points[0].clone()}})},n.getConnectorsWithoutEndItemInfo=function(n){return n.findConnectorsWithoutEndItem().map(function(n){return{connector:n,point:n.points[n.points.length-1].clone()}})},n.updateShapeAttachedConnectors=function(t,i,r){r.attachedConnectors.forEach(function(r){n.removeConnectorIntermediatePoints(t,r);n.updateConnectorAttachedPoints(t,i,r)})},n.updateMovingShapeConnections=function(n,t,i,u,f,e){var s=this;f();i.forEach(function(i){var u=s.getMovingShapeConnectionPointIndex(t,i.point);t.rectangle.contains(i.point)||u>-1?(e(t,u),u!==i.connector.beginConnectionPointIndex&&i.connector.beginItem&&n.addAndRedo(new o.DeleteConnectionHistoryItem(i.connector,r.ConnectorPosition.Begin)),n.addAndRedo(new h.AddConnectionHistoryItem(i.connector,t,u,r.ConnectorPosition.Begin))):i.connector.beginItem&&(n.addAndRedo(new o.DeleteConnectionHistoryItem(i.connector,r.ConnectorPosition.Begin)),n.addAndRedo(new c.MoveConnectorPointHistoryItem(i.connector.key,0,i.point)))});u.forEach(function(i){var u=s.getMovingShapeConnectionPointIndex(t,i.point);t.rectangle.contains(i.point)||u>-1?(e(t,u),u!==i.connector.endConnectionPointIndex&&i.connector.endItem&&n.addAndRedo(new o.DeleteConnectionHistoryItem(i.connector,r.ConnectorPosition.End)),n.addAndRedo(new h.AddConnectionHistoryItem(i.connector,t,u,r.ConnectorPosition.End))):i.connector.endItem&&(n.addAndRedo(new o.DeleteConnectionHistoryItem(i.connector,r.ConnectorPosition.End)),n.addAndRedo(new c.MoveConnectorPointHistoryItem(i.connector.key,i.connector.points.length-1,i.point)))})},n.getMovingShapeConnectionPointIndex=function(n,t){var r=this,i=-1;return n.getConnectionPoints().forEach(function(n,u){e.GeometryUtils.getDistance(t,n)<r.connectionPointActionSize&&(i=u)}),i},n.removeUnnecessaryConnectorPoints=function(n,t,i,r){n.beginTransaction();e.GeometryUtils.removeUnnecessaryLinePoints(t.points,function(u,f){var e=!0;if(i&&i.forEach(function(n){n&&n.equals(u)&&(e=!1)}),e)return n.addAndRedo(new a.DeleteConnectorPointHistoryItem(t.key,f)),void 0!==r&&r(f),!0});n.endTransaction()},n.removeConnectorIntermediatePoints=function(n,t){if(!(t.properties.lineOption!==rt.ConnectorLineOption.Orthogonal||t.points.length<=2)){n.beginTransaction();var i=!1;if(this.isShapeIntersectConnectorPointsLine(t.beginItem,t)&&(i=!0),this.isShapeIntersectConnectorPointsLine(t.endItem,t)&&(i=!0),i)for(;t.points.length>2;)n.addAndRedo(new a.DeleteConnectorPointHistoryItem(t.key,1));n.endTransaction()}},n.isShapeIntersectConnectorPointsLine=function(n,t){if(!n)return!1;for(var i,o=r.Connector.minOffset-f.UnitConverter.pixelsToTwips(1),e=n.rectangle.inflate(o,o),u=1;u<t.points.length-1;u++){if(void 0!==i&&(i.x===t.points[u].x&&e.left<=i.x&&i.x<=e.right||i.y===t.points[u].y&&e.top<=i.y&&i.y<=e.bottom))return!0;i=t.points[u]}return!1},n.getSnappedPos=function(n,t,i,r){var u=r?n.snapStartPoint.x:n.snapStartPoint.y;return Math.round((i-u)/t)*t+u},n.tryUpdateModelSize=function(n,t,i){var r=n.modelManipulator.getModelSizeUpdateOffset();r.isEmpty()||(n.addAndRedo(new g.ModelResizeHistoryItem(r)),(r.left||r.top)&&(n.addAndRedo(new nt.UpdatePositionsOnPageResizeHistoryItem(r.left,r.top)),void 0!==i&&i(r.left,r.top)),n.modelManipulator.raiseModelRectangleChanged(t.getRectangle(!0)))},n.deleteItems=function(n,t,i,r,u){n.beginTransaction();this.deleteItemsCore(n,t,r,u);this.tryUpdateModelSize(n,t);n.addAndRedo(new v.SetSelectionHistoryItem(i,[]));n.endTransaction()},n.deleteItemsCore=function(n,t,i,u){var f=this;i.forEach(function(i){if(i instanceof s.Shape){var e=t.getChildren(i);e.length&&(e.forEach(function(i){n.addAndRedo(new l.RemoveFromContainerHistoryItem(i));f.updateAttachedConnectorsContainer(n,t,i)}),f.deleteItemsCore(n,t,e.filter(function(n){return!n.locked||u}),u));t.findItem(i.key)&&f.deleteShape(n,i)}i instanceof r.Connector&&t.findItem(i.key)&&f.deleteConnector(n,i)})},n.detachConnectors=function(n,t){for(;t.attachedConnectors.length>0;){var i=t.attachedConnectors[0];n.addAndRedo(new o.DeleteConnectionHistoryItem(i,i.beginItem===t?r.ConnectorPosition.Begin:r.ConnectorPosition.End))}},n.deleteShape=function(n,t){this.detachConnectors(n,t);n.addAndRedo(new tt.DeleteShapeHistoryItem(t.key))},n.deleteConnector=function(n,t){t.beginItem&&n.addAndRedo(new o.DeleteConnectionHistoryItem(t,r.ConnectorPosition.Begin));t.endItem&&n.addAndRedo(new o.DeleteConnectionHistoryItem(t,r.ConnectorPosition.End));n.addAndRedo(new it.DeleteConnectorHistoryItem(t.key))},n.deleteAllItems=function(n,t,i){this.deleteItems(n,t,i,t.items.slice(),!0)},n.deleteSelection=function(n,t,i){this.deleteItems(n,t,i,i.getSelectedItems())},n.changeSelectionLocked=function(t,i,r,u){t.beginTransaction();r.getSelectedItems(!0).forEach(function(n){t.addAndRedo(new ct.ChangeLockedHistoryItem(n,u))});n.updateSelection(t,r);t.endTransaction()},n.copyStylesToItem=function(n,t,i,r){var u=t.findItem(r);i.styleText.forEach(function(t){i.styleText[t]!==u.styleText[t]&&n.addAndRedo(new p.ChangeStyleTextHistoryItem(r,t,i.styleText[t]))});i.style.forEach(function(t){i.style[t]!==u.style[t]&&n.addAndRedo(new y.ChangeStyleHistoryItem(r,t,i.style[t]))})},n.updateSelection=function(n,t){n.addAndRedo(new v.SetSelectionHistoryItem(t,t.getKeys(),!0))},n.cloneShapeToOffset=function(n,t,i,r,u){var e,o,f;return n.beginTransaction(),e=i.position.offset(r,u),o=new ut.AddShapeHistoryItem(i.description,e,i.text),n.addAndRedo(o),f=o.shapeKey,n.addAndRedo(new w.ResizeShapeHistoryItem(f,e,i.size.clone())),n.addAndRedo(new st.ChangeShapeParametersHistoryItem(f,i.parameters.clone())),this.copyStylesToItem(n,t,i,f),n.endTransaction(),f},n.cloneConnectorToOffset=function(n,t,i,u,f,e,o){var a,l,s,c,v,y;return n.beginTransaction(),a=i.points.map(function(n){return n.offset(e,o)}),l=new ft.AddConnectorHistoryItem(a),n.addAndRedo(l),s=l.connectorKey,c=t.findConnector(s),(i.properties.forEach(function(t){i.properties[t]!==c.properties[t]&&n.addAndRedo(new k.ChangeConnectorPropertyHistoryItem(s,t,i.properties[t]))}),u)&&(v=t.findShape(u),n.addAndRedo(new h.AddConnectionHistoryItem(c,v,i.beginConnectionPointIndex,r.ConnectorPosition.Begin))),f&&(y=t.findShape(f),n.addAndRedo(new h.AddConnectionHistoryItem(c,y,i.endConnectionPointIndex,r.ConnectorPosition.End))),i.texts.clone().forEach(function(t){n.addAndRedo(new ht.ChangeConnectorTextHistoryItem(c,t.position,t.value))}),this.copyStylesToItem(n,t,i,s),n.endTransaction(),s},n.cloneSelectionToOffset=function(t,i,r,u,f){var s=this,e,o;t.beginTransaction();e={};o=[];r.getSelectedShapes().forEach(function(n){var r=s.cloneShapeToOffset(t,i,n,u,f);e[n.key]=r;o.push(r)});r.getSelectedConnectors().forEach(function(n){var r=n.beginItem?e[n.beginItem.key]:null,h=n.endItem?e[n.endItem.key]:null,c=s.cloneConnectorToOffset(t,i,n,r,h,u,f);o.push(c)});t.addAndRedo(new v.SetSelectionHistoryItem(r,o));n.tryUpdateModelSize(t,i);t.endTransaction()},n.findContainerByEventKey=function(t,i,r){var f=t.findContainer(r),u;return f&&!f.isLocked?f:(u=t.findShape(r),u&&u.container&&!i.hasKey(u.key)?n.findContainerByEventKey(t,i,u.container.key):void 0)},n.canInsertToContainer=function(n,t,i){return t!==i&&!(t instanceof s.Shape&&n.findChild(t,i.key))},n.canInsertSelectionToContainer=function(n,t,i){var r=!0;return t.getSelectedItems().forEach(function(t){t!==i?t instanceof s.Shape&&n.findChild(t,i.key)&&(r=!1):r=!1}),r},n.insertToContainer=function(n,t,i,r){if(!r.enableChildren)throw Error("Inpossible to add children to non-container shape.");if(this.canInsertToContainer(t,i,r)){var u=i.container;u!==r&&(n.beginTransaction(),u&&n.addAndRedo(new l.RemoveFromContainerHistoryItem(i)),n.addAndRedo(new b.InsertToContainerHistoryItem(i,r)),this.updateAttachedConnectorsContainer(n,t,i),n.endTransaction())}},n.removeFromContainer=function(n,t,i){i.container&&(n.beginTransaction(),n.addAndRedo(new l.RemoveFromContainerHistoryItem(i)),this.updateAttachedConnectorsContainer(n,t,i),n.endTransaction())},n.insertSelectionToContainer=function(n,t,i,r){var f=this,u;n.beginTransaction();u=i.getSelectedItems();u.filter(function(n){return!n.container||-1===u.indexOf(n.container)}).forEach(function(i){f.insertToContainer(n,t,i,r)});n.endTransaction()},n.removeSelectionFromContainer=function(n,t,i){var r=this;n.beginTransaction();i.getSelectedItems().forEach(function(u){u.container&&!i.hasKey(u.container.key)&&(n.addAndRedo(new l.RemoveFromContainerHistoryItem(u)),r.updateAttachedConnectorsContainer(n,t,u))});n.endTransaction()},n.getConnectorContainer=function(n){if(n.beginItem&&n.endItem&&n.beginItem.container===n.endItem.container)return n.beginItem.container},n.updateAttachedConnectorsContainer=function(n,t,i){var r=this;n.beginTransaction();i.attachedConnectors.forEach(function(i){r.updateConnectorContainer(n,t,i)});n.endTransaction()},n.updateConnectorContainer=function(n,t,i){var r=this.getConnectorContainer(i);r?n.addAndRedo(new b.InsertToContainerHistoryItem(i,r)):i.container&&n.addAndRedo(new l.RemoveFromContainerHistoryItem(i))},n.updateNewShapeProperties=function(n,t,i){t.inputPosition.getDefaultStyle().forEach(function(r){n.addAndRedo(new y.ChangeStyleHistoryItem(i,r,t.inputPosition.getDefaultStylePropertyValue(r)))});t.inputPosition.getDefaultTextStyle().forEach(function(r){n.addAndRedo(new p.ChangeStyleTextHistoryItem(i,r,t.inputPosition.getDefaultTextStylePropertyValue(r)))})},n.updateNewConnectorProperties=function(n,t,i){t.inputPosition.getDefaultConnectorProperties().forEach(function(r){n.addAndRedo(new k.ChangeConnectorPropertyHistoryItem(i,r,t.inputPosition.getDefaultConnectorPropertyValue(r)))});t.inputPosition.getDefaultStyle().forEach(function(r){n.addAndRedo(new y.ChangeStyleHistoryItem(i,r,t.inputPosition.getDefaultStylePropertyValue(r)))});t.inputPosition.getDefaultTextStyle().forEach(function(r){n.addAndRedo(new p.ChangeStyleTextHistoryItem(i,r,t.inputPosition.getDefaultTextStylePropertyValue(r)))})},n.applyLayout=function(n,t,i,r,u,f,e,o,s,h){n.beginTransaction();var c=this.getOccupiedRectangles(f,i);u=this.offsetLayoutToFreeSpace(u,i&&i.clientRectangle,c,e.containerPadding);o&&this.adjustLayoutToSnapGrid(t,u,s);i&&this.resizeContainerOnLayout(n,t,u,i,e.containerPadding);this.applyLayoutToNodes(n,t,u,r.edges.map(function(n){return t.findConnector(n.key)}));this.applyLayoutToConnectors(n,t,u,r.edges.map(function(n){return t.findConnector(n.key)}),h);n.endTransaction()},n.getNonGraphItems=function(n,t,i,u,f){return(t?n.getChildren(t):n.items.filter(function(n){return!n.container})).filter(function(n){return n instanceof r.Connector?!(n.beginItem&&i[n.beginItem.key]||n.endItem&&i[n.endItem.key]||-1!==f.indexOf(n)):n instanceof s.Shape?!i[n.key]&&-1===u.indexOf(n):void 0})},n.getOccupiedRectangles=function(n,t){var r=n.map(function(n){return n.rectangle}),i;return t&&r.length&&(i=t.clientRectangle,r.push(e.Rectangle.create(i.right,i.top,1,1)),r.push(e.Rectangle.create(i.right,i.bottom,1,1))),r},n.offsetLayoutToFreeSpace=function(n,t,i,r){var f=n.getRectangle(!0),u=e.GeometryUtils.findFreeSpace(i,f.size.offset(r,r),!1,t),o,s,h,c;return u?(o=u.x+r,s=u.y+r,n.offsetNodes(o,s)):(h=i&&i.length?i.reduce(function(n,t){return t.right>n?t.right:n},0):t?t.left:0,c=t?t.top:Math.max(0,f.top),n.offsetNodes(h+r,c+r))},n.resizeContainerOnLayout=function(t,i,r,u,f){var o=r.getRectangle(!0),h=u.rectangle.width,s;u.rectangle.right<o.right+f&&(h+=o.right+f-u.rectangle.right);s=u.rectangle.height;u.rectangle.bottom<o.bottom+f&&(s+=o.bottom+f-u.rectangle.bottom);n.setShapeSize(t,i,u,u.position,new e.Size(h,s))},n.applyLayoutToNodes=function(n,t,i,r){var u=this,f=r.reduce(function(n,t){return n[t.key]=n},{});i.forEachNode(function(i,r){var e=t.findShape(r);u.applyLayoutToNode(n,t,e,i.position,f)})},n.applyLayoutToNode=function(t,i,r,u,f){var o=this,e=u.offset(-r.position.x,-r.position.y);n.setShapePosition(t,i,r,u);0===e.x&&0===e.y||(r.attachedConnectors.filter(function(n){return!f[n.key]}).forEach(function(r){n.updateConnectorAttachedPoints(t,i,r);for(var f=r.beginItem?1:0,o=r.endItem?r.points.length-2:r.points.length-1,u=f;u<=o;u++)t.addAndRedo(new c.MoveConnectorPointHistoryItem(r.key,u,r.points[u].offset(e.x,e.y)))}),i.getChildren(r).forEach(function(n){if(n instanceof s.Shape){var r=n.position.offset(e.x,e.y);o.applyLayoutToNode(t,i,n,r,f)}}))},n.applyLayoutToConnectors=function(n,t,i,u,f){var e=this;u.filter(function(n){return n.beginItem||n.endItem}).forEach(function(u){var o=i.edgeToPosition[u.key],s,c;if(u.beginItem&&u.endItem&&!f&&o&&(s=u.beginItem.getConnectionPointIndexForSide(o.beginIndex),s!==u.beginConnectionPointIndex&&n.addAndRedo(new h.SetConnectionPointIndexHistoryItem(u,s,r.ConnectorPosition.Begin)),c=u.endItem.getConnectionPointIndexForSide(o.endIndex),c!==u.endConnectionPointIndex&&n.addAndRedo(new h.SetConnectionPointIndexHistoryItem(u,c,r.ConnectorPosition.End))),e.updateConnectorAttachedPoints(n,t,u),o)for(;u.points.length>2;)n.addAndRedo(new a.DeleteConnectorPointHistoryItem(u.key,1))})},n.adjustLayoutToSnapGrid=function(n,t,i){var r=this;t.nodeKeys.forEach(function(u){t.nodeToLayout[u].position.x=r.getSnappedPos(n,i,t.nodeToLayout[u].position.x,!0);t.nodeToLayout[u].position.y=r.getSnappedPos(n,i,t.nodeToLayout[u].position.y,!1)})},n.getGraphInfoByItems=function(n,t,i,r){var u,o,e,f,h,s;void 0===r&&(r=!1);u={};[].concat(t).concat(i).forEach(function(n){var t=n.container&&n.container.key;u[t]||(u[t]=[]);u[t].push(n)});o=[];for(e in u)u.hasOwnProperty(e)&&(f=e&&n.findContainer(e),(!f||f.expanded)&&(h=f&&f.key,s=this.getGraphByItems(n,u[e],h,r),s.nodes.length>1&&o.push(new lt.GraphInfo(f,s))));return o},n.getGraphByItems=function(n,t,i,r){var f=this,u=new et.Graph([],[]),e={};return t.forEach(function(n){f.extendByConnectedComponents(n,u,i,e,r)}),u.nodes.sort(function(t,i){return n.getItemIndex(n.findItem(t))-n.getItemIndex(n.findItem(i))}),u.edges.sort(function(t,i){return n.getItemIndex(n.findItem(t.key))-n.getItemIndex(n.findItem(i.key))}),u.edges=u.edges.filter(function(n){return u.getNode(n.from)&&u.getNode(n.to)}),u},n.extendByConnectedComponents=function(n,t,i,u,f){var e=this;!n||f&&n.locked||u[n.key]||(u[n.key]=!0,!(n instanceof r.Connector&&(n.container&&n.container.key)===i&&n.beginItem)||n.beginItem.locked&&f||!n.endItem||n.endItem.locked&&f||n.beginItem===n.endItem?n instanceof s.Shape&&(n.container&&n.container.key)===i&&(t.addNode(n),n.attachedConnectors.forEach(function(n){return e.extendByConnectedComponents(n,t,i,u,f)})):(t.addEdge(new at.Edge(n.key,n.beginItem&&n.beginItem.key,n.endItem&&n.endItem.key)),this.extendByConnectedComponents(n.beginItem,t,i,u,f),this.extendByConnectedComponents(n.endItem,t,i,u,f)))},n.getlUnitValue=function(n,t){switch(n){case u.DiagramUnit.Cm:return f.UnitConverter.twipsToCentimeters(t);case u.DiagramUnit.In:return f.UnitConverter.twipsToInches(t);case u.DiagramUnit.Px:return f.UnitConverter.twipsToPixels(t)}},n.getUnitText=function(n,t,i,r,f){void 0===f&&(f=2);var e=t[n]?" "+t[n]:"",o=this.getlUnitValue(n,r);switch(n){case u.DiagramUnit.Cm:case u.DiagramUnit.In:return i(+o.toFixed(f))+e;case u.DiagramUnit.Px:return i(+o.toFixed(0))+e}},n.getTwipsValue=function(n,t){switch(n){case u.DiagramUnit.Cm:return f.UnitConverter.centimetersToTwips(t);case u.DiagramUnit.In:return f.UnitConverter.inchesToTwips(t);case u.DiagramUnit.Px:return f.UnitConverter.pixelsToTwips(t)}},n.getNextItemKey=function(n,t,i){var u,r;if(!n.length&&void 0===i)return"0";for(u=n.length-1;u>=0&&null==(i=i||n[u]);u--);for(r=this.generateNextItemKey(i||"0");!t(r);)r=this.generateNextItemKey(r);return r},n.generateNextItemKey=function(n){for(var r,i,t=n.length-1;t>=0;t--){if(!this.isDigit(n[t])){t===n.length-1&&(n+="0");break}if(r=n.charCodeAt(t),i=String.fromCharCode(r+1),i>"9"&&(i="0",0!==t&&this.isDigit(n[t-1])||(i="1"+i)),n=n.substr(0,t)+i+n.substr(t+1),"0"!==i&&"10"!==i)break;"10"===i&&t--}return n},n.isDigit=function(n){return"0"<=n&&n<="9"},n.getGuidItemKey=function(){return ot.CreateGuid()},n.connectionPointActionSize=f.UnitConverter.pixelsToTwips(8),n}();t.ModelUtils=vt},function(n,t,i){"use strict";var f,e=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(161),s=i(162),r=i(7),u=i(4),h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.getState=function(){return new s.SimpleCommandState(this.isEnabled(),this.getValue(),this.getDefaultValue(),this.getItems(),this.isVisible())},t.prototype.isVisible=function(){return!0},t.prototype.isEnabled=function(){return!this.control.settings.readOnly||this.isEnabledInReadOnlyMode()},t.prototype.isEnabledInReadOnlyMode=function(){return!1},t.prototype.getValue=function(){},t.prototype.getDefaultValue=function(){},t.prototype.getItems=function(){},t.prototype.getModelUnit=function(n){return r.ModelUtils.getlUnitValue(this.control.model.units,n)},t.prototype.getModelUnitText=function(n){return r.ModelUtils.getUnitText(this.control.model.units,u.DiagramLocalizationService.unitItems,u.DiagramLocalizationService.formatUnit,n)},t.prototype.getModelUnitTwipsValue=function(n){return r.ModelUtils.getTwipsValue(this.control.model.units,n)},t.prototype.getViewUnit=function(n){return r.ModelUtils.getlUnitValue(this.control.settings.viewUnits,n)},t.prototype.getViewUnitText=function(n){return r.ModelUtils.getUnitText(this.control.settings.viewUnits,u.DiagramLocalizationService.unitItems,u.DiagramLocalizationService.formatUnit,n)},t.prototype.getViewUnitTwipsValue=function(n){return r.ModelUtils.getTwipsValue(this.control.settings.viewUnits,n)},t}(o.CommandBase);t.SimpleCommandBase=h},function(n,t,i){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),f=i(46),h=i(20),r=i(5),c=i(14),u=i(33),e=i(4),l=i(48);t.ShapeDefaultDimension=1440;t.ShapeMinDimension=360;t.ShapeDefaultSize=new s.Size(t.ShapeDefaultDimension,t.ShapeDefaultDimension);o=function(){function n(n,i){void 0===n&&(n=t.ShapeDefaultSize.clone());this.defaultSize=n;this.hasDefaultText=i;this.connectionPoints=this.createConnectionPoints()}return Object.defineProperty(n.prototype,"enableText",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowEditText",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enableImage",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowEditImage",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"enableChildren",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minWidth",{get:function(){return t.ShapeMinDimension},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minHeight",{get:function(){return t.ShapeMinDimension},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxHeight",{get:function(){},enumerable:!0,configurable:!0}),n.prototype.getTitle=function(){return e.DiagramLocalizationService.shapeTexts[this.key]},n.prototype.getDefaultText=function(){return this.hasDefaultText?e.DiagramLocalizationService.shapeTexts[this.key]:""},n.prototype.getDefaultImageUrl=function(){return""},n.prototype.getConnectionPoints=function(){return this.connectionPoints},n.prototype.createConnectionPoints=function(){return[new u.ConnectionPoint(.5,0,r.ConnectionPointSide.North),new u.ConnectionPoint(1,.5,r.ConnectionPointSide.East),new u.ConnectionPoint(.5,1,r.ConnectionPointSide.South),new u.ConnectionPoint(0,.5,r.ConnectionPointSide.West)]},n.prototype.processConnectionPoint=function(){},n.prototype.getConnectionPointIndexForItem=function(n,t){return t},n.prototype.getConnectionPointIndexForSide=function(n){return n},n.prototype.createParameters=function(){},n.prototype.normalizeParameters=function(){},n.prototype.modifyParameters=function(){throw Error("Not implemented");},n.prototype.changeParameterValue=function(n,t,i){var r=n.get(t);r.value=i(r)},n.prototype.getParameterPoints=function(){return[]},n.prototype.getExpandedSize=function(n){return n.size},n.prototype.getCollapsedSize=function(n){return n.size},n.prototype.getToolboxHeightToWidthRatio=function(n,t){return t/n},n.prototype.allowResizeHorizontally=function(){return!0},n.prototype.allowResizeVertically=function(){return!0},n.prototype.createPrimitives=function(n,t){var i=[];return i=i.concat(this.createShapePrimitives(n,t)),this.enableImage&&(i=i.concat(this.createImagePrimitives(n,t))),this.enableText&&(i=i.concat(this.createTextPrimitives(n,t))),i},n.prototype.createImagePrimitives=function(){return[]},n.prototype.createTextPrimitives=function(t){if(void 0===t.text||""===t.text)return[];var i=this.getTextRectangle(t);return[new f.TextPrimitive(i.left,i.top,t.text,l.TextOwner.Shape,i.width,i.height,n.textSpacing,t.styleText,!1,void 0,void 0,this.getTextAngle())]},n.prototype.getTextAngle=function(){return f.TextAngle.Angle0deg},n.prototype.getTextRectangle=function(n){return n.rectangle},n.prototype.getClientRectangle=function(n){return n.rectangle},n.prototype.getTextEditRectangle=function(n){return this.getTextRectangle(n)},n.prototype.createSelectorPrimitives=function(n){return[new h.RectanglePrimitive(n.position.x,n.position.y,n.size.width,n.size.height,null,"selector")]},n.textSpacing=c.UnitConverter.pixelsToTwips(2),n}();t.ShapeDescription=o},function(n,t,i){"use strict";var e,r=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}e(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o,s,u,h,c,f,l,a,v,y,p;Object.defineProperty(t,"__esModule",{value:!0});o=i(13);!function(n){n[n.None=0]="None";n[n.Left=1]="Left";n[n.Right=2]="Right";n[n.Middle=4]="Middle"}(t.MouseButton||(t.MouseButton={})),function(n){n[n.Undefined=0]="Undefined";n[n.Background=1]="Background";n[n.Document=2]="Document";n[n.Connector=3]="Connector";n[n.ConnectorPoint=4]="ConnectorPoint";n[n.ConnectorSide=5]="ConnectorSide";n[n.ConnectorOrthogonalSide=6]="ConnectorOrthogonalSide";n[n.ConnectorText=7]="ConnectorText";n[n.Shape=8]="Shape";n[n.ShapeResizeBox=9]="ShapeResizeBox";n[n.ShapeParameterBox=10]="ShapeParameterBox";n[n.SelectionRect=11]="SelectionRect";n[n.ShapeConnectionPoint=12]="ShapeConnectionPoint";n[n.ShapeExpandButton=13]="ShapeExpandButton"}(t.MouseEventElementType||(t.MouseEventElementType={}));s=function(){return function(n,t,i){this.type=n;this.key=t;this.value=i}}();t.MouseEventSource=s,function(n){n[n.Undefined=0]="Undefined";n[n.ResizeBox_NW=1]="ResizeBox_NW";n[n.ResizeBox_NE=2]="ResizeBox_NE";n[n.ResizeBox_SE=3]="ResizeBox_SE";n[n.ResizeBox_SW=4]="ResizeBox_SW";n[n.ResizeBox_N=5]="ResizeBox_N";n[n.ResizeBox_E=6]="ResizeBox_E";n[n.ResizeBox_S=7]="ResizeBox_S";n[n.ResizeBox_W=8]="ResizeBox_W"}(t.ResizeEventSource||(t.ResizeEventSource={}));u=function(){return function(n){this.modifiers=n}}();t.DiagramEvent=u;h=function(n){function t(t){var i=n.call(this,o.ModifierKey.None)||this;return i.inputText=t,i}return r(t,n),t}(u);t.DiagramFocusEvent=h;c=function(){return function(n,t){this.offsetPoint=n;this.modelPoint=t}}();t.DiagramMouseEventTouch=c;f=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.offsetPoint=i,f.modelPoint=r,f.source=u,f}return r(t,n),t}(u);t.DiagramMouseEventBase=f;l=function(n){function t(t,i,r,u,f,e){void 0===e&&(e=[]);var o=n.call(this,t,r,u,f)||this;return o.button=i,o.touches=e,o.scrollX=0,o.scrollY=0,o}return r(t,n),t}(f);t.DiagramMouseEvent=l;a=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,u,f,e)||this;return o.deltaX=i,o.deltaY=r,o}return r(t,n),t}(f);t.DiagramWheelEvent=a;v=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.eventPoint=i,u.modelPoint=r,u}return r(t,n),t}(u);t.DiagramContextMenuEvent=v;y=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.keyCode=i,u.inputText=r,u}return r(t,n),t.prototype.getShortcutCode=function(){return this.modifiers|this.keyCode},t}(u);t.DiagramKeyboardEvent=y;p=function(n){function t(t){var i=n.call(this,o.ModifierKey.None)||this;return i.clipboardData=t,i}return r(t,n),t}(u);t.DiagramClipboardEvent=p},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(0),o=i(28),r=i(5),s=i(33),h=i(40),c=i(66),l=function(n){function t(t,i){var r=n.call(this)||this;if(r.description=t,r.children=[],r.expanded=!0,r.expandedSize=void 0,!t)throw Error("Shape type is incorrect");return r.position=i.clone(),r.size=t.defaultSize.clone(),r.text=t.getDefaultText(),r.image=new h.ImageInfo(t.getDefaultImageUrl()),r.parameters=new o.ShapeParameters,t.createParameters(r.parameters),r}return f(t,n),t.prototype.assign=function(t){n.prototype.assign.call(this,t);t.size=this.size.clone();t.text=this.text;t.image=this.image.clone();t.parameters=this.parameters.clone();t.children=this.children.slice();t.expanded=this.expanded;this.expandedSize&&(t.expandedSize=this.expandedSize.clone())},t.prototype.clone=function(){var n=new t(this.description,this.position.clone());return this.assign(n),n},Object.defineProperty(t.prototype,"enableText",{get:function(){return this.description.enableText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowEditText",{get:function(){return this.description.allowEditText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableChildren",{get:function(){return this.description.enableChildren},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableImage",{get:function(){return this.description.enableImage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowEditImage",{get:function(){return this.description.allowEditImage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this.description.minWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this.description.minHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.description.maxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this.description.maxHeight},enumerable:!0,configurable:!0}),t.prototype.createPrimitives=function(){return this.description.createPrimitives(this)},t.prototype.createSelectorPrimitives=function(){return this.description.createSelectorPrimitives(this)},t.prototype.normalizeX=function(n){return Math.max(this.position.x,Math.min(n,this.position.x+this.size.width))},t.prototype.normalizeY=function(n){return Math.max(this.position.y,Math.min(n,this.position.y+this.size.height))},t.prototype.getConnectionPoints=function(){var n=this;return this.description.getConnectionPoints().map(function(t){var i=new s.ConnectionPoint(n.position.x+t.x*n.size.width,n.position.y+t.y*n.size.height,t.side);return n.description.processConnectionPoint(n,i),i})},t.prototype.getConnectionPointSide=function(n){return n.side!==r.ConnectionPointSide.Undefined?n.side:this.getConnectionPointSideByGeometry(n)},t.prototype.getConnectionPointSideByGeometry=function(n){var t=n.offset(-this.position.x,-this.position.y).multiply(1/this.size.width,1/this.size.height);return t.x>=t.y&&(t.x>0||t.y>0)?t.x<.5||1-t.x>=t.y?r.ConnectionPointSide.North:r.ConnectionPointSide.East:t.x>.5||1-t.x<=t.y?r.ConnectionPointSide.South:r.ConnectionPointSide.West},t.prototype.getConnectionPointIndexForItem=function(n,t){return this.description.getConnectionPointIndexForItem(n,t)},t.prototype.getConnectionPointIndexForSide=function(n){return this.description.getConnectionPointIndexForSide(n)},t.prototype.toggleExpandedSize=function(){this.expanded?(this.size=this.getExpandedSize(),this.expandedSize=void 0):(this.expandedSize=this.size.clone(),this.size=this.getCollapsedSize())},t.prototype.getExpandedSize=function(){return this.description.getExpandedSize(this)},t.prototype.getCollapsedSize=function(){return this.description.getCollapsedSize(this)},t.prototype.getToolboxHeightToWidthRatio=function(){return this.description.getToolboxHeightToWidthRatio(this.size.width,this.size.height)},Object.defineProperty(t.prototype,"allowResizeHorizontally",{get:function(){return this.description.allowResizeHorizontally(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowResizeVertically",{get:function(){return this.description.allowResizeVertically(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rectangle",{get:function(){return new e.Rectangle(this.position,this.size)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientRectangle",{get:function(){return this.description.getClientRectangle(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textRectangle",{get:function(){return this.description.getTextRectangle(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textEditRectangle",{get:function(){return this.description.getTextEditRectangle(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAngle",{get:function(){return this.description.getTextAngle()},enumerable:!0,configurable:!0}),t.prototype.toNative=function(){var n=new c.NativeShape(this.key,this.dataKey);return n.type=this.description.key,n.text=this.text,n},t}(r.DiagramItem);t.Shape=l},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=i(64);t.svgNS="http://www.w3.org/2000/svg";u=/\s/gm;f=function(){function n(){}return n.createSvgElement=function(n,i){void 0===i&&(i=!1);var r=document.createElementNS(t.svgNS,"svg");return r.className.baseVal="dxdi-canvas"+(i?" export":""),n&&n.appendChild(r),r},n.createMainElement=function(n,t){void 0===t&&(t=!1);var i=document.createElement("div");return i.setAttribute("class","dxdi-control"+(t?" measurer":"")),r.Diagnostics.optimizeLayers&&(i.style.transform="translateZ(0)"),n&&n.appendChild(i),i},n.textToWords=function(n){return n.split(u).filter(function(n){return n.length})},n.addEventListener=function(n,t,i){n.addEventListener(t,i)},n.removeEventListener=function(n,t,i){n.removeEventListener(t,i)},n}();t.RenderHelper=f},function(n,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.None=0]="None";n[n.Ctrl=65536]="Ctrl";n[n.Shift=262144]="Shift";n[n.Alt=1048576]="Alt";n[n.Meta=16777216]="Meta"}(i=t.ModifierKey||(t.ModifierKey={})),function(n){n[n.Backspace=8]="Backspace";n[n.Tab=9]="Tab";n[n.Enter=13]="Enter";n[n.Pause=19]="Pause";n[n.CapsLock=20]="CapsLock";n[n.Esc=27]="Esc";n[n.Space=32]="Space";n[n.PageUp=33]="PageUp";n[n.PageDown=34]="PageDown";n[n.End=35]="End";n[n.Home=36]="Home";n[n.Left=37]="Left";n[n.Up=38]="Up";n[n.Right=39]="Right";n[n.Down=40]="Down";n[n.Insert=45]="Insert";n[n.Delete=46]="Delete";n[n.Key_0=48]="Key_0";n[n.Key_1=49]="Key_1";n[n.Key_2=50]="Key_2";n[n.Key_3=51]="Key_3";n[n.Key_4=52]="Key_4";n[n.Key_5=53]="Key_5";n[n.Key_6=54]="Key_6";n[n.Key_7=55]="Key_7";n[n.Key_8=56]="Key_8";n[n.Key_9=57]="Key_9";n[n.Key_a=65]="Key_a";n[n.Key_b=66]="Key_b";n[n.Key_c=67]="Key_c";n[n.Key_d=68]="Key_d";n[n.Key_e=69]="Key_e";n[n.Key_f=70]="Key_f";n[n.Key_g=71]="Key_g";n[n.Key_h=72]="Key_h";n[n.Key_i=73]="Key_i";n[n.Key_j=74]="Key_j";n[n.Key_k=75]="Key_k";n[n.Key_l=76]="Key_l";n[n.Key_m=77]="Key_m";n[n.Key_n=78]="Key_n";n[n.Key_o=79]="Key_o";n[n.Key_p=80]="Key_p";n[n.Key_q=81]="Key_q";n[n.Key_r=82]="Key_r";n[n.Key_s=83]="Key_s";n[n.Key_t=84]="Key_t";n[n.Key_u=85]="Key_u";n[n.Key_v=86]="Key_v";n[n.Key_w=87]="Key_w";n[n.Key_x=88]="Key_x";n[n.Key_y=89]="Key_y";n[n.Key_z=90]="Key_z";n[n.Windows=91]="Windows";n[n.ContextMenu=93]="ContextMenu";n[n.Numpad_0=96]="Numpad_0";n[n.Numpad_1=97]="Numpad_1";n[n.Numpad_2=98]="Numpad_2";n[n.Numpad_3=99]="Numpad_3";n[n.Numpad_4=100]="Numpad_4";n[n.Numpad_5=101]="Numpad_5";n[n.Numpad_6=102]="Numpad_6";n[n.Numpad_7=103]="Numpad_7";n[n.Numpad_8=104]="Numpad_8";n[n.Numpad_9=105]="Numpad_9";n[n.Multiply=106]="Multiply";n[n.Add=107]="Add";n[n.Subtract=109]="Subtract";n[n.Decimal=110]="Decimal";n[n.Divide=111]="Divide";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F3=114]="F3";n[n.F4=115]="F4";n[n.F5=116]="F5";n[n.F6=117]="F6";n[n.F7=118]="F7";n[n.F8=119]="F8";n[n.F9=120]="F9";n[n.F10=121]="F10";n[n.F11=122]="F11";n[n.F12=123]="F12";n[n.NumLock=144]="NumLock";n[n.ScrollLock=145]="ScrollLock";n[n.Semicolon=186]="Semicolon";n[n.Equals=187]="Equals";n[n.Comma=188]="Comma";n[n.Dash=189]="Dash";n[n.Period=190]="Period";n[n.ForwardSlash=191]="ForwardSlash";n[n.GraveAccent=192]="GraveAccent";n[n.OpenBracket=219]="OpenBracket";n[n.BackSlash=220]="BackSlash";n[n.CloseBracket=221]="CloseBracket";n[n.SingleQuote=222]="SingleQuote"}(t.KeyCode||(t.KeyCode={}));t.getKeyModifiers=function(n){var t=0;return n.altKey&&(t|=i.Alt),n.ctrlKey&&(t|=i.Ctrl),n.shiftKey&&(t|=i.Shift),n.metaKey&&(t|=i.Meta),t}},function(n,t){"use strict";var u,r,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i,f,e;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Centimeter=0]="Centimeter";n[n.Inch=1]="Inch"}(r=t.RichEditUnit||(t.RichEditUnit={}));i=function(){function n(){}return n.getConverter=function(n){switch(n){case r.Centimeter:return new f;case r.Inch:return new e;default:throw new Error;}},n.pixelsToTwips=function(t){return Math.round(n.pixelsToTwipsF(t))},n.inchesToTwips=function(t){return Math.round(n.inchesToTwipsF(t))},n.pointsToTwips=function(t){return Math.round(n.pointsToTwipsF(t))},n.picasToTwips=function(t){return Math.round(1440*t/n.PICAS_PER_INCH)},n.centimetersToTwips=function(t){return Math.round(n.centimetersToTwipsF(t))},n.pixelsToTwipsF=function(t){return 1440*t/n.DPI},n.inchesToTwipsF=function(n){return 1440*n},n.pointsToTwipsF=function(n){return 20*n},n.centimetersToTwipsF=function(t){return 1440*t/n.CENTIMETERS_PER_INCH},n.modelUnitsToDegrees=function(n){return n/6e4},n.modelUnitsToRadians=function(n){return n/6e4*Math.PI/180},n.degreesToModelUnits=function(n){return 6e4*n},n.radiansToModelUnits=function(n){return 6e4*n/Math.PI*180},n.radiansToDegrees=function(n){return n/Math.PI*180},n.fdToModelUnits=function(n){return Math.round(1875*n/2048)},n.emuToTwips=function(n){return n/635},n.twipsToPixels=function(t){return Math.round(n.twipsToPixelsF(t))},n.inchesToPixels=function(t){return Math.round(n.DPI*t)},n.centimeterToPixel=function(t){return Math.round(t/(n.CENTIMETERS_PER_INCH/n.DPI))},n.pointsToPixels=function(t){return Math.round(t*n.DPI/72)},n.pointsToPixelsF=function(t){return t*n.DPI/72},n.twipsToPixelsF=function(t){return t*n.DPI/1440},n.pixelsToPoints=function(t){return Math.round(72*t/n.DPI)},n.twipsToPoints=function(n){return Math.round(this.twipsToPointsF(n))},n.twipsToPointsF=function(n){return n/20},n.twipsToInches=function(n){return n/1440},n.pixelsToInches=function(t){return t/n.DPI},n.twipsToCentimeters=function(t){return t*n.CENTIMETERS_PER_INCH/1440},n.pixelToCentimeters=function(t){return t*n.CENTIMETERS_PER_INCH/n.DPI},n.hundredthsOfMillimeterToModelUnits=function(n){return 15*n/127},n.twipsToEmu=function(n){return 635*n},n.twipsToDegree=function(n){return n/6e4},n.DPI=96,n.CENTIMETERS_PER_INCH=2.54,n.PICAS_PER_INCH=6,n}();t.UnitConverter=i;f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.getUnits=function(){return r.Centimeter},t.prototype.twipsToUI=function(n){return i.twipsToCentimeters(n)},t.prototype.UIToTwips=function(n){return i.centimetersToTwips(n)},t}(i);t.UIUnitConverterCentimeter=f;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.getUnits=function(){return r.Inch},t.prototype.twipsToUI=function(n){return i.twipsToInches(n)},t.prototype.UIToTwips=function(n){return i.inchesToTwips(n)},t}(i);t.UIUnitConverterInch=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(10),u=i(18),f=i(24),e=function(){function n(){}return n.updateSvgElementSize=function(n,t,i,r){n.style.width=t+"px";n.style.height=i+"px";n.setAttribute("viewBox","0 0 "+t+" "+i);r&&(n.setAttribute("width",t.toString()),n.setAttribute("height",i.toString()))},n.removeElement=function(n){n&&n.parentNode&&n.parentNode.removeChild(n)},n.removeContent=function(n){for(;n&&n.firstChild;)n.removeChild(n.firstChild)},n.setElementEventData=function(n,t,i,u){t!==r.MouseEventElementType.Undefined&&(n.setAttribute("data-type",t.toString()),void 0!==i&&n.setAttribute("data-key",i.toString()),void 0!==u&&n.setAttribute("data-value",u.toString()))},n.getElementEventData=function(n){if(n.getAttribute&&n.getAttribute("data-type"))return new r.MouseEventSource(parseInt(n.getAttribute("data-type")),n.getAttribute("data-key"),n.getAttribute("data-value"));var t=n.getAttribute&&n.getAttribute("class");if("dxdi-page"===t||"dxdi-main"===t)return new r.MouseEventSource(r.MouseEventElementType.Document)},n.getHtmlElementStylePropertyName=function(n){switch(n){case"fill":return"color";case"text-anchor":return"text-align"}return n},n.getTextAnchorValue=function(n,t){if(void 0===t&&(t=!1),t){if("start"===n)return"end";if("end"===n)return"start"}return n},n.getStrokeDasharrayValue=function(n,t){return t?n.split(",").map(function(n){return parseInt(n)/2*t}).join(","):n},n.applyStyleToElement=function(n,t,i){var r=this,u;void 0===i&&(i=!1);u=n.getDefaultInstance();n.forEach(function(f){var e=n[f],o=t instanceof HTMLElement?r.getHtmlElementStylePropertyName(f):f;if(void 0!==e&&""!==e&&e!==u[f]){switch(f){case"text-anchor":e=r.getTextAnchorValue(e,i);break;case"stroke-dasharray":e=r.getStrokeDasharrayValue(e,parseInt(n["stroke-width"]))}t.style.setProperty(o,e)}else t.style.setProperty(o,"")})},n.generateSvgElementId=function(n){return n+"_"+u.CreateGuid()},n.GetUrlPathById=function(n){return f.Browser.Safari?"url("+location.protocol+"//"+location.host+location.pathname+"#"+n+")":"url(#"+n+")"},n}();t.RenderUtils=e;t.raiseEvent=function(n,t,i){i(t);t.preventDefault&&n.preventDefault()}},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(9),e=i(0),o=i(20),s=i(1),h=function(n){function t(t,i){return void 0===t&&(t=new e.Size(u.ShapeDefaultDimension,.75*u.ShapeDefaultDimension)),n.call(this,t,i)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.Rectangle},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,i=t.left,r=t.top,u=t.width,f=t.height;return[new o.RectanglePrimitive(i,r,u,f,n.style)]},t}(u.ShapeDescription);t.RectangleShapeDescription=h},function(n,t,i){"use strict";var r,c=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f,e,o,s,h;Object.defineProperty(t,"__esModule",{value:!0});u=i(6);f=function(){return function(n){this.orientation=o.Vertical;this.direction=e.Forward;var t=n&&2*n>u.Connector.minOffset?2*n:u.Connector.minOffset;this.columnSpacing=t;this.layerSpacing=2*t;this.containerPadding=2*t;this.componentSpacing=2*t}}();t.LayoutSettings=f;h=function(n){function t(t){var i=n.call(this,t)||this;return i.alignment=s.Center,i.subTreeColumnSpacing=i.componentSpacing/2,i}return c(t,n),t}(f);t.TreeLayoutSettings=h,function(n){n[n.Backward=0]="Backward";n[n.Forward=1]="Forward"}(e=t.LogicalDirectionKind||(t.LogicalDirectionKind={})),function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"}(o=t.DataLayoutOrientation||(t.DataLayoutOrientation={})),function(n){n[n.Left=0]="Left";n[n.Center=1]="Center"}(s=t.Alignment||(t.Alignment={}))},function(n,t,i){"use strict";function e(n){return void 0!==n&&null!=n}function h(n,t,i,r){if(r){var u=t.search("[A-Z]");-1!=u&&(t=t.replace(t.charAt(u),"-"+t.charAt(u).toLowerCase()));n.style.setProperty?n.style.setProperty(t,i,"important"):n.style.cssText+=";"+t+":"+i+"!important"}else n.style[t]=i}function w(){var n=r.Browser.IE&&"hidden"==f(document.body).overflow&&document.body.scrollTop>0;return r.Browser.WebKitFamily||r.Browser.Edge||n?r.Browser.MacOSMobilePlatform?window.pageYOffset:r.Browser.WebKitFamily&&document.documentElement.scrollTop||document.body.scrollTop:document.documentElement.scrollTop}function tt(n){var t,i;if("object"!=typeof n||null==n)return n;t={};for(i in n)t[i]=n[i];return t}function f(n){var i,u,t,f,e;if(n.currentStyle)return n.currentStyle;if(document.defaultView&&document.defaultView.getComputedStyle){if(i=document.defaultView.getComputedStyle(n,null),!i&&r.Browser.Firefox&&window.frameElement){for(u=[],t=window.frameElement;!(i=document.defaultView.getComputedStyle(n,null));)u.push([t,t.style.display]),h(t,"display","block",!0),t="BODY"==t.tagName?t.ownerDocument.defaultView.frameElement:t.parentNode;for(i=tt(i),e=0;f=u[e];e++)h(f[0],"display",f[1],!1);document.body.offsetWidth}return i}return window.getComputedStyle(n,null)}function b(){var n=r.Browser.IE&&"hidden"==f(document.body).overflow&&document.body.scrollLeft>0;return r.Browser.Edge||n?document.body?document.body.scrollLeft:document.documentElement.scrollLeft:r.Browser.WebKitFamily?document.documentElement.scrollLeft||document.body.scrollLeft:document.documentElement.scrollLeft}function it(){try{return document.activeElement}catch(n){return null}}function rt(n,t){try{if(n.focus(),r.Browser.IE&&document.activeElement!=n&&n.focus(),t){var i=Selection.GetInfo(n);if(i.startPos==i.endPos)switch(t){case"start":Selection.SetCaretPosition(n,0);break;case"all":Selection.Set(n)}}}catch(n){}}function ut(n,t){try{return!!n.className&&-1!=n.className.indexOf(t)}catch(n){return!1}}function ft(n,t){n&&"string"==typeof t&&(s(n,t=t.trim())||""===t||(n.className=""===n.className?t:n.className+" "+t))}function s(n,t){var f,r,u,i;try{if(r=n.classList,!r){if(!n.className)return!1;f=n.className.split(" ")}for(u=t.split(" "),i=u.length-1;i>=0;i--)if(r){if(!r.contains(u[i]))return!1}else if(nt.Data.ArrayIndexOf(f,u[i])<0)return!1;return!0}catch(n){return!1}}function et(n,t){if(n){var i=" "+n.className+" ",r=i.replace(" "+t+" "," ");i.length!=r.length&&(n.className=y.Str.Trim(r))}}function ot(n){return r.Browser.IE?function(n){return null==n||r.Browser.IE&&null==n.parentNode?0:n.getBoundingClientRect().top+w()}(n):r.Browser.Firefox&&r.Browser.Version>=3?st(n):r.Browser.Opera?function(n){var i=!0,t;for(n&&"TR"==n.tagName&&n.cells.length>0&&(n=n.cells[0]),t=a(n,!1);null!=n;)t+=n.offsetTop,i||(t-=n.scrollTop),n=n.offsetParent,i=!1;return t+document.body.scrollTop}(n):r.Browser.NetscapeFamily&&(!r.Browser.Firefox||r.Browser.Version<3)?function(n){for(var t=a(n,!1),i=!0,u;null!=n;)(t+=n.offsetTop,i||null==n.offsetParent||(t-=n.scrollTop),!i&&r.Browser.Firefox)&&(u=f(n),"DIV"==n.tagName&&"visible"!=u.overflow&&(t+=c(u.borderTopWidth))),i=!1,n=n.offsetParent;return t}(n):r.Browser.WebKitFamily||r.Browser.Edge?st(n):function(n){for(var t=0,i=!0;null!=n;)t+=n.offsetTop,i||null==n.offsetParent||(t-=n.scrollTop),i=!1,n=n.offsetParent;return t}(n)}function st(n){if(null==n)return 0;var t=n.getBoundingClientRect().top+w();return Math.round(t)}function a(n,t){for(var i,r=0,u=!0;null!=n&&"BODY"!=n.tagName;){if(i=f(n),"absolute"==i.position)break;u||"DIV"!=n.tagName||""!=i.position&&"static"!=i.position||(r-=t?n.scrollLeft:n.scrollTop);n=n.parentNode;u=!1}return r}function c(n){return ht(n,parseInt)}function l(n){return ht(n,parseFloat)}function ht(n,t){var r=0,i;if(null!=n&&""!=n)try{i=n.indexOf("px");i>-1&&(r=t(n.substr(0,i)))}catch(n){}return r}function ct(n){return r.Browser.IE?function(n){return null==n||r.Browser.IE&&null==n.parentNode?0:n.getBoundingClientRect().left+b()}(n):r.Browser.Firefox&&r.Browser.Version>=3?lt(n):r.Browser.Opera?function(n){for(var i=!0,t=a(n,!0);null!=n;)t+=n.offsetLeft,i||(t-=n.scrollLeft),n=n.offsetParent,i=!1;return t+document.body.scrollLeft}(n):r.Browser.NetscapeFamily&&(!r.Browser.Firefox||r.Browser.Version<3)?function(n){for(var t=a(n,!0),i=!0,u;null!=n;)(t+=n.offsetLeft,i||null==n.offsetParent||(t-=n.scrollLeft),!i&&r.Browser.Firefox)&&(u=f(n),"DIV"==n.tagName&&"visible"!=u.overflow&&(t+=c(u.borderLeftWidth))),i=!1,n=n.offsetParent;return t}(n):r.Browser.WebKitFamily||r.Browser.Edge?lt(n):function(n){for(var t=0,i=!0;null!=n;)t+=n.offsetLeft,i||null==n.offsetParent||(t-=n.scrollLeft),i=!1,n=n.offsetParent;return t}(n)}function lt(n){if(null==n)return 0;var t=n.getBoundingClientRect().left+b();return Math.round(t)}function at(n,t,i){return n-function(n,t){var i=function(n){var t=document.createElement("DIV");return t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.position=f(n).position,t}(n),r;return"static"==i.style.position&&(i.style.position="absolute"),n.parentNode.appendChild(i),r=t?ct(i):ot(i),n.parentNode.removeChild(i),Math.round(r)}(t,i)}function vt(n,t){return k(n.childNodes,t)}function yt(n,t){return k(n.all||n.getElementsByTagName("*"),t)}function k(n,t){for(var u,r=[],i=0;i<n.length;i++)u=n[i],t&&!t(u)||r.push(u);return r}function pt(n,t){for(var i,r=[],u=0;i=n[u];u++)t&&!t(i)||r.push(i);return r}function wt(n,t){n.innerHTML=t}function v(n,t,i,r){if(n)if("string"==typeof t)n.style.display=t;else if(t){if(n.style.display="",i&&"none"===f(n).display){var u=r?"inline-":"";switch(n.tagName){case"TABLE":n.style.display=u+"table";break;default:n.style.display=u+"block"}}}else n.style.display="none"}function bt(n,t){e(t)||(t=r.Browser.IE&&9!=r.Browser.MajorVersion&&window.getComputedStyle?window.getComputedStyle(n):f(n));var i=0;return"none"!=t.borderTopStyle&&(i+=l(t.borderTopWidth)),"none"!=t.borderBottomStyle&&(i+=l(t.borderBottomWidth)),i}function kt(n,t){e(n.style.cssFloat)?n.style.cssFloat=t:e(n.style.styleFloat)?n.style.styleFloat=t:p.Attr.SetAttribute(n.style,"float",t)}function dt(n,t){!r.Browser.IE||r.Browser.Version>8?n.style.opacity=t:"object"==typeof n.filters&&n.filters["DXImageTransform.Microsoft.Alpha"]?n.filters.item("DXImageTransform.Microsoft.Alpha").Opacity=100*t:n.style.filter="alpha(opacity="+100*t+")"}function gt(n){return n&&ni(n)}function ni(n){if(!n)return!1;if(!(r.Browser.Firefox&&r.Browser.Version<4)&&n.ownerDocument&&n.ownerDocument.body&&n.ownerDocument.body.compareDocumentPosition)return n.ownerDocument.body.compareDocumentPosition(n)%2==0;if(!r.Browser.Opera&&!(r.Browser.IE&&r.Browser.Version<9)&&n.offsetParent&&n.parentNode.tagName)return!0;for(;null!=n;){if("BODY"==n.tagName)return!0;n=n.parentNode}return!1}function ti(n,t){var i,r;for(void 0===t&&(t=function(){return!1}),i=n;i&&1==i.nodeType;){if(i==n||!t(i)){if(r=i.tagName.toUpperCase(),"BODY"==r)return!0;if(-1!==["INPUT","BUTTON","TEXTAREA","SELECT","OPTION"].indexOf(r)&&i.disabled||!ii(i,!1)||!ri(i,!1))return!1}i=i.parentNode}return!0}function ii(n,t){return t?"none"!=f(n).display:"none"!=n.style.display}function ri(n,t){return t?"hidden"!=f(n).visibility:"hidden"!=n.style.visibility}function ui(n,t){return fi(n,t)+bt(n,t)}function fi(n,t){var i=t||f(n);return c(i.paddingTop)+c(i.paddingBottom)}function ei(n){e(n=y.Str.DecodeHtmlViaTextArea(n))&&""!==n&&alert(n)}function g(n,t,i,r,f){var e=n;return e|=t?u.ModifierKey.Ctrl:0,e|=i?u.ModifierKey.Shift:0,e|=r?u.ModifierKey.Alt:0,e|(f?u.ModifierKey.Meta:0)}var d,o;Object.defineProperty(t,"__esModule",{value:!0});var r=i(24),nt=i(38),y=i(148),p=i(149),u=i(13),oi=i(39);t.IsExists=e;t.IsNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};t.SetStyles=function(n,t,i){var u,f;for(u in e(t.cssText)&&(n.style.cssText=t.cssText),e(t.className)&&(n.className=t.className),t)if(t.hasOwnProperty(u)){f=t[u];switch(u){case"cssText":case"className":break;case"float":kt(n,f);break;case"opacity":dt(n,f);break;case"zIndex":h(n,u,f,i);break;case"fontWeight":r.Browser.IE&&r.Browser.Version<9&&"number"==typeof t[u]&&(f=t[u].toString());default:h(n,u,f+("number"==typeof f?"px":""),i)}}};t.SetStylesCore=h;t.GetDocumentScrollTop=w;t.CloneObject=tt;t.GetCurrentStyle=f;t.GetDocumentScrollLeft=b;t.focusedElement=null;t.GetFocusedElement=function(){var n=it();return n||t.focusedElement};t.GetActiveElement=it;t.SetFocus=function(n,t){r.Browser.MacOSMobilePlatform?rt(n,t):window.setTimeout(function(){rt(n,t)},100)};t.GetIsParent=function(n,t){if(!n||!t)return!1;for(;t;){if(t===n)return!0;if("BODY"===t.tagName)return!1;t=t.parentNode}return!1};t.ElementContainsCssClass=ut;t.AddClassNameToElement=ft;t.ElementHasCssClass=s;t.RemoveClassNameFromElement=et;t.ToggleElementClassName=function(n,t,i){n&&(!1===i||void 0===i&&s(n,t)?et(n,t):(!0===i||void 0===i&&!s(n,t))&&ft(n,t))};t.GetAbsolutePositionY=ot;t.PxToInt=c;t.PxToFloat=l;t.GetAbsolutePositionX=ct;t.SetAbsoluteX=function(n,t){n.style.left=at(t,n,!0)+"px"};t.SetAbsoluteY=function(n,t){n.style.top=at(t,n,!1)+"px"};t.IsPercentageSize=function(n){return n&&-1!=n.indexOf("%")};t.GetChildNodes=vt;t.GetNodes=yt;t.RetrieveByPredicate=k;t.GetChildNodesByClassName=function(n,t){return n?n.querySelectorAll?pt(n.querySelectorAll("."+t),function(t){return t.parentNode===n}):vt(n,function(n){return n.className&&s(n,t)}):[]};t.GetNodesByClassName=function(n,t){return n.querySelectorAll?pt(n.querySelectorAll("."+t),null):yt(n,function(n){return n.className&&s(n,t)})};t.GetParentByClassName=function(n,t){for(;null!=n;){if("BODY"==n.tagName||"#document"==n.nodeName)return null;if(ut(n,t))return n;n=n.parentNode}return null};t.GetParentByTagName=function(n,t){for(t=t.toUpperCase();n;){if("BODY"===n.tagName)return null;if(n.tagName===t)return n;n=n.parentNode}return null};o=null;t.setInnerHtmlInternal=wt;t.SetElementDisplay=v;t.GetInnerText=function(n){var t,i;return r.Browser.Safari&&r.Browser.MajorVersion<=5?(t=(null==o&&((o=document.createElement("DIV")).style.width="0",o.style.height="0",o.style.overflow="visible",v(o,!1,!1,!1),document.body.appendChild(o)),o),wt(t,n.innerHTML),v(t,!0,!1,!1),i=t.innerText,v(t,!1,!1,!1),i):r.Browser.NetscapeFamily||r.Browser.WebKitFamily||r.Browser.IE&&r.Browser.Version>=9||r.Browser.Edge?n.textContent:n.innerText};t.GetVerticalScrollBarWidth=function(){var n,t,r,i;return void 0===d&&(n=document.createElement("DIV"),n.style.cssText="position: absolute; top: 0px; left: 0px; visibility: hidden; width: 200px; height: 150px; overflow: hidden; box-sizing: content-box",document.body.appendChild(n),t=document.createElement("P"),n.appendChild(t),t.style.cssText="width: 100%; height: 200px;",r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),d=r-i,document.body.removeChild(n)),d};t.GetHorizontalBordersWidth=function(n,t){e(t)||(t=r.Browser.IE&&window.getComputedStyle?window.getComputedStyle(n):f(n));var i=0;return"none"!=t.borderLeftStyle&&(i+=l(t.borderLeftWidth)),"none"!=t.borderRightStyle&&(i+=l(t.borderRightWidth)),i};t.GetVerticalBordersWidth=bt;t.SetElementVisibility=function(n,t){n&&(n.style.visibility="string"==typeof t?t:t?"visible":"hidden")};t.SetElementFloat=kt;t.SetElementOpacity=dt;t.CreateGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0;return("x"==n?t:3&t|8).toString(16)})};t.IsUrlContainsClientScript=function(n){return-1!==n.toLowerCase().indexOf("javascript:")};t.IsExistsElement=gt;t.IsValidElement=ni;t.IsInteractiveControl=function(n){return nt.Data.ArrayIndexOf(["A","INPUT","SELECT","OPTION","TEXTAREA","BUTTON","IFRAME"],n.tagName)>-1};t.IsActionElement=function(n){if(!gt(n))return!1;var i=parseInt(p.Attr.GetAttribute(n,p.Attr.GetTabIndexAttributeName())),r=!isNaN(i),u=r&&i>-1,f=r&&i<0,t=n.tagName,e=ti(n),o=-1!==["BUTTON","SELECT","TEXTAREA","OPTION","IFRAME"].indexOf(t),s="A"===t&&(!!n.href||u),h="INPUT"===t&&"hidden"!==n.type.toLowerCase(),c="INPUT"!==t&&u,l="DIV"==t&&"true"===n.contentEditable;return e&&!f&&(o||s||h||c||l)};t.IsFocusable=ti;t.GetElementDisplay=ii;t.GetElementVisibility=ri;t.GetClearClientHeight=function(n){return n.offsetHeight-ui(n)};t.GetTopBottomBordersAndPaddingsSummaryValue=ui;t.GetTopBottomPaddings=fi;t.ParseShortcutString=function(n){var i,f;if(!n)return 0;var e=!1,o=!1,s=!1,h=!1,t=null,r=n.toString().split("+");if(r.length>0)for(i=0;i<r.length;i++){f=y.Str.Trim(r[i].toUpperCase());switch(f){case"CONTROL":case"CONTROLKEY":case"CTRL":e=!0;break;case"SHIFT":case"SHIFTKEY":o=!0;break;case"ALT":s=!0;break;case"CMD":h=!0;break;case"F1":t=u.KeyCode.F1;break;case"F2":t=u.KeyCode.F2;break;case"F3":t=u.KeyCode.F3;break;case"F4":t=u.KeyCode.F4;break;case"F5":t=u.KeyCode.F5;break;case"F6":t=u.KeyCode.F6;break;case"F7":t=u.KeyCode.F7;break;case"F8":t=u.KeyCode.F8;break;case"F9":t=u.KeyCode.F9;break;case"F10":t=u.KeyCode.F10;break;case"F11":t=u.KeyCode.F11;break;case"F12":t=u.KeyCode.F12;break;case"RETURN":case"ENTER":t=u.KeyCode.Enter;break;case"HOME":t=u.KeyCode.Home;break;case"END":t=u.KeyCode.End;break;case"LEFT":t=u.KeyCode.Left;break;case"RIGHT":t=u.KeyCode.Right;break;case"UP":t=u.KeyCode.Up;break;case"DOWN":t=u.KeyCode.Down;break;case"PAGEUP":t=u.KeyCode.PageUp;break;case"PAGEDOWN":t=u.KeyCode.PageDown;break;case"SPACE":t=u.KeyCode.Space;break;case"TAB":t=u.KeyCode.Tab;break;case"BACKSPACE":case"BACK":t=u.KeyCode.Backspace;break;case"CONTEXT":t=u.KeyCode.ContextMenu;break;case"ESCAPE":case"ESC":t=u.KeyCode.Esc;break;case"DELETE":case"DEL":t=u.KeyCode.Delete;break;case"INSERT":case"INS":t=u.KeyCode.Insert;break;case"PLUS":t="+".charCodeAt(0);break;default:t=f.charCodeAt(0)}}else ei("Invalid shortcut");return g(t,e,o,s,h)};t.ShowErrorAlert=ei;t.GetShortcutCode=g;t.GetShortcutCodeByEvent=function(n){return g(oi.Evt.GetKeyCode(n),n.ctrlKey,n.shiftKey,n.altKey,!(!r.Browser.MacOSPlatform&&!r.Browser.MacOSMobilePlatform)&&n.metaKey)}},function(n,t,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});var e,u=i(11),f=i(6),r=i(0),h=i(7),o=i(47),c=i(36);!function(n){n[n.In=0]="In";n[n.Cm=1]="Cm";n[n.Px=2]="Px"}(e=t.DiagramUnit||(t.DiagramUnit={})),function(n){n[n.Portrait=0]="Portrait";n[n.Landscape=1]="Landscape"}(t.PageOrientation||(t.PageOrientation={}));s=function(){function n(t){void 0===t&&(t=new r.Size(8391,11906));this.items=[];this.itemIndexByKey={};this.pageSize=new r.Size(8391,11906);this.pageLandscape=!1;this.pageColor=n.defaultPageColor;this.units=e.In;this.snapStartPoint=new r.Point(0,0);this.pageSize=t;this.size=this.pageSize.clone();this.rectangle=new r.Rectangle(new r.Point(0,0),new r.Size(0,0))}return Object.defineProperty(n.prototype,"pageWidth",{get:function(){return this.pageLandscape?this.pageSize.height:this.pageSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageHeight",{get:function(){return this.pageLandscape?this.pageSize.width:this.pageSize.height},enumerable:!0,configurable:!0}),n.prototype.getRectangle=function(n){return n&&(this.rectangle=r.GeometryUtils.getCommonRectangle(this.items.map(function(n){return n.rectangle}))),this.rectangle},n.getRectangle=function(n){return r.GeometryUtils.getCommonRectangle(n.map(function(n){return n.rectangle}))},n.prototype.pushItem=function(n){var t=this.items.push(n);this.itemIndexByKey[n.key]=t-1;n instanceof u.Shape&&!n.image.isEmpty&&this.cacheShapeImage(n)},n.prototype.removeItem=function(n){var t=this.getItemIndex(n);delete this.itemIndexByKey[n.key];this.items.splice(t,1);this.updateIndicesHash(t)},n.prototype.updateIndicesHash=function(n){for(var t=n;t<this.items.length;t++)this.itemIndexByKey[this.items[t].key]=t},n.prototype.getItemIndex=function(n){return this.itemIndexByKey[n.key]},n.prototype.findShape=function(n){var t=this.findItem(n);if(t instanceof u.Shape)return t},n.prototype.findShapesCore=function(n){var t;return t=[],this.items.forEach(function(i){i instanceof u.Shape&&n(i)&&t.push(i)}),t},n.prototype.findShapeCore=function(n){var t;return this.items.forEach(function(i){i instanceof u.Shape&&n(i)&&(t=i)}),t},n.prototype.findShapeAtPosition=function(n){return this.findShapeCore(function(t){return t.position.equals(n)})},n.prototype.findShapeByDataKey=function(n){return this.findShapeCore(function(t){return t.dataKey===n})},n.prototype.findShapesByImageUrl=function(n){return this.findShapesCore(function(t){return t.image.url===n})},n.prototype.cacheShapeImage=function(n){var t=o.ImageCache.instance.createUnloadedInfoByShapeImageInfo(n.image);t.isLoaded&&n.image.loadBase64Content(t.base64)},n.prototype.loadAllImages=function(n){o.ImageCache.instance.loadAllImages(n)},n.prototype.findContainer=function(n){var t=this.findShape(n);if(t&&t.enableChildren)return t},n.prototype.getChildren=function(n){var t=this;return n.children.map(function(n){return t.findItem(n.key)}).filter(function(n){return n})},n.prototype.findChild=function(n,t,i){var r,f=this;return void 0===i&&(i=!0),n.children.forEach(function(n){r||(n.key!==t?i&&n instanceof u.Shape&&(r=f.findChild(n,t,i)):r=n)}),r},n.prototype.findItemContainerCore=function(n,t){for(var i=n.container;i&&t&&!t(i);)i=i.container;return i},n.prototype.findItemContainer=function(n){return this.findItemContainerCore(n)},n.prototype.findItemCollapsedContainer=function(n){return this.findItemContainerCore(n,function(n){return!n.expanded})},n.prototype.findItemTopCollapsedContainer=function(n){for(var i,t=n.container;t;)t.expanded||(i=t),t=t.container;return i},n.prototype.isContainerItem=function(n,t){return void 0!==this.findItemContainerCore(t,function(t){return t.key===n.key})},n.prototype.findConnector=function(n){var t=this.findItem(n);if(t instanceof f.Connector)return t},n.prototype.findConnectorCore=function(n){var t;return this.items.forEach(function(i){i instanceof f.Connector&&n(i)&&(t=i)}),t},n.prototype.findConnectorAtPoints=function(n){return this.findConnectorCore(function(t){return r.GeometryUtils.arePointsEqual(t.points,n)})},n.prototype.findConnectorByDataKey=function(n){return this.findConnectorCore(function(t){return t.dataKey===n})},n.prototype.findConnectorsCore=function(n){var t=[];return this.items.forEach(function(i){i instanceof f.Connector&&n(i)&&t.push(i)}),t},n.prototype.findConnectorsWithoutBeginItem=function(){return this.findConnectorsCore(function(n){return!n.beginItem})},n.prototype.findConnectorsWithoutEndItem=function(){return this.findConnectorsCore(function(n){return!n.endItem})},n.prototype.findItem=function(n){return this.items[this.itemIndexByKey[n]]},n.isIntersectedItems=function(n,t){var i=!1;return n instanceof u.Shape?i=t.intersectedByRect(n.rectangle):n instanceof f.Connector&&n.getSegments().forEach(function(n){t instanceof u.Shape?i=i||n.intersectRect(t.rectangle):t instanceof f.Connector&&t.getSegments().forEach(function(t){i=i||n.intersect(t)})}),i},n.prototype.getIntersectItems=function(t){var i=[];return this.items.forEach(function(r){r.container===t.container&&(t===r||r instanceof f.Connector&&-1!==t.attachedConnectors.indexOf(r)||!n.isIntersectedItems(r,t)||i.push(r))}),i},n.prototype.getIntersectItemsMinZIndex=function(n){return this.getIntersectItems(n).map(function(n){return n.zIndex}).reduce(function(n,t){return Math.min(n,t)},Number.MAX_VALUE)},n.prototype.getIntersectItemsMaxZIndex=function(n){return this.getIntersectItems(n).map(function(n){return n.zIndex}).reduce(function(n,t){return Math.max(n,t)},-Number.MAX_VALUE)},n.prototype.iterateItems=function(n){this.items.forEach(n)},n.prototype.invalidateItems=function(){this.iterateItems(function(n){n.invalidatePrimitives();n instanceof f.Connector&&n.invalidateRenderPoints()})},n.prototype.getNextKey=function(n){var t=this;return h.ModelUtils.getNextItemKey(this.items.map(function(n){return n.key}),function(n){return void 0===t.itemIndexByKey[n]},n)},n.defaultPageColor=c.ColorHelper.LIGHT_COLOR,n}();t.DiagramModel=s},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,f,e,o,s)||this;return h.x=t,h.y=i,h.width=r,h.height=u,h}return e(t,n),t.prototype.createMainElement=function(){return document.createElementNS(u.svgNS,"rect")},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"x",this.x);this.setUnitAttribute(t,"y",this.y);this.setUnitAttribute(t,"width",this.width);this.setUnitAttribute(t,"height",this.height);this.setPositionCorrectionAttribute(t);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.RectanglePrimitive=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(15);f=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.className=i,f.clipPathId=r,f.onApplyProperties=u,f.children=[],f}return e(t,n),t.prototype.createElement=function(){var n=this.createMainElement();return this.createChildElements(n),n},t.prototype.createChildElements=function(n){for(var t=0;t<this.children.length;t++)n.appendChild(this.children[t].createElement())},t.prototype.applyElementProperties=function(n,t){this.applyElementStyleProperties(n);this.className&&n.setAttribute("class",this.className);"string"==typeof this.clipPathId&&(this.clipPathId?n.setAttribute("clip-path",u.RenderUtils.GetUrlPathById(this.clipPathId)):n.removeAttribute("clip-path"));this.onApplyProperties&&this.onApplyProperties(n);this.applyChildrenProperties(n,t)},t.prototype.applyChildrenProperties=function(n,t){for(var i=0;i<this.children.length;i++)this.children[i].applyElementProperties(n.childNodes[i],t)},t.prototype.applyElementStyleProperties=function(n){this.applyElementStylePropertiesCore(n)},t.prototype.applyElementStylePropertiesCore=function(n,t){void 0===t&&(t=!1);this.style&&u.RenderUtils.applyStyleToElement(this.style,n,t)},t.prototype.dispose=function(){this.children&&this.children.forEach(function(n){return n.dispose()})},t}(i(87).PrimitiveObject);t.SvgPrimitive=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(n,t){this.key=n;this.point=t}}();t.ShapeParameterPoint=i},function(n,t,i){"use strict";var o,r=this&&this.__extends||(o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}o(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f,e,h,c;Object.defineProperty(t,"__esModule",{value:!0});var l=i(36),a=i(85),v=i(14),s=function(){function n(){this.createDefaultProperties()}return n.prototype.clone=function(){var t=this,n=this.createInstance();return this.forEach(function(i){n[i]=t[i]}),n},n.prototype.forEach=function(n){for(var t in this)this.hasOwnProperty(t)&&n(t)},Object.defineProperty(n.prototype,"strokeWidthPx",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeWidth",{get:function(){return v.UnitConverter.pixelsToTwips(this.strokeWidthPx)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeOffset",{get:function(){return.5},enumerable:!0,configurable:!0}),n.prototype.toHash=function(){var n=this.toObject();return n?Object.keys(n).map(function(t){return t+"|"+n[t]}).join(""):""},n.prototype.toObject=function(){var n=this,t={},i=!1,r=this.getDefaultInstance();return this.forEach(function(u){n[u]!==r[u]&&(t[u]=n[u],i=!0)}),i?t:null},n.prototype.fromObject=function(n){var t,i;for(t in n)n.hasOwnProperty(t)&&void 0!==this[t]&&(i=a.isColorProperty(t)?l.ColorHelper.stringToHash(n[t]):n[t],this[t]=i)},n}();t.StyleBase=s;t.DEFAULT_STROKE_WIDTH=2;t.DEFAULT_STROKE_DASHARRAY="";u=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return r(i,n),i.prototype.createInstance=function(){return new i},i.prototype.createDefaultProperties=function(){this.fill="#ffffff";this.stroke="#000000";this["stroke-width"]=t.DEFAULT_STROKE_WIDTH.toString();this["stroke-dasharray"]=t.DEFAULT_STROKE_DASHARRAY},i.prototype.getDefaultInstance=function(){return i.defaultInstance},i.prototype.isDefaultStrokeDashArray=function(){return this["stroke-dasharray"]===t.DEFAULT_STROKE_DASHARRAY},i.prototype.resetStrokeDashArray=function(){this["stroke-dasharray"]=t.DEFAULT_STROKE_DASHARRAY},Object.defineProperty(i.prototype,"strokeWidthPx",{get:function(){return parseInt(this["stroke-width"])},enumerable:!0,configurable:!0}),i.defaultInstance=new i,i}(s);t.Style=u;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.createInstance=function(){return new t},t.prototype.createDefaultProperties=function(){this.fill="#000000";this["font-family"]="Arial";this["font-size"]="10pt";this["font-weight"]="";this["font-style"]="";this["text-decoration"]="";this["text-anchor"]="middle"},t.prototype.getDefaultInstance=function(){return t.defaultInstance},t.prototype.getAlignment=function(){switch(this["text-anchor"]){case"left":return f.Left;case"right":return f.Right;default:return f.Center}},t.defaultInstance=new t,t}(s);t.TextStyle=e,function(n){n[n.Left=0]="Left";n[n.Right=1]="Right";n[n.Center=2]="Center"}(f=t.TextAlignment||(t.TextAlignment={}));h=function(n){function t(t,i){var r=n.call(this)||this;return r._strokeWidthPx=t,r._strokeOffset=i,r}return r(t,n),t.prototype.createInstance=function(){return new t},t.prototype.createDefaultProperties=function(){},t.prototype.getDefaultInstance=function(){return e.defaultInstance},Object.defineProperty(t.prototype,"strokeWidthPx",{get:function(){return this._strokeWidthPx||0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeOffset",{get:function(){return this._strokeOffset||0},enumerable:!0,configurable:!0}),t.default1pxInstance=new t(1,.5),t.default1pxNegativeOffsetInstance=new t(1,-.5),t.default2pxInstance=new t(2),t}(u);t.StrokeStyle=h;c=function(n){function t(t){var i=n.call(this)||this;return t&&Object.keys(t).forEach(function(n){return i[n]=t[n]}),i}return r(t,n),t.prototype.createInstance=function(){return new t},t.prototype.createDefaultProperties=function(){},t.prototype.getDefaultInstance=function(){return e.defaultInstance},t.defaultInstance=new t,t}(u);t.EmptyStyle=c},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.IdentUserAgent=function(t,i){var o,c,h,a,v,e,b,k,s,y,p,d,nt;if(void 0===i&&(i=!1),o=["Mozilla","IE","Firefox","Netscape","Safari","Chrome","Opera","Opera10","Edge"],c={Safari:2,Chrome:.1,Mozilla:1.9,Netscape:8,Firefox:2,Opera:9,IE:6,Edge:12},t&&0!=t.length){t=t.toLowerCase();n.indentPlatformMajorVersion(t);try{for(var u,l={Windows:"Win",Macintosh:"Mac","Mac OS":"Mac",Mac_PowerPC:"Mac","cpu os":"MacMobile","cpu iphone os":"MacMobile",Android:"Android","!Windows Phone":"WinPhone","!WPDesktop":"WinPhone","!ZuneWP":"WinPhone"},f="(?:(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?)?",g={Safari:"applewebkit(?:.*?(?:version/(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?[\\.\\w\\d]*?(?:\\s+mobile/\\S*)?\\s+safari))?",Chrome:"(?:chrome|crios)(?!frame)(?:/|\\s*)?"+f,Mozilla:"mozilla(?:.*rv:"+f+".*Gecko)?",Netscape:"(?:netscape|navigator)\\d*/?\\s*"+f,Firefox:"firefox(?:/|\\s*)?"+f,Opera:"(?:opera|sopr)(?:/|\\s*)?"+f,Opera10:"opera.*\\s*version(?:/|\\s*)?"+f,IE:"msie\\s*"+f,Edge:"edge(?:/|\\s*)?"+f},r=-1,w=0;w<o.length;w++)if(h=o[w],a=new RegExp(g[h],"i"),a.compile&&a.compile(g[h],"i"),v=a.exec(t),v&&v.index>=0){if("IE"==u&&r>=11&&"Safari"==h)continue;"Opera10"==(u=h)&&(u="Opera");r=n.GetBrowserVersion(t,v,"trident(?:/|\\s*)?(?:(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?)?",n.getIECompatibleVersionString());"Mozilla"==u&&r>=11&&(u="IE")}u||(u="IE");b=-1!=r;b||(r=c[u]);k=Number.MAX_VALUE;for(s in l)l.hasOwnProperty(s)&&(y="!"==s.substr(0,1),p=t.indexOf((y?s.substr(1):s).toLowerCase()),p>=0&&(p<k||y)&&(k=y?0:p,e=l[s]));d=t.toUpperCase().match("SM-[A-Z]");nt=d&&d.length>0;"WinPhone"==e&&r<9&&(r=Math.floor(n.getVersionFromTrident(t,"trident(?:/|\\s*)?"+f)));!i&&"IE"==u&&r>7&&document.documentMode<r&&(r=document.documentMode);"WinPhone"==e&&(r=Math.max(9,r));e||(e="Win");e!=l["cpu os"]||b||(r=4);n.fillUserAgentInfo(o,u,r,e,nt)}catch(t){n.fillUserAgentInfo(o,"IE",c.IE,"Win")}}else n.fillUserAgentInfo(o,"IE",c.IE,"Win")},n.GetBrowserVersion=function(t,i,r,u){var e=n.getVersionFromMatches(i),f;return u&&(f=n.getVersionFromTrident(t,r),"edge"===u||parseInt(u)===f)?f:e},n.getIECompatibleVersionString=function(){if(document.compatible)for(var n=0;n<document.compatible.length;n++)if("IE"===document.compatible[n].userAgent&&document.compatible[n].version)return document.compatible[n].version.toLowerCase();return""},n.isTouchEnabled=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},n.fillUserAgentInfo=function(t,i,r,u,f){var e,o,s,h;for(void 0===f&&(f=!1),e=0;e<t.length;e++)o=t[e],n[o]=o==i;n.Version=Math.floor(10*r)/10;n.MajorVersion=Math.floor(n.Version);n.WindowsPlatform="Win"==u||"WinPhone"==u;n.MacOSMobilePlatform="MacMobile"==u||"Mac"==u&&n.isTouchEnabled();n.MacOSPlatform="Mac"==u&&!n.MacOSMobilePlatform;n.AndroidMobilePlatform="Android"==u;n.WindowsPhonePlatform="WinPhone"==u;n.WebKitFamily=n.Safari||n.Chrome||n.Opera&&n.MajorVersion>=15;n.NetscapeFamily=n.Netscape||n.Mozilla||n.Firefox;n.HardwareAcceleration=n.IE&&n.MajorVersion>=9||n.Firefox&&n.MajorVersion>=4||n.AndroidMobilePlatform&&n.Chrome||n.Chrome&&n.MajorVersion>=37||n.Safari&&!n.WindowsPlatform||n.Edge||n.Opera&&n.MajorVersion>=46;n.WebKitTouchUI=n.MacOSMobilePlatform||n.AndroidMobilePlatform;s=n.IE&&n.MajorVersion>9&&n.WindowsPlatform&&n.UserAgent.toLowerCase().indexOf("touch")>=0;(n.MSTouchUI=s||n.Edge&&!!window.navigator.maxTouchPoints,n.TouchUI=n.WebKitTouchUI||n.MSTouchUI,n.MobileUI=n.WebKitTouchUI||n.WindowsPhonePlatform,n.AndroidDefaultBrowser=n.AndroidMobilePlatform&&!n.Chrome,n.AndroidChromeBrowser=n.AndroidMobilePlatform&&n.Chrome,f&&(n.SamsungAndroidDevice=f),n.MSTouchUI)?(h=n.UserAgent.toLowerCase().indexOf("arm;")>-1,n.VirtualKeyboardSupported=h||n.WindowsPhonePlatform):n.VirtualKeyboardSupported=n.WebKitTouchUI;n.fillDocumentElementBrowserTypeClassNames(t)},n.indentPlatformMajorVersion=function(t){var i=/(?:(?:windows nt|macintosh|mac os|cpu os|cpu iphone os|android|windows phone|linux) )(\d+)(?:[-0-9_.])*/.exec(t);i&&(n.PlaformMajorVersion=i[1])},n.prototype.GetBrowserVersion=function(t,i,r,u){var e=n.getVersionFromMatches(i),f;return u&&(f=n.getVersionFromTrident(t,r),"edge"===u||parseInt(u)===f)?f:e},n.getVersionFromMatches=function(n){var t=-1,i="";return n[1]&&(i+=n[1],n[2]&&(i+="."+n[2])),""!=i&&(t=parseFloat(i),isNaN(t)&&(t=-1)),t},n.getVersionFromTrident=function(t,i){var r=new RegExp(i,"i").exec(t);return n.getVersionFromMatches(r)+4},n.fillDocumentElementBrowserTypeClassNames=function(t){for(var u,i="",f=t.concat(["WindowsPlatform","MacOSPlatform","MacOSMobilePlatform","AndroidMobilePlatform","WindowsPhonePlatform","WebKitFamily","WebKitTouchUI","MSTouchUI","TouchUI","AndroidDefaultBrowser"]),r=0;r<f.length;r++)u=f[r],n[u]&&(i+="dx"+u+" ");i+="dxBrowserVersion-"+n.MajorVersion;document&&document.documentElement&&(""!=document.documentElement.className&&(i=" "+i),document.documentElement.className+=i,n.Info=i)},n.UserAgent=window.navigator.userAgent.toLowerCase(),n._foo=n.IdentUserAgent(n.UserAgent),n}();t.Browser=i},function(n,t){"use strict";var r,i,u;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Straight=0]="Straight";n[n.Orthogonal=1]="Orthogonal"}(r=t.ConnectorLineOption||(t.ConnectorLineOption={})),function(n){n[n.None=0]="None";n[n.Arrow=1]="Arrow";n[n.OutlinedTriangle=2]="OutlinedTriangle";n[n.FilledTriangle=3]="FilledTriangle"}(i=t.ConnectorLineEnding||(t.ConnectorLineEnding={}));t.DEFAULT_CONNECTOR_LINEOPTION=r.Orthogonal;t.DEFAULT_CONNECTOR_STARTLINEENDING=i.None;t.DEFAULT_CONNECTOR_ENDLINEENDING=i.Arrow;u=function(){function n(){this.lineOption=t.DEFAULT_CONNECTOR_LINEOPTION;this.startLineEnding=t.DEFAULT_CONNECTOR_STARTLINEENDING;this.endLineEnding=t.DEFAULT_CONNECTOR_ENDLINEENDING}return n.prototype.clone=function(){var t=new n;return t.lineOption=this.lineOption,t.startLineEnding=this.startLineEnding,t.endLineEnding=this.endLineEnding,t},n.prototype.forEach=function(n){for(var t in this)this.hasOwnProperty(t)&&n(t)},n.prototype.toObject=function(){var n={},i=!1;return this.lineOption!==t.DEFAULT_CONNECTOR_LINEOPTION&&(n.lineOption=this.lineOption,i=!0),this.startLineEnding!==t.DEFAULT_CONNECTOR_STARTLINEENDING&&(n.startLineEnding=this.startLineEnding,i=!0),this.endLineEnding!==t.DEFAULT_CONNECTOR_ENDLINEENDING&&(n.endLineEnding=this.endLineEnding,i=!0),i?n:null},n.prototype.fromObject=function(n){"number"==typeof n.lineOption&&(this.lineOption=n.lineOption);"number"==typeof n.startLineEnding&&(this.startLineEnding=n.startLineEnding);"number"==typeof n.endLineEnding&&(this.endLineEnding=n.endLineEnding)},n}();t.ConnectorProperties=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(31),u=i(10),o=i(14),s=function(n){function t(t,i){var r=n.call(this,t)||this;return r.history=i,r}return f(t,n),t.prototype.onMouseDown=function(n){this.mouseDownPoint=n.modelPoint.clone()},t.prototype.onMouseMove=function(n){n.button!==u.MouseButton.Left?(this.cancelChanges(),this.handler.switchToDefaultState()):n.button===u.MouseButton.Left&&(!this.mouseDownPoint||Math.abs(this.mouseDownPoint.x-n.modelPoint.x)>t.dragStartLimit||Math.abs(this.mouseDownPoint.y-n.modelPoint.y)>t.dragStartLimit)&&(this.onApplyChanges(n),this.modified||this.handler.raiseDragStart(this.getDraggingElementKeys()),this.modified=!0,this.mouseDownPoint=void 0)},t.prototype.cancelChanges=function(){this.history.undoTransaction();this.modified&&this.handler.raiseDragEnd(this.getDraggingElementKeys());this.modified=!1},t.prototype.onMouseUp=function(){this.mouseDownPoint=void 0;this.handler.switchToDefaultState()},t.prototype.start=function(){this.history.beginTransaction()},t.prototype.finish=function(){this.modified?(this.onFinishWithChanges(),this.modified=!1,this.history.endTransaction(),this.handler.raiseDragEnd(this.getDraggingElementKeys())):this.history.endTransaction()},t.prototype.onFinishWithChanges=function(){},t.prototype.getSnappedPoint=function(n,t){return this.handler.getSnappedPoint(n,t)},t.dragStartLimit=o.UnitConverter.pixelsToTwips(4),t}(e.MouseHandlerCancellableState);t.MouseHandlerDraggingState=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r,u){void 0===r&&(r=-1);void 0===u&&(u=!1);var f=n.call(this,t,i)||this;return f.pointIndex=r,f.skipped=u,f}return f(t,n),t.prototype.offset=function(n,i){return void 0===n&&(n=0),void 0===i&&(i=0),new t(this.x+n,this.y+i)},t.prototype.multiply=function(n,i){return void 0===n&&(n=1),void 0===i&&(i=n),new t(this.x*n,this.y*i)},t.prototype.clone=function(){return new t(this.x,this.y,this.pointIndex)},t}(i(0).Point);t.ConnectorRenderPoint=u},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0});i=function(){return function(n,t){this.key=n;this.value=t}}();t.ShapeParameter=i;r=function(){function n(){this.items={}}return n.prototype.add=function(n){this.items[n.key]=n},n.prototype.addRange=function(n){for(var t=0;t<n.length;t++)this.add(n[t])},n.prototype.get=function(n){return this.items[n]},n.prototype.forEach=function(n){for(var t in this.items)this.items.hasOwnProperty(t)&&n(this.items[t])},n.prototype.clone=function(){var t=new n;return this.forEach(function(n){t.add(new i(n.key,n.value))}),t},n.prototype.toObject=function(){var n={},t=!1;return this.forEach(function(i){n[i.key]={value:i.value};t=!0}),t?n:null},n.prototype.fromObject=function(n){this.forEach(function(t){var i=n[t.key];i&&"number"==typeof i.value&&(t.value=i.value)})},n}();t.ShapeParameters=r},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0});i=function(){function n(n,t,i,r){void 0===r&&(r=1);this.weight=r;this.key=n;this.from=t;this.to=i}return n.prototype.getHashKey=function(){return this.from+"_"+this.to},n.prototype.reverse=function(){return new n(this.key,this.to,this.from,this.weight)},n}();t.Edge=i;r=function(){return function(n,t){this.item=n;this.position=t}}();t.PositionInfo=r,function(n){n[n.Outgoing=1]="Outgoing";n[n.Incoming=2]="Incoming";n[n.OutgoingAndIncoming=3]="OutgoingAndIncoming"}(t.ConnectionMode||(t.ConnectionMode={}))},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e){var o=n.call(this,null,i,u,f)||this;return o.zIndex=r,o.onBeforeDispose=e,o.children=t,o}return e(t,n),t.prototype.createMainElement=function(){return document.createElementNS(u.svgNS,"g")},t.prototype.applyElementProperties=function(t,i){(this.zIndex||0===this.zIndex)&&t.style.setProperty("z-index",this.zIndex.toString());n.prototype.applyElementProperties.call(this,t,i)},t.prototype.dispose=function(){this.onBeforeDispose&&this.onBeforeDispose();n.prototype.dispose.call(this)},t}(i(21).SvgPrimitive);t.GroupPrimitive=f},function(n,t,i){"use strict";var r,o=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f,u,e;Object.defineProperty(t,"__esModule",{value:!0});f=i(13);u=function(){function n(n){this.handler=n}return n.prototype.start=function(){},n.prototype.finish=function(){},n.prototype.onMouseClick=function(){},n.prototype.onMouseDblClick=function(){this.handler.switchToDefaultState()},n.prototype.onMouseDown=function(){},n.prototype.onMouseUp=function(){},n.prototype.onMouseMove=function(){},n.prototype.onMouseWheel=function(){return!1},n.prototype.onDragStart=function(){},n.prototype.onDragEnd=function(){},n.prototype.onShortcut=function(){return!1},n}();t.MouseHandlerStateBase=u;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.onShortcut=function(n){return n===f.KeyCode.Esc&&(this.cancelChanges(),this.handler.switchToDefaultState(),!0)},t}(u);t.MouseHandlerCancellableState=e},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=i(150);u=i(14);t.PAGE_BG_TEXTFLOOR_FILTER_ID="page-text-flood";f=function(){function n(n,t){this.elements={};this.actualZoom=n;this.dom=t}return n.prototype.createAndChangePrimitivesElements=function(n,t){var i=this;n.forEach(function(n){i.createAndChangePrimitiveElement(n,t)})},n.prototype.createPrimitiveElement=function(n,t,i){return this.dom.createElement(n,t,i)},n.prototype.createAndChangePrimitiveElement=function(n,t,i){var r=this.createPrimitiveElement(n,t,i);return this.dom.changeByPrimitive(r,n),r},n.prototype.changePrimitiveElement=function(n,t){this.dom.changeByPrimitive(t,n)},n.prototype.getOrCreateElement=function(n,t,i,r){var u=n&&this.elements[n]||(this.elements[n]=this.createPrimitiveElement(t,i,r));return this.changePrimitiveElement(t,u),u},n.prototype.createTextFloodFilter=function(n,i,u){this.getOrCreateElement(n,new r.TextFloodFilterPrimitive(t.PAGE_BG_TEXTFLOOR_FILTER_ID,u),i)},n.prototype.getAbsoluteSize=function(n){return n.transform(u.UnitConverter.twipsToPixelsF).multiply(this.actualZoom)},n}();t.CanvasManagerBase=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),e=i(5),o=function(n){function t(t,i,r){void 0===r&&(r=e.ConnectionPointSide.Undefined);var u=n.call(this,t,i)||this;return u.side=r,u}return f(t,n),t.prototype.offset=function(n,i){return void 0===n&&(n=0),void 0===i&&(i=0),new t(this.x+n,this.y+i)},t.prototype.multiply=function(n,i){return void 0===n&&(n=1),void 0===i&&(i=n),new t(this.x*n,this.y*i)},t.prototype.clone=function(){return new t(this.x,this.y,this.side)},t.prototype.toPoint=function(){return new u.Point(this.x,this.y)},t}(u.Point);t.ConnectionPoint=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f,u=i(4),e=i(19),r=i(0),o=function(){function n(){this.onZoomChanged=new u.EventDispatcher;this.onViewChanged=new u.EventDispatcher;this.onReadOnlyChanged=new u.EventDispatcher;this._zoomLevel=1;this._zoomLevelItems=[.5,.75,1,1.25,1.5,2,3];this._simpleView=!1;this._fullscreen=!1;this._readOnly=!1;this._autoZoom=f.Disabled;this._snapToGrid=!0;this._showGrid=!0;this._gridSize=180;this._gridSizeItems=[90,180,360,720];this._pageSizeItems=[{size:new r.Size(12240,15840),text:"US-Letter ({width} x {height})"},{size:new r.Size(12240,20160),text:"US-Legal ({width} x {height})"},{size:new r.Size(15817,24491),text:"US-Tabloid ({width} x {height})"},{size:new r.Size(47679,67408),text:"A0 ({width} x {height})"},{size:new r.Size(33676,47679),text:"A1 ({width} x {height})"},{size:new r.Size(23811,33676),text:"A2 ({width} x {height})"},{size:new r.Size(16838,23811),text:"A3 ({width} x {height})"},{size:new r.Size(11906,16838),text:"A4 ({width} x {height})"},{size:new r.Size(8391,11906),text:"A5 ({width} x {height})"},{size:new r.Size(5953,8391),text:"A6 ({width} x {height})"},{size:new r.Size(4195,5953),text:"A7 ({width} x {height})"}];this._viewUnits=e.DiagramUnit.In}return Object.defineProperty(n.prototype,"zoomLevel",{get:function(){return this._zoomLevel},set:function(t){var i=this;(t=n.correctZoomLevel(t))!==this._zoomLevel&&(this._zoomLevel=t,this.onZoomChanged.raise1(function(n){return n.notifyZoomChanged(t,i._autoZoom)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"zoomLevelItems",{get:function(){return this._zoomLevelItems},set:function(t){(t=t.map(function(t){return n.correctZoomLevel(t)}))!==this._zoomLevelItems&&(this._zoomLevelItems=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"autoZoom",{get:function(){return this._autoZoom},set:function(n){var t=this;n!==this._autoZoom&&(this._autoZoom=n,this.onZoomChanged.raise1(function(i){return i.notifyZoomChanged(t._zoomLevel,n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"simpleView",{get:function(){return this._simpleView},set:function(n){n!==this._simpleView&&(this._simpleView=n,this.onViewChanged.raise1(function(t){return t.notifyViewChanged(n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"readOnly",{get:function(){return this._readOnly},set:function(n){n!==this._readOnly&&(this._readOnly=n,this.onReadOnlyChanged.raise1(function(t){return t.notifyReadOnlyChanged(n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(n){this._fullscreen=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"snapToGrid",{get:function(){return this._snapToGrid},set:function(n){this._snapToGrid=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showGrid",{get:function(){return this._showGrid},set:function(n){var t=this;n!==this._showGrid&&(this._showGrid=n,this.onViewChanged.raise1(function(n){return n.notifyGridChanged(t.showGrid,t.gridSize)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridSize",{get:function(){return this._gridSize},set:function(n){var t=this;n!==this._gridSize&&(this._gridSize=n,this.onViewChanged.raise1(function(n){return n.notifyGridChanged(t.showGrid,t.gridSize)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gridSizeItems",{get:function(){return this._gridSizeItems},set:function(n){n!==this._gridSizeItems&&(this._gridSizeItems=n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageSizeItems",{get:function(){return this._pageSizeItems},set:function(n){n!==this._pageSizeItems&&(this._pageSizeItems=n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewUnits",{get:function(){return this._viewUnits},set:function(n){this._viewUnits=n},enumerable:!0,configurable:!0}),n.correctZoomLevel=function(n){return Math.min(10,Math.max(n,.01))},n}();t.DiagramSettings=o,function(n){n[n.Disabled=0]="Disabled";n[n.FitContent=1]="FitContent";n[n.FitToWidth=2]="FitToWidth"}(f=t.AutoZoomMode||(t.AutoZoomMode={}))},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e;Object.defineProperty(t,"__esModule",{value:!0});var f=i(3),o=i(6),s=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f.connectorKey=t.key,f.itemKey=i.key,f.connectionPointIndex=r,f.position=u,f}return u(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey),i=n.model.findItem(this.itemKey);n.addConnection(t,i,this.connectionPointIndex,this.position)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.deleteConnection(t,this.position)},t}(f.HistoryItem);t.AddConnectionHistoryItem=s;e=function(n){function t(t,i,r){var u=n.call(this)||this;return u.connectorKey=t.key,u.connectionPointIndex=i,u.position=r,u}return u(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.oldConnectionPointIndex=this.position===o.ConnectorPosition.Begin?t.beginConnectionPointIndex:t.endConnectionPointIndex;n.setConnectionPointIndex(t,this.connectionPointIndex,this.position)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.setConnectionPointIndex(t,this.oldConnectionPointIndex,this.position)},t}(f.HistoryItem);t.SetConnectionPointIndexHistoryItem=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(139),u=function(){function n(){}return n.constructFromArgbNumber=function(n,t,i,r){return n<<24|t<<16|i<<8|r},n.getPredefinedColor=function(t){return n.hashToColor(t,0)},n.isGray=function(t){var i=n.getRed(t);return i==n.getGreen(t)&&i==n.getBlue(t)},n.getAlpha=function(n){return n>>24&255},n.getRed=function(n){return n>>16&255},n.getGreen=function(n){return n>>8&255},n.getBlue=function(n){return 255&n},n.redPartToString=function(t){var i=n.getRed(t).toString(16);return i.length>1?i:"0"+i},n.greenPartToString=function(t){var i=n.getGreen(t).toString(16);return i.length>1?i:"0"+i},n.bluePartToString=function(t){var i=n.getBlue(t).toString(16);return i.length>1?i:"0"+i},n.colorToHash=function(t){return"#"+n.redPartToString(t)+n.greenPartToString(t)+n.bluePartToString(t)},n.hashToColor=function(n,t){return void 0===t&&(t=255),3===(n="#"==n.charAt(0)?n.substr(1):n).length&&(n=r.StringUtils.repeat(n.charAt(0),2)+r.StringUtils.repeat(n.charAt(1),2)+r.StringUtils.repeat(n.charAt(2),2)),parseInt(n,16)|t<<24},n.getActualForeColor=function(t,i){return t==n.AUTOMATIC_COLOR&&(t=i==n.AUTOMATIC_COLOR||i==n.NO_COLOR||n.calculateLumaY(i)>=n.DEFAULT_BOUNDARY_LUMA?n.DARK_COLOR:n.LIGHT_COLOR),n.getCssString(t,!0)},n.getCssString=function(t,i){return t==n.AUTOMATIC_COLOR?n.colorToHash(i?n.DARK_COLOR:n.LIGHT_COLOR):n.getCssStringInternal(t)},n.stringToHash=function(n){return this.colorToHash(this.stringToColor(n))},n.stringToColor=function(t){var i=this.getRGBAByString(t),r="";return i?(255&i[0])<<16|(255&i[1])<<8|255&i[2]|(255&(i.length>3?i[3]:255))<<24:(/^#([0-9a-f]{6})$/i.test(t)||/^#([0-9a-f]{3})$/i.test(t)?r=t:/^[a-z]+$/i.test(t)&&(r=n.colorNames[t.toLowerCase()]),r?n.hashToColor(r):null)},n.getRGBAByString=function(n){var r=n.replace(/ +/g,"").match(/(rgba?)|(\d+(\.\d+)?%?)|(\.\d+)/g),i,u,t;if(r&&r.length>3){for(u=0,t=[];u<r.length-1;){if((i=-1!=(i=r[++u]).indexOf("%")?Math.round(2.55*parseFloat(i)):parseInt(i))<0||i>255)return null;t.push(i)}if(0===n.indexOf("rgba")){if(isNaN(t[3])||t[3]<0||t[3]>1)return null;t[3]<=1&&(t[3]=Math.round(255*t[3]))}else if(t[3])return null;return t}return null},n.IsDarkColor=function(t){return n.calculateLumaY(t)<n.DEFAULT_BOUNDARY_LUMA},n.getCssStringInternal=function(t){var i=n.getAlpha(t);switch(i){case 0:return"transparent";case 255:return n.colorToHash(t);default:return"rgba("+n.getRed(t)+","+n.getGreen(t)+","+n.getBlue(t)+","+i/255+")"}},n.isEmptyBgColor=function(n){return n===this.AUTOMATIC_COLOR||n===this.NO_COLOR},n.calculateLumaY=function(t){return n.DEFAULT_BOUNDARY_LUMA_RED*n.getRed(t)+n.DEFAULT_BOUNDARY_LUMA_GREEN*n.getGreen(t)+n.DEFAULT_BOUNDARY_LUMA_BLUE*n.getBlue(t)},n.colorNames={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#00ff00",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",windowtext:"#000000"},n.DEFAULT_BOUNDARY_LUMA=3982098.432,n.DEFAULT_BOUNDARY_LUMA_RED=19595.264,n.DEFAULT_BOUNDARY_LUMA_BLUE=7471.104,n.DEFAULT_BOUNDARY_LUMA_GREEN=38469.632,n.DARK_COLOR=-16777216,n.LIGHT_COLOR=-1,n.BLACK_COLOR=-16777216,n.AUTOMATIC_COLOR=0,n.NO_COLOR=16777215,n}();t.ColorHelper=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),u=i(6),f=function(){function n(n){this.parent=n}return Object.defineProperty(n.prototype,"connector",{get:function(){return this.parent.connector},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"beginRect",{get:function(){return this.parent.beginRect},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endRect",{get:function(){return this.parent.endRect},enumerable:!0,configurable:!0}),n.prototype.getBeginOffsetPoints=function(n,t,i,u){if(t=this.getCorrectOriginPoint(t,u),n!==r.ConnectionPointSide.Undefined){if(this.isBeginEndSame())return this.getSameShapeOffsetPoints(n,t,i,u);if(this.isBeginEndOverlappedPoints(t,i))return this.getOverlappedPointsOffsetPoints(n,t,i,u);if(this.isBeginEndOverlapped())return this.getBeginOverlappedShapeOffsetPoints(n,t,i,u)}else if(this.isOriginRectContainsTargetPoint(u,i))return this.getOverlappedPointsOffsetPoints(n,t,i,u);return this.isOnSidePoint(t,i)?this.getBeginOnSideOffsetPoints(n,t,i,u):this.getBeginOffSideOffsetPoints(n,t,i,u)},n.prototype.getEndOffsetPoints=function(n,t,i,u){if(t=this.getCorrectOriginPoint(t,u),n!==r.ConnectionPointSide.Undefined){if(this.isBeginEndSame())return this.getSameShapeOffsetPoints(n,t,i,u);if(this.isBeginEndOverlappedPoints(i,t))return this.getOverlappedPointsOffsetPoints(n,t,i,u);if(this.isBeginEndOverlapped())return this.getEndOverlappedShapeOffsetPoints(n,t,i,u)}else if(this.isOriginRectContainsTargetPoint(u,i))return this.getOverlappedPointsOffsetPoints(n,t,i,u);return this.isOnSidePoint(t,i)?this.getEndOnSideOffsetPoints(n,t,i,u):this.getEndOffSideOffsetPoints(n,t,i,u)},n.prototype.getSide=function(n,t){return Math.abs(t.x-n.x)>Math.abs(t.y-n.y)?t.x>n.x?r.ConnectionPointSide.East:r.ConnectionPointSide.West:t.y>n.y?r.ConnectionPointSide.South:r.ConnectionPointSide.North},n.prototype.getSideCalculator=function(n,t){return this.parent.getSideCalculator(this.getSide(n,t))},n.prototype.getMinOffset=function(){return u.Connector.minOffset},n.prototype.isBeginEndSame=function(){return this.connector.beginItem===this.connector.endItem},n.prototype.isBeginEndOverlapped=function(){return this.beginRect&&this.endRect&&this.beginRect.intersect(this.endRect)},n.prototype.isBeginEndOverlappedX=function(){return this.beginRect&&this.endRect&&this.beginRect.intersectX(this.endRect)},n.prototype.isBeginEndOverlappedY=function(){return this.beginRect&&this.endRect&&this.beginRect.intersectY(this.endRect)},n.prototype.isBeginEndOverlappedPoints=function(n,t){return this.beginRect&&this.endRect&&(this.beginRect.contains(t)||this.endRect.contains(n))},n.prototype.isOriginRectContainsTargetPoint=function(n,t){return n&&n.contains(t)},n}();t.ConnectorPointsOrthogonalSideCalculatorBase=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(18),u=function(){function n(){}return n.ArrayInsert=function(n,t,i){if(0<=i&&i<n.length){for(var r=n.length;r>i;r--)n[r]=n[r-1];n[i]=t}else n.push(t)},n.ArrayRemove=function(t,i){var r=n.ArrayIndexOf(t,i);r>-1&&n.ArrayRemoveAt(t,r)},n.ArrayRemoveAt=function(n,t){if(t>=0&&t<n.length){for(var i=t;i<n.length-1;i++)n[i]=n[i+1];n.pop()}},n.ArrayClear=function(n){for(;n.length>0;)n.pop()},n.ArrayIndexOf=function(n,t,i){if(i){for(r=0;r<n.length;r++)if(i(n[r],t))return r}else for(var r=0;r<n.length;r++)if(n[r]==t)return r;return-1},n.ArrayContains=function(t,i){return n.ArrayIndexOf(t,i)>=0},n.ArrayEqual=function(n,t){var r=n.length,i;if(r!=t.length)return!1;for(i=0;i<r;i++)if(n[i]!=t[i])return!1;return!0},n.ArraySame=function(t,i){return t.length===i.length&&t.every(function(t){return n.ArrayContains(i,t)})},n.ArrayGetIntegerEdgeValues=function(t){var i=n.CollectionToArray(t);return n.ArrayIntegerAscendingSort(i),{start:i[0],end:i[i.length-1]}},n.ArrayIntegerAscendingSort=function(t){n.ArrayIntegerSort(t,!1)},n.ArrayIntegerSort=function(n,t){n.sort(function(n,i){var r=0;return n>i?r=1:n<i&&(r=-1),t&&(r*=-1),r})},n.CollectionsUnionToArray=function(n,t){for(var r=[],u=n.length,f=t.length,i=0;i<u+f;i++)i<u?r.push(n[i]):r.push(t[i-u]);return r},n.CollectionToArray=function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t]);return i},n.CreateHashTableFromArray=function(n){for(var i=[],t=0;t<n.length;t++)i[n[t]]=1;return i},n.CreateIndexHashTableFromArray=function(n){for(var i=[],t=0;t<n.length;t++)i[n[t]]=t;return i},n.ArrayToHash=function(n,t,i){return n instanceof Array?n.reduce(function(n,r,u){var f=t(r,u),e=i(r,u);return n[f]=e,n},{}):{}},n.Sum=function(n,t){return n instanceof Array?n.reduce(function(n,i){var u=t?t(i):i;return r.IsNumber(u)||(u=0),n+u},0):0},n.Min=function(t,i){return n.CalculateArrayMinMax(t,i,!1)},n.Max=function(t,i){return n.CalculateArrayMinMax(t,i,!0)},n.NearestLeftBinarySearchComparer=function(n,t,i){var r=n[t],u=r<i;return u&&t==n.length-1||u&&n[t+1]>=i?0:r<i?-1:1},n.ArrayBinarySearch=function(t,i,u,f,e){var s,o,h;for(u||(u=n.defaultBinarySearchComparer),r.IsExists(f)||(f=0),r.IsExists(e)||(e=t.length-f),s=f+e-1;f<=s;){if(o=f+(s-f>>1),h=u(t,o,i),0==h)return o;h<0?f=o+1:s=o-1}return-(f+1)},n.ArrayFlatten=function(n){return[].concat.apply([],n)},n.GetDistinctArray=function(t){for(var u,i=[],r=0;r<t.length;r++)u=t[r],-1==n.ArrayIndexOf(i,u)&&i.push(u);return i},n.ForEach=function(n,t){if(Array.prototype.forEach)Array.prototype.forEach.call(n,t);else for(var i=0,r=n.length;i<r;i++)t(n[i],i,n)},n.MergeHashTables=function(n,t){if(!t||"string"==typeof t)return n;for(var i in n||(n={}),t)!i||i in n||(n[i]=t[i]);return n},n.Range=function(n,t){return(n=parseInt(n)||0)<0&&(n=0),(t=parseInt(t)||0)<0&&(t=0),Array.apply(null,Array(n)).map(function(n,i){return t+i})},n.CalculateArrayMinMax=function(n,t,i){if(!(n instanceof Array))return 0;var u=i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;return n.reduce(function(n,f){var e=t?t(f):f;return r.IsNumber(e)||(e=u),(i?Math.max:Math.min)(e,n)},u)},n.defaultBinarySearchComparer=function(n,t,i){var r=n[t];return r==i?0:r<i?-1:1},n.cssTextToObject=function(n){return n?(n=n.replace(/\/\*(.|\s)*?\*\//g,"").replace(/\s+/g," ")).split(";").reduce(function(n,t){var i,r,u;return t?(i=/\s*([^:]+?)\s*:\s*([^;]*)\s*$/.exec(t),i&&(r=i[1],u=i[2],r&&u&&(n[r.trim()]=u.trim())),n):n},{}):{}},n.objectToCssText=function(n){return n?Object.keys(n).reduce(function(t,i){var r=i.trim(),u=n[i];return r&&u&&t.push(r+": "+u.toString().trim()),t},[]).join("; "):""},n}();t.Data=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(24),u=i(65),f=i(18),e=function(){function n(){}return n.GetEvent=function(n){return"undefined"!=typeof event&&null!=event&&r.Browser.IE?event:n},n.AttachEventToElement=function(n,t,i,r){void 0===r&&(r=!1);n.addEventListener?n.addEventListener(t,i,!r):n.attachEvent("on"+t,i)},n.AttachEventToDocument=function(t,i){u.TouchUIHelper.onEventAttachingToDocument(t,i)&&n.AttachEventToElement(document,t,i)},n.PreventEvent=function(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,!1},n.GetKeyCode=function(n){return r.Browser.NetscapeFamily||r.Browser.Opera?n.which:n.keyCode},n.GetEventSource=function(t,i){return f.IsExists(t)?i&&document.elementFromPoint&&void 0!==n.GetEventX(t)&&void 0!==n.GetEventY(t)?document.elementFromPoint(n.GetEventX(t),n.GetEventY(t)):t.srcElement?t.srcElement:t.target:null},n.GetMouseWheelEventName=function(){return r.Browser.Safari?"mousewheel":r.Browser.NetscapeFamily&&r.Browser.MajorVersion<17?"DOMMouseScroll":"wheel"},n.IsLeftButtonPressed=function(t){return!!u.TouchUIHelper.isTouchEvent(t)||!!(t=n.GetEvent(t))&&(r.Browser.IE&&r.Browser.Version<11?!!r.Browser.MSTouchUI||t.button%2==1:r.Browser.WebKitFamily?"pointermove"===t.type?1===t.buttons:1==t.which:r.Browser.NetscapeFamily||r.Browser.Edge||r.Browser.IE&&r.Browser.Version>=11?t.type===u.TouchUIHelper.touchMouseMoveEventName?1===t.buttons:1==t.which:!r.Browser.Opera||0==t.button)},n.PreventEventAndBubble=function(t){return n.PreventEvent(t),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,!1},n.clientEventRequiresDocScrollCorrection=function(){var n=r.Browser.Safari&&r.Browser.Version<3,t=r.Browser.MacOSMobilePlatform&&r.Browser.Version<5.1;return r.Browser.AndroidDefaultBrowser||r.Browser.AndroidChromeBrowser||!(n||t)},n.GetEventX=function(t){return u.TouchUIHelper.isTouchEvent(t)?u.TouchUIHelper.getEventX(t):t.clientX+(n.clientEventRequiresDocScrollCorrection()?f.GetDocumentScrollLeft():0)},n.GetEventY=function(t){return u.TouchUIHelper.isTouchEvent(t)?u.TouchUIHelper.getEventY(t):t.clientY+(n.clientEventRequiresDocScrollCorrection()?f.GetDocumentScrollTop():0)},n.CancelBubble=function(n){return n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0,!1},n}();t.Evt=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(89),u=function(){function n(n){this.url=void 0;this.base64=void 0;n&&(r.Base64Utils.checkPrependDataUrl(n)?this.base64=n:this.url=n);this.loadFailed=!1}return n.prototype.clone=function(){var t=new n;return t.url=this.url,t.base64=this.base64,t},Object.defineProperty(n.prototype,"isEmpty",{get:function(){return void 0===this.url&&void 0===this.base64},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unableToLoad",{get:function(){return this.loadFailed},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"renderUrl",{get:function(){return this.base64||""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"exportUrl",{get:function(){return this.base64?this.base64:this.url},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"actualUrl",{get:function(){return this.url?this.url:this.base64},enumerable:!0,configurable:!0}),Object.defineProperty(n,"transparentOnePixelImage",{get:function(){return this.transparentWhiteImage1_1},enumerable:!0,configurable:!0}),n.prototype.loadBase64Content=function(n){this.base64=r.Base64Utils.normalize(n)},n.prototype.setUnableToLoadFlag=function(){this.loadFailed=!0},n.transparentWhiteImage1_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAANSURBVBhXY/j///9/AAn7A/0FQ0XKAAAAAElFTkSuQmCC",n}();t.ImageInfo=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.selectedKeys=i,u.selection=t,u.forceChange=r,u}return f(t,n),t.prototype.redo=function(){this.oldSelection=this.selection.getKeys().slice(0);this.selection.set(this.selectedKeys,this.forceChange)},t.prototype.undo=function(){this.selection.set(this.oldSelection,this.forceChange)},t}(i(3).HistoryItem);t.SetSelectionHistoryItem=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(3),e=i(11),o=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f.shapeDescription=t,f.position=i,f.text=r,f.dataKey=u,f}return u(t,n),t.prototype.redo=function(n){var t=new e.Shape(this.shapeDescription,this.position);"string"==typeof this.text&&(t.text=this.text);void 0!==this.dataKey&&(t.dataKey=this.dataKey);n.addShape(t,this.shapeKey);this.shapeKey=t.key},t.prototype.undo=function(n){n.deleteShape(n.model.findShape(this.shapeKey))},t}(f.HistoryItem);t.AddShapeHistoryItem=o},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,f,e,void 0,o)||this;return s.cx=t,s.cy=i,s.rx=r,s.ry=u,s}return e(t,n),t.prototype.createMainElement=function(){return document.createElementNS(u.svgNS,"ellipse")},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"cx",this.cx);this.setUnitAttribute(t,"cy",this.cy);this.setUnitAttribute(t,"rx",this.rx);this.setUnitAttribute(t,"ry",this.ry);this.setPositionCorrectionAttribute(t);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.EllipsePrimitive=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t}(i(8).SimpleCommandBase);t.ExportImportCommandBase=u},function(n,t,i){"use strict";var p;Object.defineProperty(t,"__esModule",{value:!0});var r,w=i(137),b=i(163),k=i(164),d=i(165),g=i(203),nt=i(204),tt=i(205),it=i(206),rt=i(207),ut=i(208),ft=i(209),et=i(210),ot=i(211),s=i(212),h=i(213),st=i(214),ht=i(215),u=i(13),c=i(112),ct=i(217),l=i(218),lt=i(219),a=i(221),at=i(223),vt=i(225),yt=i(226),pt=i(227),wt=i(228),bt=i(229),kt=i(232),dt=i(235),gt=i(236),v=i(118),e=i(237),f=i(238),ni=i(239),ti=i(241),ii=i(120),ri=i(121),ui=i(242),fi=i(243),o=i(244),y=i(245),ei=i(247),oi=i(249),si=i(250),hi=i(251),ci=i(252),li=i(253),ai=i(254),vi=i(255),yi=i(257),pi=i(258),wi=i(259),bi=i(260),ki=i(261),di=i(262),gi=i(263),nr=i(264);!function(n){n[n.Undo=0]="Undo";n[n.Redo=1]="Redo";n[n.Cut=2]="Cut";n[n.Copy=3]="Copy";n[n.Paste=4]="Paste";n[n.PasteInPosition=5]="PasteInPosition";n[n.SelectAll=6]="SelectAll";n[n.Delete=7]="Delete";n[n.Import=8]="Import";n[n.ImportBPMN=9]="ImportBPMN";n[n.Export=10]="Export";n[n.ExportSvg=11]="ExportSvg";n[n.ExportPng=12]="ExportPng";n[n.ExportJpg=13]="ExportJpg";n[n.BindDocument=14]="BindDocument";n[n.UnbindDocument=15]="UnbindDocument";n[n.Bold=16]="Bold";n[n.Italic=17]="Italic";n[n.Underline=18]="Underline";n[n.FontName=19]="FontName";n[n.FontSize=20]="FontSize";n[n.FontColor=21]="FontColor";n[n.FillColor=22]="FillColor";n[n.StrokeColor=23]="StrokeColor";n[n.TextLeftAlign=24]="TextLeftAlign";n[n.TextCenterAlign=25]="TextCenterAlign";n[n.TextRightAlign=26]="TextRightAlign";n[n.ConnectorLineOption=27]="ConnectorLineOption";n[n.ConnectorStartLineEnding=28]="ConnectorStartLineEnding";n[n.ConnectorEndLineEnding=29]="ConnectorEndLineEnding";n[n.BringToFront=30]="BringToFront";n[n.SendToBack=31]="SendToBack";n[n.MoveLeft=32]="MoveLeft";n[n.MoveStepLeft=33]="MoveStepLeft";n[n.MoveRight=34]="MoveRight";n[n.MoveStepRight=35]="MoveStepRight";n[n.MoveUp=36]="MoveUp";n[n.MoveStepUp=37]="MoveStepUp";n[n.MoveDown=38]="MoveDown";n[n.MoveStepDown=39]="MoveStepDown";n[n.CloneLeft=40]="CloneLeft";n[n.CloneRight=41]="CloneRight";n[n.CloneUp=42]="CloneUp";n[n.CloneDown=43]="CloneDown";n[n.AutoLayoutTree=44]="AutoLayoutTree";n[n.AutoLayoutFlow=45]="AutoLayoutFlow";n[n.AutoLayoutTreeVertical=46]="AutoLayoutTreeVertical";n[n.AutoLayoutTreeHorizontal=47]="AutoLayoutTreeHorizontal";n[n.AutoLayoutLayeredVertical=48]="AutoLayoutLayeredVertical";n[n.AutoLayoutLayeredHorizontal=49]="AutoLayoutLayeredHorizontal";n[n.Lock=50]="Lock";n[n.Unlock=51]="Unlock";n[n.Units=52]="Units";n[n.ViewUnits=53]="ViewUnits";n[n.PageSize=54]="PageSize";n[n.PageLandscape=55]="PageLandscape";n[n.PageColor=56]="PageColor";n[n.GridSize=57]="GridSize";n[n.ShowGrid=58]="ShowGrid";n[n.SnapToGrid=59]="SnapToGrid";n[n.ZoomLevel=60]="ZoomLevel";n[n.Fullscreen=61]="Fullscreen";n[n.ToggleSimpleView=62]="ToggleSimpleView";n[n.ToggleReadOnly=63]="ToggleReadOnly";n[n.EditShapeImage=64]="EditShapeImage";n[n.FitToScreen=65]="FitToScreen";n[n.SwitchAutoZoom=66]="SwitchAutoZoom";n[n.ToggleAutoZoom=67]="ToggleAutoZoom";n[n.FitToWidth=68]="FitToWidth";n[n.ZoomLevelItems=69]="ZoomLevelItems";n[n.GridSizeItems=70]="GridSizeItems";n[n.PageSizeItems=71]="PageSizeItems";n[n.ImportXML=72]="ImportXML";n[n.InsertShapeImage=73]="InsertShapeImage";n[n.DeleteShapeImage=74]="DeleteShapeImage";n[n.StrokeStyle=75]="StrokeStyle";n[n.StrokeWidth=76]="StrokeWidth";n[n.AutoLayoutTreeVerticalBottomToTop=77]="AutoLayoutTreeVerticalBottomToTop";n[n.AutoLayoutTreeHorizontalRightToLeft=78]="AutoLayoutTreeHorizontalRightToLeft";n[n.AutoLayoutLayeredVerticalBottomToTop=79]="AutoLayoutLayeredVerticalBottomToTop";n[n.AutoLayoutLayeredHorizontalRightToLeft=80]="AutoLayoutLayeredHorizontalRightToLeft";n[n.Zoom25=81]="Zoom25";n[n.Zoom50=82]="Zoom50";n[n.Zoom75=83]="Zoom75";n[n.Zoom100=84]="Zoom100";n[n.Zoom125=85]="Zoom125";n[n.Zoom150=86]="Zoom150";n[n.Zoom200=87]="Zoom200";n[n.AutoZoomToContent=88]="AutoZoomToContent";n[n.AutoZoomToWidth=89]="AutoZoomToWidth";n[n.ZoomLevelInPercentage=90]="ZoomLevelInPercentage"}(r=t.DiagramCommand||(t.DiagramCommand={}));p=function(){function n(n){this.commands={};this.shortcutsToCommand={};this.lastCommandsChain=[];this.executingCommandsChain=[];this.executingCommandCounter=0;this.isPublicApiCall=!1;this.createCommand(n,r.Undo,b.UndoCommand,u.ModifierKey.Ctrl|u.KeyCode.Key_z,u.ModifierKey.Meta|u.KeyCode.Key_z);this.createCommand(n,r.Redo,k.RedoCommand,u.ModifierKey.Ctrl|u.KeyCode.Key_y,u.ModifierKey.Ctrl|u.ModifierKey.Shift|u.KeyCode.Key_z,u.ModifierKey.Meta|u.ModifierKey.Shift|u.KeyCode.Key_z);this.createCommand(n,r.Cut,wt.CutSelectionCommand,u.KeyCode.Key_x|u.ModifierKey.Ctrl,u.KeyCode.Key_x|u.ModifierKey.Meta);this.createCommand(n,r.Copy,pt.CopySelectionCommand,u.KeyCode.Key_c|u.ModifierKey.Ctrl,u.KeyCode.Key_c|u.ModifierKey.Meta);this.createCommand(n,r.Paste,bt.PasteSelectionCommand);this.createCommand(n,r.PasteInPosition,ai.PasteSelectionInPositionCommand);this.createCommand(n,r.SelectAll,ht.SelectAllCommand,u.KeyCode.Key_a|u.ModifierKey.Ctrl,u.KeyCode.Key_a|u.ModifierKey.Meta);this.createCommand(n,r.Delete,w.DeleteCommand,u.KeyCode.Delete,u.KeyCode.Backspace);this.createCommand(n,r.Import,d.ImportCommand);this.createCommand(n,r.ImportBPMN,kt.ImportBPMNCommand);this.createCommand(n,r.ImportXML,vi.ImportXMLCommand);this.createCommand(n,r.Export,g.ExportCommand);this.createCommand(n,r.ExportSvg,vt.ExportSvgCommand);this.createCommand(n,r.ExportPng,at.ExportPngCommand);this.createCommand(n,r.ExportJpg,yt.ExportJpgCommand);this.createCommand(n,r.BindDocument,ni.BindDocumentCommand);this.createCommand(n,r.UnbindDocument,ti.UnbindDocumentCommand);this.createCommand(n,r.Bold,nt.ToggleFontBoldCommand,u.ModifierKey.Ctrl|u.KeyCode.Key_b,u.ModifierKey.Meta|u.KeyCode.Key_b);this.createCommand(n,r.Italic,tt.ToggleFontItalicCommand,u.ModifierKey.Ctrl|u.KeyCode.Key_i,u.ModifierKey.Meta|u.KeyCode.Key_i);this.createCommand(n,r.Underline,it.ToggleFontUnderlineCommand,u.ModifierKey.Ctrl|u.KeyCode.Key_u,u.ModifierKey.Meta|u.KeyCode.Key_u);this.createCommand(n,r.FontName,rt.ChangeFontNameCommand);this.createCommand(n,r.FontSize,ut.ChangeFontSizeCommand);this.createCommand(n,r.FontColor,ft.ChangeFontColorCommand);this.createCommand(n,r.FillColor,et.ChangeFillColorCommand);this.createCommand(n,r.StrokeColor,ot.ChangeStrokeColorCommand);this.createCommand(n,r.StrokeStyle,wi.ChangeStrokeStyleCommand);this.createCommand(n,r.StrokeWidth,bi.ChangeStrokeWidthCommand);this.createCommand(n,r.TextLeftAlign,s.TextLeftAlignCommand);this.createCommand(n,r.TextCenterAlign,s.TextCenterAlignCommand);this.createCommand(n,r.TextRightAlign,s.TextRightAlignCommand);this.createCommand(n,r.ConnectorLineOption,st.ChangeConnectorLineOptionCommand);this.createCommand(n,r.ConnectorStartLineEnding,h.ChangeConnectorStartLineEndingCommand);this.createCommand(n,r.ConnectorEndLineEnding,h.ChangeConnectorEndLineEndingCommand);this.createCommand(n,r.BringToFront,gt.BringToFrontCommand);this.createCommand(n,r.SendToBack,dt.SendToBackCommand);this.createCommand(n,r.MoveLeft,e.MoveLeftCommand,u.ModifierKey.Shift|u.KeyCode.Left);this.createCommand(n,r.MoveStepLeft,e.MoveStepLeftCommand,u.KeyCode.Left);this.createCommand(n,r.MoveRight,e.MoveRightCommand,u.ModifierKey.Shift|u.KeyCode.Right);this.createCommand(n,r.MoveStepRight,e.MoveStepRightCommand,u.KeyCode.Right);this.createCommand(n,r.MoveUp,e.MoveUpCommand,u.ModifierKey.Shift|u.KeyCode.Up);this.createCommand(n,r.MoveStepUp,e.MoveStepUpCommand,u.KeyCode.Up);this.createCommand(n,r.MoveDown,e.MoveDownCommand,u.ModifierKey.Shift|u.KeyCode.Down);this.createCommand(n,r.MoveStepDown,e.MoveStepDownCommand,u.KeyCode.Down);this.createCommand(n,r.CloneLeft,o.CloneLeftCommand,u.ModifierKey.Ctrl|u.ModifierKey.Shift|u.KeyCode.Left);this.createCommand(n,r.CloneRight,o.CloneRightCommand,u.ModifierKey.Ctrl|u.ModifierKey.Shift|u.KeyCode.Right);this.createCommand(n,r.CloneUp,o.CloneUpCommand,u.ModifierKey.Ctrl|u.ModifierKey.Shift|u.KeyCode.Up);this.createCommand(n,r.CloneDown,o.CloneDownCommand,u.ModifierKey.Ctrl|u.ModifierKey.Shift|u.KeyCode.Down);this.createCommand(n,r.Lock,ui.LockCommand);this.createCommand(n,r.Unlock,fi.UnLockCommand);this.createCommand(n,r.AutoLayoutTree,c.AutoLayoutTreeVerticalCommand);this.createCommand(n,r.AutoLayoutFlow,v.AutoLayoutLayeredHorizontalCommand);this.createCommand(n,r.Units,y.ChangeUnitsCommand);this.createCommand(n,r.ViewUnits,y.ChangeViewUnitsCommand);this.createCommand(n,r.PageSize,a.ChangePageSizeCommand);this.createCommand(n,r.PageLandscape,lt.ChangePageLandscapeCommand);this.createCommand(n,r.PageColor,ei.ChangePageColorCommand);this.createCommand(n,r.GridSize,l.ChangeGridSizeCommand);this.createCommand(n,r.ShowGrid,oi.ChangeShowGridCommand);this.createCommand(n,r.SnapToGrid,ct.ChangeSnapToGridCommand);this.createCommand(n,r.ZoomLevel,f.ChangeZoomLevelCommand);this.createCommand(n,r.ZoomLevelInPercentage,f.ChangeZoomLevelInPercentageCommand);this.createCommand(n,r.AutoLayoutTreeVertical,c.AutoLayoutTreeVerticalCommand);this.createCommand(n,r.AutoLayoutTreeVerticalBottomToTop,ki.AutoLayoutTreeVerticalBottomToTopCommand);this.createCommand(n,r.AutoLayoutTreeHorizontal,ii.AutoLayoutTreeHorizontalCommand);this.createCommand(n,r.AutoLayoutTreeHorizontalRightToLeft,di.AutoLayoutTreeHorizontalRightToLeftCommand);this.createCommand(n,r.AutoLayoutLayeredVertical,ri.AutoLayoutLayeredVerticalCommand);this.createCommand(n,r.AutoLayoutLayeredVerticalBottomToTop,gi.AutoLayoutLayeredVerticalBottomToTopCommand);this.createCommand(n,r.AutoLayoutLayeredHorizontal,v.AutoLayoutLayeredHorizontalCommand);this.createCommand(n,r.AutoLayoutLayeredHorizontalRightToLeft,nr.AutoLayoutLayeredHorizontalRightToLeftCommand);this.createCommand(n,r.Fullscreen,si.ToggleFullscreenCommand,u.KeyCode.F11);this.createCommand(n,r.ToggleSimpleView,hi.ToggleSimpleViewCommand);this.createCommand(n,r.ToggleReadOnly,ci.ToggleReadOnlyCommand);this.createCommand(n,r.InsertShapeImage,yi.InsertShapeImageCommand);this.createCommand(n,r.EditShapeImage,li.EditShapeImageCommand);this.createCommand(n,r.DeleteShapeImage,pi.DeleteShapeImageCommand);this.createCommand(n,r.FitToScreen,f.FitToScreenCommand);this.createCommand(n,r.FitToWidth,f.FitToWidthCommand);this.createCommand(n,r.SwitchAutoZoom,f.SwitchAutoZoomCommand);this.createCommand(n,r.ToggleAutoZoom,f.ToggleAutoZoomCommand);this.createCommand(n,r.ZoomLevelItems,f.ChangeZoomLevelItemsCommand);this.createCommand(n,r.GridSizeItems,l.ChangeGridSizeItemsCommand);this.createCommand(n,r.PageSizeItems,a.ChangePageSizeItemsCommand);this.createCommand(n,r.Zoom25,f.ChangeZoomLevelTo25Command);this.createCommand(n,r.Zoom50,f.ChangeZoomLevelTo50Command);this.createCommand(n,r.Zoom75,f.ChangeZoomLevelTo75Command);this.createCommand(n,r.Zoom100,f.ChangeZoomLevelTo100Command);this.createCommand(n,r.Zoom125,f.ChangeZoomLevelTo125Command);this.createCommand(n,r.Zoom150,f.ChangeZoomLevelTo150Command);this.createCommand(n,r.Zoom200,f.ChangeZoomLevelTo200Command);this.createCommand(n,r.AutoZoomToContent,f.ToggleAutoZoomToContentCommand);this.createCommand(n,r.AutoZoomToWidth,f.ToggleAutoZoomToWidthCommand)}return n.prototype.getCommand=function(n){return this.commands[n]},n.prototype.beforeExecuting=function(n){this.executingCommandsChain.push(n);this.executingCommandCounter++},n.prototype.afterExecuting=function(){this.executingCommandCounter--;0===this.executingCommandCounter&&(this.lastCommandsChain=this.executingCommandsChain,this.executingCommandsChain=[])},n.prototype.assertLastExecutedCommandsChain=function(n){for(var u,i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];if(n&&this.lastCommandsChain.length!==r.length)return!1;for(i=0;u=r[i];i++)if(!(this.lastCommandsChain[i]&&this.lastCommandsChain[i]instanceof u))return!1;return!0},n.prototype.processShortcut=function(n){var t=this.shortcutsToCommand[n];return!!t&&t.execute()},n.prototype.processPaste=function(n){var t=this.getCommand(r.Paste);return t&&t.isEnabled()&&t.performPaste(n),!0},n.prototype.notifySelectionChanged=function(){this.lastCommandsChain=[]},n.prototype.notifyScrollPositionChanged=function(){},n.prototype.createCommand=function(n,t,i){for(var f,e,u=[],r=3;r<arguments.length;r++)u[r-3]=arguments[r];for(this.commands[t]=new i(n),f=0;f<u.length;f++)e=u[f],"number"==typeof e&&(this.shortcutsToCommand[e]=this.commands[t])},n}();t.CommandManager=p},function(n,t,i){"use strict";var o,u=this&&this.__extends||(o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}o(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c,r,e,l,a;Object.defineProperty(t,"__esModule",{value:!0});var f,s=i(14),h=i(12),y=i(21),v=i(15);!function(n){n[n.Angle0deg=0]="Angle0deg";n[n.Angle90deg=90]="Angle90deg";n[n.Angle180deg=180]="Angle180deg";n[n.Angle270deg=270]="Angle270deg"}(f=t.TextAngle||(t.TextAngle={}));c=function(n){function t(t,i,r,u,f,e,o,s,h,c,l,a,v){var y=n.call(this,s,"",c,v)||this;return y.x=t,y.y=i,y.text=r,y.owner=u,y.textWidth=f,y.textHeight=e,y.textSpacing=o,y.reverseTextAhchor=h,y.angle=a,y.filterId=l,y.textSegmens=y.text.split("\n").filter(function(n){return n}),y.renderHelper=y.createRenderHelper(),void 0!==y.textWidth&&void 0!==y.textWidth&&(y.x=y.renderHelper.getTextX(y.x),y.y=y.renderHelper.getTextY(y.y)),y}return u(t,n),t.prototype.createMainElement=function(){return document.createElementNS(h.svgNS,"text")},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"x",this.x);this.setUnitAttribute(t,"y",this.y);this.filterId&&t.setAttribute("filter",v.RenderUtils.GetUrlPathById(this.filterId));n.prototype.applyElementProperties.call(this,t,i);t.getAttribute("appliedText")!==this.text||t.getAttribute("appliedSize")!==(this.fitToSize&&this.fitToSize.toString())?(this.createTSpanElements(t,i),t.setAttribute("appliedText",this.text),t.setAttribute("appliedSize",this.fitToSize&&this.fitToSize.toString())):this.prepareTSpanElements(t);this.renderHelper.prepareMainElement(t,this.x,this.y)},t.prototype.createTSpanElements=function(n,t){var i=this,r;v.RenderUtils.removeContent(n);this.textSegmens.forEach(function(r){i.fitToSize?i.lineWrap(r,t,i.fitToSize).forEach(function(t){i.createTSpanElement(n).textContent=t}):i.createTSpanElement(n).textContent=r});r=n.firstChild;r&&this.prepareFirstTSpanElement(r,n.childNodes.length)},t.prototype.lineWrap=function(n,t,i){var r=h.RenderHelper.textToWords(n),u,f;if(1===r.length)return r;i=s.UnitConverter.twipsToPixels(i);for(var a=t.measureWords(r,this.style,this.owner),v=a[" "].width,e=[],o=0,c=-1,l=0;l<r.length;l++)u=r[l],f=a[u].width,-1===c||o+v+f>i?(c=e.push(u)-1,o=f):(o+=v+f,e[c]+=" "+u);return e},t.prototype.createTSpanElement=function(n){var t=document.createElementNS(h.svgNS,"tspan");return n.appendChild(t),this.prepareTSpanElement(t),t},t.prototype.prepareTSpanElements=function(n){for(var r,i,t=0;t<n.childNodes.length;t++)r=n.childNodes[t],this.prepareTSpanElement(r);i=n.firstChild;i&&this.prepareFirstTSpanElement(i,n.childNodes.length)},t.prototype.prepareTSpanElement=function(n){this.renderHelper.prepareTSpanElement(n,this.x,this.y)},t.prototype.prepareFirstTSpanElement=function(n,t){this.renderHelper.prepareFirstTSpanElement(n,t)},t.prototype.applyElementStyleProperties=function(n){this.applyElementStylePropertiesCore(n,this.reverseTextAhchor)},Object.defineProperty(t.prototype,"fitToSize",{get:function(){return this.renderHelper.fitToSize},enumerable:!0,configurable:!0}),t.prototype.createRenderHelper=function(){switch(this.angle){case f.Angle90deg:return new e(this);case f.Angle180deg:return new l(this);case f.Angle270deg:return new a(this);default:return new r(this)}},t.baselineCorrection=.35,t}(y.SvgPrimitive);t.TextPrimitive=c;r=function(){function n(n){this.primitive=n}return Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.primitive.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.primitive.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fitToSize",{get:function(){return this.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textAnchor",{get:function(){return this.primitive.style["text-anchor"]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textSpacing",{get:function(){return this.primitive.textSpacing},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"angle",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needRotation",{get:function(){return!1},enumerable:!0,configurable:!0}),n.prototype.prepareMainElement=function(n,t,i){this.needRotation&&n.setAttribute("transform","rotate("+this.angle+", "+s.UnitConverter.twipsToPixels(t)+", "+s.UnitConverter.twipsToPixels(i)+")")},n.prototype.prepareTSpanElement=function(n,t){this.primitive.setUnitAttribute(n,"x",t);n.setAttribute("dy","1.05em")},n.prototype.prepareFirstTSpanElement=function(n,t){var i=-(t-1)/2+c.baselineCorrection;n.setAttribute("dy",i.toFixed(2)+"em")},n.prototype.getTextX=function(n){return this.textAnchor&&"middle"!==this.textAnchor?"end"===this.textAnchor?n+this.textWidth-this.textSpacing:"start"===this.textAnchor?n+this.textSpacing:n:n+this.textWidth/2},n.prototype.getTextY=function(n){return n+this.textHeight/2},n.prototype.setUnitAttribute=function(n,t,i){this.primitive.setUnitAttribute(n,t,i)},n}();t.TextPrimitiveRenderHelper=r;e=function(n){function t(t){return n.call(this,t)||this}return u(t,n),Object.defineProperty(t.prototype,"fitToSize",{get:function(){return this.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return 90},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"needRotation",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.getTextX=function(n){return n+this.textWidth/2},t.prototype.getTextY=function(n){return this.textAnchor&&"middle"!==this.textAnchor?"end"===this.textAnchor?n+this.textHeight-this.textSpacing:"start"===this.textAnchor?n+this.textSpacing:n:n+this.textHeight/2},t}(r);t.TextPrimitive90degRenderHelper=e;l=function(n){function t(t){return n.call(this,t)||this}return u(t,n),Object.defineProperty(t.prototype,"angle",{get:function(){return 180},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"needRotation",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.getTextX=function(n){return this.textAnchor&&"middle"!==this.textAnchor?"start"===this.textAnchor?n+this.textWidth-this.textSpacing:"end"===this.textAnchor?n+this.textSpacing:n:n+this.textWidth/2},t}(r);t.TextPrimitive180degRenderHelper=l;a=function(n){function t(t){return n.call(this,t)||this}return u(t,n),Object.defineProperty(t.prototype,"angle",{get:function(){return 270},enumerable:!0,configurable:!0}),t.prototype.getTextY=function(n){return this.textAnchor&&"middle"!==this.textAnchor?"start"===this.textAnchor?n+this.textHeight-this.textSpacing:"end"===this.textAnchor?n+this.textSpacing:n:n+this.textHeight/2},t}(e);t.TextPrimitive270degRenderHelper=a},function(n,t,i){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0});var r=i(89),e=i(40),u=function(){function n(n,t,i,u,f){this._base64=void 0!==n?r.Base64Utils.normalize(n):void 0;this.actualId=t;this._referenceInfo=u;this._isLoaded=void 0!==f&&f;this.imageUrl=i}return Object.defineProperty(n.prototype,"isLoaded",{get:function(){return this._referenceInfo?this._referenceInfo._isLoaded:this._isLoaded},set:function(n){this._isLoaded=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"base64",{get:function(){return this._base64},set:function(n){this._base64=r.Base64Utils.normalize(n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"referenceInfo",{get:function(){return this._referenceInfo},set:function(n){this._referenceInfo=n;this._base64=void 0;this._isLoaded=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoading",{get:function(){return this._referenceInfo?this.referenceInfo._isLoading:this._isLoading},enumerable:!0,configurable:!0}),n.prototype.startLoading=function(){this._referenceInfo?this._referenceInfo.startLoading():this._isLoading=!0},n.prototype.finalizeLoading=function(){this._referenceInfo?this._referenceInfo.finalizeLoading():this._isLoading=!1},n}();t.CacheImageInfo=u;f=function(){function n(){this.emptyImageId=0;this.lastActualId=0;this.cache=[];this.createUnloadedInfoByBase64(e.ImageInfo.transparentOnePixelImage).isLoaded=!0}return n.prototype.reset=function(){this.cache.splice(1);this.lastActualId=1},Object.defineProperty(n.prototype,"emptyImage",{get:function(){return this.cache[this.emptyImageId]},enumerable:!0,configurable:!0}),n.prototype.getImageData=function(n){return this.cache[n]},n.prototype.createUnloadedInfoByUrl=function(n){var t=this.findInfoByUrl(n);return t||this.registerImageData(new u(void 0,this.getNextActualId(),n))},n.prototype.createUnloadedInfoByBase64=function(n){var t=this.findInfoByBase64(n);return t||this.registerImageData(new u(n,this.getNextActualId()))},n.prototype.createUnloadedInfoByShapeImageInfo=function(n){var t=n.exportUrl;return r.Base64Utils.checkPrependDataUrl(t)?this.createUnloadedInfoByBase64(t):this.createUnloadedInfoByUrl(t)},n.prototype.registerImageData=function(n){var t=this.cache[n.actualId];return t||(t=n),void 0!==n.actualId&&(this.cache[n.actualId]=t),t},n.prototype.loadAllImages=function(n){var t=this;this.cache.forEach(function(i){t.emptyImageId==i.actualId||i.isLoaded||i.isLoading||n.load(i)})},n.prototype.finalizeLoading=function(n,t){if(n.finalizeLoading(),n.isLoaded=!0,!n.referenceInfo&&t.base64){var i=r.Base64Utils.normalize(t.base64);this.cache.forEach(function(t){var r=t.base64==i&&t!==n&&t.isLoaded;return r&&(n.referenceInfo=t.referenceInfo?t.referenceInfo:t),r});n.base64=i}},n.prototype.getNextActualId=function(){return this.lastActualId++},n.prototype.findInfoByBase64=function(n){return n=r.Base64Utils.normalize(n),this.findInfoCore(function(t){return t.base64===n})},n.prototype.findInfoByUrl=function(n){return this.findInfoCore(function(t){return t.imageUrl===n})},n.prototype.findInfoCore=function(n){var t;return this.cache.forEach(function(i){n(i)&&(t=i)}),t},n.instance=new n,n}();t.ImageCache=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Shape=0]="Shape";n[n.Connector=1]="Connector";n[n.ExtensionLine=2]="ExtensionLine";n[n.Resize=3]="Resize"}(t.TextOwner||(t.TextOwner={}))},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.connectorKey=t,u.pointIndex=i,u.point=r,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.oldPoint=t.points[this.pointIndex].clone();n.moveConnectorPoint(t,this.pointIndex,this.point)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.moveConnectorPoint(t,this.pointIndex,this.oldPoint)},t}(i(3).HistoryItem);t.MoveConnectorPointHistoryItem=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(3),e=i(6),o=function(n){function t(t,i){var r=n.call(this)||this;return r.points=t,r.dataKey=i,r}return u(t,n),t.prototype.redo=function(n){var t=new e.Connector(this.points);void 0!==this.dataKey&&(t.dataKey=this.dataKey);n.addConnector(t,this.connectorKey);this.connectorKey=t.key},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.deleteConnector(t)},t}(f.HistoryItem);t.AddConnectorHistoryItem=o},function(n,t,i){"use strict";var f,e=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c,u;Object.defineProperty(t,"__esModule",{value:!0});var r=i(29),o=i(11),l=i(0),s=i(67),h=function(){function n(n,t){this.nodeMap={};this.edgeMap={};this.nodes=[];this.edges=[];this.onInit();n.forEach(this.addNode.bind(this));t.forEach(this.addEdge.bind(this))}return Object.defineProperty(n.prototype,"items",{get:function(){return this.nodes.map(this.getNode.bind(this))},enumerable:!0,configurable:!0}),n.prototype.onInit=function(){},n.prototype.addEdge=function(n){this.edgeMap[n.key]=n;this.edges.push(n)},n.prototype.addNode=function(n){this.nodeMap[n.key]=n;this.nodes.push(n.key)},n.prototype.getNode=function(n){return this.nodeMap[n]},n.prototype.getEdge=function(n){return this.edgeMap[n]},n.prototype.isEmpty=function(){return!this.nodes.length&&!this.edges.length},n.prototype.getAdjacentEdges=function(n,t){return void 0===t&&(t=r.ConnectionMode.OutgoingAndIncoming),this.edges.filter(function(i){return t&r.ConnectionMode.Incoming&&i.to===n||t&r.ConnectionMode.Outgoing&&i.from===n})},n}(),a=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.cast=function(n,i){var r=this;return new t(this.nodes.map(function(t){return n(r.getNode(t))}),this.edges.map(function(n){return i?i(n):n}))},t.prototype.getConnectedComponents=function(){var n=this.createIterator(r.ConnectionMode.OutgoingAndIncoming);n.visitEachEdgeOnce=!0;for(var u=[],f=function(i){var r=[],f=[];n.onNode=function(n){return r.push(n)};n.onEdge=function(n){return f.push(n)};n.iterate(e.nodes[i]);r.length&&u.push(new t(r,f))},e=this,i=0;i<this.nodes.length;i++)f(i);return u},t.prototype.createIterator=function(n){var t=new u(this,n);return t.comparer=function(n,t){return n.weight-t.weight},t},t.prototype.getSpanningGraph=function(n,i,r){var c=this,e,h;if(void 0===r&&(r=void 0),!this.nodes.length)return new t([],[]);r||(r=function(n){return n.weight});var f=[],u=new s.HashSet,o=new s.HashSet([],function(n){return n.getHashKey()});for(this.addNodeToSpanningGraph(n,i,f,u,o,r);f.length&&u.length!==this.nodes.length;)e=f.shift(),o.tryPush(e),h=u.contains(e.from)?e.to:e.from,this.addNodeToSpanningGraph(h,i,f,u,o,r),f=f.filter(function(n){return!u.contains(n.from)||!u.contains(n.to)});return new t(u.list().map(function(n){return c.getNode(n)}),o.list())},t.prototype.addNodeToSpanningGraph=function(n,t,i,u,f,e){u.tryPush(n);this.getAdjacentEdges(n,t).filter(function(n){return!f.contains(n)}).forEach(function(n){for(var u=e(n),t=l.Utils.binaryIndexOf(i,function(n){return n.weight-u}),t=t<0?~t:t;t<i.length&&e(i[t])===u;)t++;i.splice(t,0,new r.Edge(n.key,n.from,n.to,u))})},t.create=function(n,i){return new t(n,i.filter(function(n){return n.beginItem&&n.endItem instanceof o.Shape&&n.endItem&&n.endItem instanceof o.Shape&&n.beginItem!==n.endItem}).map(function(n){return new r.Edge(n.key,n.beginItem&&n.beginItem.key,n.endItem&&n.endItem.key)}))},t}(h);t.Graph=a;c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.onInit=function(){this.parentToChildren={};this.childToParents={}},t.prototype.addEdge=function(t){n.prototype.addEdge.call(this,t);(this.parentToChildren[t.from]||(this.parentToChildren[t.from]=[])).push(t.to);(this.childToParents[t.to]||(this.childToParents[t.to]=[])).push(t.from)},t.prototype.getChildren=function(n){return this.parentToChildren[n]||[]},t.prototype.getParents=function(n){return this.childToParents[n]||[]},t.prototype.createIterator=function(n){return new u(this,n)},t}(h);t.FastGraph=c;u=function(){function n(n,t){void 0===t&&(t=r.ConnectionMode.OutgoingAndIncoming);this.graph=n;this.connectionMode=t;this.visitEachEdgeOnce=!0;this.visitEachNodeOnce=!0;this.visitedNodes={};this.visitedEdges={}}return n.prototype.iterate=function(n){if(!this.visitEachNodeOnce&&!this.visitEachEdgeOnce&&!this.skipNode)throw"skipNode or visitEachNodeOnce or visitEachEdgeOnce must be set to avoid SOF";this.iterateCore(n)},n.prototype.iterateCore=function(n){var t=this,i=this.graph.getNode(n),u,f,e;!i||this.skipNode&&this.skipNode(i)||this.visitEachNodeOnce&&this.isNodeVisited(n)||(this.visitedNodes[n]=!0,this.onNode&&this.onNode(i),u=this.graph.getAdjacentEdges(n,this.connectionMode),(this.skipEdge&&(u=u.filter(function(n){return!t.skipEdge(n)})),this.connectionMode&r.ConnectionMode.Outgoing)&&(f=u.filter(function(t){return t.from===n}),this.comparer&&f.sort(this.comparer),f.forEach(function(n){t.visitEachEdgeOnce&&t.visitedEdges[n.key]||(t.visitedEdges[n.key]=!0,t.onEdge&&t.onEdge(n,!0),t.iterateCore(n.to),t.onAfterEdge&&t.onAfterEdge(n,!0))})),(this.onAllEdges&&this.onAllEdges(i,!0),this.connectionMode&r.ConnectionMode.Incoming)&&(e=u.filter(function(t){return t.to===n}),this.comparer&&e.sort(this.comparer),e.forEach(function(n){t.visitEachEdgeOnce&&t.visitedEdges[n.key]||(t.visitedEdges[n.key]=!0,t.onEdge&&t.onEdge(n,!1),t.iterateCore(n.from),t.onAfterEdge&&t.onAfterEdge(n,!1))})),this.onAllEdges&&this.onAllEdges(i,!1))},n.prototype.isNodeVisited=function(n){return!!this.visitedNodes[n]},n.prototype.isEdgeVisited=function(n){return!!this.visitedEdges[n]},n}();t.GraphIterator=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){return n.call(this,t,i,r)||this}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey);this.oldStyleValue=t.styleText[this.styleProperty];n.changeStyleText(t,this.styleProperty,this.styleValue)},t.prototype.undo=function(n){var t=n.model.findItem(this.itemKey);n.changeStyleText(t,this.styleProperty,this.oldStyleValue)},t}(i(93).ChangeStyleHistoryItemBase);t.ChangeStyleTextHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.connectorKey=t.key,u.text=r,u.position=i,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.oldText=t.getText(this.position);n.changeConnectorText(t,this.text,this.position)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.changeConnectorText(t,this.oldText,this.position)},t}(i(3).HistoryItem);t.ChangeConnectorTextHistoryItem=u},function(n,t,i){"use strict";var r,u,f,e,o;Object.defineProperty(t,"__esModule",{value:!0});r=i(0);u=function(){return function(n,t,i,r){void 0===r&&(r=[]);this.key=n;this.margin=t;this.size=i;this.connectionPoints=r}}();t.NodeInfo=u;f=function(){function n(n,t){this.info=n;this.position=t}return Object.defineProperty(n.prototype,"key",{get:function(){return this.info.key},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rectangle",{get:function(){return new r.Rectangle(this.position,this.info.size)},enumerable:!0,configurable:!0}),n}();t.NodeLayout=f;e=function(){return function(n,t,i){this.key=n;this.beginIndex=t;this.endIndex=i}}();t.EdgeLayout=e;o=function(){function n(n,t,i,r){void 0===t&&(t=n);void 0===i&&(i=n);void 0===r&&(r=n);this.top=n;this.right=t;this.bottom=i;this.left=r}return n.empty=function(){return new n(0)},n}();t.Margin=o},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(9),e=i(0),o=i(43),s=i(1),h=function(n){function t(t){return n.call(this,new e.Size(u.ShapeDefaultDimension,.75*u.ShapeDefaultDimension),t)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.Ellipse},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,r=t.width,u=t.height,i=t.center,f=i.x,e=i.y;return[new o.EllipsePrimitive(f,e,r/2,u/2,n.style)]},t}(u.ShapeDescription);t.EllipseShapeDescription=h},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i){var r=n.call(this)||this;return r.id=t,r.children=i,r}return e(t,n),t.prototype.createMainElement=function(){var n=document.createElementNS(u.svgNS,"clipPath");return n.setAttribute("id",this.id),n},t.prototype.applyElementProperties=function(t,i){this.id&&t.setAttribute("id",this.id);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.ClipPathPrimitive=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(11),u=i(6),f=function(){function n(){}return n.prototype.export=function(n){var t={page:{},connectors:[],shapes:[]};return t.page={width:n.size.width,height:n.size.height,pageColor:n.pageColor,pageWidth:n.pageSize.width,pageHeight:n.pageSize.height,pageLandscape:n.pageLandscape,units:n.units},this.exportItemsCore(n.items,t),JSON.stringify(t)},n.prototype.exportItems=function(n){var t={connectors:[],shapes:[]};return this.exportItemsCore(n,t),JSON.stringify(t)},n.prototype.exportItemsCore=function(n,t){var i=this;n.forEach(function(n){if(n instanceof r.Shape)t.shapes.push(i.exportShape(n));else if(n instanceof u.Connector){var f=i.exportConnector(n);n.beginItem&&(f.beginItemKey=n.beginItem.key,f.beginConnectionPointIndex=n.beginConnectionPointIndex);n.endItem&&(f.endItemKey=n.endItem.key,f.endConnectionPointIndex=n.endConnectionPointIndex);t.connectors.push(f)}})},n.prototype.exportItem=function(n){return{key:n.key,dataKey:n.dataKey,locked:n.locked,zIndex:n.zIndex}},n.prototype.exportShape=function(n){var t=this.exportItem(n),i,r,u;return t.type=n.description.key,t.text=n.text,n.image.isEmpty||(t.imageUrl=n.image.exportUrl),t.x=n.position.x,t.y=n.position.y,t.width=n.size.width,t.height=n.size.height,i=n.parameters.toObject(),i&&(t.parameters=i),r=n.style.toObject(),r&&(t.style=r),u=n.styleText.toObject(),u&&(t.styleText=u),n.children.length&&(t.childKeys=n.children.map(function(n){return n.key})),n.expanded||(t.expanded=!1),n.expandedSize&&(t.expandedWidth=n.expandedSize.width,t.expandedHeight=n.expandedSize.height),t},n.prototype.exportConnector=function(n){var t=this.exportItem(n),i,r,u,f;return t.points=n.points.map(function(n){return{x:n.x,y:n.y}}),i=n.texts.toObject(),i&&(t.texts=i),r=n.properties.toObject(),r&&(t.properties=r),u=n.style.toObject(),u&&(t.style=u),f=n.styleText.toObject(),f&&(t.styleText=f),t},n.prototype.exportSvg=function(n,t,i,r){i.exportSvgImage(n,t,r)},n.prototype.exportPng=function(n,t,i,r){i.exportPngImage(n,t,r)},n.prototype.exportJpg=function(n,t,i,r){i.exportJpgImage(n,t,r)},n}();t.Exporter=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(109),o=i(52),u=i(23),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentTextStylePropertyValue(this.getStyleProperty())===this.getStylePropertyValue()},t.prototype.executeCore=function(n){var r=this,t,i;return this.control.history.beginTransaction(),t=this.getStyleProperty(),i=n.value?u.TextStyle.defaultInstance[t]:this.getStylePropertyValue(),this.control.selection.getSelectedItems().forEach(function(n){r.control.history.addAndRedo(new o.ChangeStyleTextHistoryItem(n.key,t,i))}),this.control.selection.inputPosition.setTextStylePropertyValue(this.getStyleProperty(),i),this.control.history.endTransaction(),!0},t.prototype.getStyleObj=function(n){return n.styleText},t.prototype.getDefaultStyleObj=function(){return new u.TextStyle},t}(e.StylePropertyCommandBase);t.ToggleStyleTextPropertyCommand=s},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(110),e=i(68),o=i(23),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentStylePropertyValue(this.getStyleProperty())},t.prototype.getStyleObj=function(n){return n.style},t.prototype.getDefaultStyleObj=function(){return new o.Style},t.prototype.createHistoryItem=function(n,t,i){return new e.ChangeStyleHistoryItem(n.key,t,i)},t.prototype.updateInputPosition=function(n){this.control.selection.inputPosition.setStylePropertyValue(this.getStyleProperty(),n)},t}(f.ChangeStylePropertyCommandBase);t.ChangeStylePropertyCommand=s},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(7),e=i(8),o=i(11),s=i(6),h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.executeCore=function(){var n=this;this.control.history.beginTransaction();var t=this.getAffectedShapes(),i=this.getAffectedConnectors(),u=this.createLayoutSettings();return r.ModelUtils.getGraphInfoByItems(this.control.model,t,i,!0).forEach(function(f){var e=n.createLayout(u,f.graph),o=r.ModelUtils.getNonGraphItems(n.control.model,f.container,e.nodeToLayout,t,i);r.ModelUtils.applyLayout(n.control.history,n.control.model,f.container,f.graph,e,o,u,n.control.settings.snapToGrid,n.control.settings.gridSize,!1)}),r.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.endTransaction(),!0},t.prototype.getAffectedShapes=function(){return this.control.selection.isEmpty()?this.control.model.items.filter(function(n){return n instanceof o.Shape&&!n.locked}):this.control.selection.getSelectedShapes(!1,!0)},t.prototype.getAffectedConnectors=function(){return this.control.selection.isEmpty()?this.control.model.items.filter(function(n){return n instanceof s.Connector&&!n.locked}):this.control.selection.getSelectedConnectors(!1,!0)},t}(e.SimpleCommandBase);t.AutoLayoutCommandBase=h},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(7);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.executeCore=function(n,t){var i=this;return this.control.history.beginTransaction(),this.createHistoryItems(t).forEach(function(n){i.control.history.addAndRedo(n)}),u.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.endTransaction(),!0},t.prototype.getItems=function(){return null},t}(i(8).SimpleCommandBase);t.ChangePagePropertyCommand=f},function(n,t,i){"use strict";function b(n){return Math.trunc?Math.trunc(n):isFinite(n)?n-n%1||(n<0?-0:0===n?n:0):n}var c,k=this&&this.__extends||(c=function(n,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}c(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a,v,s,r,o;Object.defineProperty(t,"__esModule",{value:!0});var d=i(114),y=i(51),l=i(54),f=i(29),p=i(67),e=i(0),u=i(17),w=i(113),h=i(6),g=i(234),nt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return k(t,n),t.prototype.build=function(){var n=this,t=0,i=new w.GraphLayout,r=new v;return this.graph.getConnectedComponents().forEach(function(u){var f=g.CycleRemover.removeCycles(u),o=a.getLayers(f.graph),s=r.orderNodes(f.graph,o),h=Object.keys(f.removedEdges).map(function(n){return u.getEdge(n)}),c=r.assignAbsCoordinates(s),e=n.createInfoGraphLayout(c,f.reversedEdges,h);i.extend(n.setComponentOffset(e,t));t+=n.getComponentOffset(e)}),i},t.prototype.createInfoGraphLayout=function(n,t,i){for(var s,r=this,f=new e.Point(0,0),v=n.items,h=new p.HashSet(v.map(function(n){return n.layer}).sort()),k=this.getAbsOffsetInfo(n.items),y={},c=0,l=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,b=Number.MIN_SAFE_INTEGER||Number.MAX_VALUE,d=function(n){var i=h.item(n),t=0;v.filter(function(n){return n.layer===i}).sort(function(n,t){return n.position-t.position}).forEach(function(n){var o=r.getDepthNodeSize(n),s=r.chooseDirectionValue(0,o),h=r.getAbsPosition(n.position,r.getBreadthNodeSize(n),k),i,e;f=r.setBreadth(f,h);i=r.setDepthOffset(f,-s);(y[n.key]=i,n.isDummy)||(e=r.settings.orientation===u.DataLayoutOrientation.Horizontal?i.y:i.x,l=Math.min(l,e),b=Math.max(b,e+r.getBreadthNodeSize(n)),t=Math.max(t,r.getDepthNodeSize(n)))});c+=t;f=o.setBreadth(f,0);f=o.setDepthOffset(f,o.getDirectionValue(t+o.settings.layerSpacing))},o=this,a=0;a<h.length;a++)d(a);return c+=(h.length-1)*this.settings.layerSpacing,s=new w.GraphLayout,this.createNodesLayout(n,s,l,c,y),this.createEdgesLayout(n,s,t,i),s},t.prototype.createNodesLayout=function(n,t,i,r,f){var s=this,o=this.settings.orientation===u.DataLayoutOrientation.Vertical?new e.Point(-i,this.chooseDirectionValue(0,r)):new e.Point(this.chooseDirectionValue(0,r),-i);n.items.forEach(function(n){if(!n.isDummy){var i=s.graph.getNode(n.key);t.addNode(new l.NodeLayout(i,f[n.key].offset(o.x,o.y)))}})},t.prototype.createEdgesLayout=function(n,t,i,r){var u=this.getDirectEdgeLayout(),e=this.getDiffLevelEdgeLayout(!0),s=this.getDiffLevelEdgeLayout(!1),c=this.getSameLevelEdgeLayout(!0),a=this.getSameLevelEdgeLayout(!1),f={};n.edges.filter(function(n){return!n.isDummy}).concat(r.map(function(n){return new o(n.key,!1,n.from,n.to)})).sort(function(t,i){return n.getNode(t.originFrom).layer-n.getNode(i.originFrom).layer||n.getNode(t.to).layer-n.getNode(i.to).layer}).forEach(function(r){var g=i[r.key],p=n.getNode(g?r.to:r.originFrom),v=n.getNode(g?r.originFrom:r.to),o,w,b,y,k,d;if(v.layer-p.layer==1)t.addEdge(new l.EdgeLayout(r.key,u.from,u.to));else for(o=[],v.position-p.position>=1?(o.push(e),o.push({from:u.from,to:e.to}),o.push({from:e.from,to:u.to})):v.position-p.position<=-1?(o.push(s),o.push({from:u.from,to:s.to}),o.push({from:s.from,to:u.to})):(w=p.position===v.position&&0===v.position?[c,a]:[a,c],w.forEach(function(n){return o.push(n)}),w.forEach(function(n){o.push({from:n.from,to:u.to});o.push({from:u.from,to:n.to})})),o.push(u),b=0,y=void 0;y=o[b];b++)if(k=p.key+"_"+y.from,d=v.key+"_"+y.to,f[k]!==h.ConnectorPosition.End&&f[d]!==h.ConnectorPosition.Begin){t.addEdge(new l.EdgeLayout(r.key,y.from,y.to));f[k]=h.ConnectorPosition.Begin;f[d]=h.ConnectorPosition.End;break}})},t.prototype.getDirectEdgeLayout=function(){return this.settings.orientation===u.DataLayoutOrientation.Horizontal?this.settings.direction===u.LogicalDirectionKind.Forward?{from:1,to:3}:{from:3,to:1}:this.settings.direction===u.LogicalDirectionKind.Forward?{from:2,to:0}:{from:0,to:2}},t.prototype.getDiffLevelEdgeLayout=function(n){return this.settings.orientation===u.DataLayoutOrientation.Horizontal?n?{from:2,to:0}:{from:0,to:2}:n?{from:3,to:1}:{from:1,to:3}},t.prototype.getSameLevelEdgeLayout=function(n){return this.settings.orientation===u.DataLayoutOrientation.Horizontal?n?{from:0,to:0}:{from:2,to:2}:n?{from:3,to:3}:{from:1,to:1}},t.prototype.getAbsOffsetInfo=function(n){var i=this,t={},f=function(n,r){void 0===t[r]&&(t[r]=i.getBreadthNodeSize(n));t[r]=Math.max(t[r],i.getBreadthNodeSize(n))},r,u;return n.forEach(function(n){var i=b(n.position);f(n,i);t[i]%1!=0&&f(n,i+1)}),r={},u=0,Object.keys(t).sort().forEach(function(n){r[n]={leftOffset:u,width:t[n]};u+=t[n]+i.settings.columnSpacing}),r},t.prototype.setBreadth=function(n,t){return this.settings.orientation===u.DataLayoutOrientation.Vertical?new e.Point(t,n.y):new e.Point(n.x,t)},t.prototype.setDepthOffset=function(n,t){return this.settings.orientation===u.DataLayoutOrientation.Horizontal?new e.Point(n.x+t,n.y):new e.Point(n.x,n.y+t)},t.prototype.getAbsPosition=function(n,t,i){var r=b(n),u=i[r].leftOffset,f=i[r].width;return n%1==0?u+(f-t)/2:u+f-(t-this.settings.columnSpacing)/2},t.prototype.getBreadthNodeSize=function(n){return n.isDummy?0:this.getBreadthNodeSizeCore(this.graph.getNode(n.key))},t.prototype.getDepthNodeSize=function(n){return n.isDummy?0:this.getDepthNodeSizeCore(this.graph.getNode(n.key))},t}(d.LayoutBuilder);t.SugiyamaLayoutBuilder=nt;a=function(){function n(){}return n.getLayers=function(n){var t=this.getFeasibleTree(n);return this.calcNodesLayers(t)},n.getFeasibleTree=function(n){var t=this.initLayerAssignment(n);return n.getSpanningGraph(n.nodes[0],f.ConnectionMode.OutgoingAndIncoming,function(n){return t[n.to]-t[n.from]})},n.initLayerAssignment=function(n){for(var t={},u=0,i={},r=n.nodes.filter(function(t){return!n.getAdjacentEdges(t,f.ConnectionMode.Incoming).length}),e=function(){r.forEach(function(n){t[n]=u;i[n]=!0});Object.keys(i).forEach(function(r){0===n.getAdjacentEdges(r,f.ConnectionMode.Outgoing).filter(function(n){return void 0===t[n.to]}).length&&delete i[r]});var e={};Object.keys(i).forEach(function(i){n.getAdjacentEdges(i,f.ConnectionMode.Outgoing).map(function(n){return n.to}).filter(function(i){return void 0===t[i]&&n.getAdjacentEdges(i,f.ConnectionMode.Incoming).reduce(function(n,i){return n&&void 0!==t[i.from]},!0)}).forEach(function(n){return e[n]=!0})});r=Object.keys(e);u++};r.length;)e();return t},n.calcNodesLayers=function(n){var t={},r=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,u=0,i=n.createIterator(f.ConnectionMode.OutgoingAndIncoming);for(var e in i.visitEachEdgeOnce=!1,i.onNode=function(n){t[n.key]=u;r=Math.min(r,u)},i.skipNode=function(n){return void 0!==t[n.key]},i.skipEdge=function(n){return void 0!==t[n.from]&&void 0!==t[n.to]},i.onEdge=function(n,i){u=i?t[n.from]+1:t[n.to]-1},i.iterate(n.nodes[0]),t)t.hasOwnProperty(e)&&(t[e]-=r);return t},n}();t.SugiyamaLayerDistributor=a;v=function(){function n(){this.idCounter=-1e4}return n.prototype.orderNodes=function(n,t){for(var e,o=1,i=this.initGraphInfo(n,t),s=i.items,r=this.initOrder(s),h=this.getNodeToPositionMap(s),u=this.getCrossCount(r,i),f=!0;o<14&&0!=u;)r=this.getNodesOrder(r,i,f),e=this.getCrossCount(r,i),e<u&&(h=this.getNodeToPositionMap(i.items),u=e),f=!f,o++;return i.items.forEach(function(n){return n.position=h[n.key]}),i},n.prototype.getNodesOrder=function(n,t,i){var u=this,r={},f=function(f){if(!n.hasOwnProperty(f))return"continue";var o={};n[f].forEach(function(n){var r=(i?t.getChildren(n.key):t.getParents(n.key)).map(function(n){return t.getNode(n).position});o[n.key]=u.getNodePosition(r)});r[f]=e.sortNodes(o,t)},e=this;for(var o in n)f(o);return r},n.prototype.sortNodes=function(n,t){return Object.keys(n).sort(function(t,i){return n[t]-n[i]}).map(function(n,i){var r=t.getNode(n);return r.position=i,r})},n.prototype.getNodePosition=function(n){var t,i,r;return(n=n.sort()).length?(t=Math.floor(n.length/2),2===n.length||n.length%2==1)?n[t]:(i=n[t-1]-n[0],r=n[n.length-1]-n[t],Math.floor((n[t-1]*r+n[t]*i)/(i+r))):0},n.prototype.initOrder=function(n){var t={};return n.forEach(function(n){return(t[n.layer]||(t[n.layer]=[])).push(n)}),t},n.prototype.getCrossCount=function(n,t){var i=0,r=function(r){if(!n.hasOwnProperty(r))return"continue";var u=[];n[r].forEach(function(n){var r=t.getChildren(n.key).map(function(n){return t.getNode(n).position});r.forEach(function(n){i+=u.filter(function(t){return n<t}).length});u.push.apply(u,r)})};for(var u in n)r(u);return i},n.prototype.initGraphInfo=function(n,t){var e=this,r={},i={},f=[],u=[];return n.nodes.forEach(function(n){var u=t[n],e;void 0===r[u]&&(r[u]=0);e=new s(n,!1,u,r[u]++);i[n]=e;f.push(e)}),n.edges.forEach(function(n){var a=t[n.to]-t[n.from],c,h,l;if(a>1){for(c=i[n.from],h=1;h<a;h++)l=new s(e.createDummyID(),!0,t[n.from]+h,r[t[n.from]+h]++),u.push(new o(e.createDummyID(),!0,c.key,l.key)),f.push(l),c=l;u.push(new o(n.key,!1,c.key,i[n.to].key,i[n.from].key))}else u.push(new o(n.key,!1,i[n.from].key,i[n.to].key))}),new y.FastGraph(f,u)},n.prototype.createDummyID=function(){return"dummy_"+--this.idCounter},n.prototype.getNodeToPositionMap=function(n){return n.reduce(function(n,t){return n[t.key]=t.position,n},{})},n.prototype.assignAbsCoordinates=function(n){var t=this.getAbsCoodinate(n);return new y.FastGraph(n.items.map(function(n){return new s(n.key,n.isDummy,n.layer,t[n.key])}),n.edges.slice(0))},n.prototype.getAbsCoodinate=function(n){var i=this,u=n.items.reduce(function(n,t){n[t.layer]=n[t.layer]||[];var i=e.Utils.binaryIndexOf(n[t.layer],function(n){return n.position-t.position});return n[t.layer].splice(i<0?~i:i,0,t),n},{}),f=[r.TopLeft,r.TopRight,r.BottomLeft,r.BottomRight].map(function(t){return i.getPositionByMedian(n,t,u)}),t={};return n.items.forEach(function(n){var i=f.map(function(t){return t[n.key]}).sort();t[n.key]=(i[1]+i[2])/2}),t},n.prototype.getPositionByMedian=function(n,t,i){var u=n.items,r=this.getNodeToPositionMap(u),f=this.getMedians(n,u,t);return f=this.resolveMedianConflicts(n,i,f,t),this.getSortedBlocks(n,u,f,t).forEach(function(n){var t=n.reduce(function(n,t){return r[t.key]>n?r[t.key]:n},-2);n.forEach(function(n){var u=t-r[n.key];u>0&&i[n.layer].filter(function(t){return t.position>n.position}).forEach(function(n){return r[n.key]+=u});r[n.key]=t})}),r},n.prototype.getSortedBlocks=function(n,t,i,u){for(var s,o,f=[],h=u===r.BottomLeft||u===r.BottomRight,e=new p.HashSet(t.slice(0).sort(function(n,t){return h?n.layer-t.layer:t.layer-n.layer}),function(n){return n.key});e.length;)s=e.item(0),o=this.getBlock(n,s,i,u),f.push(o),o.forEach(function(n){return e.remove(n)});return f.sort(function(n,t){var r=n.reduce(function(n,t){return t.position<n.position?t:n},n[0]),f=t.filter(function(n){return n.layer==r.layer})[0],i,u;return f?r.position-f.position:(i=t.reduce(function(n,t){return t.position<n.position?t:n},t[0]),u=n.filter(function(n){return n.layer==i.layer})[0],u?u.position-i.position:r.layer-i.layer)}),f},n.prototype.getBlock=function(n,t,i,u){var e=[],f=null;do f&&(t=u===r.TopLeft||u===r.TopRight?n.getNode(f.from):n.getNode(f.to)),e.push(t),f=i[t.key];while(f);return e},n.prototype.resolveMedianConflicts=function(n,t,i,u){var e=this,f={},o=function(o){var s=void 0,h=void 0,c;if(!t.hasOwnProperty(o))return"continue";c=t[o];u!==r.TopRight&&u!==r.BottomRight||(c=c.slice(0).sort(function(n,t){return t.position-n.position}));c.forEach(function(t){var c=i[t.key],l,o;c?(l=u===r.TopLeft||u===r.TopRight?c.from:c.to,o=n.getNode(l).position,e.checkMedianConfict(s,h,o,u)?f[t.key]=null:(s=void 0===s?o:Math.min(s,o),h=void 0===h?o:Math.max(h,o),f[t.key]=c)):f[t.key]=null})};for(var s in t)o(s);return f},n.prototype.checkMedianConfict=function(n,t,i,u){return void 0!==n&&void 0!==t&&(u===r.TopLeft||u===r.BottomLeft?t>=i:n<=i)},n.prototype.getMedians=function(n,t,i){var r=this,u={};return t.forEach(function(t){var f=r.getActualAdjacentEdges(n,t,i),e=r.getMedianPosition(f.length,i);u[t.key]=f[e]}),u},n.prototype.getMedianPosition=function(n,t){if(0===n)return-1;if(n%2!=0)return Math.floor(n/2);if(t===r.TopLeft||t===r.BottomLeft)return Math.floor(n/2)-1;if(t===r.TopRight||t===r.BottomRight)return Math.floor(n/2);throw new Error("Invalid Operation");},n.prototype.getActualAdjacentEdges=function(n,t,i){return i===r.TopLeft||i===r.TopRight?n.getAdjacentEdges(t.key,f.ConnectionMode.Incoming).sort(function(t,i){return n.getNode(t.from).position-n.getNode(i.from).position}):n.getAdjacentEdges(t.key,f.ConnectionMode.Outgoing).sort(function(t,i){return n.getNode(t.to).position-n.getNode(i.to).position})},n}();t.SugiyamaNodesOrderer=v;s=function(){function n(n,t,i,r){this.key=n;this.isDummy=t;this.layer=i;this.position=r}return n.prototype.getHashCode=function(){return this.key.toString()},n}();t.NodeOnLayer=s;o=function(){function n(n,t,i,r,u){this.key=n;this.isDummy=t;this.from=i;this.to=r;this._originFrom=u}return n.prototype.getHashCode=function(){return this.from+"-"+this.to},Object.defineProperty(n.prototype,"originFrom",{get:function(){return void 0!==this._originFrom?this._originFrom:this.from},enumerable:!0,configurable:!0}),n}();t.EdgeOnLayer=o,function(n){n[n.TopLeft=0]="TopLeft";n[n.TopRight=1]="TopRight";n[n.BottomLeft=2]="BottomLeft";n[n.BottomRight=3]="BottomRight"}(r||(r={}))},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){this.suspendUpdateCount=0;this.occurredEvents=0}return n.prototype.beginUpdate=function(){0===this.suspendUpdateCount&&this.onUpdateLocked();this.suspendUpdateCount<0?this.suspendUpdateCount--:this.suspendUpdateCount++},n.prototype.endUpdate=function(){if(this.suspendUpdateCount<0?this.suspendUpdateCount++:this.suspendUpdateCount>0&&this.suspendUpdateCount--,!this.isUpdateLocked()){var n=this.occurredEvents;this.occurredEvents=0;this.onUpdateUnlocked(n)}},n.prototype.isUpdateLocked=function(){return this.suspendUpdateCount>0},n.prototype.onUpdateLocked=function(){},n.prototype.registerOccurredEvent=function(n){this.occurredEvents|=n},n}();t.BatchUpdatableObject=i},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Disabled=0]="Disabled";n[n.Console=1]="Console";n[n.Document=2]="Document"}(i||(i={}));r=function(){function n(){}return n.beginAverage=function(n){this.enableLogsAndTimers&&(this.lastAverageGroupName=n)},n.endAverage=function(){this.enableLogsAndTimers&&(this.lastAverageGroupName=null)},n.tryLogAverage=function(n){var r=this,t,i;this.lastAverageGroupName!=n&&(t=Object.keys(this.timers).map(function(n){return r.timers[n]}).filter(function(t){return t.groupName===n}),t.filter(function(n){return!n.endTime}).length||(i=t.reduce(function(n,t){return n+(t.endTime-t.startTime)},0)/t.length,this.log("average: "+i)))},n.timer=function(n){this.enableLogsAndTimers&&(this.lastCreatedTimer={message:n,startTime:performance.now(),groupName:this.lastAverageGroupName})},n.endTimer=function(){var t=this,n,i;this.enableLogsAndTimers&&(n=this.lastCreatedTimer,i=setTimeout(function(){n.endTime=performance.now();t.showMessage('timer "'+n.message+'": '+(n.endTime-n.startTime));n.groupName&&t.tryLogAverage(n.groupName)},0),this.timers[i]=n,this.lastCreatedTimer=null)},n.logPerfInfo=function(){var t=document.querySelector(".dxdi-control > svg").querySelectorAll("*").length,n=performance.memory;this.log("nodes: "+t.toLocaleString()+(n?" memory: ":"")+(n?n.usedJSHeapSize.toLocaleString():""))},n.log=function(n){this.showMessage(n)},n.showMessage=function(t){var r,f,u;switch(n.mode){case i.Console:console.log(t);break;case i.Document:r=this.getElement().innerText;this.lastMessage===t?(f=r.indexOf("\r\n"),f<0&&(f=r.indexOf("\n")),u=r.substr(0,f),/( \()([0-9]+)(\))$/.test(u)?u=u.replace(/( \()([0-9]+)(\))$/,function(n,t,i,r){return t+ ++i+r}):u+=" (1)",this.getElement().innerText=u+r.substr(f)):(this.getElement().innerText=t+"\r\n"+r,this.lastMessage=t)}},n.getElement=function(){return this.el||(this.el=document.createElement("pre"),this.el.style.top="0px",this.el.style.right="0px",this.el.style.position="fixed",this.el.style.maxHeight="100px",this.el.style.overflow="auto",document.body.appendChild(this.el)),this.el},n.mode=i.Document,n.optimizeUsingRAF=!0,n.optimizeLayers=!0,n.timers={},n.enableLogsAndTimers=!1,n}();t.Diagnostics=r},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(24),u=i(18),f=function(){function n(){}return n.onEventAttachingToDocument=function(t,i){return!r.Browser.MacOSMobilePlatform||!n.isTouchEventName(t)||(n.documentTouchHandlers[t]||(n.documentTouchHandlers[t]=[]),n.documentTouchHandlers[t].push(i),n.documentEventAttachingAllowed)},n.isTouchEventName=function(n){return r.Browser.WebKitTouchUI&&(n.indexOf("touch")>-1||n.indexOf("gesture")>-1)},n.isTouchEvent=function(n){return!!n&&r.Browser.WebKitTouchUI&&u.IsExists(n.changedTouches)},n.getEventX=function(n){return r.Browser.IE?n.pageX:n.changedTouches[0].pageX},n.getEventY=function(n){return r.Browser.IE?n.pageY:n.changedTouches[0].pageY},n.touchMouseDownEventName=r.Browser.WebKitTouchUI?"touchstart":r.Browser.Edge&&r.Browser.MSTouchUI&&window.PointerEvent?"pointerdown":"mousedown",n.touchMouseUpEventName=r.Browser.WebKitTouchUI?"touchend":r.Browser.Edge&&r.Browser.MSTouchUI&&window.PointerEvent?"pointerup":"mouseup",n.touchMouseMoveEventName=r.Browser.WebKitTouchUI?"touchmove":r.Browser.Edge&&r.Browser.MSTouchUI&&window.PointerEvent?"pointermove":"mousemove",n.msTouchDraggableClassName="dxMSTouchDraggable",n.documentTouchHandlers={},n.documentEventAttachingAllowed=!0,n}();t.TouchUIHelper=f},function(n,t){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i,f,e;Object.defineProperty(t,"__esModule",{value:!0});i=function(){return function(n,t){this.id=n;this.key=t}}();t.NativeItem=i;f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t}(i);t.NativeShape=f;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t}(i);t.NativeConnector=e},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){void 0===n&&(n=[]);void 0===t&&(t=function(n){return n.toString()});var i=this;this.items=[];this.map={};this.getHashCode=t;n.forEach(function(n){return i.tryPush(n)})}return n.prototype.tryPush=function(n){var t=this.getHashCode(n);return void 0===this.map[t]&&(this.map[t]=this.items.push(n)-1,!0)},n.prototype.contains=function(n){return void 0!==this.map[this.getHashCode(n)]},n.prototype.forEach=function(n){this.items.forEach(n)},n.prototype.filter=function(n){return this.items.filter(n)},n.prototype.list=function(){return this.items.slice(0)},n.prototype.item=function(n){return this.items[n]},n.prototype.first=function(){return this.items[0]},n.prototype.remove=function(n){var r=this.getHashCode(n),i=this.map[r],t;if("number"!=typeof i)throw"Item not found";for(delete this.map[r],this.items.splice(i,1),t=i;t<this.items.length;t++)this.map[this.getHashCode(this.items[t])]--},Object.defineProperty(n.prototype,"length",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),n}();t.HashSet=i},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){return n.call(this,t,i,r)||this}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey);this.oldStyleValue=t.style[this.styleProperty];n.changeStyle(t,this.styleProperty,this.styleValue)},t.prototype.undo=function(n){var t=n.model.findItem(this.itemKey);n.changeStyle(t,this.styleProperty,this.oldStyleValue)},t}(i(93).ChangeStyleHistoryItemBase);t.ChangeStyleHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.connectorKey=t,u.propertyName=i,u.value=r,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.oldValue=t.properties[this.propertyName];n.changeConnectorProperty(t,this.propertyName,this.value)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.changeConnectorProperty(t,this.propertyName,this.oldValue)},t}(i(3).HistoryItem);t.ChangeConnectorPropertyHistoryItem=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(166),s=i(167),h=i(168),c=i(169),l=i(170),a=i(171),v=i(172),y=i(173),p=i(174),w=i(175),b=i(96),k=i(55),d=i(176),u=i(16),g=i(97),nt=i(98),tt=i(99),it=i(177),rt=i(178),ut=i(179),ft=i(180),et=i(181),ot=i(100),st=i(101),ht=i(182),ct=i(183),lt=i(184),at=i(185),vt=i(186),yt=i(187),pt=i(188),wt=i(189),bt=i(190),kt=i(191),dt=i(192),gt=i(193),ni=i(194),f=i(102),e=i(196),ti=i(197),ii=i(198),ri=i(200),ui=i(201),r=i(1),fi=i(202),ei=function(){function n(){this.descriptions={};this.descriptionTypes={};this.descriptionCategories={};this.register(new g.TextShapeDescription,r.ShapeCategories.General);this.register(new u.RectangleShapeDescription,r.ShapeCategories.General);this.register(new k.EllipseShapeDescription,r.ShapeCategories.General);this.register(new w.CrossShapeDescription,r.ShapeCategories.General);this.register(new ot.TriangleShapeDescription,r.ShapeCategories.General);this.register(new b.DiamondShapeDescription,r.ShapeCategories.General);this.register(new d.HeartShapeDescription,r.ShapeCategories.General);this.register(new nt.PentagonShapeDescription,r.ShapeCategories.General);this.register(new tt.HexagonShapeDescription,r.ShapeCategories.General);this.register(new it.OctagonShapeDescription,r.ShapeCategories.General);this.register(new rt.StarShapeDescription,r.ShapeCategories.General);this.register(new p.ArrowUpShapeDescription,r.ShapeCategories.General);this.register(new ut.ArrowDownShapeDescription,r.ShapeCategories.General);this.register(new et.ArrowLeftShapeDescription,r.ShapeCategories.General);this.register(new y.ArrowRightShapeDescription,r.ShapeCategories.General);this.register(new v.ArrowUpDownShapeDescription,r.ShapeCategories.General);this.register(new ft.ArrowLeftRightShapeDescription,r.ShapeCategories.General);this.register(new o.ProcessShapeDescription,r.ShapeCategories.Flowchart);this.register(new s.DecisionShapeDescription,r.ShapeCategories.Flowchart);this.register(new l.TerminatorShapeDescription,r.ShapeCategories.Flowchart);this.register(new a.PredefinedProcessShapeDescription,r.ShapeCategories.Flowchart);this.register(new st.DocumentShapeDescription,r.ShapeCategories.Flowchart);this.register(new ht.MultipleDocumentsShapeDescription,r.ShapeCategories.Flowchart);this.register(new h.ManualInputShapeDescription,r.ShapeCategories.Flowchart);this.register(new ct.PreparationShapeDescription,r.ShapeCategories.Flowchart);this.register(new c.DataShapeDescription,r.ShapeCategories.Flowchart);this.register(new at.DatabaseShapeDescription,r.ShapeCategories.Flowchart);this.register(new lt.HardDiskShapeDescription,r.ShapeCategories.Flowchart);this.register(new vt.InternalStorageShapeDescription,r.ShapeCategories.Flowchart);this.register(new yt.PaperTapeShapeDescription,r.ShapeCategories.Flowchart);this.register(new pt.ManualOperationShapeDescription,r.ShapeCategories.Flowchart);this.register(new wt.DelayShapeDescription,r.ShapeCategories.Flowchart);this.register(new bt.StoredDataShapeDescription,r.ShapeCategories.Flowchart);this.register(new dt.DisplayShapeDescription,r.ShapeCategories.Flowchart);this.register(new kt.MergeShapeDescription,r.ShapeCategories.Flowchart);this.register(new fi.ConnectorShapeDescription,r.ShapeCategories.Flowchart);this.register(new gt.OrShapeDescription,r.ShapeCategories.Flowchart);this.register(new ni.SummingJunctionShapeDescription,r.ShapeCategories.Flowchart);this.register(new ii.CardWithImageOnLeftDescription,r.ShapeCategories.OrgChart);this.register(new ri.CardWithImageOnRightDescription,r.ShapeCategories.OrgChart);this.register(new ui.CardWithImageOnTopDescription,r.ShapeCategories.OrgChart);this.register(new e.VerticalContainerDescription,r.ShapeCategories.Containers);this.register(new ti.HorizontalContainerDescription,r.ShapeCategories.Containers)}return Object.defineProperty(n,"default",{get:function(){return n.defaultInstance},enumerable:!0,configurable:!0}),Object.defineProperty(n,"defaultContainer",{get:function(){return n.defaultContainerInstance},enumerable:!0,configurable:!0}),n.prototype.get=function(n){return this.descriptions[n]},n.prototype.getTypesByCategory=function(n){return this.descriptionTypes[n]||[]},n.prototype.getCategoryByType=function(n){return this.descriptionCategories[n]},n.prototype.getCategoryByDescription=function(n){return this.getCategoryByType(n.key)},n.prototype.register=function(n,t,i){if(void 0===i&&(i=n.key),void 0!==this.descriptions[i])throw Error("Description key is duplicated");this.descriptions[i]=n;this.descriptionTypes[t]||(this.descriptionTypes[t]=[]);this.descriptionTypes[t].push(i);this.descriptionCategories[i]=t},n.prototype.registerCustomShape=function(n){if(void 0===n.type)throw Error("Custom shape type is not defined");if(void 0!==this.descriptions[n.type])throw Error("Custom shape type is duplicated");var t=n.baseType&&this.descriptions[n.baseType];n.minWidth>n.maxWidth&&(n.minWidth=n.maxWidth);n.minHeight>n.maxHeight&&(n.minHeight=n.maxHeight);n.defaultWidth<n.minWidth&&(n.defaultWidth=n.minWidth);n.defaultWidth>n.maxWidth&&(n.defaultWidth=n.maxWidth);n.defaultHeight<n.minHeight&&(n.defaultHeight=n.minHeight);n.defaultHeight>n.maxHeight&&(n.defaultHeight=n.maxHeight);this.register(new f.CustomShapeDescription(n,t),n.category||r.ShapeCategories.Custom)},n.prototype.unregisterCustomShape=function(n){var t,i;this.descriptions[n]instanceof f.CustomShapeDescription&&(t=this.descriptionCategories[n],delete this.descriptions[n],delete this.descriptionCategories[n],i=this.descriptionTypes[t].indexOf(n),this.descriptionTypes[t].splice(i,1),0===this.descriptionTypes[t].length&&delete this.descriptionTypes[t])},n.defaultInstance=new u.RectangleShapeDescription,n.defaultContainerInstance=new e.VerticalContainerDescription,n}();t.ShapeDescriptionManager=ei},function(n,t,i){"use strict";var r,s=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o;Object.defineProperty(t,"__esModule",{value:!0});var u=i(9),h=i(0),f=i(28),e=i(5);t.ArrowVerticalTriangleHeightParameterName="th";t.ArrowVerticalLineWidthParameterName="lw";o=function(n){function i(){return n.call(this,new h.Size(.375*u.ShapeDefaultDimension,u.ShapeDefaultDimension))||this}return s(i,n),i.prototype.createParameters=function(n){n.addRange([new f.ShapeParameter(t.ArrowVerticalTriangleHeightParameterName,Math.sqrt(Math.pow(this.defaultSize.width,2)-Math.pow(this.defaultSize.width/2,2))),new f.ShapeParameter(t.ArrowVerticalLineWidthParameterName,this.defaultSize.width/3)])},i.prototype.normalizeParameters=function(n,i){this.changeParameterValue(i,t.ArrowVerticalTriangleHeightParameterName,function(t){return Math.max(0,Math.min(n.size.height,t.value))});this.changeParameterValue(i,t.ArrowVerticalLineWidthParameterName,function(t){return Math.max(0,Math.min(n.size.width,t.value))})},i.prototype.processConnectionPoint=function(n,i){var r=(n.size.width-n.parameters.get(t.ArrowVerticalLineWidthParameterName).value)/2,u=n.getConnectionPointSide(i);u===e.ConnectionPointSide.East?i.x-=r:u===e.ConnectionPointSide.West&&(i.x+=r)},i}(u.ShapeDescription);t.ArrowVerticalShapeDescription=o},function(n,t,i){"use strict";var r,s=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o;Object.defineProperty(t,"__esModule",{value:!0});var u=i(9),h=i(0),f=i(28),e=i(5);t.ArrowVerticalTriangleWidthParameterName="tw";t.ArrowVerticalLineHeightParameterName="lh";o=function(n){function i(){return n.call(this,new h.Size(u.ShapeDefaultDimension,.375*u.ShapeDefaultDimension))||this}return s(i,n),i.prototype.createParameters=function(n){n.addRange([new f.ShapeParameter(t.ArrowVerticalTriangleWidthParameterName,Math.sqrt(Math.pow(this.defaultSize.height,2)-Math.pow(this.defaultSize.height/2,2))),new f.ShapeParameter(t.ArrowVerticalLineHeightParameterName,this.defaultSize.height/3)])},i.prototype.normalizeParameters=function(n,i){this.changeParameterValue(i,t.ArrowVerticalTriangleWidthParameterName,function(t){return Math.max(0,Math.min(n.size.width,t.value))});this.changeParameterValue(i,t.ArrowVerticalLineHeightParameterName,function(t){return Math.max(0,Math.min(n.size.height,t.value))})},i.prototype.processConnectionPoint=function(n,i){var r=(n.size.height-n.parameters.get(t.ArrowVerticalLineHeightParameterName).value)/2,u=n.getConnectionPointSide(i);u===e.ConnectionPointSide.North?i.y+=r:u===e.ConnectionPointSide.South&&(i.y-=r)},i}(u.ShapeDescription);t.ArrowHorizontalShapeDescription=o},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(9);f=function(n){function t(t){var i=n.call(this,void 0,t)||this;return i.defaultSize.height=i.calculateHeight(u.ShapeDefaultDimension),i}return e(t,n),Object.defineProperty(t.prototype,"angle",{get:function(){return Math.PI*(this.angleCount-2)/this.angleCount},enumerable:!0,configurable:!0}),t}(u.ShapeDescription);t.PolygonShapeDescription=f},function(n,t,i){"use strict";var e,l=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}e(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(9),s=i(0),f=i(104),h=i(199),r=i(4),u=i(2),a=i(30),c=i(105),v=i(1),y=function(n){function t(t){return void 0===t&&(t=new s.Size(o.ShapeDefaultDimension,26/46*o.ShapeDefaultDimension)),n.call(this,t,!0)||this}return l(t,n),t.prototype.getDefaultText=function(){return r.DiagramLocalizationService.shapeTexts[v.ShapeTypes.Card]},t.prototype.createShapePrimitives=function(n,t){var i=n.rectangle,r=i.left,u=i.top,f=i.width,e=i.height;return[new h.RoundedRectanglePrimitive(r,u,f,e,t?30:60,t?30:60,n.style)]},t.prototype.createImagePlaceholder=function(n){return[new h.RoundedRectanglePrimitive(n.left,n.top,n.width,n.height,r.UnitConverter.pixelsToTwips(2),r.UnitConverter.pixelsToTwips(2),void 0,f.SHAPE_IMAGE_CLASSNAMES.IMAGE_PLACEHOLDER)]},t.prototype.createEmptyImagePrimitive=function(n){return c.ShapeImageIndicator.createUserIconPrimitives(n.left,n.top,this.defaultIconSize,r.UnitConverter.pixelsToTwips(1),f.SHAPE_IMAGE_CLASSNAMES.USER_PIC)},t.prototype.createWarningPrimitive=function(n){return c.ShapeImageIndicator.createWarningIconPrimitives(n.left+this.defaultIconSize/2,n.top+this.defaultIconSize/2,this.defaultIconSize/2,f.SHAPE_IMAGE_CLASSNAMES.WARNING_MARK)},t.prototype.getTextRectangle=function(n){var f=n.rectangle,t=f.clone(),i=this.getTextBlockOffset(f),u=r.UnitConverter.pixelsToTwips(3);return i.left>0&&(t.position.x=t.left+i.left+u),i.top>0&&(t.position.y=t.top+i.top+u),t.size.width=t.width-i.right-i.left-2*u,t.size.height=t.height-i.bottom-i.top-2*u,t.position.x+=u,t.position.y+=u,(i.left>0||i.right>0)&&(t.size.width=Math.max(t.width-u,0)),(i.top>0||i.bottom>0)&&(t.size.height=Math.max(t.height-u,0)),t},t.prototype.createTextPrimitives=function(t,i){return i?this.createGraphicalTextRepresentation(t.rectangle):n.prototype.createTextPrimitives.call(this,t,i)},t.prototype.createGraphicalTextRepresentation=function(n){var t=s.Rectangle.create(0,0,0,0),i=this.getTextBlockOffset(n,!0),u,f;return i.left>0||i.right>0?(u=i.left>0?n.width/2-r.UnitConverter.pixelsToTwips(2):0,t.position.x=n.left+u+r.UnitConverter.pixelsToTwips(4),t.position.y=n.top+r.UnitConverter.pixelsToTwips(5),t.size.width=(i.left||i.right)-r.UnitConverter.pixelsToTwips(4),t.size.height=n.height-r.UnitConverter.pixelsToTwips(6)):(f=i.top>0?n.height/2-r.UnitConverter.pixelsToTwips(2):0,t.position.x=n.left+n.width/4,t.position.y=n.top+f+r.UnitConverter.pixelsToTwips(4),t.size.width=n.width/2,t.size.height=(i.top||i.bottom)-r.UnitConverter.pixelsToTwips(2)),this.createTextRepresentationPrimitives(t)},t.prototype.createTextRepresentationPrimitives=function(n){var t=r.UnitConverter.pixelsToTwips(r.UnitConverter.twipsToPixels(n.height/3));return[new a.GroupPrimitive([new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(n.left,n.top),new u.PathPrimitiveLineToCommand(n.left+n.width,n.top)]),new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(n.left,n.top+t),new u.PathPrimitiveLineToCommand(n.left+n.width,n.top+t)]),new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(n.left,n.top+2*t),new u.PathPrimitiveLineToCommand(n.left+.66*n.width,n.top+2*t)])],"dxdi-shape-text")]},t}(f.ShapeWithImageDescription);t.CardBaseDescription=y},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.parseJSON=function(n){if(!n||""===n)return{};try{return JSON.parse(n)}catch(n){return{}}},n.createDocument=function(n){return(new DOMParser).parseFromString(n,"application/xml")},n}();t.ImportUtils=i},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(110),e=i(52),o=i(23),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentTextStylePropertyValue(this.getStyleProperty())},t.prototype.getStyleObj=function(n){return n.styleText},t.prototype.getDefaultStyleObj=function(){return new o.TextStyle},t.prototype.createHistoryItem=function(n,t,i){return new e.ChangeStyleTextHistoryItem(n.key,t,i)},t.prototype.updateInputPosition=function(n){this.control.selection.inputPosition.setTextStylePropertyValue(this.getStyleProperty(),n)},t}(f.ChangeStylePropertyCommandBase);t.ChangeStyleTextPropertyCommand=s},function(n,t,i){"use strict";var o,h=this&&this.__extends||(o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}o(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=i(113),c=i(216),e=i(54),u=i(0),l=i(114),a=i(29),f=i(5),r=i(17),v=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.nodeToLevel={},t.levelDepthSize={},t}return h(t,n),t.prototype.build=function(){var n=this,t=new s.GraphLayout,i=0;return this.graph.getConnectedComponents().forEach(function(r){var f=c.Tree.createSpanningTree(r),u=n.processTree(f);t.extend(n.setComponentOffset(u,i));i+=n.getComponentOffset(u)}),t},t.prototype.preProcessTree=function(n,t,i){var r=this,u;(t=t.filter(function(n){return(void 0===r.nodeToLevel[n.key]?r.nodeToLevel[n.key]=i:-1)>=0})).length&&(u=this.getMaxDepthSize(t),this.levelDepthSize[i]=u,this.preProcessTree(n,[].concat.apply([],t.map(function(t){return n.getChildren(t)})),i+1))},t.prototype.loadNodes=function(n,t,i){return i?n.getChildren(i.info).map(function(n){if(!t.hasNode(n.key))return t.addNode(new e.NodeLayout(n,u.Point.empty()))}).filter(function(n){return n}):[t.addNode(new e.NodeLayout(n.root,u.Point.empty()))]},t.prototype.processTree=function(n){var t=this,i=new s.GraphLayout,f,e;return(this.preProcessTree(n,[n.root],0),this.processLevel(n,i,0,new u.Range(0),0),this.settings.direction===r.LogicalDirectionKind.Backward)&&(f=Object.keys(this.levelDepthSize).map(function(n){return t.levelDepthSize[n]}),e=f.reduce(function(n,t){return n+t},0)+(f.length-1)*this.settings.layerSpacing,i.forEachNode(function(n){return t.setDepthPos(n,t.getDepthPos(n)+e)})),i},t.prototype.processLevel=function(n,t,i,r,f,e){var h,o=this,s=this.addNodes(n,t,f,e),y=e?this.graph.getAdjacentEdges(e.key,a.ConnectionMode.Outgoing):[],l=this.getDirectionValue(this.levelDepthSize[f]),p=this.getDirectionValue(this.settings.layerSpacing),c,v;(s.forEach(function(e){var s=u.Range.fromLength(h?h.to+o.settings.columnSpacing:r.from,o.getBreadthNodeSizeCore(e.info));e.position=o.getNodePosition(s.from,i,l).offset(e.info.margin.left,e.info.margin.top);o.processLevel(n,t,i+l+p,s,f+1,e);o.updateEdgeConnections(t,y,e);r.extend(s);h=s}),e&&s.length)&&(c=s[s.length-1],v=new u.Range(this.getBreadthPos(s[0]),this.getBreadthPos(c)+this.getBreadthNodeSizeCore(c.info,!0)),this.alignParent(e,v,r))},t.prototype.addNodes=function(n,t,i,r){var f=this;return 0===i?[t.addNode(new e.NodeLayout(n.root,u.Point.empty()))]:n.getChildren(r.info).reduce(function(n,r){return f.nodeToLevel[r.key]!==i||t.hasNode(r.key)||n.push(t.addNode(new e.NodeLayout(r,u.Point.empty()))),n},[])},t.prototype.getMaxDepthSize=function(n){var t=this;return n.reduce(function(n,i){return Math.max(n,t.getDepthNodeSizeCore(i))},0)},t.prototype.getNodePosition=function(n,t,i){return this.settings.direction===r.LogicalDirectionKind.Forward?this.settings.orientation===r.DataLayoutOrientation.Vertical?new u.Point(n,t):new u.Point(t,n):this.settings.orientation===r.DataLayoutOrientation.Vertical?new u.Point(n,t+i):new u.Point(t+i,n)},t.prototype.updateEdgeConnections=function(n,t,i){var r=this;t.filter(function(n){return n.to===i.key}).forEach(function(t){var i=r.getBeginEdgeIndex(),u=r.getEndEdgeIndex();n.addEdge(new e.EdgeLayout(t.key,i,u))})},t.prototype.getBeginEdgeIndex=function(){return this.settings.direction===r.LogicalDirectionKind.Forward?this.isVertical()?f.ConnectionPointSide.South:f.ConnectionPointSide.East:this.isVertical()?f.ConnectionPointSide.North:f.ConnectionPointSide.West},t.prototype.getEndEdgeIndex=function(){return this.settings.direction===r.LogicalDirectionKind.Forward?this.isVertical()?f.ConnectionPointSide.North:f.ConnectionPointSide.West:this.isVertical()?f.ConnectionPointSide.South:f.ConnectionPointSide.East},t.prototype.alignParent=function(n,t,i){if(this.settings.alignment===r.Alignment.Center){var u=t.from+t.length/2-this.getBreadthNodeSizeCore(n.info,!0)/2;this.settings.orientation===r.DataLayoutOrientation.Vertical?(n.position.x=Math.max(i.from+n.info.margin.left,u),n.position.x=Math.min(i.to-n.info.size.width-n.info.margin.right,n.position.x)):(n.position.y=Math.max(i.from+n.info.margin.top,u),n.position.y=Math.min(i.to-n.info.size.height-n.info.margin.bottom,n.position.y))}},t.prototype.getDepthPos=function(n){return this.settings.orientation===r.DataLayoutOrientation.Vertical?n.position.y:n.position.x},t.prototype.getBreadthPos=function(n){return this.settings.orientation===r.DataLayoutOrientation.Vertical?n.position.x:n.position.y},t.prototype.setDepthPos=function(n,t){this.settings.orientation===r.DataLayoutOrientation.Vertical?n.position.y=t:n.position.x=t},t.prototype.isVertical=function(){return this.settings.orientation===r.DataLayoutOrientation.Vertical},t}(l.LayoutBuilder);t.TreeLayoutBuilder=v},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(115),e=i(224),o=i(44),s=i(57),h=i(12),c=i(80),l=i(79),a=function(n){function t(t){var i=n.call(this,t)||this;return i.exporter=new s.Exporter,i}return u(t,n),t.prototype.executeCore=function(n,t){var i=this,r;try{r=this.getExportManager();this.getExportFunc()(this.control.model.size.clone(),this.control.model.pageColor,r,function(n){t(n,i.getExtension());i.tryDispose()})}catch(n){throw this.tryDispose(),n;}return!0},t.prototype.getExportManager=function(){var n=this.getOrCreateMeasurer(),t=this.control.render&&this.control.render.items||this.createItemsManager(n);return this.exportManager||(this.exportManager=new e.CanvasExportManager(t.itemsContainer,n))},t.prototype.createItemsManager=function(n){this.svgElement=h.RenderHelper.createSvgElement(document.body,!0);var t=new f.CanvasItemsManager(this.svgElement,1,new l.ExportDOMManipulator(n));return this.control.modelManipulator.onModelChanged.add(t),this.control.modelManipulator.onLoad(),t},t.prototype.tryDispose=function(){this.svgElement&&(document.body.removeChild(this.svgElement),delete this.svgElement,this.exportManager=void 0);this.tempMeasurer&&(this.tempMeasurer.clean(),this.tempMeasurer=void 0)},t.prototype.getOrCreateMeasurer=function(){return this.control.render&&this.control.render.measurer||(this.tempMeasurer=new c.TextMeasurer(document.body))},t}(o.ExportImportCommandBase);t.ExportImageCommand=a},function(n,t,i){"use strict";var r,o=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f,u,e;Object.defineProperty(t,"__esModule",{value:!0});f=i(4);u=function(){function n(n){this.measurer=n;this.queue=[]}return n.prototype.createElement=function(n,t,i){var r=n.createElement();return null!=t&&(void 0!==i?t.insertBefore(r,i):t.appendChild(r)),r},n.prototype.changeChildrenByPrimitives=function(n,t){var i=this;n.forEach(function(n,r){var u=t.childNodes[r];i.changeByPrimitive(u,n)})},n.prototype.changeByFunc=function(n,t){this.doChange(n,t)},n.prototype.changeByPrimitive=function(n,t){this.doChange(n,t)},n.prototype.cancelAnimation=function(){void 0!==this.rafId&&(cancelAnimationFrame(this.rafId),this.queue=[])},n.prototype.doChange=function(n,t){f.Diagnostics.optimizeUsingRAF?(this.queue.push([n,t]),this.requestAnimation()):this.doChangeSync(n,t)},n.prototype.doChangeSync=function(n,t){"function"==typeof t?t(n):t.applyElementProperties(n,this.measurer)},n.prototype.requestAnimation=function(){var n=this,t;this.rafRequested||(this.rafRequested=!0,t=function(){n.queue.splice(0,2e3).forEach(function(t){return n.doChangeSync(t[0],t[1])});n.queue.length?n.rafId=requestAnimationFrame(t):(n.rafRequested=!1,n.rafId=void 0)},this.rafId=requestAnimationFrame(t))},n}();t.DOMManipulator=u;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.doChange=function(n,t){this.doChangeSync(n,t)},t}(u);t.ExportDOMManipulator=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),e=i(15),o=i(11),s=i(6),r=i(48),u=i(12),h=function(){function n(n){this.cache={};this.containers={};this.parent=n;this.createNodes()}return n.prototype.measureWords=function(n,t,i){var o=this,u={},f="string"==typeof n?this.splitToWords(n,!1):n.reduce(function(n,t){return n.concat(o.splitToWords(t,!1))},[]),r,e;return f.push(" "),r=this.tryLoadWordsToMeasurer(f,t,i,this.cache,void 0,void 0,void 0,u),r&&(e=this.containers[i],this.putElementsInDOM(e,r),this.beforeMeasureInDOM(),this.measureElementsInDOM(r,u),this.afterMeasureInDOM()),u},n.prototype.measureTextLine=function(n,t,i){var r=this.measureWords(n,t,i);return u.RenderHelper.textToWords(n).reduce(function(n,t,i){var u=r[t];return n.width+=u.width,n.height=Math.max(n.height,u.height),i>0&&(n.width+=r[" "].width),n},new f.Size(0,0))},n.prototype.onNewModel=function(n,t){t.changeByFunc(null,function(){this.onNewModelCore(n)}.bind(this))},n.prototype.onNewModelCore=function(n){var f=n.filter(function(n){return n instanceof o.Shape}),e=n.filter(function(n){return n instanceof s.Connector}),u=this.cache,t=this.tryLoadShapeTexts(f,u),i=this.tryLoadConnectorTexts(e,u);(t||i)&&(t&&this.putElementsInDOM(this.containers[r.TextOwner.Shape],t),i&&this.putElementsInDOM(this.containers[r.TextOwner.Connector],i),this.beforeMeasureInDOM(),t&&this.measureElementsInDOM(t),i&&this.measureElementsInDOM(i),this.afterMeasureInDOM())},n.prototype.replaceParent=function(n){this.parent!==n&&(this.mainElement.parentNode&&n.appendChild(this.mainElement),this.parent=n)},n.prototype.clean=function(){e.RenderUtils.removeElement(this.mainElement)},n.prototype.tryLoadShapeTexts=function(n,t){var u=this,e={},i=[],f=[];return n.forEach(function(n){return u.tryLoadWordsToMeasurer(u.splitToWords(n.text,!0),n.styleText,r.TextOwner.Shape,t,e,i,f)}),i.length?{elements:i,hashes:f}:null},n.prototype.tryLoadConnectorTexts=function(n,t){var u=this,e={},i=[],f=[];return n.forEach(function(n){var o=n.texts.map(function(n){return n.value}).reduce(function(n,t){return n.concat(u.splitToWords(t,!1))},[]);o.length&&(o.push(" "),u.tryLoadWordsToMeasurer(o,n.styleText,r.TextOwner.Connector,t,e,i,f))}),i.length?{elements:i,hashes:f}:null},n.prototype.tryLoadWordsToMeasurer=function(n,t,i,r,u,f,e,o){var h=this,s=[];return f=f||[],e=e||[],u=u||{},n.forEach(function(n){return h.tryLoadWordToMeasurer(n,t,i,r,u,f,e,s,o)}),f.length?{elements:f,hashes:e,newWords:s}:null},n.prototype.putElementsInDOM=function(n,t){for(n.parentNode&&n.parentNode.removeChild(n);n.firstChild;)n.removeChild(n.firstChild);t.elements.forEach(function(t){return n.appendChild(t)});this.svgElement.appendChild(n)},n.prototype.measureElementsInDOM=function(n,t){for(var r,u=n.hashes,f=n.elements,e=n.newWords,o=u.length,i=0;i<o;i++)r=this.getSvgTextSize(f[i]),r&&(this.cache[u[i]]=r,t&&(t[e[i]]=r))},n.prototype.beforeMeasureInDOM=function(){this.parent.appendChild(this.mainElement)},n.prototype.afterMeasureInDOM=function(){this.mainElement.parentNode&&this.mainElement.parentNode.removeChild(this.mainElement)},n.prototype.tryLoadWordToMeasurer=function(n,t,i,r,u,f,e,o,s){var h=this.getHash(n,t,i),c=r[h];c||u[h]?c&&s&&(s[n]=c):(u[h]=!0,e.push(h),f.push(this.createElement(n,t)),o.push(n));r[h]||u[h]||(u[h]=!0,e.push(h),f.push(this.createElement(n,t)))},n.prototype.getHash=function(n,t,i){return i+"|"+(t&&t.toHash())+"|"+n},n.prototype.createElement=function(n,t){var i=document.createElementNS(u.svgNS,"text");return" "===n&&i.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),i.textContent=n,t&&e.RenderUtils.applyStyleToElement(t,i),i},n.prototype.splitToWords=function(n,t){var i=u.RenderHelper.textToWords(n);return t&&i.push(" "),i},n.prototype.getSvgTextSize=function(n){var t;try{t=n.getBBox()}catch(n){}return t?new f.Size(t.width,t.height):null},n.prototype.createNodes=function(){this.mainElement=u.RenderHelper.createMainElement(void 0,!0);this.svgElement=u.RenderHelper.createSvgElement(this.mainElement,!1);this.createContainer(r.TextOwner.Shape,"shape");this.createContainer(r.TextOwner.Connector,"connector");this.createContainer(r.TextOwner.ExtensionLine,"extension-line");this.createContainer(r.TextOwner.Resize,"resize-info")},n.prototype.createContainer=function(n,t){var i=document.createElementNS(u.svgNS,"g");i.setAttribute("class",t);this.containers[n]=i},n}();t.TextMeasurer=h},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.setClipboardData=function(n){this.control.render&&this.control.render.input.setClipboardData(n);t.clipboardData=n},t.prototype.getClipboardData=function(n){this.control.render&&this.isPasteSupportedByBrowser()?this.control.render.input.getClipboardData(n):n(t.clipboardData)},t.prototype.isPasteSupportedByBrowser=function(){return this.control.render&&this.control.render.input.isPasteSupportedByBrowser()},t}(i(8).SimpleCommandBase);t.ClipboardCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.itemKey=t.key,r.zIndex=i,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey);this.oldZIndex=t.zIndex;n.changeZIndex(t,this.zIndex)},t.prototype.undo=function(n){var t=n.model.findItem(this.itemKey);n.changeZIndex(t,this.oldZIndex)},t}(i(3).HistoryItem);t.ChangeZindexHistoryItem=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(123);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabled=function(){var t=this.getSelectedShape();return n.prototype.isEnabled.call(this)&&!!t&&!t.locked&&t.enableImage&&t.allowEditImage},t.prototype.getValue=function(){var n=this.getSelectedShape();if(n)return n.image.exportUrl},t.prototype.getSelectedShape=function(){var n=this.control.selection.getSelectedShapes(!0);if(1===n.length)return n[0]},t.prototype.executeCore=function(n,t){this.control.history.beginTransaction();var i=this.control.selection.getSelectedShapes(!1);return this.control.history.addAndRedo(new u.ChangeShapeImageHistoryItem(i[0],t)),this.control.history.endTransaction(),!0},t}(i(8).SimpleCommandBase);t.EditShapeImageCommandBase=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(7),o=i(127),u=i(13),s=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,i,r,u,f)||this;return o.moveStartPoint=e,o}return f(t,n),t.prototype.onMouseDown=function(t){var i=this.moveStartPoint?t.modelPoint.x-this.moveStartPoint.x:0,r=this.moveStartPoint?t.modelPoint.y-this.moveStartPoint.y:0;e.ModelUtils.cloneSelectionToOffset(this.history,this.model,this.selection,i,r);n.prototype.onMouseDown.call(this,t)},t.isMoveClonedShapeEvent=function(n){return n.modifiers&u.ModifierKey.Ctrl&&n.modifiers&u.ModifierKey.Shift},t}(o.MouseHandlerMoveShapeStateBase);t.MouseHandlerMoveClonedShapeState=s},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={stroke:!0,fill:!0};t.isColorProperty=function(n){return i[n]}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(n){this.connector=n}}();t.ConnectorPointsCalculatorBase=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(14),u=function(){function n(n){this.style=n}return Object.defineProperty(n.prototype,"strokeWidthPx",{get:function(){return this.style?this.style.strokeWidthPx:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeOffset",{get:function(){return this.style?this.style.strokeOffset:0},enumerable:!0,configurable:!0}),n.prototype.getUnitVaue=function(n){return"number"==typeof n?r.UnitConverter.twipsToPixels(n).toString():n},n.prototype.setUnitAttribute=function(n,t,i){null!=i&&n.setAttribute(t,this.getUnitVaue(i))},n.prototype.setPositionCorrectionAttribute=function(n){var t=this.strokeWidthPx%2==1?"translate("+this.strokeOffset+", "+this.strokeOffset+")":"";n.setAttribute("transform",t)},n}();t.PrimitiveObject=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f){var e=n.call(this)||this;return e.id=t,e.x=i,e.y=r,e.width=u,e.height=f,e}return e(t,n),t.prototype.createMainElement=function(){var n=document.createElementNS(u.svgNS,"filter");return n.setAttribute("id",this.id),n},t.prototype.applyElementProperties=function(t,i){this.id&&t.setAttribute("id",this.id);this.setUnitAttribute(t,"x",this.x);this.setUnitAttribute(t,"y",this.y);this.setUnitAttribute(t,"width",this.width);this.setUnitAttribute(t,"height",this.height);this.setPositionCorrectionAttribute(t);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.FilterPrimitive=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.normalize=function(t,i){return void 0===i&&(i="image/png"),n.checkPrependDataUrl(t)||(t=n.prepend(t,i)),t},n.prepend=function(n,t){return void 0===t&&(t="image/png"),"data:"+t+";base64,"+n},n.checkPrependDataUrl=function(t){return n.dataUrl.test(t)},n.dataUrl=/data:(.*)(;(.*))?(;base64)?,/,n}();t.Base64Utils=i},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(3),e=i(6),o=function(n){function t(t,i){var r=n.call(this)||this;return r.connectorKey=t.key,r.position=i,r.itemKey=t.getExtremeItem(r.position).key,r}return u(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.oldConnectionPointIndex=this.position===e.ConnectorPosition.Begin?t.beginConnectionPointIndex:t.endConnectionPointIndex;n.deleteConnection(t,this.position)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey),i=n.model.findItem(this.itemKey);n.addConnection(t,i,this.oldConnectionPointIndex,this.position)},t}(f.HistoryItem);t.DeleteConnectionHistoryItem=o},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.shapeKey=t,i}return f(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);this.shape=t.clone();n.deleteShape(t)},t.prototype.undo=function(n){n.addShape(this.shape,this.shape.key)},t}(i(3).HistoryItem);t.DeleteShapeHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.shapeKey=t,r.parameters=i,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);this.oldParameters=t.parameters.clone();n.changeShapeParameters(t,this.parameters)},t.prototype.undo=function(n){var t=n.model.findShape(this.shapeKey);n.changeShapeParameters(t,this.oldParameters)},t}(i(3).HistoryItem);t.ChangeShapeParametersHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.itemKey=t,u.styleProperty=i,u.styleValue=r,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey);this.oldStyleValue=t.style[this.styleProperty];n.changeStyle(t,this.styleProperty,this.styleValue)},t.prototype.undo=function(n){var t=n.model.findItem(this.itemKey);n.changeStyle(t,this.styleProperty,this.oldStyleValue)},t}(i(3).HistoryItem);t.ChangeStyleHistoryItemBase=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.itemKey=t.key,r.locked=i,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey);this.oldLocked=t.locked;n.changeLocked(t,this.locked)},t.prototype.undo=function(n){var t=n.model.findItem(this.itemKey);n.changeLocked(t,this.oldLocked)},t}(i(3).HistoryItem);t.ChangeLockedHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(11),u=i(0),o=i(70),s=i(6),h=i(40),c=i(108),l=i(75),a=i(4),v=function(n){function t(t,i){var r=n.call(this,t)||this;return r.obj=l.ImportUtils.parseJSON(i),r}return f(t,n),t.prototype.getObject=function(){return this.obj},t.prototype.getPageObject=function(n){return n.page},t.prototype.getShapeObjects=function(n){return n.shapes},t.prototype.getConnectorObjects=function(n){return n.connectors},t.prototype.importPageSettings=function(n,t){t&&(this.assert(t.width,"number"),this.assert(t.height,"number"),"number"==typeof t.width&&(n.size.width=t.width),"number"==typeof t.height&&(n.size.height=t.height),"number"==typeof t.pageColor?n.pageColor=t.pageColor:"string"==typeof t.pageColor&&(n.pageColor=a.ColorHelper.stringToColor(t.pageColor)),"number"==typeof t.pageWidth&&(n.pageSize.width=t.pageWidth),"number"==typeof t.pageHeight&&(n.pageSize.height=t.pageHeight),"boolean"==typeof t.pageLandscape&&(n.pageLandscape=t.pageLandscape),"number"==typeof t.units&&(n.units=t.units))},t.prototype.importShape=function(n){this.assert(n.key,"string");this.assert(n.x,"number");this.assert(n.y,"number");this.assert(n.type,"string");var i=n.type,r=this.shapeDescriptionManager.get(i),f=new u.Point(n.x,n.y),t=new e.Shape(r||o.ShapeDescriptionManager.default,f);return t.key=n.key,"string"!=typeof n.dataKey&&"number"!=typeof n.dataKey||(t.dataKey=n.dataKey),"boolean"==typeof n.locked&&(t.locked=n.locked),"number"==typeof n.width&&(t.size.width=n.width),"number"==typeof n.height&&(t.size.height=n.height),"string"==typeof n.text&&(t.text=n.text),"string"==typeof n.imageUrl&&(t.image=new h.ImageInfo(n.imageUrl)),n.parameters&&(t.parameters.fromObject(n.parameters),t.description.normalizeParameters(t,t.parameters)),n.style&&t.style.fromObject(n.style),n.styleText&&t.styleText.fromObject(n.styleText),"number"==typeof n.zIndex&&(t.zIndex=n.zIndex),Array.isArray(n.childKeys)&&(t.childKeys=n.childKeys.slice()),"boolean"==typeof n.expanded&&(t.expanded=n.expanded),"number"==typeof n.expandedWidth&&"number"==typeof n.expandedHeight&&(t.expandedSize=new u.Size(n.expandedWidth,n.expandedHeight)),t},t.prototype.importShapeChildren=function(){return[]},t.prototype.importConnector=function(n){var i=this,r,t;if(this.assert(n.key,"string"),!Array.isArray(n.points))throw Error("Invalid Format");return r=n.points.map(function(n){return i.assert(n.x,"number"),i.assert(n.y,"number"),new u.Point(n.x,n.y)}),t=new s.Connector(r),t.key=n.key,"string"!=typeof n.dataKey&&"number"!=typeof n.dataKey||(t.dataKey=n.dataKey),"boolean"==typeof n.locked&&(t.locked=n.locked),t.endConnectionPointIndex="number"==typeof n.endConnectionPointIndex?n.endConnectionPointIndex:-1,t.beginConnectionPointIndex="number"==typeof n.beginConnectionPointIndex?n.beginConnectionPointIndex:-1,void 0!==n.endItemKey&&this.assert(n.endItemKey,"string"),void 0!==n.beginItemKey&&this.assert(n.beginItemKey,"string"),t.endItemKey=n.endItemKey,t.beginItemKey=n.beginItemKey,n.texts&&t.texts.fromObject(n.texts),n.properties&&t.properties.fromObject(n.properties),n.style&&t.style.fromObject(n.style),n.styleText&&t.styleText.fromObject(n.styleText),"number"==typeof n.zIndex&&(t.zIndex=n.zIndex),t},t}(c.ImporterBase);t.Importer=v},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(9),r=i(2),o=i(1),s=function(n){function t(t,i){return void 0===t&&(t=f.ShapeDefaultSize.clone()),n.call(this,t,i)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Diamond},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,e=t.left,o=t.top,s=t.right,h=t.bottom,i=t.center,u=i.x,f=i.y;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(u,o),new r.PathPrimitiveLineToCommand(s,f),new r.PathPrimitiveLineToCommand(u,h),new r.PathPrimitiveLineToCommand(e,f),new r.PathPrimitiveClosePathCommand],n.style)]},t}(f.ShapeDescription);t.DiamondShapeDescription=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(9),e=i(0),o=i(1),s=function(n){function t(){return n.call(this,new e.Size(u.ShapeDefaultDimension,.5*u.ShapeDefaultDimension),!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Text},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(){return[]},t}(u.ShapeDescription);t.TextShapeDescription=s},function(n,t,i){"use strict";var f,e=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),o=i(1),s=i(73),u=i(5),h=function(n){function t(t){var i=n.call(this,t)||this;return i.defaultRatio=i.defaultSize.height/i.defaultSize.width,i}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Pentagon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angleCount",{get:function(){return 5},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,i=t.left,u=t.top,f=t.right,e=t.bottom,o=t.width,s=t.height,y=t.center.x,h=s/o/this.defaultRatio,c=Math.PI-this.angle,l=o/2*Math.tan(c/2)*h,a=u+l,v=(s-l)/Math.tan(c)/h,p=i+v,w=f-v;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(y,u),new r.PathPrimitiveLineToCommand(f,a),new r.PathPrimitiveLineToCommand(w,e),new r.PathPrimitiveLineToCommand(p,e),new r.PathPrimitiveLineToCommand(i,a),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.processConnectionPoint=function(n,t){var i=n.getConnectionPointSide(t);if(i===u.ConnectionPointSide.East||i===u.ConnectionPointSide.West){var r=n.rectangle,o=r.top,f=r.width,s=r.height/f/this.defaultRatio,h=Math.PI-this.angle,e=o+f/2*Math.tan(h/2)*s;i===u.ConnectionPointSide.East?t.y=e:i===u.ConnectionPointSide.West&&(t.y=e)}},t.prototype.calculateHeight=function(n){var t=Math.PI-this.angle;return n/2*Math.tan(t/2)+n/2/Math.cos(t/2)*Math.sin(t)},t}(s.PolygonShapeDescription);t.PentagonShapeDescription=h},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),e=i(1),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return e.ShapeTypes.Hexagon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angleCount",{get:function(){return 6},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,u=t.left,f=t.top,l=t.right,e=t.bottom,o=t.width,s=(t.height,t.center.y),a=Math.PI-this.angle,h=o/(1+2*Math.cos(a)),i=u+(o-h)/2,c=i+h;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(i,f),new r.PathPrimitiveLineToCommand(c,f),new r.PathPrimitiveLineToCommand(l,s),new r.PathPrimitiveLineToCommand(c,e),new r.PathPrimitiveLineToCommand(i,e),new r.PathPrimitiveLineToCommand(u,s),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.calculateHeight=function(n){var t=Math.PI-this.angle;return 2*(n/(1+2*Math.cos(t)))*Math.sin(t)},t}(i(73).PolygonShapeDescription);t.HexagonShapeDescription=o},function(n,t,i){"use strict";var e,s=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}e(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(9),r=i(2),h=i(1),u=i(33),f=i(5),c=function(n){function t(t){var i=n.call(this,void 0,t)||this;return i.defaultSize.height=i.calculateHeight(o.ShapeDefaultDimension),i}return s(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return h.ShapeTypes.Triangle},enumerable:!0,configurable:!0}),t.prototype.createConnectionPoints=function(){return[new u.ConnectionPoint(.5,0,f.ConnectionPointSide.North),new u.ConnectionPoint(.75,.5,f.ConnectionPointSide.East),new u.ConnectionPoint(.5,1,f.ConnectionPointSide.South),new u.ConnectionPoint(.25,.5,f.ConnectionPointSide.West)]},t.prototype.createShapePrimitives=function(n){var t=n.rectangle,u=t.left,f=t.top,e=t.right,i=t.bottom;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(t.center.x,f),new r.PathPrimitiveLineToCommand(e,i),new r.PathPrimitiveLineToCommand(u,i),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.calculateHeight=function(n){return Math.sqrt(Math.pow(n,2)-Math.pow(n/2,2))},t.prototype.getTextRectangle=function(n){var t=n.rectangle;return t.resize(0,.25*-t.width).offset(0,.25*t.width)},t}(o.ShapeDescription);t.TriangleShapeDescription=c},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=i(5),h=function(n){function t(){return n.call(this,void 0,!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Document},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){return this.createDocumentPrimitives(n.rectangle,n.style)},t.prototype.createDocumentPrimitives=function(n,i){var e=n.left,s=n.top,o=n.right,u=n.bottom,h=n.width,c=n.height,l=n.center.x,f=c*t.curveOffsetRatio;return[].concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(e,s),new r.PathPrimitiveLineToCommand(o,s),new r.PathPrimitiveLineToCommand(o,u),new r.PathPrimitiveQuadraticCurveToCommand(o-.25*h,u-2*f,l,u-f),new r.PathPrimitiveQuadraticCurveToCommand(e+.25*h,u+f,e,u-f),new r.PathPrimitiveClosePathCommand],i)])},t.prototype.processConnectionPoint=function(n,i){n.getConnectionPointSide(i)===s.ConnectionPointSide.South&&(i.y-=n.size.height*t.curveOffsetRatio)},t.prototype.getTextRectangle=function(n){var i=n.rectangle;return i.resize(0,-i.height*t.curveOffsetRatio)},t.curveOffsetRatio=.1,t}(e.RectangleShapeDescription);t.DocumentShapeDescription=h},function(n,t,i){"use strict";var f,s=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var h=i(103),r=i(0),c=i(33),l=i(5),a=i(104),u=i(9),e=i(40),o=i(47),v=i(106),y=i(195),p=function(n){function t(t,i){var f=n.call(this,new r.Size(t.defaultWidth||i&&i.defaultSize.width||u.ShapeDefaultDimension,t.defaultHeight||i&&i.defaultSize.height||u.ShapeDefaultDimension))||this,s;return(f.properties=t,f.baseDescription=i,f.imageLoader=new v.ImageLoader(f.updateSvgImage.bind(f)),f.defaultText=t.defaultText||i&&i.getDefaultText(),f.defaultImageUrl=t.defaultImageUrl||i&&i.getDefaultImageUrl(),f.title=t.title||i&&i.getTitle()||f.defaultText||"",f.connectionPoints=f.createConnectionPoints(),t.svgUrl)&&(f.svgImage=new e.ImageInfo(t.svgUrl),s=o.ImageCache.instance.createUnloadedInfoByShapeImageInfo(f.svgImage),f.imageLoader.load(s)),t.svgToolboxUrl&&(f.svgToolboxImage=new e.ImageInfo(t.svgToolboxUrl),s=o.ImageCache.instance.createUnloadedInfoByShapeImageInfo(f.svgToolboxImage),f.imageLoader.load(s)),f}return s(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return this.properties.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowEditText",{get:function(){return!1!==this.properties.allowEditText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowEditImage",{get:function(){return!0===this.properties.allowEditImage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this.properties.minWidth||this.baseDescription&&this.baseDescription.minWidth||u.ShapeMinDimension},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this.properties.minHeight||this.baseDescription&&this.baseDescription.minHeight||u.ShapeMinDimension},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.properties.maxWidth||this.baseDescription&&this.baseDescription.maxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this.properties.maxHeight||this.baseDescription&&this.baseDescription.maxHeight},enumerable:!0,configurable:!0}),t.prototype.getTitle=function(){return void 0!==this.title?this.title:n.prototype.getTitle.call(this)},t.prototype.getDefaultText=function(){return void 0!==this.defaultText?this.defaultText:n.prototype.getDefaultText.call(this)},t.prototype.getDefaultImageUrl=function(){return void 0!==this.defaultImageUrl?this.defaultImageUrl:n.prototype.getDefaultImageUrl.call(this)},t.prototype.allowResizeHorizontally=function(t){return!1!==this.properties.allowResize&&(this.baseDescription?this.baseDescription.allowResizeHorizontally(t):n.prototype.allowResizeHorizontally.call(this,t))},t.prototype.allowResizeVertically=function(t){return!1!==this.properties.allowResize&&(this.baseDescription?this.baseDescription.allowResizeVertically(t):n.prototype.allowResizeVertically.call(this,t))},t.prototype.createConnectionPoints=function(){return this.properties&&this.properties.connectionPoints&&this.properties.connectionPoints.length?this.properties.connectionPoints.map(function(n){if(n&&"number"==typeof n.x&&"number"==typeof n.y){var t="number"==typeof n.side?n.side:l.ConnectionPointSide.Undefined;return new c.ConnectionPoint(n.x,n.y,t)}}).filter(function(n){return n}):n.prototype.createConnectionPoints.call(this)},t.prototype.createImagePrimitives=function(t,i){return this.baseDescription?this.baseDescription.createImagePrimitives(t,i):n.prototype.createImagePrimitives.call(this,t,i)},t.prototype.createShapePrimitives=function(n,t){var r=[],e=n.rectangle,c=e.left,l=e.top,u=e.width,f=e.height,o=!!this.properties.createTemplate,i=!this.baseDescription&&t,s;if(this.baseDescription)r=this.baseDescription.createShapePrimitives(n,t);else if(s=t&&this.svgToolboxImage?this.svgToolboxImage:this.svgImage,s){var a=c+(this.properties.svgLeft&&!i?this.properties.svgLeft*u:0),v=l+(this.properties.svgTop&&!i?this.properties.svgTop*f:0),p=this.properties.svgWidth&&!i?this.properties.svgWidth*u:u,w=this.properties.svgHeight&&!i?this.properties.svgHeight*f:f;r=r.concat([new h.ImagePrimitive(a,v,p,w,s.exportUrl)]);o=o&&!t}if(o){var b=c+(this.properties.templateLeft&&!i?this.properties.templateLeft*u:0),k=l+(this.properties.templateTop&&!i?this.properties.templateTop*f:0),d=this.properties.templateWidth&&!i?this.properties.templateWidth*u:u,g=this.properties.templateHeight&&!i?this.properties.templateHeight*f:f;r=r.concat([new y.SvgElementPrimitive(b,k,d,g,this.properties.createTemplate,n.toNative())])}return r},t.prototype.createParameters=function(t){return this.baseDescription?this.baseDescription.createParameters(t):n.prototype.createParameters.call(this,t)},t.prototype.normalizeParameters=function(t,i){this.baseDescription?this.baseDescription.normalizeParameters(t,i):n.prototype.normalizeParameters.call(this,t,i)},t.prototype.modifyParameters=function(t,i,r,u){this.baseDescription?this.baseDescription.modifyParameters(t,i,r,u):n.prototype.modifyParameters.call(this,t,i,r,u)},t.prototype.getParameterPoints=function(t){return this.baseDescription?this.baseDescription.getParameterPoints(t):n.prototype.getParameterPoints.call(this,t)},t.prototype.getTextRectangle=function(n){if(this.baseDescription)return this.baseDescription.getTextRectangle(n);var t=n.rectangle,f=t.left,e=t.top,i=t.width,u=t.height;return r.Rectangle.create(f+(this.properties.textLeft?this.properties.textLeft*i:0),e+(this.properties.textTop?this.properties.textTop*u:0),this.properties.textWidth?this.properties.textWidth*i:i,this.properties.textHeight?this.properties.textHeight*u:u)},t.prototype.getRawImageSize=function(n){n.left;n.top;var t=n.width,i=n.height;return new r.Size(this.properties.imageWidth?this.properties.imageWidth*t:t,this.properties.imageHeight?this.properties.imageHeight*i:i)},t.prototype.getImagePlacementRectangle=function(n,t){var f=n.left,e=n.top,i=n.width,u=n.height;return r.Rectangle.create(f+(this.properties.imageLeft&&!t?this.properties.imageLeft*i:0),e+(this.properties.imageTop&&!t?this.properties.imageTop*u:0),this.properties.imageWidth&&!t?this.properties.imageWidth*i:0,this.properties.imageHeight&&!t?this.properties.imageHeight*u:0)},t.prototype.updateSvgImage=function(n){var t=n.imageUrl===this.properties.svgToolboxUrl?this.svgToolboxImage:this.svgImage;n.base64?t.loadBase64Content(n.base64):t.setUnableToLoadFlag()},t}(a.ShapeWithImageDescription);t.CustomShapeDescription=p},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e,o,s){void 0===e&&(e="none");var h=n.call(this,o,s)||this;return h.x=t,h.y=i,h.width=r,h.height=u,h.url=f,h.preserveAspectRatio=e,h}return e(t,n),t.prototype.createMainElement=function(){return document.createElementNS(u.svgNS,"image")},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"x",this.x);this.setUnitAttribute(t,"y",this.y);this.setUnitAttribute(t,"width",this.width);this.setUnitAttribute(t,"height",this.height);this.setPositionCorrectionAttribute(t);t.setAttribute("href",this.url);t.setAttribute("preserveAspectRatio",this.preserveAspectRatio);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.ImagePrimitive=f},function(n,t,i){"use strict";var u,s=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o;Object.defineProperty(t,"__esModule",{value:!0});var h=i(9),r=i(0),f=i(14),c=i(103),l=i(20),e=i(30),a=i(15),v=i(56),y=i(105);t.ShapeDefaultDimension=1440;t.ShapeDefaultSize=new r.Size(t.ShapeDefaultDimension,t.ShapeDefaultDimension);t.SHAPE_IMAGE_CLASSNAMES={IMAGE:"dxdi-image",IMAGE_PLACEHOLDER:"dxdi-image-placeholder",LOADING_INDICATOR:"dxdi-spinner",USER_PIC:"dxdi-user",WARNING_MARK:"dxdi-warning"};o=function(n){function i(i,r){void 0===i&&(i=t.ShapeDefaultSize.clone());var u=n.call(this,i,r)||this;return u.hasDefaultText=r,u.defaultIconSize=480,u}return s(i,n),Object.defineProperty(i.prototype,"enableImage",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.getImageMargin=function(n){return n?f.UnitConverter.pixelsToTwips(2):f.UnitConverter.pixelsToTwips(3)},i.prototype.createImagePrimitives=function(n,i){var r,u,f;return this.enableImage?(r=this.getImagePlacementRectangle(n.rectangle,i),i)?this.createImagePlaceholder(r):(u=[],u=n.image.isEmpty||n.image.unableToLoad?u.concat(this.createEmptyImagePrimitives(r,n.image.unableToLoad)):""===n.image.renderUrl?u.concat(this.createLoadingImagePrimitives(r)):u.concat(this.createLoadedImagePrimitives(r,n.image.renderUrl)),""===n.image.renderUrl)?(f=a.RenderUtils.generateSvgElementId("clipImage"),[].concat([new e.GroupPrimitive(u,t.SHAPE_IMAGE_CLASSNAMES.IMAGE,void 0,f),new v.ClipPathPrimitive(f,[new l.RectanglePrimitive(r.left,r.top,r.width,r.height)])])):u:[]},i.prototype.createImagePlaceholder=function(){return[]},i.prototype.createLoadedImagePrimitives=function(n,r){return[new c.ImagePrimitive(n.left,n.top,n.width,n.height,r,i.imageScalingRule,void 0,t.SHAPE_IMAGE_CLASSNAMES.IMAGE)]},i.prototype.createLoadingImagePrimitives=function(n){var i=this.getIconPlacementRectangle(n);return[y.ShapeImageIndicator.createLoadingIndicatorPrimitives(i.left,i.top,this.defaultIconSize,f.UnitConverter.pixelsToTwips(5),t.SHAPE_IMAGE_CLASSNAMES.LOADING_INDICATOR)]},i.prototype.createEmptyImagePrimitives=function(n,t){var r=this.getIconPlacementRectangle(n),i=[];return i=i.concat(this.createEmptyImagePrimitive(r)),t&&(i=i.concat(this.createWarningPrimitive(r))),i},i.prototype.createEmptyImagePrimitive=function(){return new e.GroupPrimitive([])},i.prototype.createWarningPrimitive=function(){return new e.GroupPrimitive([])},i.prototype.getIconPlacementRectangle=function(n){var t=new r.Rectangle(new r.Point(n.left,n.top),new r.Size(this.defaultIconSize,this.defaultIconSize));return t.width<n.width&&(t.position.x=n.left+(n.width-t.width)/2),t.height<n.height&&(t.position.y=n.top+(n.height-t.height)/2),t},i.prototype.getImagePlacementRectangle=function(n,t){var f=this.getImageSize(n,t),i=r.Rectangle.create(n.left,n.top,f.width,f.height),u=this.getTextBlockOffset(n,t);return u.right>0?i.position.x=n.right-u.right-this.getImageMargin(t):u.left>0&&(i.position.x+=this.getImageMargin(t)),u.bottom>0?i.position.y=n.bottom-u.bottom-this.getImageMargin(t):i.position.y+=this.getImageMargin(t),(u.top>0||u.bottom>0)&&(i.position.x=i.left+(n.width-i.width)/2),i},i.prototype.getImageSize=function(n,t){var i=this.getRawImageSize(n,t);return this.correctImageSize(i)},i.prototype.getRawImageSize=function(){return new r.Size(0,0)},i.prototype.correctImageSize=function(n){return n.width=Math.max(n.width,0),n.height=Math.max(n.height,0),n},i.prototype.getTextBlockOffset=function(){return r.Offset.empty()},i.imageScalingRule="xMidYMid meet",i}(h.ShapeDescription);t.ShapeWithImageDescription=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(43),r=i(2),u=i(4),e=i(30),s=i(24),o=i(20),h=function(){function n(n,t,i,r,u){this.x=n;this.y=t;this.size=i;this.borderThickness=r;this.className=u;this.animationStarted=!1}return n.createLoadingIndicatorPrimitives=function(t,i,r,u,f){return new n(t,i,r,u,f).createLoadingIndicatorPrimitive()},n.createUserIconPrimitives=function(t,i,r,u,f){return new n(t,i,r,u,f).createUserIconPrimitive()},n.createWarningIconPrimitives=function(t,i,r,u){return new n(t,i,r,void 0,u).createWarningIconPrimitive()},n.prototype.rotate=function(n,t,i,r){if(this.animationStarted){var u="rotate("+Math.round(r)%1080/3+" "+t+" "+i+")";n.setAttribute("transform",u);this.animationRequestId=requestAnimationFrame(function(r){this.rotate(n,t,i,r)}.bind(this))}},n.prototype.onApplyLoadingIndicatorElementProperties=function(n){var t=[u.UnitConverter.twipsToPixelsF(this.x+this.size/2),u.UnitConverter.twipsToPixelsF(this.y+this.size/2)],i=t[0],r=t[1];s.Browser.IE?(this.animationRequestId=requestAnimationFrame(function(t){this.rotate(n,i,r,t)}.bind(this)),this.animationStarted=!0):n.style.setProperty("transform-origin",i+"px "+r+"px")},n.prototype.center=function(){return[u.UnitConverter.twipsToPixelsF(this.x+this.size/2),u.UnitConverter.twipsToPixelsF(this.y+this.size/2)]},n.prototype.createLoadingIndicatorPrimitive=function(){var o=this.center(),t=o[0],i=o[1],n=u.UnitConverter.twipsToPixelsF(this.size/2-this.borderThickness/2);return new e.GroupPrimitive([new f.EllipsePrimitive(t+"",i+"",n+"",n+""),new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(t+n+"",i+""),new r.PathPrimitiveArcToCommand(n+"",n+"",0,!1,!1,t+"",i-n+"")])],this.className,void 0,void 0,this.onApplyLoadingIndicatorElementProperties.bind(this),this.onBeforeDispose.bind(this))},n.prototype.createUserIconPrimitive=function(){var o=this.center(),t=o[0],i=o[1],s=u.UnitConverter.twipsToPixelsF(this.size/2-this.borderThickness/2),n=u.UnitConverter.twipsToPixelsF(this.size);return new e.GroupPrimitive([new f.EllipsePrimitive(t+"",i+"",s+"",s+"",void 0,"dxdi-background"),new f.EllipsePrimitive(t+"",i-n/8+"",n/8+"",n/8+""),new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(t+"",i+n/16+""),new r.PathPrimitiveCubicCurveToCommand(t+.1375*n+"",i+n/16+"",t+n/4+"",i+.11875*n+"",t+n/4+"",i+.1875*n+""),new r.PathPrimitiveLineToCommand(t+n/4+"",i+n/4+""),new r.PathPrimitiveLineToCommand(t-n/4+"",i+n/4+""),new r.PathPrimitiveLineToCommand(t-n/4+"",i+.1875*n+""),new r.PathPrimitiveCubicCurveToCommand(t-n/4+"",i+.11875*n+"",t-.1375*n+"",i+n/16+"",t+"",i+n/16+""),new r.PathPrimitiveClosePathCommand])],this.className)},n.prototype.createWarningIconPrimitive=function(){var s=this.center(),i=s[0],r=s[1],t=u.UnitConverter.twipsToPixelsF(this.size/2)-1,n=u.UnitConverter.twipsToPixelsF(this.size/8);return new e.GroupPrimitive([new f.EllipsePrimitive(i+"",r+"",t+"",t+""),new o.RectanglePrimitive(i-n/2+.5+"",r+t-u.UnitConverter.twipsToPixelsF(this.size/4)+"",n+"",n+""),new o.RectanglePrimitive(i-n/2+.5+"",r-t+u.UnitConverter.twipsToPixelsF(this.size/4)-n+"",n+"",t+"")],this.className)},n.prototype.onBeforeDispose=function(){this.animationRequestId&&cancelAnimationFrame(this.animationRequestId);this.animationStarted=!1},n}();t.ShapeImageIndicator=h},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(47),u=function(){function n(n){this.loadedCallback=n}return n.prototype.load=function(n){n.isLoaded?this.loadedCallback(n):n.isLoading||this.loadInner(n)},n.prototype.loadInner=function(n){var t=this;return n.imageUrl?this.loadPictureByUrl(n,function(){return t.finalizeLoading(n,n)}):n.base64&&this.loadPictureByBase64(n,function(){return t.finalizeLoading(n,n)}),n},n.prototype.finalizeLoading=function(n,t){t||(t=r.ImageCache.instance.getImageData(n.actualId));t.isLoaded||r.ImageCache.instance.finalizeLoading(t,n);this.loadedCallback(t)},n.prototype.loadPictureByBase64=function(n,t){var i=new Image;i.onload=function(){t(n)};i.src=n.base64},n.prototype.loadPictureByUrl=function(n,t){var r=this,i=new XMLHttpRequest;try{i.onload=function(){var u=new FileReader;u.onloadend=function(){n.base64=u.result;r.loadPictureByBase64(n,function(n){return t(n)})};u.readAsDataURL(i.response)};i.onerror=function(){return t(n)};i.onloadend=function(){404===i.status&&t(n)};i.open("GET",n.imageUrl,!0);i.responseType="blob";n.startLoading();i.send()}catch(n){}},n}();t.ImageLoader=u},function(n,t,i){"use strict";var e,c=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}e(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),h;Object.defineProperty(t,"__esModule",{value:!0});var o=i(9),l=i(0),a=i(1),s=i(20),f=i(2),v=i(15),y=i(10),p=i(30),r=i(33),u=i(5),w=i(4);t.CONTAINER_HEADER_SIZE=360;t.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO=.2;t.CONTAINER_EXPAND_BUTTON_RECT_RATIO=.5;t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO=.3;h=function(n){function i(t){return void 0===t&&(t=new l.Size(2*o.ShapeDefaultDimension,1.5*o.ShapeDefaultDimension)),n.call(this,t,!0)||this}return c(i,n),Object.defineProperty(i.prototype,"enableChildren",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.getDefaultText=function(){return w.DiagramLocalizationService.shapeTexts[a.ShapeTypes.Container]},i.prototype.createConnectionPoints=function(){return[new r.ConnectionPoint(.25,0,u.ConnectionPointSide.North),new r.ConnectionPoint(.5,0,u.ConnectionPointSide.North),new r.ConnectionPoint(.75,0,u.ConnectionPointSide.North),new r.ConnectionPoint(1,.25,u.ConnectionPointSide.East),new r.ConnectionPoint(1,.5,u.ConnectionPointSide.East),new r.ConnectionPoint(1,.75,u.ConnectionPointSide.East),new r.ConnectionPoint(.75,1,u.ConnectionPointSide.South),new r.ConnectionPoint(.5,1,u.ConnectionPointSide.South),new r.ConnectionPoint(.25,1,u.ConnectionPointSide.South),new r.ConnectionPoint(0,.75,u.ConnectionPointSide.West),new r.ConnectionPoint(0,.5,u.ConnectionPointSide.West),new r.ConnectionPoint(0,.25,u.ConnectionPointSide.West)]},i.prototype.getConnectionPointIndexForItem=function(n,t){return 4===(n&&n.getConnectionPoints()).length?3*t+1:t},i.prototype.getConnectionPointIndexForSide=function(n){return 3*n+1},i.prototype.createShapePrimitives=function(n,t){var i=n.rectangle,u=i.left,f=i.top,e=i.width,o=i.height,r=[];return n.expanded&&(r=r.concat([new s.RectanglePrimitive(u,f,e,o,n.style)])),r.concat(this.createHeaderPrimitives(n,t))},i.prototype.createExpandButtonPrimitives=function(n,i){var u=[new f.PathPrimitiveMoveToCommand(i.left+i.width*((1-t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2),i.center.y),new f.PathPrimitiveLineToCommand(i.left+i.width*((1-t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2+t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO),i.center.y)],r;return n.expanded||(u=u.concat([new f.PathPrimitiveMoveToCommand(i.center.x,i.top+i.height*((1-t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2)),new f.PathPrimitiveLineToCommand(i.center.x,i.top+i.height*((1-t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2+t.CONTAINER_EXPAND_BUTTON_SIGN_RATIO))])),r=i.inflate(-i.width*(1-t.CONTAINER_EXPAND_BUTTON_RECT_RATIO)/2,-i.height*(1-t.CONTAINER_EXPAND_BUTTON_RECT_RATIO)/2),[new p.GroupPrimitive([new s.RectanglePrimitive(r.left,r.top,r.width,r.height,n.style),new f.PathPrimitive(u,n.style)],"shape-expand-btn",null,null,function(t){v.RenderUtils.setElementEventData(t,y.MouseEventElementType.ShapeExpandButton,n.key)})]},i}(o.ShapeDescription);t.ContainerDescription=h},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(19),r=i(11),f=function(){function n(n){this.shapeDescriptionManager=n}return n.prototype.import=function(){var n=new u.DiagramModel,r=this.getObject(),f,i,e,o,t;for(this.importPageSettings(n,this.getPageObject(r)),f=this.importShapes(this.getShapeObjects(r)),i=0;i<f.length;i++){if(e=f[i],n.findItem(e.key))throw Error("Item key is duplicated");n.pushItem(e)}for(o=this.importConnectors(this.getConnectorObjects(r)),i=0;i<o.length;i++){if(t=o[i],t.endItem=n.findItem(t.endItemKey)||void 0,delete t.endItemKey,t.beginItem=n.findItem(t.beginItemKey)||void 0,delete t.beginItemKey,n.findItem(t.key))throw Error("Item key is duplicated");n.pushItem(t);this.updateConnections(t)}return this.updateChildren(n.items,function(t){return n.findItem(t)}),n},n.prototype.importItems=function(n){for(var r,o,s,t,l,a,u,e=[],h=this.getObject(),f={},c=this.importShapes(this.getShapeObjects(h)),i=0;i<c.length;i++)r=c[i],o=r.key,u=n.getNextKey(u),r.key=u,f[o]=r,void 0!==r.dataKey&&(r.dataKey=void 0),e.push(r);for(s=this.importConnectors(this.getConnectorObjects(h)),i=0;i<s.length;i++)t=s[i],o=t.key,u=n.getNextKey(u),t.key=u,f[o]=t,void 0!==t.dataKey&&(t.dataKey=void 0),l=t.endItemKey,t.endItem=f[l],delete t.endItemKey,a=t.beginItemKey,t.beginItem=f[a],delete t.beginItemKey,e.push(t),this.updateConnections(t);return this.updateChildren(e,function(n){return f[n]}),e},n.prototype.importItemsData=function(n){for(var t,i,e,u,r,o=this.getObject(),s=this.importShapes(this.getShapeObjects(o)),f=0;f<s.length;f++)t=s[f],i=void 0,void 0!==t.dataKey&&(i=n.findShapeByDataKey(t.dataKey)),i||(i=n.findShape(t.key)),i&&(i.dataKey=t.dataKey,i.locked=t.locked,i.position=t.position.clone(),i.expanded=t.expanded,t.expandedSize&&(i.expandedSize=t.expandedSize.clone()),i.size=t.size.clone(),i.parameters=t.parameters.clone(),i.style=t.style.clone(),i.styleText=t.styleText.clone(),i.zIndex=t.zIndex,i.text=t.text,i.description=t.description,i.image=t.image.clone());for(e=this.importConnectors(this.getConnectorObjects(o)),f=0;f<e.length;f++)u=e[f],r=void 0,void 0!==u.dataKey&&(r=n.findConnectorByDataKey(u.dataKey)),r||(r=n.findConnector(u.key)),r&&(r.dataKey=u.dataKey,r.locked=u.locked,r.points=u.points.slice(),r.properties=u.properties.clone(),r.style=u.style.clone(),r.endConnectionPointIndex=u.endConnectionPointIndex,r.beginConnectionPointIndex=u.beginConnectionPointIndex,r.texts=u.texts.clone(),r.styleText=u.styleText.clone(),r.zIndex=u.zIndex)},n.prototype.importShapes=function(n){var t=[],i,r,u;if(!n)return t;if(!Array.isArray(n))throw Error("Invalid Format");for(i=0;i<n.length;i++)r=n[i],u=this.importShape(r),t.push(u),t=t.concat(this.importShapeChildren(r,u));return t},n.prototype.importConnectors=function(n){var i=[],t,r;if(!n)return i;if(!Array.isArray(n))throw Error("Invalid Format");for(t=0;t<n.length;t++)r=n[t],i.push(this.importConnector(r));return i},n.prototype.updateChildren=function(n,t){n.forEach(function(n){n instanceof r.Shape&&n.childKeys&&(n.childKeys.forEach(function(i){var r=t(i);r&&(n.children.push(r),r.container=n)}),delete n.childKeys)})},n.prototype.updateConnections=function(n){n.endItem&&(n.endItem instanceof r.Shape?(n.endItem.attachedConnectors.push(n),n.points[n.points.length-1]=n.endItem.getConnectionPointPosition(n.endConnectionPointIndex,n.points[n.points.length-2])):(n.endItem=void 0,n.endConnectionPointIndex=-1));n.beginItem&&(n.beginItem instanceof r.Shape?(n.beginItem.attachedConnectors.push(n),n.points[0]=n.beginItem.getConnectionPointPosition(n.beginConnectionPointIndex,n.points[1])):(n.beginItem=void 0,n.beginConnectionPointIndex=-1))},n.prototype.assert=function(n,t){if(void 0===n)throw Error("Invalid Format");if(void 0!==t&&typeof n!==t)throw Error("Invalid Format");},n}();t.ImporterBase=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.lockInputPositionUpdating=function(){return!0},t}(i(8).SimpleCommandBase);t.StylePropertyCommandBase=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.executeCore=function(n,t){var i=this,r;return this.control.history.beginTransaction(),r=this.control.selection.getSelectedItems(),t=this.processParameter(t),r.forEach(function(n){var r=i.getStyleProperty();i.control.history.addAndRedo(i.createHistoryItem(n,r,t))}),this.updateInputPosition(t),this.control.history.endTransaction(),!0},t.prototype.getDefaultValue=function(){return this.getDefaultStyleObj()[this.getStyleProperty()]},t.prototype.processParameter=function(n){return n},t}(i(109).StylePropertyCommandBase);t.ChangeStylePropertyCommandBase=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(69);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentConnectorPropertyValue(this.getPropertyName())},t.prototype.getDefaultValue=function(){return this.getPropertyDefaultValue()},t.prototype.executeCore=function(n,t){var i=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedConnectors().forEach(function(n){var r=i.getPropertyName();i.control.history.addAndRedo(new u.ChangeConnectorPropertyHistoryItem(n.key,r,t))}),this.control.selection.inputPosition.setConnectorPropertyValue(this.getPropertyName(),t),this.control.history.endTransaction(),!0},t.prototype.lockInputPositionUpdating=function(){return!0},t}(i(8).SimpleCommandBase);t.ChangeConnectorPropertyCommand=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(60),o=i(77),u=i(17),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.createLayoutSettings=function(){var t=this.control.settings.snapToGrid?this.control.settings.gridSize:void 0,n=new u.TreeLayoutSettings(t);return n.orientation=u.DataLayoutOrientation.Vertical,n},t.prototype.createLayout=function(n,t){return new o.TreeLayoutBuilder(n,t).build()},t}(e.AutoLayoutCommandBase);t.AutoLayoutTreeVerticalCommand=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),r=i(54),f=function(){function n(){this.nodeKeys=[];this.nodeToLayout={};this.edgeToPosition={}}return n.prototype.forEachNode=function(n){var t=this;this.nodeKeys.forEach(function(i){return n(t.nodeToLayout[i],i)})},n.prototype.reduce=function(n,t){var i=this;return this.nodeKeys.reduce(function(t,r,u){return n(t,i.nodeToLayout[r],u)},t)},n.prototype.addNode=function(n){if(this.nodeToLayout[n.key])throw Error("Node layout is already registered");return this.nodeKeys.push(n.key),this.nodeToLayout[n.key]=n,n},n.prototype.hasNode=function(n){return!!this.nodeToLayout[n]},n.prototype.addEdge=function(n){if(this.edgeToPosition[n.key])throw Error("Edge layout is already registered");this.edgeToPosition[n.key]=n},n.prototype.getRectangle=function(){var n=this;return u.GeometryUtils.getCommonRectangle(this.nodeKeys.map(function(t){return n.nodeToLayout[t].rectangle}))},n.prototype.offsetNodes=function(t,i){var f=this,u;return void 0===t&&(t=0),void 0===i&&(i=0),u=new n,this.nodeKeys.forEach(function(n){var e=f.nodeToLayout[n];u.addNode(new r.NodeLayout(e.info,e.position.offset(t,i)))}),u.copyEdges(this),u},n.prototype.extend=function(n){var t=this;n.forEachNode(function(n){return t.addNode(n)});this.copyEdges(n)},n.prototype.copyEdges=function(n){var t=this;Object.keys(n.edgeToPosition).forEach(function(i){var u=n.edgeToPosition[i];t.addEdge(new r.EdgeLayout(u.key,u.beginIndex,u.endIndex))})},n}();t.GraphLayout=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(17),u=function(){function n(n,t){this.settings=n;this.graph=t}return n.prototype.getBreadthNodeSizeCore=function(n,t){var i=this.settings.orientation===r.DataLayoutOrientation.Vertical?n.size.width:n.size.height;return t||(i+=this.settings.orientation===r.DataLayoutOrientation.Vertical?n.margin.left+n.margin.right:n.margin.top+n.margin.bottom),i},n.prototype.getDepthNodeSizeCore=function(n){return this.settings.orientation===r.DataLayoutOrientation.Horizontal?n.size.width+n.margin.left+n.margin.right:n.size.height+n.margin.top+n.margin.bottom},n.prototype.chooseDirectionValue=function(n,t){return this.settings.direction===r.LogicalDirectionKind.Forward?n:t},n.prototype.getDirectionValue=function(n){return this.settings.direction===r.LogicalDirectionKind.Forward?n:-n},n.prototype.getComponentOffset=function(n){var t=n.getRectangle(!0);return(this.settings.orientation===r.DataLayoutOrientation.Vertical?t.width:t.height)+this.settings.componentSpacing},n.prototype.setComponentOffset=function(n,t){return this.settings.orientation===r.DataLayoutOrientation.Vertical?n.offsetNodes(t):n.offsetNodes(0,t)},n}();t.LayoutBuilder=u},function(n,t,i){"use strict";var o,s=this&&this.__extends||(o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}o(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(116),f=i(10),u=i(30),e=i(15),h=i(32),c=i(11),l=i(6),a=function(n){function t(t,i,r){var u=n.call(this,i,r)||this;return u.itemSelectorGroupContainers={},u.itemSelectorElements={},u.itemGroupContainers={},u.itemElements={},u.itemChildElements={},u.pendingChanges={},u.updatesLock=0,u.initializeContainerElements(t),u}return s(t,n),t.prototype.initializeContainerElements=function(n){this.itemSelectorsContainer=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null),n);this.itemsContainer=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null),n)},t.prototype.clear=function(){e.RenderUtils.removeContent(this.itemSelectorsContainer);e.RenderUtils.removeContent(this.itemsContainer);this.itemSelectorGroupContainers={};this.itemSelectorElements={};this.itemGroupContainers={};this.itemElements={};this.itemChildElements={}},t.prototype.beginUpdate=function(){this.updatesLock++},t.prototype.endUpdate=function(){this.updatesLock--;0===this.updatesLock&&this.applyPendingChanges()},t.prototype.getPendingChanges=function(){var n=this;return Object.keys(this.pendingChanges).map(function(t){return n.pendingChanges[t]})},t.prototype.applyPendingChanges=function(){var n=this.getPendingChanges();this.applyChangesCore(n);this.pendingChanges={}},t.prototype.applyChangesCore=function(n){var i=this,t=[];n.forEach(function(n){i.applyChange(n)||t.push(n)});t.length&&t.length!==n.length&&this.applyChangesCore(t)},t.prototype.applyChange=function(n){var t=n.item;return!!this.getItemParent(t.zIndex,t.container&&t.container.key)&&(t instanceof c.Shape?this.applyShapeChange(t,n.type):t instanceof l.Connector&&this.applyConnectorChange(t,n.type),!0)},t.prototype.postponeChanges=function(n){var t=this;n.forEach(function(n){t.pendingChanges[n.key]?n.type===r.ItemChangeType.Create||n.type===r.ItemChangeType.Remove?t.pendingChanges[n.key]=n:n.type===r.ItemChangeType.UpdateStructure&&t.pendingChanges[n.key].type===r.ItemChangeType.Update&&(t.pendingChanges[n.key]=n):t.pendingChanges[n.key]=n})},t.prototype.notifyModelChanged=function(n){0===this.updatesLock?this.applyChangesCore(n):this.postponeChanges(n)},t.prototype.notifyPageColorChanged=function(){},t.prototype.notifyPageSizeChanged=function(){},t.prototype.notifyDragStart=function(n){var t=this;n.forEach(function(n){t.itemElements[n]&&(t.itemElements[n].style.pointerEvents="none");t.itemChildElements[n]&&(t.itemChildElements[n].style.pointerEvents="none");t.itemSelectorElements[n]&&(t.itemSelectorElements[n].style.display="none")})},t.prototype.notifyDragEnd=function(n){var t=this;n.forEach(function(n){t.itemElements[n]&&(t.itemElements[n].style.pointerEvents="");t.itemChildElements[n]&&(t.itemChildElements[n].style.pointerEvents="");t.itemSelectorElements[n]&&(t.itemSelectorElements[n].style.display="")})},t.prototype.notifyDragScrollStart=function(){},t.prototype.notifyDragScrollEnd=function(){},t.prototype.notifyTextInputStart=function(n){var t=this.itemElements[n.key],i=t.getAttribute("class");t.setAttribute("class",i+" text-input")},t.prototype.notifyTextInputEnd=function(n){var t=this.itemElements[n.key],i=t.getAttribute("class");t.setAttribute("class",i.replace(" text-input",""))},t.prototype.notifyActualZoomChanged=function(n){var t="scale("+n+")";this.dom.changeByFunc(this.itemsContainer,function(n){return n.setAttribute("transform",t)});this.dom.changeByFunc(this.itemSelectorsContainer,function(n){return n.setAttribute("transform",t)});this.actualZoom=n},t.prototype.notifyViewAdjusted=function(){},t.prototype.applyShapeChange=function(n,t){var i=n.key,s=n.container&&n.container.key,o=this.getItemSelectorGroupContainer(n.zIndex,s),u=this.getItemGroupContainer(n.zIndex,s),e="shape";switch(n.enableChildren&&(e+=" container"),n.isLocked&&(e+=" locked"),t){case r.ItemChangeType.Create:this.itemSelectorElements[i]=this.createItemElements(i,n.getSelectorPrimitives(),o,e,f.MouseEventElementType.Shape);this.itemElements[i]=this.createItemElements(i,n.getPrimitives(),u,e,f.MouseEventElementType.Shape);n.enableChildren&&(this.itemChildElements[i]=this.createItemElements(i,[],u,"container-children",f.MouseEventElementType.Undefined),this.changeItemChildrenVisibility(this.itemChildElements[i],n.expanded));break;case r.ItemChangeType.Remove:this.removeItemElements(this.itemSelectorElements[i]);delete this.itemSelectorElements[i];this.removeItemElements(this.itemElements[i]);delete this.itemElements[i];this.itemChildElements[i]&&(this.removeItemElements(this.itemChildElements[i]),delete this.itemChildElements[i],delete this.itemGroupContainers[i],delete this.itemSelectorGroupContainers[i]);break;case r.ItemChangeType.UpdateStructure:case r.ItemChangeType.Update:this.changeItemElements(n.getSelectorPrimitives(),this.itemSelectorElements[i],t===r.ItemChangeType.UpdateStructure);this.changeItemElements(n.getPrimitives(),this.itemElements[i],t===r.ItemChangeType.UpdateStructure,e);this.itemChildElements[i]&&this.changeItemChildrenVisibility(this.itemChildElements[i],n.expanded);o!==(this.itemSelectorElements[i]&&this.itemSelectorElements[i].parentNode)&&this.moveItemElements(o,this.itemSelectorElements[i]);u!==(this.itemElements[i]&&this.itemElements[i].parentNode)&&this.moveItemElements(u,this.itemElements[i]);this.itemChildElements[i]&&u!==this.itemChildElements[i].parentNode&&this.moveItemElements(u,this.itemChildElements[i])}},t.prototype.applyConnectorChange=function(n,t){var i=n.key,o=n.container&&n.container.key,u=this.getItemSelectorGroupContainer(n.zIndex,o),e=this.getItemGroupContainer(n.zIndex,o);switch(t){case r.ItemChangeType.Create:this.itemSelectorElements[i]=this.createItemElements(i,n.getSelectorPrimitives(),u,"connector",f.MouseEventElementType.Connector);this.itemElements[i]=this.createItemElements(i,n.getPrimitives(),e,"connector",f.MouseEventElementType.Connector);break;case r.ItemChangeType.Remove:this.removeItemElements(this.itemSelectorElements[i]);delete this.itemSelectorElements[i];this.removeItemElements(this.itemElements[i]);delete this.itemElements[i];break;case r.ItemChangeType.UpdateStructure:case r.ItemChangeType.Update:this.changeItemElements(n.getSelectorPrimitives(),this.itemSelectorElements[i],t===r.ItemChangeType.UpdateStructure);this.changeItemElements(n.getPrimitives(),this.itemElements[i],t===r.ItemChangeType.UpdateStructure);u!==(this.itemSelectorElements[i]&&this.itemSelectorElements[i].parentNode)&&this.moveItemElements(u,this.itemSelectorElements[i]);e!==(this.itemElements[i]&&this.itemElements[i].parentNode)&&this.moveItemElements(e,this.itemElements[i])}},t.prototype.createItemElements=function(n,t,i,r,f){var o=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],r,void 0,void 0,function(t){return e.RenderUtils.setElementEventData(t,f,n)}),i);return this.createAndChangePrimitivesElements(t,o),o},t.prototype.changeItemElements=function(n,t,i,r){i||n.length!==t.childNodes.length?(e.RenderUtils.removeContent(t),this.createAndChangePrimitivesElements(n,t)):this.dom.changeChildrenByPrimitives(n,t);r&&this.changePrimitiveElement(new u.GroupPrimitive([],r),t)},t.prototype.removeItemElements=function(n){n&&n.parentNode&&n.parentNode.removeChild(n)},t.prototype.moveItemElements=function(n,t,i){t&&n&&(i?n.insertBefore(t,i):n.appendChild(t))},t.prototype.changeItemChildrenVisibility=function(n,t){n.style.display=t?"":"none"},t.prototype.getItemGroupContainerKey=function(n,t){return void 0!==t?n+"_"+t:n.toString()},t.prototype.getItemGroupContainer=function(n,t){var r=void 0!==t?this.getItemParent(n,t):this.itemsContainer,i=t||"Main";return void 0!==this.itemGroupContainers[i]&&void 0!==this.itemGroupContainers[i][n]||(void 0===this.itemGroupContainers[i]&&(this.itemGroupContainers[i]=[]),this.itemGroupContainers[i][n]=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null,n),r,this.itemGroupContainers[i][n+1])),this.itemGroupContainers[i][n]},t.prototype.getItemSelectorGroupContainer=function(n,t){var r=void 0!==t?this.getItemSelectorParent(n,t):this.itemSelectorsContainer,i=t||"Main";return void 0!==this.itemSelectorGroupContainers[i]&&void 0!==this.itemSelectorGroupContainers[i][n]||(void 0===this.itemSelectorGroupContainers[i]&&(this.itemSelectorGroupContainers[i]=[]),this.itemSelectorGroupContainers[i][n]=this.createAndChangePrimitiveElement(new u.GroupPrimitive([],null,n),r,this.itemSelectorGroupContainers[i][n+1])),this.itemSelectorGroupContainers[i][n]},t.prototype.getItemParent=function(n,t){return void 0!==t?this.itemChildElements[t]:this.getItemGroupContainer(n)},t.prototype.getItemSelectorParent=function(n,t){return void 0!==t?this.itemChildElements[t]:this.getItemSelectorGroupContainer(n)},t}(h.CanvasManagerBase);t.CanvasItemsManager=a},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Create=0]="Create";n[n.Update=1]="Update";n[n.UpdateStructure=2]="UpdateStructure";n[n.Remove=3]="Remove"}(t.ItemChangeType||(t.ItemChangeType={}));var i=function(){function n(n,t){this.item=n;this.type=t}return Object.defineProperty(n.prototype,"key",{get:function(){return this.item.key},enumerable:!0,configurable:!0}),n}();t.ItemChange=i},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(81),e=i(95),o=i(11),s=i(230),h=i(6),c=i(231),l=i(7),a=i(41),v=i(14),y=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&(this.isPasteSupportedByBrowser()||void 0!==u.ClipboardCommand.clipboardData)},t.prototype.isVisible=function(){return this.isPasteSupportedByBrowser()||void 0!==u.ClipboardCommand.clipboardData},t.prototype.executeCore=function(n,t){var i=this;return this.getClipboardData(function(n){i.performPaste(n,t)}),!0},t.prototype.performPaste=function(n,t){var r,u,f,i,v;for(this.control.beginUpdate(!0),this.control.history.beginTransaction(),r=[],u=new e.Importer(this.control.shapeDescriptionManager,n).importItems(this.control.model),this.calculateSelectionOffset(u,this.control.getPastePosition()||t),f=0;f<u.length;f++)i=u[f],i instanceof o.Shape?(i.position=this.getShapeNewPosition(i.position),this.control.history.addAndRedo(new s.ImportShapeHistoryItem(i))):i instanceof h.Connector&&(this.changeConnectorPoints(i),this.control.history.addAndRedo(new c.ImportConnectorHistoryItem(i))),v=i.container&&i.container.key,v&&-1!==r.indexOf(v)||r.push(i.key);l.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model);this.control.history.addAndRedo(new a.SetSelectionHistoryItem(this.control.selection,r));this.control.history.endTransaction();this.control.endUpdate(!0);this.control.barManager.updateItemsState()},t.prototype.calculateSelectionOffset=function(){},t.getShapeNewPosition=function(n,i){for(;n.findShapeAtPosition(i);)i=i.offset(t.positionOffset,t.positionOffset);return i},t.changeConnectorPoints=function(n,i){for(;n.findConnectorAtPoints(i.points);)i.points.forEach(function(n){n.x+=t.positionOffset;n.y+=t.positionOffset})},t.positionOffset=v.UnitConverter.pixelsToTwips(10),t}(u.ClipboardCommand);t.PasteSelectionCommandBase=y},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(60),o=i(62),u=i(17),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.createLayoutSettings=function(){var n=new u.LayoutSettings;return n.orientation=u.DataLayoutOrientation.Horizontal,n},t.prototype.createLayout=function(n,t){return new o.SugiyamaLayoutBuilder(n,t).build()},t}(e.AutoLayoutCommandBase);t.AutoLayoutLayeredHorizontalCommand=s},function(n,t,i){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0});var r,u=i(17),e=i(77),o=i(62);!function(n){n[n.Tree=0]="Tree";n[n.Sugiyama=1]="Sugiyama"}(r=t.DataLayoutType||(t.DataLayoutType={}));f=function(){function n(n){this.layoutType=void 0!==n&&void 0!==n.type?n.type:r.Sugiyama;this.layoutSettings=this.layoutType===r.Sugiyama?new u.LayoutSettings:new u.TreeLayoutSettings;void 0!==n&&(void 0!==n.orientation&&(this.layoutSettings.orientation=n.orientation),this.skipPointIndices=n.skipPointIndices)}return n.prototype.getLayoutBuilder=function(n){return this.layoutType===r.Tree?new e.TreeLayoutBuilder(this.layoutSettings,n):new o.SugiyamaLayoutBuilder(this.layoutSettings,n)},n}();t.DataLayoutParameters=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(60),o=i(77),u=i(17),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.createLayoutSettings=function(){var t=this.control.settings.snapToGrid?this.control.settings.gridSize:void 0,n=new u.TreeLayoutSettings(t);return n.orientation=u.DataLayoutOrientation.Horizontal,n},t.prototype.createLayout=function(n,t){return new o.TreeLayoutBuilder(n,t).build()},t}(e.AutoLayoutCommandBase);t.AutoLayoutTreeHorizontalCommand=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(60),o=i(62),u=i(17),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.createLayoutSettings=function(){var n=new u.LayoutSettings;return n.orientation=u.DataLayoutOrientation.Vertical,n},t.prototype.createLayout=function(n,t){return new o.SugiyamaLayoutBuilder(n,t).build()},t}(e.AutoLayoutCommandBase);t.AutoLayoutLayeredVerticalCommand=s},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(7);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabled=function(){var i=this,r=this.control.selection.getSelectedItems(!0),t=!1;return r.forEach(function(n){n.locked!==i.getLockState()&&(t=!0)}),n.prototype.isEnabled.call(this)&&t},t.prototype.executeCore=function(){return u.ModelUtils.changeSelectionLocked(this.control.history,this.control.model,this.control.selection,this.getLockState()),!0},t}(i(8).SimpleCommandBase);t.ChangeLockedCommand=f},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(3),e=i(40),o=function(n){function t(t,i){var r=n.call(this)||this;return r.shapeKey=t.key,r.imageUrl=i,r}return u(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);this.oldImage=t.image;n.changeShapeImage(t,new e.ImageInfo(this.imageUrl))},t.prototype.undo=function(n){var t=n.model.findShape(this.shapeKey);n.changeShapeImage(t,this.oldImage)},t}(f.HistoryItem);t.ChangeShapeImageHistoryItem=o},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(10),e=i(269),o=i(270),s=i(271),h=i(272),c=i(273),l=i(274),a=i(275),v=i(276),y=i(84),p=i(128),w=i(282),b=i(13),k=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.finish=function(){this.visualizerManager.resetConnectionPoints();n.prototype.finish.call(this)},t.prototype.onMouseDownCore=function(t){if(t.modifiers===b.ModifierKey.Ctrl)this.startScrolling(t);else if(t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ConnectorText){var i=t.source.key;this.modifySelection(t,i);this.handler.switchState(new v.MouseHandlerMoveConnectorTextState(this.handler,this.history,this.model))}else t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ShapeResizeBox?this.handler.switchState(new o.MouseHandlerResizeShapeState(this.handler,this.history,this.model,this.selection,this.visualizerManager)):t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ShapeParameterBox?this.handler.switchState(new h.MouseHandlerDragParameterPointState(this.handler,this.history,this.model)):t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ConnectorPoint?this.handler.switchState(new e.MouseHandlerMoveConnectorPointState(this.handler,this.history,this.model,this.visualizerManager)):t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ConnectorSide?this.handler.switchState(new s.MouseHandlerMoveConnectorSideState(this.handler,this.history,this.model)):t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ConnectorOrthogonalSide?this.handler.switchState(new l.MouseHandlerMoveConnectorOrthogonalSideState(this.handler,this.history,this.model)):t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ShapeConnectionPoint?this.handler.switchState(new c.MouseHandlerCreateConnectorState(this.handler,this.history,this.model,this.visualizerManager,this.shapeDescriptionManager,this.selection)):n.prototype.onMouseDownCore.call(this,t)},t.prototype.onShapeMouseDown=function(t){if(t.button===r.MouseButton.Left){var i=t.source.key;y.MouseHandlerMoveClonedShapeState.isMoveClonedShapeEvent(t)?(this.selection.add(i),this.handler.switchToMoveClonedShapeState(),this.handler.state.onMouseDown(t)):(this.modifySelection(t,i),this.selection.getSelectedShapes(!1).length&&(this.handler.switchState(new w.MouseHandlerMoveShapeState(this.handler,this.history,this.model,this.selection,this.visualizerManager)),this.handler.state.onMouseDown(t)))}else n.prototype.onShapeMouseDown.call(this,t)},t.prototype.onDragStart=function(n){this.handler.switchState(new a.MouseHandlerBeforeToolboxDraggingState(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.shapeDescriptionManager));this.handler.state.onDragStart(n)},t.prototype.onMouseMoveCore=function(t){this.updateConnectionsOnMouseMove(t);n.prototype.onMouseMoveCore.call(this,t)},t.prototype.updateConnectionsOnMouseMove=function(n){var t=this.model.findItem(n.source.key);this.visualizerManager.updateConnections(t,n.source.type,n.source.value)},t.prototype.canDragObjectOnMouseDown=function(){return!0},t.prototype.canExpandContainerOnMouseDown=function(){return!0},t.prototype.canClearSelectionOnMouseDown=function(){return!1},t.prototype.processOnMouseMoveAfterLimit=function(n){this.startSelection(n)},t.prototype.canSelectOnMouseUp=function(){return!1},t.prototype.canClearSelectionOnMouseUp=function(){return!0},t}(p.MouseHandlerDefaultStateBase);t.MouseHandlerDefaultState=k},function(n,t,i){"use strict";var u,c=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(6),f=i(10),l=i(26),e=i(90),s=i(35),a=i(49),o=i(7),h=i(13),v=function(n){function t(t,i,r,u){var f=n.call(this,t,i)||this;return f.model=r,f.visualizerManager=u,f}return c(t,n),t.prototype.finish=function(){this.visualizerManager.resetConnectionTarget();this.visualizerManager.resetConnectionPoints();n.prototype.finish.call(this)},t.prototype.onMouseMove=function(t){var i,r;(n.prototype.onMouseMove.call(this,t),this.allowAttachToObjects(t))?this.connector&&(i=this.connector.getExtremeItem(this.pointPosition),this.visualizerManager.setConnectionTarget(i,t.source.type),r=this.connector.getExtremeConnectionPointIndex(this.pointPosition),i||-1===this.oppositeConnectionPointIndex||(i=this.model.findItem(t.source.key)),this.visualizerManager.setConnectionPoints(i,t.source.type,r,!0)):(this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints())},t.prototype.onApplyChanges=function(n){var u=this.getSnappedPoint(n,n.modelPoint),i,t;void 0!==this.pointPosition&&(void 0===this.oppositePointPosition&&(this.oppositePointPosition=this.getOppositePointPosition(),this.oppositeItem=this.connector.getExtremeItem(this.oppositePointPosition),this.oppositeConnectionPointIndex=this.connector.getExtremeConnectionPointIndex(this.oppositePointPosition)),this.targetItem=this.model.findItem(n.source.key),i=this.allowAttachToObjects(n)?this.targetItem:void 0,t=-1,n.source.type===f.MouseEventElementType.ShapeConnectionPoint&&(t=parseInt(n.source.value)),!i||n.source.type!==f.MouseEventElementType.Shape&&n.source.type!==f.MouseEventElementType.ShapeConnectionPoint||this.connector.getExtremeItem(this.oppositePointPosition)===i&&(-1===t||-1===this.oppositeConnectionPointIndex||t===this.oppositeConnectionPointIndex)?this.connector.getExtremeItem(this.pointPosition)&&(this.history.addAndRedo(new e.DeleteConnectionHistoryItem(this.connector,this.pointPosition)),this.oppositeItem&&this.updateOppositeItemConnectionPointIndex(this.oppositeConnectionPointIndex)):(this.connector.getExtremeItem(this.pointPosition)===i&&this.connector.getExtremeConnectionPointIndex(this.pointPosition)===t||(this.connector.getExtremeItem(this.pointPosition)&&this.history.addAndRedo(new e.DeleteConnectionHistoryItem(this.connector,this.pointPosition)),this.history.addAndRedo(new s.AddConnectionHistoryItem(this.connector,i,t,this.pointPosition)),this.oppositeItem&&this.updateOppositeItemConnectionPointIndex(t)),u=i.getConnectionPointPosition(t,this.connector.points[this.pointIndex+(this.pointPosition===r.ConnectorPosition.End?-1:1)]),this.visualizerManager.setConnectionPointIndex(t)));this.history.addAndRedo(new a.MoveConnectorPointHistoryItem(this.connector.key,this.pointIndex,u));o.ModelUtils.updateConnectorAttachedPoints(this.history,this.model,this.connector);this.handler.tryUpdateModelSize()},t.prototype.updateOppositeItemConnectionPointIndex=function(n){this.history.addAndRedo(new e.DeleteConnectionHistoryItem(this.connector,this.oppositePointPosition));this.history.addAndRedo(new s.AddConnectionHistoryItem(this.connector,this.oppositeItem,-1===n?-1:this.oppositeConnectionPointIndex,this.oppositePointPosition))},t.prototype.onFinishWithChanges=function(){o.ModelUtils.updateConnectorContainer(this.history,this.model,this.connector);o.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector)},t.prototype.getDraggingElementKeys=function(){return this.connector?[this.connector.key]:[]},t.prototype.getOppositePointPosition=function(){return this.pointPosition===r.ConnectorPosition.Begin?r.ConnectorPosition.End:r.ConnectorPosition.Begin},t.prototype.allowAttachToObjects=function(n){return!(n.modifiers&h.ModifierKey.Ctrl||n.modifiers&h.ModifierKey.Shift)},t}(l.MouseHandlerDraggingState);t.MouseHandlerMoveConnectorPointStateBase=v},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.connectorKey=t,u.pointIndex=i,u.point=r,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);n.addConnectorPoint(t,this.pointIndex,this.point.clone())},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.deleteConnectorPoint(t,this.pointIndex)},t}(i(3).HistoryItem);t.AddConnectorPointHistoryItem=u},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),f=i(10),s=i(26),r=i(7),h=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i)||this;return e.model=r,e.selection=u,e.visualizerManager=f,e.startScrollLeft=0,e.startScrollTop=0,e}return e(t,n),t.prototype.finish=function(){this.visualizerManager.resetExtensionLines();this.visualizerManager.resetContainerTarget();this.visualizerManager.resetConnectionTarget();this.visualizerManager.resetConnectionPoints();n.prototype.finish.call(this)},t.prototype.onMouseDown=function(t){var u=this,i;(this.startPoint=t.modelPoint,this.shapes=this.selection.getSelectedShapes(!1,!0),this.connectors=this.selection.getSelectedConnectors(!1,!0),0!==this.shapes.length)?((this.startShapePositions=this.shapes.map(function(n){return n.position.clone()}),this.movingConnectors=[],1===this.shapes.length)&&(i=this.shapes[0],i.attachedConnectors.filter(function(n){return n.beginItem===i&&n.endItem===i}).forEach(function(n){return u.movingConnectors.push(n)})),this.changingConnectors=[],(this.shapes.length>1||this.connectors.length)&&(this.shapes.forEach(function(n){return n.attachedConnectors.forEach(function(t){return u.addUniqueAttachedConnector(n,t)})}),this.connectors.filter(function(n){return!n.beginItem&&!n.endItem}).forEach(function(n){return u.movingConnectors.push(n)})),this.startMovingConnectorPoints=this.movingConnectors.map(function(n){return n.points.map(function(n){return n.clone()})}),this.startChangingConnectorPoints=this.changingConnectors.map(function(n){return n.points.map(function(n){return n.clone()})}),this.connectorsWithoutBeginItemInfo=r.ModelUtils.getConnectorsWithoutBeginItemInfo(this.model),this.connectorsWithoutEndItemInfo=r.ModelUtils.getConnectorsWithoutEndItemInfo(this.model),n.prototype.onMouseDown.call(this,t)):this.handler.switchToDefaultState()},t.prototype.onMouseMove=function(t){n.prototype.onMouseMove.call(this,t);this.visualizerManager.setExtensionLines(this.selection.getSelectedShapes(!1,!0));var i=r.ModelUtils.findContainerByEventKey(this.model,this.selection,t.source.key);i&&r.ModelUtils.canInsertSelectionToContainer(this.model,this.selection,i)?this.visualizerManager.setContainerTarget(i,t.source.type):this.visualizerManager.resetContainerTarget()},t.prototype.onApplyChanges=function(n){var t=this,f,i,u;this.shapes.forEach(function(i,r){return t.updateShape(i,t.getPosition(n,t.startShapePositions[r]))});f=this.shapes[0];i=this.startShapePositions[0].offset(-f.position.x,-f.position.y);(i.x||i.y)&&(this.movingConnectors.forEach(function(n,u){t.setConnectorPoint(n,t.startMovingConnectorPoints[u],i);r.ModelUtils.updateConnectorAttachedPoints(t.history,t.model,n)}),this.changingConnectors.forEach(function(n,u){r.ModelUtils.removeConnectorIntermediatePoints(t.history,n);t.setConnectorPoint(n,t.startChangingConnectorPoints[u],i);r.ModelUtils.updateConnectorAttachedPoints(t.history,t.model,n)}));u=r.ModelUtils.findContainerByEventKey(this.model,this.selection,n.source.key);u&&r.ModelUtils.canInsertSelectionToContainer(this.model,this.selection,u)?r.ModelUtils.insertSelectionToContainer(this.history,this.model,this.selection,u):r.ModelUtils.removeSelectionFromContainer(this.history,this.model,this.selection);this.handler.tryUpdateModelSize(function(n,i){t.connectorsWithoutBeginItemInfo.forEach(function(t){t.point.x+=n;t.point.y+=i});t.connectorsWithoutEndItemInfo.forEach(function(t){t.point.x+=n;t.point.y+=i})})},t.prototype.getDraggingElementKeys=function(){return this.shapes.map(function(n){return n.key})},t.prototype.getXPosition=function(n,t){return t+n.modelPoint.x-this.startPoint.x},t.prototype.getYPosition=function(n,t){return t+n.modelPoint.y-this.startPoint.y},t.prototype.getPosition=function(n,t){return new o.Point(this.handler.getSnappedPos(n,this.getXPosition(n,t.x),!0),this.handler.getSnappedPos(n,this.getYPosition(n,t.y),!1))},t.prototype.updateShape=function(n,t){var i=this;r.ModelUtils.setShapePosition(this.history,this.model,n,t);r.ModelUtils.updateMovingShapeConnections(this.history,n,this.connectorsWithoutBeginItemInfo,this.connectorsWithoutEndItemInfo,function(){i.visualizerManager.resetConnectionTarget();i.visualizerManager.resetConnectionPoints()},function(n,t){i.visualizerManager.setConnectionTarget(n,f.MouseEventElementType.Shape);i.visualizerManager.setConnectionPoints(n,f.MouseEventElementType.Shape,t,!0)});this.movingConnectors.length||this.changingConnectors.length||r.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,n)},t.prototype.setConnectorPoint=function(n,t,i){for(var f=n.beginItem?1:0,e=n.endItem?n.points.length-2:n.points.length-1,u=f;u<=e;u++)r.ModelUtils.setConnectorPoint(this.history,this.model,n,u,t[u].offset(-i.x,-i.y));r.ModelUtils.updateConnectorAttachedPoints(this.history,this.model,n)},t.prototype.addUniqueAttachedConnector=function(n,t){var i=this.getOtherSideShape(n,t),r=!i||this.shapes.indexOf(i)>-1?this.movingConnectors:this.changingConnectors;this.addUniqueConnector(r,t)},t.prototype.getOtherSideShape=function(n,t){return n===t.beginItem?t.endItem:n===t.endItem?t.beginItem:void 0},t.prototype.addUniqueConnector=function(n,t){-1===n.indexOf(t)&&n.push(t)},t}(s.MouseHandlerDraggingState);t.MouseHandlerMoveShapeStateBase=h},function(n,t,i){"use strict";var f,e=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(31),r=i(10),u=i(13),s=i(278),h=i(280),c=i(281),l=i(129),a=i(14),v=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t)||this;return c.history=i,c.selection=r,c.model=u,c.view=f,c.visualizerManager=e,c.shapeDescriptionManager=o,c.settings=s,c.bars=h,c}return e(t,n),t.prototype.onMouseDown=function(n){this.onMouseDownCore(n);this.handler.state!==this&&this.handler.state.onMouseDown(n)},t.prototype.onMouseDownCore=function(n){n.modifiers===u.ModifierKey.Ctrl?this.startScrolling(n):n.source.type===r.MouseEventElementType.Shape&&this.canDragObjectOnMouseDown(n.source.key)?this.onShapeMouseDown(n):n.source.type===r.MouseEventElementType.Connector&&this.canDragObjectOnMouseDown(n.source.key)?this.onConnectorMouseDown(n):n.button===r.MouseButton.Left&&n.source.type===r.MouseEventElementType.ShapeExpandButton&&this.canExpandContainerOnMouseDown(n.source.key)?this.onShapeExpandBtnMouseDown(n):(n.source.type!==r.MouseEventElementType.Shape&&n.source.type!==r.MouseEventElementType.Connector&&this.canClearSelectionOnMouseDown()&&this.clearSelection(),this.startPoint=n.modelPoint)},t.prototype.onMouseMove=function(n){this.onMouseMoveCore(n);this.handler.state!==this&&(this.handler.state.onMouseDown(this.handler.mouseDownEvent),this.handler.state.onMouseMove(n))},t.prototype.onMouseMoveCore=function(n){this.startPoint&&(Math.abs(this.startPoint.x-n.modelPoint.x)>t.startLimit||Math.abs(this.startPoint.y-n.modelPoint.y)>t.startLimit)&&(this.processOnMouseMoveAfterLimit(n),this.startPoint=void 0)},t.prototype.onMouseUp=function(n){this.onMouseUpCore(n);this.handler.state!==this&&this.handler.state.onMouseUp(n)},t.prototype.onMouseUpCore=function(n){n.source.type===r.MouseEventElementType.Shape&&this.canSelectOnMouseUp(n.source.key)?this.modifySelection(n,n.source.key):n.source.type===r.MouseEventElementType.Connector&&this.canSelectOnMouseUp(n.source.key)?this.modifySelection(n,n.source.key):n.source.type===r.MouseEventElementType.ShapeExpandButton&&this.canSelectOnMouseUp(n.source.key)?this.modifySelection(n,n.source.key):this.startPoint&&this.canClearSelectionOnMouseUp()&&this.clearSelection();this.startPoint=void 0},t.prototype.onMouseWheel=function(n){return!!(n.modifiers&u.ModifierKey.Ctrl)&&(this.handler.switchState(new c.MouseHandlerZoomOnWheelState(this.handler,this.settings,this.view,this.bars)),this.handler.state.onMouseWheel(n),!0)},t.prototype.onLongTouch=function(n){this.modifySelection(n,n.source.key,!0)},t.prototype.onConnectorMouseDown=function(n){this.modifySelection(n,n.source.key)},t.prototype.onShapeMouseDown=function(n){this.modifySelection(n,n.source.key)},t.prototype.onShapeExpandBtnMouseDown=function(n){this.modifySelection(n,n.source.key);this.handler.switchState(new s.MouseHandlerToggleShapeExpandedState(this.handler,this.history,this.model,this.selection))},t.prototype.finish=function(){this.startPoint=void 0},t.prototype.startSelection=function(n){n.button===r.MouseButton.Left&&this.handler.switchState(new h.MouseHandlerSelectionState(this.handler,this.selection,this.visualizerManager))},t.prototype.startScrolling=function(n){n.button===r.MouseButton.Left&&this.handler.switchState(new l.MouseHandlerScrollingState(this.handler,this.view,this.selection))},t.prototype.modifySelection=function(n,t,i){this.isMultipleSelectionModifier(n)||i?this.selection.hasKey(t)?this.selection.remove(t):this.selection.add(t):this.selection.hasKey(t)||this.selection.set([t])},t.prototype.clearSelection=function(){this.selection.set([])},t.prototype.inSelection=function(n){return this.selection.hasKey(n)},t.prototype.isMultipleSelectionModifier=function(n){return n.modifiers&u.ModifierKey.Ctrl||n.modifiers&u.ModifierKey.Shift},t.startLimit=a.UnitConverter.pixelsToTwips(1),t}(o.MouseHandlerStateBase);t.MouseHandlerDefaultStateBase=v},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(31),o=i(10),u=i(0),s=function(n){function t(t,i,r){var f=n.call(this,t)||this;return f.view=i,f.selection=r,f.lastOffset=new u.Point(0,0),f}return f(t,n),t.prototype.onMouseDown=function(n){n.preventDefault=!0;this.startPoint=this.getPointByEvent(n)},t.prototype.onMouseMove=function(n){var i,t,r;n.button===o.MouseButton.Left?(i=this.currentPoint||this.startPoint,n.preventDefault=!0,t=this.getPointByEvent(n),r=this.view.scrollBy(new u.Point(t.x-i.x,t.y-i.y)),this.lastOffset=this.lastOffset.offset(r.x,r.y),this.currentPoint=t):this.handler.switchToDefaultState()},t.prototype.onMouseUp=function(){this.handler.switchToDefaultState()},t.prototype.cancelChanges=function(){this.currentPoint&&this.view.scrollBy(this.lastOffset.multiply(-1))},t.prototype.start=function(){this.handler.raiseDragScrollStart();n.prototype.start.call(this)},t.prototype.finish=function(){this.handler.raiseDragScrollEnd();this.currentPoint&&this.startPoint&&!this.currentPoint.equals(this.startPoint)||this.selection.set([]);n.prototype.finish.call(this)},t.prototype.getPointByEvent=function(n){return n.offsetPoint},t}(e.MouseHandlerCancellableState);t.MouseHandlerScrollingState=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.canDragObjectOnMouseDown=function(){return!1},t.prototype.canExpandContainerOnMouseDown=function(){return!1},t.prototype.canClearSelectionOnMouseDown=function(){return!1},t.prototype.processOnMouseMoveAfterLimit=function(n){this.startSelection(n)},t.prototype.canSelectOnMouseUp=function(){return!0},t.prototype.canClearSelectionOnMouseUp=function(){return!0},t}(i(128).MouseHandlerDefaultStateBase);t.MouseHandlerDefaultReadOnlyState=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(4),u=i(10),o=i(13),s=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.contextMenuVisible=!1,t.onVisibilityChanged=new e.EventDispatcher,t}return f(t,n),t.prototype.onMouseDown=function(n){n.button===u.MouseButton.Left&&n.source.type!==u.MouseEventElementType.Undefined&&this.hideContextMenu()},t.prototype.onMouseUp=function(){this.hideContextMenu()},t.prototype.onContextMenu=function(n){this.showContextMenu(n.eventPoint,n.modelPoint)},t.prototype.onFocus=function(){},t.prototype.onBlur=function(){},t.prototype.onTextInputFocus=function(){},t.prototype.onTextInputBlur=function(){},t.prototype.onLongTouch=function(){},t.prototype.onKeyDown=function(n){n.keyCode===o.KeyCode.Esc&&this.hideContextMenu()},t.prototype.showContextMenu=function(n,t){this.onVisibilityChanged.raise1(function(i){return i.notifyShowContextMenu(n,t)});this.contextMenuVisible=!0},t.prototype.hideContextMenu=function(){this.contextMenuVisible&&(this.onVisibilityChanged.raise1(function(n){return n.notifyHideContextMenu()}),this.contextMenuVisible=!1)},t.prototype.notifyDragStart=function(){},t.prototype.notifyDragEnd=function(){},t.prototype.notifyDragScrollStart=function(){},t.prototype.notifyDragScrollEnd=function(){},t.prototype.notifyShowContextToolbox=function(){},t.prototype.notifyHideContextToolbox=function(){},t.prototype.onUpdateUnlocked=function(){},t}(i(63).BatchUpdatableObject);t.ContextMenuHandler=s},function(n,t,i){"use strict";var o,l=this&&this.__extends||(o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}o(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(290),v=i(291),u=i(134),s=i(4),c=i(19),e=i(10),h=i(292),y=i(11),r=i(0),f=i(135),p=i(7),w=i(293),b=i(294),k=function(n){function t(t,i,r,f,e){void 0===e&&(e=f.readOnly);var o=n.call(this)||this;return o.selection=t,o.model=i,o.eventManager=r,o.settings=f,o.readOnly=e,o.onVisualizersUpdate=new s.EventDispatcher,o.connectionPointsVisualizer=new h.ConnectionPointsVisualizer(o.onVisualizersUpdate),o.connectionPointsVisualizer=new h.ConnectionPointsVisualizer(o.onVisualizersUpdate),o.connectionTargetVisualizer=new a.ConnectionTargetVisualizer(o.onVisualizersUpdate),o.containerTargetVisualizer=new v.ContainerTargetVisualizer(o.onVisualizersUpdate),o.extensionLinesVisualizer=new u.ExtensionLinesVisualizer(o.onVisualizersUpdate),o.resizeInfoVisualizer=new w.ResizeInfoVisualizer(o.onVisualizersUpdate),o.selectionRectangleVisualizer=new b.SelectionRectVisualizer(o.onVisualizersUpdate),o}return l(t,n),t.prototype.initialize=function(n){this.model=n},t.prototype.onMouseDown=function(){},t.prototype.onMouseUp=function(){},t.prototype.onMouseEnter=function(){},t.prototype.onMouseLeave=function(){this.resetConnectionPoints();this.resetConnectionTarget();this.resetExtensionLines();this.resetContainerTarget();this.resetResizeInfo();this.resetSelectionRectangle()},t.prototype.onBlur=function(){},t.prototype.onFocus=function(){},t.prototype.updateConnections=function(n,t,i){var r=-1,u;i&&t===e.MouseEventElementType.ShapeConnectionPoint&&(r=parseInt(i));u=n&&(!n.allowResizeHorizontally&&!n.allowResizeVertically||n.isLocked);this.setConnectionPoints(n,t,r,u)},t.prototype.setConnectionPoints=function(n,t,i,r){if(this.eventManager.isFocused())if(n&&(t===e.MouseEventElementType.Shape||t===e.MouseEventElementType.ShapeResizeBox||t===e.MouseEventElementType.ShapeConnectionPoint)&&void 0!==n){var u=n.key,f=this.selection.hasKey(u),o=n.getConnectionPoints();this.connectionPointsVisualizer.setPoints(u,o.map(function(t){return new h.ConnectionPointInfo(t,n.getConnectionPointSide(t))}),i,f&&!r&&n.rectangle)}else this.connectionPointsVisualizer.reset()},t.prototype.setConnectionPointIndex=function(n){this.connectionPointsVisualizer.setPointIndex(n)},t.prototype.updateConnectionPoints=function(){void 0!==this.model.findItem(this.connectionPointsVisualizer.getKey())?this.connectionPointsVisualizer.update():this.connectionPointsVisualizer.reset()},t.prototype.resetConnectionPoints=function(){this.connectionPointsVisualizer.reset()},t.prototype.setConnectionTarget=function(n,t){!n||t!==e.MouseEventElementType.Shape&&t!==e.MouseEventElementType.ShapeConnectionPoint?this.connectionTargetVisualizer.reset():this.connectionTargetVisualizer.setTargetRect(n.key,n.rectangle,n.strokeWidth)},t.prototype.resetConnectionTarget=function(){this.connectionTargetVisualizer.reset()},t.prototype.setContainerTarget=function(n,t){n&&!n.isLocked&&t===e.MouseEventElementType.Shape&&n.enableChildren?this.containerTargetVisualizer.setTargetRect(n.key,n.rectangle,n.strokeWidth):this.containerTargetVisualizer.reset()},t.prototype.resetContainerTarget=function(){this.containerTargetVisualizer.reset()},t.prototype.setExtensionLines=function(n){var i=this,t;this.eventManager.isFocused()&&(this.extensionLinesVisualizer.reset(),t=c.DiagramModel.getRectangle(n.filter(function(n){return n})),this.addPageExtensionLines(t),this.model.items.forEach(function(r){n.indexOf(r)>-1||r instanceof y.Shape&&i.addShapeExtensionLines(r,t)}))},t.prototype.addPageExtensionLines=function(n){for(var f,i,t,o=Math.round(this.model.size.width/this.model.pageWidth),s=Math.round(this.model.size.height/this.model.pageHeight),e=0;e<o;e++)for(f=0;f<s;f++)i=new r.Point(e*this.model.pageWidth+this.model.pageWidth/2,f*this.model.pageHeight+this.model.pageHeight/2),Math.abs(n.center.x-i.x)<this.settings.gridSize/2&&(t=new r.Segment(new r.Point(n.center.x,0),new r.Point(n.center.x,this.model.size.height)),this.extensionLinesVisualizer.addSegment(u.ExtensionLineType.HorizontalCenterToPageCenter,t,"")),Math.abs(n.center.y-i.y)<this.settings.gridSize/2&&(t=new r.Segment(new r.Point(0,n.center.y),new r.Point(this.model.size.width,n.center.y)),this.extensionLinesVisualizer.addSegment(u.ExtensionLineType.VerticalCenterToPageCenter,t,"")),Math.abs(n.left-i.x)<this.settings.gridSize/2&&(t=new r.Segment(new r.Point(n.left,0),new r.Point(n.left,this.model.size.height)),this.extensionLinesVisualizer.addSegment(u.ExtensionLineType.LeftToPageCenter,t,"")),Math.abs(n.top-i.y)<this.settings.gridSize/2&&(t=new r.Segment(new r.Point(0,n.top),new r.Point(this.model.size.width,n.top)),this.extensionLinesVisualizer.addSegment(u.ExtensionLineType.TopToPageCenter,t,"")),Math.abs(n.right-i.x)<this.settings.gridSize/2&&(t=new r.Segment(new r.Point(n.right,0),new r.Point(n.right,this.model.size.height)),this.extensionLinesVisualizer.addSegment(u.ExtensionLineType.RightToPageCenter,t,"")),Math.abs(n.bottom-i.y)<this.settings.gridSize/2&&(t=new r.Segment(new r.Point(0,n.bottom),new r.Point(this.model.size.width,n.bottom)),this.extensionLinesVisualizer.addSegment(u.ExtensionLineType.BottomToPageCenter,t,""))},t.prototype.addShapeExtensionLines=function(n,t){var y,p,w,b,o,s,h,c,i=n.rectangle,l=n.strokeWidth-f.CanvasSelectionManager.extensionLineWidth,a=!0,v,e;(t.right<i.left?(y=t.right,w=i.left,o=y+l+f.CanvasSelectionManager.extensionLineOffset,h=w-f.CanvasSelectionManager.extensionLineOffset):t.left>i.right&&(y=t.left,w=i.right,o=y-f.CanvasSelectionManager.extensionLineOffset,h=w+l+f.CanvasSelectionManager.extensionLineOffset),t.bottom<i.top?(p=t.bottom,b=i.top,s=p+l+f.CanvasSelectionManager.extensionLineOffset,c=b-f.CanvasSelectionManager.extensionLineOffset):t.top>i.bottom&&(p=t.top,b=i.bottom,s=p-f.CanvasSelectionManager.extensionLineOffset,c=b+l+f.CanvasSelectionManager.extensionLineOffset),null!=o&&void 0!==h)&&(v=this.getViewUnitText(Math.abs(y-w)),t.center.y===i.center.y&&(e=new r.Segment(new r.Point(o,t.center.y),new r.Point(h,i.center.y)),this.extensionLinesVisualizer.addSegment(o>h?u.ExtensionLineType.VerticalCenterAfter:u.ExtensionLineType.VerticalCenterBefore,e,a?v:""),a=!1),t.top===i.top&&(e=new r.Segment(new r.Point(o,t.top),new r.Point(h,i.top)),this.extensionLinesVisualizer.addSegment(o>h?u.ExtensionLineType.TopToTopAfter:u.ExtensionLineType.TopToTopBefore,e,a?v:"")),t.bottom===i.bottom&&(e=new r.Segment(new r.Point(o,t.bottom+l),new r.Point(h,i.bottom+l)),this.extensionLinesVisualizer.addSegment(o>h?u.ExtensionLineType.BottomToBottomAfter:u.ExtensionLineType.BottomToBottomBefore,e,a?v:"")),t.top===i.bottom&&(e=new r.Segment(new r.Point(o,t.top),new r.Point(h,i.bottom+l)),this.extensionLinesVisualizer.addSegment(o>h?u.ExtensionLineType.TopToBottomAfter:u.ExtensionLineType.TopToBottomBefore,e,a?v:"")),t.bottom===i.top&&(e=new r.Segment(new r.Point(o,t.bottom+l),new r.Point(h,i.top)),this.extensionLinesVisualizer.addSegment(o>h?u.ExtensionLineType.BottomToTopAfter:u.ExtensionLineType.BottomToTopBefore,e,a?v:"")));null!=s&&void 0!==c&&(v=this.getViewUnitText(Math.abs(p-b)),t.center.x===i.center.x&&(e=new r.Segment(new r.Point(t.center.x,s),new r.Point(i.center.x,c)),this.extensionLinesVisualizer.addSegment(s>c?u.ExtensionLineType.HorizontalCenterBelow:u.ExtensionLineType.HorizontalCenterAbove,e,a?v:""),a=!1),t.left===i.left&&(e=new r.Segment(new r.Point(t.left,s),new r.Point(i.left,c)),this.extensionLinesVisualizer.addSegment(s>c?u.ExtensionLineType.LeftToLeftBelow:u.ExtensionLineType.LeftToLeftAbove,e,a?v:"")),t.right===i.right&&(e=new r.Segment(new r.Point(t.right+l,s),new r.Point(i.right+l,c)),this.extensionLinesVisualizer.addSegment(s>c?u.ExtensionLineType.RightToRightBelow:u.ExtensionLineType.RightToRightAbove,e,a?v:"")),t.left===i.right&&(e=new r.Segment(new r.Point(t.left,s),new r.Point(i.right+l,c)),this.extensionLinesVisualizer.addSegment(s>c?u.ExtensionLineType.LeftToRightBelow:u.ExtensionLineType.LeftToRightAbove,e,a?v:"")),t.right===i.left&&(e=new r.Segment(new r.Point(t.right+l,s),new r.Point(i.left,c)),this.extensionLinesVisualizer.addSegment(s>c?u.ExtensionLineType.RightToLeftBelow:u.ExtensionLineType.RightToLeftAbove,e,a?v:"")))},t.prototype.resetExtensionLines=function(){this.extensionLinesVisualizer.reset()},t.prototype.setResizeInfo=function(n){var t=c.DiagramModel.getRectangle(n),i=new r.Point(t.center.x,t.bottom+f.CanvasSelectionManager.resizeInfoOffset),u=this.getViewUnitText(t.width)+" x "+this.getViewUnitText(t.height);this.resizeInfoVisualizer.set(i,u)},t.prototype.resetResizeInfo=function(){this.resizeInfoVisualizer.reset()},t.prototype.setSelectionRectangle=function(n){this.selectionRectangleVisualizer.setRectangle(n)},t.prototype.resetSelectionRectangle=function(){this.selectionRectangleVisualizer.reset()},t.prototype.getViewUnitText=function(n){return p.ModelUtils.getUnitText(this.settings.viewUnits,s.DiagramLocalizationService.unitItems,s.DiagramLocalizationService.formatUnit,n)},t.prototype.notifyReadOnlyChanged=function(n){this.readOnly=n},t.prototype.notifyDragStart=function(){},t.prototype.notifyDragEnd=function(){},t.prototype.notifyDragScrollStart=function(){},t.prototype.notifyDragScrollEnd=function(){},t.prototype.onUpdateUnlocked=function(){},t}(i(63).BatchUpdatableObject);t.VisualizerManager=k},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this.dispatcher=n}return n.prototype.getKey=function(){return this.key},n.prototype.setTargetRect=function(n,t,i){this.key!==n&&(this.key=n,this.targetRect=t,this.targetStrokeWidth=i,this.raiseShow())},n.prototype.reset=function(){"-1"!==this.key&&(this.key="-1",this.targetRect=void 0,this.targetStrokeWidth=0,this.raiseHide())},n}();t.TargetVisualizerBase=i},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.LeftToLeftAbove=0]="LeftToLeftAbove";n[n.LeftToLeftBelow=1]="LeftToLeftBelow";n[n.RightToRightAbove=2]="RightToRightAbove";n[n.RightToRightBelow=3]="RightToRightBelow";n[n.LeftToRightAbove=4]="LeftToRightAbove";n[n.LeftToRightBelow=5]="LeftToRightBelow";n[n.RightToLeftAbove=6]="RightToLeftAbove";n[n.RightToLeftBelow=7]="RightToLeftBelow";n[n.TopToTopBefore=8]="TopToTopBefore";n[n.TopToTopAfter=9]="TopToTopAfter";n[n.BottomToBottomBefore=10]="BottomToBottomBefore";n[n.BottomToBottomAfter=11]="BottomToBottomAfter";n[n.TopToBottomBefore=12]="TopToBottomBefore";n[n.TopToBottomAfter=13]="TopToBottomAfter";n[n.BottomToTopBefore=14]="BottomToTopBefore";n[n.BottomToTopAfter=15]="BottomToTopAfter";n[n.HorizontalCenterAbove=16]="HorizontalCenterAbove";n[n.HorizontalCenterBelow=17]="HorizontalCenterBelow";n[n.VerticalCenterBefore=18]="VerticalCenterBefore";n[n.VerticalCenterAfter=19]="VerticalCenterAfter";n[n.VerticalCenterToPageCenter=20]="VerticalCenterToPageCenter";n[n.HorizontalCenterToPageCenter=21]="HorizontalCenterToPageCenter";n[n.LeftToPageCenter=22]="LeftToPageCenter";n[n.RightToPageCenter=23]="RightToPageCenter";n[n.TopToPageCenter=24]="TopToPageCenter";n[n.BottomToPageCenter=25]="BottomToPageCenter"}(t.ExtensionLineType||(t.ExtensionLineType={}));i=function(){return function(n,t,i){this.type=n;this.segment=t;this.text=i}}();t.ExtensionLine=i;r=function(){function n(n){this.dispatcher=n;this.lines=[];this.lineIndexByType={}}return n.prototype.addSegment=function(n,t,r){var f=this.lineIndexByType[n],u,e;void 0===f?(u=new i(n,t,r),e=this.lines.push(u),this.lineIndexByType[u.type]=e-1,this.raiseShow()):t.distance<this.lines[f].segment.distance&&(u=new i(n,t,r),this.lines.splice(f,1,u),this.raiseShow())},n.prototype.update=function(){this.raiseShow()},n.prototype.reset=function(){this.lines.length&&(this.lines=[],this.lineIndexByType={},this.raiseHide())},n.prototype.raiseShow=function(){var n=this;this.dispatcher.raise1(function(t){return t.notifyExtensionLinesShow(n.lines)})},n.prototype.raiseHide=function(){this.dispatcher.raise1(function(n){return n.notifyExtensionLinesHide()})},n}();t.ExtensionLinesVisualizer=r},function(n,t,i){"use strict";var k,a=this&&this.__extends||(k=function(n,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}k(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r;Object.defineProperty(t,"__esModule",{value:!0});var g=i(32),v=i(30),c=i(15),e=i(10),p=i(5),f=i(0),s=i(134),rt=i(11),d=i(6),y=i(25),l=i(20),u=i(2),nt=i(46),ut=i(43),h=i(23),w=i(4),o=i(14),b=i(48);t.SELECTION_ELEMENT_CLASSNAMES={SELECTION_RECTANGLE:"selection-rect",CONNECTION_POINT:"connection-point",ACTIVE:"active",CONTAINER_TARGET:"container-target",CONNECTION_TARGET:"connection-target",EXTENSION_LINE:"extension-line",CONNECTION_MARK:"connection-mark",SELECTION_MARK:"selection-mark",LOCKED_SELECTION_MARK:"locked-selection-mark",ITEMS_SELECTION_RECT:"items-selection-rect",CONNECTOR_MULTI_SELECTION:"connector-multi-selection",CONNECTOR_SELECTION:"connector-selection",CONNECTOR_POINT_MARK:"connector-point-mark",CONNECTOR_SELECTION_MASK:"connector-selection-mask",CONNECTOR_SIDE_MARK:"connector-side-mark",ITEM_SELECTION_RECT:"item-selection-rect",ITEM_MULTI_SELECTION:"item-multi-selection-rect"};r=function(n){function i(t,i,r,u){var f=n.call(this,i,u)||this;return f.readOnly=r,f.connectionPointElements=[],f.extensionLineElements=[],f.selectionMap={},f.initializeContainerElements(t),f}return a(i,n),i.prototype.initializeContainerElements=function(n){this.itemSelectionContainer=this.createAndChangePrimitiveElement(new v.GroupPrimitive([],null),n);this.visualizersContainer=this.createAndChangePrimitiveElement(new v.GroupPrimitive([],null),n);this.selectionMarksContainer=this.createAndChangePrimitiveElement(new v.GroupPrimitive([],null),n)},i.prototype.clear=function(){c.RenderUtils.removeContent(this.itemSelectionContainer);c.RenderUtils.removeContent(this.selectionMarksContainer);c.RenderUtils.removeContent(this.visualizersContainer);this.selectionRectElement=void 0;this.resizeInfoElement=void 0;this.connectionPointElements=[];this.connectionTargetElement=void 0;this.containerTargetElement=void 0;this.extensionLineElements=[];this.selectionMap={}},i.prototype.showSelectionRect=function(n){var i=new l.RectanglePrimitive(n.left,n.top,n.size.width,n.size.height,h.StrokeStyle.default1pxInstance,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_RECTANGLE),r=this.getSelectionRectElement(i);this.changePrimitiveElement(i,r)},i.prototype.hideSelectionRect=function(){void 0!==this.selectionRectElement&&this.dom.changeByFunc(this.selectionRectElement,function(n){return n.style.display="none"})},i.prototype.getSelectionRectElement=function(n){return void 0!==this.selectionRectElement?this.dom.changeByFunc(this.selectionRectElement,function(n){return n.style.display=""}):this.selectionRectElement=this.createPrimitiveElement(n,this.visualizersContainer),this.selectionRectElement},i.prototype.showResizeInfo=function(n,t){var u=new l.RectanglePrimitive(n.x,n.y,0,0,h.StrokeStyle.default1pxInstance),e=new v.GroupPrimitive([u,new nt.TextPrimitive(n.x,n.y,t,b.TextOwner.Resize)],"resize-info"),c=this.getResizeInfoElement(e),r,s;this.changePrimitiveElement(e,c);r=this.dom.measurer.measureTextLine(t,null,b.TextOwner.Resize).transform(o.UnitConverter.pixelsToTwips);u.width=r.width+2*i.resizeInfoTextOffset;u.height=r.height+2*i.resizeInfoTextOffset;u.x=n.x-r.width/2-i.resizeInfoTextOffset;u.y=n.y-r.height/2-i.resizeInfoTextOffset;s=new f.Rectangle(n,r);s=s.inflate(i.resizeInfoTextOffset,i.resizeInfoTextOffset);this.changePrimitiveElement(e,c)},i.prototype.hideResizeInfo=function(){void 0!==this.resizeInfoElement&&this.dom.changeByFunc(this.resizeInfoElement,function(n){return n.style.display="none"})},i.prototype.getResizeInfoElement=function(n){return void 0!==this.resizeInfoElement?this.dom.changeByFunc(this.resizeInfoElement,function(n){return n.style.display=""}):this.resizeInfoElement=this.createPrimitiveElement(n,this.visualizersContainer),this.resizeInfoElement},i.prototype.showConnectionPoint=function(n,r,u,f,o,s){this.showConnectionPointCore(2*n,r.x,r.y,i.connectionPointLargeSize,i.connectionPointLargeSize,e.MouseEventElementType.ShapeConnectionPoint,f,o,t.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_POINT+" selector");this.showConnectionPointCore(2*n+1,r.x,r.y,i.connectionPointSmallSize,i.connectionPointSmallSize,e.MouseEventElementType.ShapeConnectionPoint,f,o,t.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_POINT+(s?" "+t.SELECTION_ELEMENT_CLASSNAMES.ACTIVE:""))},i.prototype.showConnectionPointCore=function(n,t,i,r,u,f,e,o,s){var h=new ut.EllipsePrimitive(t,i,r,u,null,s,function(n){return c.RenderUtils.setElementEventData(n,f,e,o)}),l=this.getConnectionPointElement(h,n);this.changePrimitiveElement(h,l)},i.prototype.hideConnectionPoints=function(){for(var n=0;n<this.connectionPointElements.length;n++)this.dom.changeByFunc(this.connectionPointElements[n],function(n){return n.style.display="none"})},i.prototype.getConnectionPointElement=function(n,t){var i=this.connectionPointElements[t];return void 0!==i?this.dom.changeByFunc(i,function(n){return n.style.display=""}):(i=this.createPrimitiveElement(n,this.visualizersContainer),this.connectionPointElements[t]=i),i},i.prototype.showContainerTarget=function(n,i){var r=new l.RectanglePrimitive(i.left,i.top,i.width,i.height,null,t.SELECTION_ELEMENT_CLASSNAMES.CONTAINER_TARGET),u=this.getContainerTargetElement(r,n);this.changePrimitiveElement(r,u)},i.prototype.hideContainerTarget=function(){this.containerTargetElement&&this.dom.changeByFunc(this.containerTargetElement,function(n){return n.style.display="none"})},i.prototype.getContainerTargetElement=function(n){return void 0!==this.containerTargetElement?this.dom.changeByFunc(this.containerTargetElement,function(n){return n.style.display=""}):this.containerTargetElement=this.createPrimitiveElement(n,this.itemSelectionContainer),this.containerTargetElement},i.prototype.showConnectionTarget=function(n,i){var r=new l.RectanglePrimitive(i.left,i.top,i.width,i.height,null,t.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_TARGET),u=this.getConnectionTargetElement(r,n);this.changePrimitiveElement(r,u)},i.prototype.hideConnectionTarget=function(){this.connectionTargetElement&&this.dom.changeByFunc(this.connectionTargetElement,function(n){return n.style.display="none"})},i.prototype.getConnectionTargetElement=function(n){return void 0!==this.connectionTargetElement?this.dom.changeByFunc(this.connectionTargetElement,function(n){return n.style.display=""}):this.connectionTargetElement=this.createPrimitiveElement(n,this.itemSelectionContainer),this.connectionTargetElement},i.prototype.showExtensionLine=function(n,r,f,e,o){var a=t.SELECTION_ELEMENT_CLASSNAMES.EXTENSION_LINE,c,l;r!==s.ExtensionLineType.VerticalCenterAfter&&r!==s.ExtensionLineType.VerticalCenterBefore&&r!==s.ExtensionLineType.HorizontalCenterAbove&&r!==s.ExtensionLineType.HorizontalCenterBelow||(a+=" center");r!==s.ExtensionLineType.VerticalCenterToPageCenter&&r!==s.ExtensionLineType.HorizontalCenterToPageCenter&&r!==s.ExtensionLineType.LeftToPageCenter&&r!==s.ExtensionLineType.RightToPageCenter&&r!==s.ExtensionLineType.TopToPageCenter&&r!==s.ExtensionLineType.BottomToPageCenter||(a+=" page");var y=0,p=0,w=0,k=0,d=0,tt=0,it=0,rt=0;f.y===e.y?(y=f.x-i.extensionLineWidth,p=f.y-i.extensionLineEndingSize,w=f.x-i.extensionLineWidth,k=f.y+i.extensionLineEndingSize,d=e.x-i.extensionLineWidth,tt=f.y-i.extensionLineEndingSize,it=e.x-i.extensionLineWidth,rt=f.y+i.extensionLineEndingSize):f.x===e.x&&(y=f.x-i.extensionLineEndingSize,p=f.y-i.extensionLineWidth,w=f.x+i.extensionLineEndingSize,k=f.y-i.extensionLineWidth,d=f.x-i.extensionLineEndingSize,tt=e.y-i.extensionLineWidth,it=f.x+i.extensionLineEndingSize,rt=e.y-i.extensionLineWidth);c=0;l=0;r!==s.ExtensionLineType.RightToRightAbove&&r!==s.ExtensionLineType.RightToRightBelow||(c-=i.extensionLineWidth);r!==s.ExtensionLineType.BottomToBottomAfter&&r!==s.ExtensionLineType.BottomToBottomBefore||(l-=i.extensionLineWidth);var ft=[new u.PathPrimitive([u.PathPrimitiveMoveToCommand.fromPoint(f.offset(c,l)),u.PathPrimitiveLineToCommand.fromPoint(e.offset(c,l))],h.StrokeStyle.default1pxInstance,"size-line"),new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(y,p),new u.PathPrimitiveLineToCommand(w,k),new u.PathPrimitiveMoveToCommand(d,tt),new u.PathPrimitiveLineToCommand(it,rt)],h.StrokeStyle.default1pxInstance),new nt.TextPrimitive((e.x+f.x)/2,(e.y+f.y)/2,o,b.TextOwner.ExtensionLine,void 0,void 0,void 0,null,void 0,null,g.PAGE_BG_TEXTFLOOR_FILTER_ID)],ut=new v.GroupPrimitive(ft,a),et=this.getExtensionLineElement(ut,n);this.changePrimitiveElement(ut,et)},i.prototype.clipRectangleFromCenter=function(n,t,i){var e=new f.Point(t.x-n.x,t.y-n.y).multiply(.5,.5).offset(n.x,n.y),b=e.x-i.width/2,k=e.x+i.width/2,d=e.y-i.height/2,g=e.y+i.height/2,o=n.x-t.x,h=-o,s=n.y-t.y,c=-s,nt=n.x-b,tt=k-n.x,it=n.y-d,rt=g-n.y,r=[1],u=[0],l,a,v,y,p,w;return 0!==o&&(l=nt/o,a=tt/h,o<0?(u.push(l),r.push(a)):(u.push(a),r.push(l))),0!==s&&(v=it/s,y=rt/c,s<0?(u.push(v),r.push(y)):(u.push(y),r.push(v))),p=u.reduce(function(n,t){return n<t?t:n},0),w=r.reduce(function(n,t){return n>t?t:n},1),[new f.Point(n.x+h*p,n.y+c*p),new f.Point(n.x+h*w,n.y+c*w)]},i.prototype.hideExtensionLines=function(){for(var n=0;n<this.extensionLineElements.length;n++)this.extensionLineElements[n]&&this.dom.changeByFunc(this.extensionLineElements[n],function(n){return n.style.display="none"})},i.prototype.getExtensionLineElement=function(n,t){var i=this.extensionLineElements[t];return void 0!==i?this.dom.changeByFunc(i,function(n){return n.style.display=""}):(i=this.createPrimitiveElement(n,this.visualizersContainer),this.extensionLineElements[t]=i),i},i.prototype.getOrCreateShapeSelection=function(n,t){var i=this.selectionMap[n.key];return i||(i=new et(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom,n.key,n.isLocked,n.rectangle,n.style,n.allowResizeHorizontally,n.allowResizeVertically,n.description.getParameterPoints(n)),this.selectionMap[n.key]=i),t&&(t[n.key]=!0),i},i.prototype.getOrCreateConnectorSelection=function(n,t){var i=this.selectionMap[n.key],r=n.getRenderPoints();return i||(i=new ot(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom,n.key,n.isLocked,n.rectangle,r,n.style,n.styleText,n.enableText,n.texts.map(function(t){var i=f.GeometryUtils.getPathPointByPosition(r,t.position);return{text:n.getText(t.position),point:i[0],pointIndex:i[1],pos:t.position}}).sort(function(n,t){return n.pos-t.pos}),n.points,n.properties.lineOption),this.selectionMap[n.key]=i),t&&(t[n.key]=!0),i},i.prototype.getOrCreateMultipleSelection=function(n){var t=this.selectionMap[-1];return t||(t=new ft(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom),this.selectionMap[-1]=t),n[-1]=!0,t},i.prototype.getMultipleSelection=function(){return this.selectionMap[-1]},i.prototype.updateShapeSelection=function(n,t){n.key in this.selectionMap&&(this.getOrCreateShapeSelection(n).onModelChanged(n.isLocked,n.rectangle,n.style,n.allowResizeHorizontally,n.allowResizeVertically,n.description.getParameterPoints(n)),t&&t.onModelItemChanged(n.key,n.rectangle))},i.prototype.updateConnectorSelection=function(n,t){if(n.key in this.selectionMap){var i=n.getRenderPoints();this.getOrCreateConnectorSelection(n).onModelChanged(n.isLocked,n.rectangle,i,n.style,n.styleText,n.enableText,n.texts.map(function(t){var r=f.GeometryUtils.getPathPointByPosition(i,t.position);return{text:n.getText(t.position),pointIndex:r[1],pos:t.position,point:r[0]}}).sort(function(n,t){return n.pos-t.pos}),n.points,n.properties.lineOption);t&&t.onModelItemChanged(n.key,n.rectangle)}},i.prototype.hideOutdatedSelection=function(n){var t=this;Object.keys(this.selectionMap).filter(function(t){return!n[t]}).forEach(function(n){t.selectionMap[n].destroy();delete t.selectionMap[n]})},i.prototype.selectionCanBeDrawn=function(n){return!n.container||n.container.expanded&&this.selectionCanBeDrawn(n.container)},i.prototype.notifySelectionChanged=function(n){var t=this,i=n.getSelectedItems(!0).filter(function(n){return t.selectionCanBeDrawn(n)}),r={},u=i.length>1,e=n.getSelectedShapes(!0).filter(function(n){return t.selectionCanBeDrawn(n)}),s=n.getSelectedConnectors(!0).filter(function(n){return t.selectionCanBeDrawn(n)}),o,f;(e.forEach(function(n){return t.getOrCreateShapeSelection(n,r).onSelectionChanged(u)}),s.forEach(function(n){return t.getOrCreateConnectorSelection(n,r).onSelectionChanged(u)}),u)&&(o=i.length>0?i[0].strokeWidth:0,f={},i.filter(function(n){return!n.isLocked}).forEach(function(n){return f[n.key]=n.rectangle}),this.getOrCreateMultipleSelection(r).onSelectionChanged(!!e.filter(function(n){return!n.isLocked}).length,o,f));this.hideOutdatedSelection(r)},i.prototype.notifyModelChanged=function(n){var i=this,t=this.getMultipleSelection();n.forEach(function(n){n.item instanceof rt.Shape?i.updateShapeSelection(n.item,t):n.item instanceof d.Connector&&i.updateConnectorSelection(n.item,t)});t&&t.onModelChanged()},i.prototype.notifyPageColorChanged=function(){},i.prototype.notifyPageSizeChanged=function(){},i.prototype.notifyActualZoomChanged=function(n){var t=this;Object.keys(this.selectionMap).forEach(function(i){return t.selectionMap[i].notifyZoomChanged(n)});this.actualZoom=n},i.prototype.notifyViewAdjusted=function(){},i.prototype.notifyReadOnlyChanged=function(n){var t=this;this.readOnly=n;Object.keys(this.selectionMap).forEach(function(i){return t.selectionMap[i].notifyReadOnlyChanged(n)})},i.prototype.notifySelectionRectShow=function(n){this.showSelectionRect(n.multiply(this.actualZoom))},i.prototype.notifySelectionRectHide=function(){this.hideSelectionRect()},i.prototype.notifyResizeInfoShow=function(n,t){this.showResizeInfo(n.multiply(this.actualZoom),t)},i.prototype.notifyResizeInfoHide=function(){this.hideResizeInfo()},i.prototype.notifyConnectionPointsShow=function(n,t,r,u){var f=this;this.hideConnectionPoints();t.forEach(function(t,e){var o=t.point.multiply(f.actualZoom);if(u)switch(t.side){case p.ConnectionPointSide.North:o.y=u.top*f.actualZoom-i.connectionPointShift;break;case p.ConnectionPointSide.South:o.y=u.bottom*f.actualZoom+i.connectionPointShift;break;case p.ConnectionPointSide.West:o.x=u.left*f.actualZoom-i.connectionPointShift;break;case p.ConnectionPointSide.East:o.x=u.right*f.actualZoom+i.connectionPointShift}f.showConnectionPoint(e,o,t.side,n,e,e===r)})},i.prototype.notifyConnectionPointsHide=function(){this.hideConnectionPoints()},i.prototype.notifyConnectionTargetShow=function(n,t,r){var u=i.correctSelectionRect(t.multiply(this.actualZoom),r,i.connectionTargetBorderWidth,this.actualZoom,0);this.showConnectionTarget(0,u)},i.prototype.notifyConnectionTargetHide=function(){this.hideConnectionTarget()},i.prototype.notifyContainerTargetShow=function(n,t,r){var u=i.correctSelectionRect(t.multiply(this.actualZoom),r,i.connectionTargetBorderWidth,this.actualZoom,0);this.showContainerTarget(0,u)},i.prototype.notifyContainerTargetHide=function(){this.hideContainerTarget()},i.prototype.notifyExtensionLinesShow=function(n){var t=this;this.hideExtensionLines();n.forEach(function(n,i){t.showExtensionLine(i,n.type,n.segment.startPoint.multiply(t.actualZoom),n.segment.endPoint.multiply(t.actualZoom),n.text)})},i.prototype.notifyExtensionLinesHide=function(){this.hideExtensionLines()},i.prototype.notifyDragStart=function(){this.dom.changeByFunc(this.selectionMarksContainer,function(n){return n.style.display="none"})},i.prototype.notifyDragEnd=function(){this.dom.changeByFunc(this.selectionMarksContainer,function(n){return n.style.display=""})},i.prototype.notifyDragScrollStart=function(){},i.prototype.notifyDragScrollEnd=function(){},i.prototype.notifyTextInputStart=function(){this.dom.changeByFunc(this.visualizersContainer,function(n){return n.style.display="none"})},i.prototype.notifyTextInputEnd=function(){this.dom.changeByFunc(this.visualizersContainer,function(n){return n.style.display=""})},i.correctSelectionRect=function(n,t,r,u,f){var c,e,s,h;return void 0===f&&(f=i.selectionOffset),c=o.UnitConverter.twipsToPixels(t)%2!=o.UnitConverter.twipsToPixels(r)%2,e=Math.ceil(t/2*u),n=n.inflate(e,e),s=Math.floor(r/2),(n.position.x-=s,n.position.y-=s,n.size.width+=r,n.size.height+=r,c)&&(h=i.evenOddSelectionCorrection*(o.UnitConverter.twipsToPixels(r)%2==1?-1:1),n=n.offset(h,h)),n.inflate(f,f)},i.selectionMarkSize=o.UnitConverter.pixelsToTwips(10),i.lockedSelectionMarkSize=o.UnitConverter.pixelsToTwips(8),i.selectionOffset=o.UnitConverter.pixelsToTwips(2),i.selectionRectLineWidth=o.UnitConverter.pixelsToTwips(1),i.multiSelectionRectLineWidth=o.UnitConverter.pixelsToTwips(1),i.connectionPointSmallSize=o.UnitConverter.pixelsToTwips(5),i.connectionPointLargeSize=o.UnitConverter.pixelsToTwips(12),i.connectionPointShift=o.UnitConverter.pixelsToTwips(16),i.connectionTargetBorderWidth=o.UnitConverter.pixelsToTwips(2),i.geomertyMarkSize=o.UnitConverter.pixelsToTwips(8),i.connectorPointMarkSize=o.UnitConverter.pixelsToTwips(6),i.connectorSideMarkSize=o.UnitConverter.pixelsToTwips(6),i.extensionLineWidth=o.UnitConverter.pixelsToTwips(1),i.extensionLineOffset=o.UnitConverter.pixelsToTwips(1),i.extensionLineEndingSize=o.UnitConverter.pixelsToTwips(6),i.resizeInfoOffset=o.UnitConverter.pixelsToTwips(16),i.resizeInfoTextOffset=o.UnitConverter.pixelsToTwips(2),i.resizeInfoLineWidth=o.UnitConverter.pixelsToTwips(1),i.evenOddSelectionCorrection=o.UnitConverter.pixelsToTwips(1),i}(g.CanvasManagerBase);t.CanvasSelectionManager=r;var tt=function(){function n(n,t,i,r,u,f){this.rectsContainer=n;this.marksContainer=t;this.key=i;this.zoomLevel=r;this.readOnly=u;this.dom=f;this.elements={};this.updatedElements={}}return n.prototype.notifyZoomChanged=function(n){this.zoomLevel!==n&&(this.zoomLevel=n,this.redraw())},n.prototype.notifyReadOnlyChanged=function(n){this.readOnly=n;this.redraw()},n.prototype.destroy=function(){var n=this;Object.keys(this.elements).forEach(function(t){n.elements[t].parentNode.removeChild(n.elements[t]);delete n.elements[t]})},n.prototype.redraw=function(){var n=this;this.updatedElements={};this.redrawCore();Object.keys(this.elements).filter(function(t){return!n.updatedElements[t]}).forEach(function(t){n.elements[t].parentNode.removeChild(n.elements[t]);delete n.elements[t]});this.updatedElements={}},n.prototype.drawSelectionMarks=function(n,i,u){if(!this.readOnly){var s=i&&n.height>3*r.selectionMarkSize,h=u&&n.width>3*r.selectionMarkSize,o=i||u;o&&this.drawSelectionMark(0,new f.Point(n.left,n.top),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_NW,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);h&&!w.Browser.TouchUI&&this.drawSelectionMark(1,new f.Point(n.left+n.size.width/2,n.top),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_N,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);o&&this.drawSelectionMark(2,new f.Point(n.right,n.top),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_NE,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);s&&!w.Browser.TouchUI&&this.drawSelectionMark(3,new f.Point(n.right,n.top+n.size.height/2),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_E,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);o&&this.drawSelectionMark(4,new f.Point(n.right,n.bottom),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_SE,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);h&&!w.Browser.TouchUI&&this.drawSelectionMark(5,new f.Point(n.left+n.size.width/2,n.bottom),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_S,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);o&&this.drawSelectionMark(6,new f.Point(n.left,n.bottom),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_SW,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK);s&&!w.Browser.TouchUI&&this.drawSelectionMark(7,new f.Point(n.left,n.top+n.size.height/2),r.selectionMarkSize,e.MouseEventElementType.ShapeResizeBox,e.ResizeEventSource.ResizeBox_W,t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK)}},n.prototype.drawSelectionMark=function(n,t,i,r,u,f){var e=this;this.getOrCreateElement("SM"+n,new l.RectanglePrimitive(t.x-i/2,t.y-i/2,i,i,null,f,void 0,function(n){c.RenderUtils.setElementEventData(n,r,e.key,u)}),this.marksContainer)},n.prototype.drawSelectionRect=function(n,t,i){var r=new l.RectanglePrimitive(n.left,n.top,n.width,n.height,h.StrokeStyle.default1pxInstance,i,void 0,function(n){c.RenderUtils.setElementEventData(n,t,"-1",-1)});this.getOrCreateElement("shapeSelection",r,this.rectsContainer)},n.prototype.getOrCreateElement=function(n,t,i){var r=this.elements[n];return r||(r=t.createElement(),this.elements[n]=r,i.appendChild(r)),this.updatedElements[n]=!0,this.dom.changeByPrimitive(r,t),r},n}(),it=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r,u,f,e)||this;return h.isLocked=o,h.rectangle=s,h}return a(t,n),t.prototype.onSelectionChanged=function(n){this.isMultipleSelection!==n&&(this.isMultipleSelection=n,this.redraw())},t.prototype.isLockedRender=function(){return this.isLocked&&!this.readOnly},t.prototype.drawLockedSelectionMark=function(n,t,i,r){var f=new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(t.x-i/2,t.y-i/2),new u.PathPrimitiveLineToCommand(t.x+i/2,t.y+i/2),new u.PathPrimitiveMoveToCommand(t.x+i/2,t.y-i/2),new u.PathPrimitiveLineToCommand(t.x-i/2,t.y+i/2)],null,r);this.getOrCreateElement("LSM"+n,f,this.marksContainer)},t}(tt),ft=function(n){function i(t,i,r,u,f){var e=n.call(this,t,i,"-1",r,u,f)||this;return e.rectangles={},e}return a(i,n),i.prototype.onModelItemChanged=function(n,t){n in this.rectangles&&(this.rectangles[n]=t)},i.prototype.onModelChanged=function(){this.redraw()},i.prototype.onSelectionChanged=function(n,t,i){this.needDrawSelectionMarks=n;this.strokeWidth=t;this.rectangles=i;this.redraw()},i.prototype.redrawCore=function(){var o=this,i=Object.keys(this.rectangles),n,u;i.length&&(n=f.GeometryUtils.getCommonRectangle(i.map(function(n){return o.rectangles[n]})).multiply(this.zoomLevel),u=r.correctSelectionRect(n,this.strokeWidth,r.selectionRectLineWidth,this.zoomLevel),this.drawSelectionRect(u,e.MouseEventElementType.SelectionRect,t.SELECTION_ELEMENT_CLASSNAMES.ITEMS_SELECTION_RECT),this.needDrawSelectionMarks&&this.drawSelectionMarks(n,!0,!0))},i}(tt),et=function(n){function i(t,i,r,u,f,e,o,s,h,c,l,a){var v=n.call(this,t,i,e,r,u,f,o,s)||this;return v.style=h,v.allowResizeHorizontally=c,v.allowResizeVertically=l,v.shapeParameterPoints=a,v}return a(i,n),i.prototype.onModelChanged=function(n,t,i,r,u,f){this.isLocked=n;this.rectangle=t;this.style=i;this.allowResizeHorizontally=r;this.allowResizeVertically=u;this.shapeParameterPoints=f;this.redraw()},i.prototype.redrawCore=function(){var n=this.rectangle.multiply(this.zoomLevel);this.isLockedRender()?this.drawLockedSelection(n):this.drawUnlockedSelection(n)},i.prototype.drawLockedSelection=function(n){this.drawLockedSelectionMark(0,new f.Point(n.left,n.top),r.lockedSelectionMarkSize,t.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK);this.drawLockedSelectionMark(1,new f.Point(n.right,n.top),r.lockedSelectionMarkSize,t.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK);this.drawLockedSelectionMark(2,new f.Point(n.right,n.bottom),r.lockedSelectionMarkSize,t.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK);this.drawLockedSelectionMark(3,new f.Point(n.left,n.bottom),r.lockedSelectionMarkSize,t.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK)},i.prototype.drawUnlockedSelection=function(n){var i=r.correctSelectionRect(n,this.style.strokeWidth,r.selectionRectLineWidth,this.zoomLevel);this.drawSelectionRect(i,e.MouseEventElementType.SelectionRect,this.isMultipleSelection?t.SELECTION_ELEMENT_CLASSNAMES.ITEM_MULTI_SELECTION:t.SELECTION_ELEMENT_CLASSNAMES.ITEM_SELECTION_RECT);this.isMultipleSelection||this.drawSelectionMarks(n,this.allowResizeHorizontally,this.allowResizeVertically);this.drawShapeParameterPoints()},i.prototype.drawShapeParameterPoints=function(){var n=this;this.readOnly||this.shapeParameterPoints.forEach(function(t,i){var r=t.point.multiply(n.zoomLevel);n.drawShapeParameterPoint(r,i,t.key)})},i.prototype.drawShapeParameterPoint=function(n,t,i){var f=this,u=r.geomertyMarkSize,o=new l.RectanglePrimitive(n.x-u/2,n.y-u/2,u,u,null,"geometry-mark",void 0,function(n){c.RenderUtils.setElementEventData(n,e.MouseEventElementType.ShapeParameterBox,f.key,i)});this.getOrCreateElement("pp"+t.toString(),o,this.marksContainer)},i}(it),ot=function(n){function i(t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){var w=n.call(this,t,i,e,r,u,f,o,s)||this;return w.renderPoints=h,w.style=c,w.styleText=l,w.enableText=a,w.texts=v,w.points=y,w.lineType=p,w}return a(i,n),i.prototype.onModelChanged=function(n,t,i,r,u,f,e,o,s){this.isLocked=n;this.rectangle=t;this.renderPoints=i;this.style=r;this.styleText=u;this.enableText=f;this.texts=e;this.points=o;this.lineType=s;this.redraw()},i.prototype.redrawCore=function(){this.rectangle.multiply(this.zoomLevel);this.isLockedRender()?this.drawLockedSelection():this.drawUnlockedSelection()},i.prototype.drawLockedSelection=function(){var n=this;this.renderPoints.forEach(function(i,u){n.drawLockedSelectionMark(u,i,r.lockedSelectionMarkSize,t.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK)})},i.prototype.drawUnlockedSelection=function(){this.drawConnectorSelection(this.isMultipleSelection?t.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_MULTI_SELECTION:t.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_SELECTION);this.isMultipleSelection||this.readOnly||this.drawConnectorSelectionMarks()},i.prototype.drawConnectorSelection=function(n){for(var p,dt,ct,lt,at,y,rt,e,vt,ut=this.texts,b=0,gt=this.styleText.getAlignment(),o=[],v=[],ft=this.renderPoints,i=this.zoomLevel,t=ft[0],k=1,f=void 0;f=ft[k];k++){p=ft[k+1];void 0===y&&(y=(ct=this.getSelectionOffsetPoints(t,f))[0],rt=ct[1]);p&&(e=(lt=this.getSelectionOffsetPoints(f,p))[0],vt=lt[1]);var s=y.x,c=y.y,l=-y.x,a=-y.y,et=e&&e.x,ot=e&&e.y,st=e&&-e.x,ht=e&&-e.y;for(this.style.strokeWidthPx%2==0&&(l>0?l-=r.evenOddSelectionCorrection:s>0&&(s-=r.evenOddSelectionCorrection),a>0?a-=r.evenOddSelectionCorrection:c>0&&(c-=r.evenOddSelectionCorrection),st>0?st-=r.evenOddSelectionCorrection:et>0&&(et-=r.evenOddSelectionCorrection),ht>0?ht-=r.evenOddSelectionCorrection:ot>0&&(ot-=r.evenOddSelectionCorrection));ut[b]&&ut[b].pointIndex<=k;){var yt=ut[b],ni=(f.x-t.x)/rt,ti=(f.y-t.y)/rt,w=this.getTextStartEndPoints(ti,ni,yt.point,yt.text,gt);ut[b].pointIndex<k?(t=w[1],o.push(u.PathPrimitiveMoveToCommand.fromPoint(t.offset(s,c).multiply(i))),v.push(u.PathPrimitiveLineToCommand.fromPoint(t.offset(l,a).multiply(i)))):(o.length||(o.push(u.PathPrimitiveMoveToCommand.fromPoint(t.offset(s,c).multiply(i))),v.push(u.PathPrimitiveLineToCommand.fromPoint(t.offset(l,a).multiply(i)))),o.push(u.PathPrimitiveLineToCommand.fromPoint(w[0].offset(s,c).multiply(i))),o.push(u.PathPrimitiveMoveToCommand.fromPoint(w[1].offset(s,c).multiply(i))),v.push(u.PathPrimitiveMoveToCommand.fromPoint(w[0].offset(l,a).multiply(i))),v.push(u.PathPrimitiveLineToCommand.fromPoint(w[1].offset(l,a).multiply(i))),t=w[1]);b++}if(o.length||(o.push(u.PathPrimitiveMoveToCommand.fromPoint(t.offset(s,c).multiply(i))),v.push(u.PathPrimitiveLineToCommand.fromPoint(t.offset(l,a).multiply(i)))),p){var d=f.y-t.y,g=t.x-f.x,pt=d*(t.x+s)+g*(t.y+c),wt=d*(t.x+l)+g*(t.y+a),nt=p.y-f.y,tt=f.x-p.x,bt=nt*(f.x+et)+tt*(f.y+ot),kt=nt*(f.x+st)+tt*(f.y+ht),it=d*tt-nt*g;0!==it&&(o.push(new u.PathPrimitiveLineToCommand(i*(tt*pt-g*bt)/it,i*(d*bt-nt*pt)/it)),v.push(new u.PathPrimitiveLineToCommand(i*(tt*wt-g*kt)/it,i*(d*kt-nt*wt)/it)));y=(at=[e,vt])[0];rt=at[1]}else o.push(u.PathPrimitiveLineToCommand.fromPoint(f.offset(s,c).multiply(i))),v.push(u.PathPrimitiveMoveToCommand.fromPoint(f.offset(l,a).multiply(i)));t=f}dt=new u.PathPrimitive(o.concat(v.reverse()),h.StrokeStyle.default1pxInstance,n);this.getOrCreateElement("CS",dt,this.rectsContainer)},i.prototype.getSelectionOffset=function(){return r.selectionOffset+o.UnitConverter.pixelsToTwips(Math.round(this.style.strokeWidthPx/2)+(this.style.strokeWidthPx+1)%2)},i.prototype.getSelectionOffsetPoints=function(n,t){var i=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));return[new f.Point(this.getSelectionOffset()/i*(n.y-t.y),this.getSelectionOffset()/i*(t.x-n.x)),i]},i.prototype.getTextStartEndPoints=function(n,t,i,r,u){var s=this.dom.measurer.measureTextLine(r,this.styleText,b.TextOwner.Connector).transform(o.UnitConverter.pixelsToTwips).offset(this.getSelectionOffset(),this.getSelectionOffset()),e=s.width*t+s.height*n;switch(u){case h.TextAlignment.Left:return[i,new f.Point(i.x+t*e,i.y+n*e)];case h.TextAlignment.Right:return[new f.Point(i.x-t*e,i.y-n*e),i];default:return[new f.Point(i.x-.5*t*e,i.y-.5*n*e),new f.Point(i.x+.5*t*e,i.y+.5*n*e)]}},i.prototype.drawConnectorSelectionMarks=function(){var n=this,i=this.points.length-1;this.points.forEach(function(u,f){var o=0===f||f===i,s=o?t.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK:t.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_POINT_MARK,h=o?r.selectionMarkSize:r.connectorPointMarkSize;o||n.lineType===y.ConnectorLineOption.Straight?n.drawSelectionMark(f,u.multiply(n.zoomLevel),h,e.MouseEventElementType.ConnectorPoint,f,s):n.drawSelectionMark(f,u.multiply(n.zoomLevel),h,e.MouseEventElementType.Undefined,-1,s+" disabled")});this.drawConnectorSideMarks()},i.prototype.drawConnectorSideMarks=function(){var n,u,i=this,o=this.lineType===y.ConnectorLineOption.Straight?e.MouseEventElementType.ConnectorSide:e.MouseEventElementType.ConnectorOrthogonalSide;this.renderPoints.filter(function(n){return!n.skipped}).forEach(function(e,s){if(!e.skipped){if(void 0!==n&&i.canDrawConnectorSideMark(e,n)){var h=i.lineType===y.ConnectorLineOption.Orthogonal?e.x-n.x==0?"vertical":"horizontal":"";i.drawSelectionMark(i.points.length+s-1,new f.Point(n.x+(e.x-n.x)/2,n.y+(e.y-n.y)/2).multiply(i.zoomLevel),r.connectorSideMarkSize,o,u+"_"+s,t.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_SIDE_MARK+" "+h)}n=e;u=s}})},i.prototype.canDrawConnectorSideMark=function(n,t){if(this.lineType===y.ConnectorLineOption.Straight){var i=r.selectionMarkSize+r.connectorSideMarkSize;return f.GeometryUtils.getDistance(n,t)>i}return this.lineType===y.ConnectorLineOption.Orthogonal&&(n.x-t.x==0||Math.abs(n.x-t.x)>d.Connector.minOffset)&&(n.y-t.y==0||Math.abs(n.y-t.y)>d.Connector.minOffset)},i}(it)},function(n,t,i){"use strict";var h,c;Object.defineProperty(t,"__esModule",{value:!0});var r,s=i(0),f=i(39),e=i(18),o=i(65),u=i(4),l=i(15),a=function(){function n(n,t,i,f,e){this.readOnly=t;this.allowDragging=i;this.shapeDescriptionManager=f;this.shapeTypes=e;this.dragPrepareTimeout=-1;this.dragState=r.None;this.emulateDragEvents=u.Browser.WebKitTouchUI||u.Browser.AndroidMobilePlatform;this.onDragOperation=new s.EventDispatcher;this.onClickOperation=new s.EventDispatcher;n&&(this.mainElement=this.createMainElement(n),this.attachHandlers(this.mainElement))}return n.prototype.clean=function(){this.detachHandlers(this.mainElement);l.RenderUtils.removeElement(this.mainElement)},n.prototype.createMainElement=function(n){var t=document.createElement("div");return t.setAttribute("class","dxdi-toolbox"),t.draggable=!0,this.emulateDragEvents&&(t.tabIndex=0),n.appendChild(t),t},n.prototype.attachHandlers=function(n){this.onClickHandler=this.onClick.bind(this);this.onMouseDownHandler=this.onMouseDown.bind(this);this.onMouseMoveHandler=this.onMouseMove.bind(this);this.onMouseUpHandler=this.onMouseUp.bind(this);this.onDragStartHandler=this.onDragStart.bind(this);this.onTouchMoveHandler=this.onTouchMove.bind(this);this.emulateDragEvents&&(this.onSelectionChangeHandler=this.onSelectionChange.bind(this));this.emulateDragEvents||u.RenderHelper.addEventListener(n,"dragstart",this.onDragStartHandler);u.RenderHelper.addEventListener(n,"touchmove",this.onTouchMoveHandler);u.RenderHelper.addEventListener(n,"click",this.onClickHandler);u.RenderHelper.addEventListener(n,o.TouchUIHelper.touchMouseDownEventName,this.onMouseDownHandler);u.RenderHelper.addEventListener(document,o.TouchUIHelper.touchMouseMoveEventName,this.onMouseMoveHandler);u.RenderHelper.addEventListener(document,o.TouchUIHelper.touchMouseUpEventName,this.onMouseUpHandler);this.emulateDragEvents&&u.RenderHelper.addEventListener(document,"selectionchange",this.onSelectionChangeHandler)},n.prototype.detachHandlers=function(n){this.emulateDragEvents||u.RenderHelper.removeEventListener(n,"dragstart",this.onDragStartHandler);u.RenderHelper.removeEventListener(n,"touchmove",this.onTouchMoveHandler);u.RenderHelper.removeEventListener(n,"click",this.onClickHandler);u.RenderHelper.removeEventListener(n,o.TouchUIHelper.touchMouseDownEventName,this.onMouseDownHandler);u.RenderHelper.removeEventListener(document,o.TouchUIHelper.touchMouseMoveEventName,this.onMouseMoveHandler);u.RenderHelper.removeEventListener(document,o.TouchUIHelper.touchMouseUpEventName,this.onMouseUpHandler);this.emulateDragEvents&&u.RenderHelper.removeEventListener(document,"selectionchange",this.onSelectionChangeHandler)},n.prototype.render=function(n){this.mainElement.childNodes&&(this.mainElement.innerHTML="");var t=n?this.shapeTypes.filter(n):this.shapeTypes;return t.length&&this.createElements(this.mainElement,t),!!t.length},n.prototype.createDraggingObject=function(n){var t=new c;return t.data=n,t.onFinishDragging=this.finishDragging.bind(this),t.onCaptured=this.capture.bind(this),new h(t)},n.prototype.getDragShapeType=function(n){for(;n&&!e.ElementHasCssClass(n,"dxdi-toolbox");){if(n.getAttribute&&n.getAttribute("data-tb-type"))return n.getAttribute("data-tb-type");n=n.parentNode}},n.prototype.onClick=function(n){var t=this.getDragShapeType(f.Evt.GetEventSource(n));t&&this.onClickOperation.raise("notifyToolboxClick",t)},n.prototype.onMouseDown=function(n){this.setDragState(r.Prepare,n)},n.prototype.onDragStart=function(n){this.setDragState(r.Start,n);n.preventDefault()},n.prototype.onTouchMove=function(n){this.draggingObject&&n.preventDefault()},n.prototype.onSelectionChange=function(){},n.prototype.onMouseMove=function(n){this.setDragState(f.Evt.IsLeftButtonPressed(n)?r.Dragging:r.None,n)},n.prototype.onMouseUp=function(n){this.setDragState(r.None,n)},n.prototype.updateDraggingElementPosition=function(n,t){var i=this.draggingObject.element,r=n-i.offsetWidth/2,u=t-i.offsetHeight/2;e.SetAbsoluteX(i,r);e.SetAbsoluteY(i,u)},n.prototype.setDragState=function(n,t){if(!this.readOnly&&this.allowDragging&&!(n===r.None&&n===this.dragState||(this.dragPrepareTimeout>-1&&(clearTimeout(this.dragPrepareTimeout),this.dragPrepareTimeout=-1),n-this.dragState>1||n!==r.None&&n<this.dragState)))switch(this.dragState=n,n){case r.Prepare:this.prepareDragging(t)||this.setDragState(r.None,t);this.emulateDragEvents&&(this.dragPrepareTimeout=setTimeout(this.onDragPrepareTimeout.bind(this),800));break;case r.Start:e.ToggleElementClassName(document.body,"dxdi-dragging",!0);this.startDragging();break;case r.Dragging:this.doDragging(t);break;case r.None:this.finishDragging()}},n.prototype.onDragPrepareTimeout=function(){this.dragPrepareTimeout=-1;this.dragState===r.Prepare&&this.setDragState(r.Start,null)},n.prototype.prepareDragging=function(n){return this.dragStartPoint=new s.Point(f.Evt.GetEventX(n),f.Evt.GetEventY(n)),this.dragStartShapeType=this.getDragShapeType(f.Evt.GetEventSource(n)),this.emulateDragEvents&&this.mainElement.focus(),!!this.dragStartShapeType},n.prototype.startDragging=function(){this.draggingObject=this.createDraggingObject(this.dragStartShapeType);this.raiseDragStart();this.draggingObject.element=this.createDraggingElement(this.draggingObject);void 0!==this.draggingObject.captured&&this.capture(this.draggingObject.captured,!0);this.updateDraggingElementPosition(this.dragStartPoint.x,this.dragStartPoint.y)},n.prototype.doDragging=function(n){this.draggingObject.element&&this.updateDraggingElementPosition(f.Evt.GetEventX(n),f.Evt.GetEventY(n))},n.prototype.finishDragging=function(){if(this.draggingObject){this.raiseDragEnd();var n=this.draggingObject.element;n&&n.parentNode.removeChild(n);delete this.draggingObject}this.dragStartPoint=void 0;this.dragStartShapeType=void 0;setTimeout(function(){return e.ToggleElementClassName(document.body,"dxdi-dragging",!1)},500)},n.prototype.capture=function(n,t){this.draggingObject&&(this.draggingObject.captured!==n||t)&&(this.draggingObject.captured=n,this.draggingObject.element&&e.ToggleElementClassName(this.draggingObject.element,"dxdi-tb-drag-captured",n))},n.prototype.raiseDragStart=function(){this.onDragOperation.raise("notifyToolboxDragStart")},n.prototype.raiseDragEnd=function(){this.onDragOperation.raise("notifyToolboxDragEnd")},n.prototype.notifyReadOnlyChanged=function(n){this.readOnly=n},n}();t.Toolbox=a,function(n){n[n.None=-1]="None";n[n.Prepare=0]="Prepare";n[n.Start=1]="Start";n[n.Dragging=2]="Dragging"}(r||(r={}));h=function(){return function(n){this.evt=n}}();t.ToolboxDraggingObject=h;c=function(){return function(){}}();t.DiagramDraggingEvent=c},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(7);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty()},t.prototype.executeCore=function(){return u.ModelUtils.deleteSelection(this.control.history,this.control.model,this.control.selection),!0},t}(i(8).SimpleCommandBase);t.DeleteCommand=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.shapeKey=t,r.position=i,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);this.oldPosition=t.position.clone();n.moveShape(t,this.position)},t.prototype.undo=function(n){var t=n.model.findShape(this.shapeKey);n.moveShape(t,this.oldPosition)},t}(i(3).HistoryItem);t.MoveShapeHistoryItem=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.stringCompare=function(n,t){return n==t?0:n>t?1:-1},n.stringHashCode=function(n){var t=0,r,i;if(0===n.length)return t;for(r=n.length,i=0;i<r;i++)t=(t<<5)-t+n.charCodeAt(i),t|=0;return t},n.endsAt=function(n,t){var i=n.length-1,r=t.length-1,u=i-r;if(u<0)return!1;for(;i>=u;i--,r--)if(n[i]!=t[r])return!1;return!0},n.startsAt=function(n,t){return n.substr(0,t.length)==t},n.stringInLowerCase=function(n){return n.toLowerCase()==n},n.stringInUpperCase=function(n){return n.toUpperCase()==n},n.inStringAtLeastOneSymbolInUpperCase=function(t){for(var i,r=0;i=t[r];r++)if(n.stringInUpperCase(i)&&!n.stringInLowerCase(i))return!0;return!1},n.getSymbolFromEnd=function(n,t){return n[n.length-t]},n.stringTrim=function(n,t){void 0===t&&(t=["\\s"]);var i=t.join("");return n.replace(new RegExp("(^["+i+"]*)|(["+i+"]*$)","g"),"")},n.stringTrimStart=function(n){return n.replace(/(^\s*)/g,"")},n.stringTrimEnd=function(n,t){return void 0===t&&(t="\\s"),n.replace(new RegExp(t+"*$"),"")},n.stringCustomTrim=function(n,t){for(var u,i=0,r=t;i<r.length;i++)u=r[i],n=n.replace(new RegExp("(^"+u+"*)|("+u+"*)$","g"),"");return n},n.mergeStringNTimes=function(n,t){return new Array(t<=0?0:t+1).join(n)},n.getDecimalSeparator=function(){return 1.1.toLocaleString().substr(1,1)},n.strCompare=function(n,t,i){return void 0===i&&(i=!1),i&&(n=n.toLowerCase(),t=t.toLowerCase()),n==t?0:n>t?1:-1},n.repeat=function(n,t){for(var i="",r=1;r<=t;r++)i+=n;return i},n.isNullOrEmpty=function(n){return!n||!n.length},n.padLeft=function(t,i,r){return n.mergeStringNTimes(r,Math.max(0,i-t.length))+t},n}();t.StringUtils=i},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(86),e=i(27),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getPoints=function(){return this.connector.points.map(function(n,t){return new e.ConnectorRenderPoint(n.x,n.y,t)})},t}(f.ConnectorPointsCalculatorBase);t.ConnectorPointsCalculator=o},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(0),r=i(5),s=i(86),h=i(142),c=i(143),l=i(144),a=i(145),v=i(146),f=i(27),y=function(n){function t(t){var i=n.call(this,t)||this;return i.sideCalculators={},i.sideCalculators[r.ConnectionPointSide.Undefined]=new h.ConnectorPointsOrthogonalUndefinedSideCalculator(i),i.sideCalculators[r.ConnectionPointSide.South]=new c.ConnectorPointsOrthogonalSouthSideCalculator(i),i.sideCalculators[r.ConnectionPointSide.North]=new l.ConnectorPointsOrthogonalNorthSideCalculator(i),i.sideCalculators[r.ConnectionPointSide.East]=new a.ConnectorPointsOrthogonalEastSideCalculator(i),i.sideCalculators[r.ConnectionPointSide.West]=new v.ConnectorPointsOrthogonalWestSideCalculator(i),i}return o(t,n),Object.defineProperty(t.prototype,"beginRect",{get:function(){if(this.connector.beginItem)return this.connector.beginItem.rectangle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endRect",{get:function(){if(this.connector.endItem)return this.connector.endItem.rectangle},enumerable:!0,configurable:!0}),t.prototype.getPoints=function(){var n=this.connector.points.map(function(n,t){return new f.ConnectorRenderPoint(n.x,n.y,t)}),e,i,o,c;this.removeUnnecessaryLinePoints(n);var t=0,r=n.length-1,a=this.getPointSide(n,0),l=this.getPointSide(n,1),v=this.getPointSide(n,n.length-1),y=this.getPointSide(n,n.length-2),u=this.getSideCalculator(a),p=this.getSideCalculator(v),w=this.beginRect,s=u.getCorrectOriginPoint(n[t],w),h=n[t+1];if(2===n.length&&u.isOnSidePoint(s,h)&&u.isDirectConnectionAllowed(l,s,h))u.getDirectConnectionPoints(s,h).forEach(function(i){n.splice(t+1,0,i);t++;r++});else for(e=u.getBeginOffsetPoints(l,n[t],n[t+1],this.beginRect),e.forEach(function(i){n.splice(t+1,0,i)}),t+=e.length,r+=e.length,p.getEndOffsetPoints(y,n[r],n[r-1],this.endRect).forEach(function(t,i){n.splice(r+i,0,t)}),i=t;i<r;i++)o=i+1,c=this.getMiddlePoint(n[i],n[i-1],i-1==0,n[o],n[o+1],o+1===n.length-1),void 0!==c&&(n.splice(i+1,0,c),i++,r++);return this.removeUnnecessaryLinePoints(n),n},t.prototype.getSideCalculator=function(n){return this.sideCalculators[n]},t.prototype.getPointSide=function(n,t){if(0===t&&this.connector.beginItem){var i=this.connector.beginConnectionPointIndex;return this.connector.beginItem.getConnectionPointSideByIndex(i,n[1])}return t===n.length-1&&this.connector.endItem?(i=this.connector.endConnectionPointIndex,this.connector.endItem.getConnectionPointSideByIndex(i,n[n.length-2])):r.ConnectionPointSide.Undefined},t.prototype.getMiddlePoints=function(n,t){return n.x===t.x||n.y===t.y?[]:[new f.ConnectorRenderPoint(n.x,t.y),new f.ConnectorRenderPoint(t.x,n.y)]},t.prototype.getMiddlePoint=function(n,t,i,r,u){var e,f=this,o=this.getMiddlePoints(n,r);return o.forEach(function(i){var h=f.createPointsRect(n,i),c=f.createPointsRect(i,r),o=f.connector.beginItem?f.connector.beginItem.rectangle:void 0,s=f.connector.endItem?f.connector.endItem.rectangle:void 0;o&&(o.intersect(h)||o.intersect(c))||s&&(s.intersect(h)||s.intersect(c))||f.isReturnPoint(i,n,t)&&!f.isIntermediatePoints(n,t)||f.isReturnPoint(i,r,u)&&!f.isIntermediatePoints(r,u)||(void 0===e?e=i:f.isPriorMiddlePoint(i,n,t,r,u)&&(e=i))}),void 0===e&&o.length>0&&(e=o[0]),e},t.prototype.createPointsRect=function(n,t){var i=e.Rectangle.createByPoints(n,t);return i.width>0&&(i=i.inflate(-1,0)),i.height>0&&(i=i.inflate(0,-1)),i},t.prototype.isPriorMiddlePoint=function(n,t,i,r,u){return!(!i||n.x!==i.x&&n.y!==i.y)||!(!u||n.x!==u.x&&n.y!==u.y)},t.prototype.isReturnPoint=function(n,t,i){return void 0!==t&&void 0!==i&&(n.x===i.x&&(t.y<n.y&&n.y<i.y||t.y>n.y&&n.y>i.y)||n.y===i.y&&(t.x<n.x&&n.x<i.x||t.x>n.x&&n.x>i.x))?!0:!1},t.prototype.isIntermediatePoints=function(n,t){return 0<n.pointIndex&&n.pointIndex<this.connector.points.length-1&&0<t.pointIndex&&t.pointIndex<this.connector.points.length-1},t.prototype.removeUnnecessaryLinePoints=function(n){e.GeometryUtils.removeUnnecessaryLinePoints(n,function(t,i){return-1===t.pointIndex?(n.splice(i,1),!0):(t.skipped=!0,!1)},function(n){return void 0!==n&&!n.skipped})},t}(s.ConnectorPointsCalculatorBase);t.ConnectorPointsOrthogonalCalculator=y},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(37),r=i(27),o=function(n){function t(t){return n.call(this,t)||this}return f(t,n),t.prototype.getCorrectOriginPoint=function(n){return n},t.prototype.getSameShapeOffsetPoints=function(){return[]},t.prototype.getOverlappedPointsOffsetPoints=function(){return[]},t.prototype.getBeginOverlappedShapeOffsetPoints=function(){return[]},t.prototype.getEndOverlappedShapeOffsetPoints=function(){return[]},t.prototype.getBeginOnSideOffsetPoints=function(){return[]},t.prototype.getEndOnSideOffsetPoints=function(){return[]},t.prototype.getBeginOffSideOffsetPoints=function(){return[]},t.prototype.getEndOffSideOffsetPoints=function(){return[]},t.prototype.isOnSidePoint=function(){return!0},t.prototype.isDirectConnectionAllowed=function(n,t,i){var r=this.getSideCalculator(t,i);return void 0===r||r.isDirectConnectionAllowed(n,t,i)},t.prototype.getDirectConnectionPoints=function(n,t){var f=Math.abs(t.x-n.x),e=Math.abs(t.y-n.y),i,u;return f>e?(i=Math.min(n.x,t.x)+f/2,[new r.ConnectorRenderPoint(i,n.y),new r.ConnectorRenderPoint(i,t.y)]):(u=Math.min(n.y,t.y)+e/2,[new r.ConnectorRenderPoint(n.x,u),new r.ConnectorRenderPoint(t.x,u)])},t}(e.ConnectorPointsOrthogonalSideCalculatorBase);t.ConnectorPointsOrthogonalUndefinedSideCalculator=o},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(37),f=i(27),s=function(n){function t(t){return n.call(this,t)||this}return e(t,n),t.prototype.getCorrectOriginPoint=function(n,t){return n.y<t.bottom&&(n=n.offset(0,t.bottom-n.y)),n},t.prototype.getSameShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:case r.ConnectionPointSide.West:case r.ConnectionPointSide.South:return[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.North:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset())}},t.prototype.getOverlappedPointsOffsetPoints=function(n,t){switch(n){case r.ConnectionPointSide.South:return[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.North:return[t.offset(0,-this.getMinOffset())]}return[]},t.prototype.getBeginOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:return t.y<i.y?t.x>i.x?[]:[t.offset(0,this.getMinOffset())]:t.y>this.endRect.bottom?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.West:return t.y<i.y?t.x<i.x?[]:[t.offset(0,this.getMinOffset())]:t.y>this.endRect.bottom?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.South:return[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.North:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),t.x<i.x)}},t.prototype.getEndOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:return i.y<t.y?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):t.x<i.x?[t.offset(0,this.getMinOffset())]:[];case r.ConnectionPointSide.West:return i.y<t.y?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):t.x>i.x?[t.offset(0,this.getMinOffset())]:[];case r.ConnectionPointSide.South:return[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.North:var f=this.getMinOffset();return this.beginRect.bottom>t.y&&(f+=this.beginRect.bottom-t.y),[t.offset(0,f)]}},t.prototype.getBeginOnSideOffsetPoints=function(n,t,i){return[t.offset(0,this.getScaleableOffsetY(t,i,!1))]},t.prototype.getEndOnSideOffsetPoints=function(n,t,i){return[t.offset(0,this.getScaleableOffsetY(t,i,!0))]},t.prototype.getBeginOffSideOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!1);break;case r.ConnectionPointSide.West:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!0);break;case r.ConnectionPointSide.South:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(t,i,u,!1);break;case r.ConnectionPointSide.Undefined:case r.ConnectionPointSide.North:return this.getScaleableAsideOffsetPoints(t,i,u,!1)}return[t.offset(0,this.getScaleableOffsetY(t,i,!1))]},t.prototype.getEndOffSideOffsetPoints=function(n,t,i,u){if(n===r.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(t,i,u,!0);if(this.isBeginEndOverlappedX()){var f=this.beginRect.center.x>this.endRect.center.x;return this.getScaleableAsideOffsetPoints(t,i,u,!0,f)}return[t.offset(0,this.getScaleableOffsetY(t,i,!0))]},t.prototype.getAsideOffsetPoints=function(n,t,i,r,u,f){var e=[];return void 0!==i&&(void 0===f&&(f=t.x<n.x),f?e.push(n.offset(-(n.x-i.left+u),r)):e.push(n.offset(i.right-n.x+u,r))),e.push(n.offset(0,r)),e},t.prototype.getScaleableAsideOffsetPoints=function(n,t,i,r,u){var f=this.getScaleableOffsetY(n,t,r),e=this.getScaleableOffsetX(n,t,r);return this.getAsideOffsetPoints(n,t,i,f,e,u)},t.prototype.getScaleableOffsetX=function(n,t,i){if(this.beginRect&&this.endRect&&!i&&!this.isBeginEndOverlappedX()){var r=void 0;if((r=t.x<n.x?this.beginRect.left-this.endRect.right:this.endRect.left-this.beginRect.right)<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.getScaleableOffsetY=function(n,t,i){if(this.beginRect&&this.endRect){var r=i?this.beginRect.top-n.y:this.endRect.top-n.y;if(r>0&&r<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.isOnSidePoint=function(n,t){return t.y>n.y},t.prototype.isDirectConnectionAllowed=function(n){return n===r.ConnectionPointSide.North||n===r.ConnectionPointSide.Undefined},t.prototype.getDirectConnectionPoints=function(n,t){var i=n.y+(t.y-n.y)/2;return[new f.ConnectorRenderPoint(n.x,i),new f.ConnectorRenderPoint(t.x,i)]},t}(o.ConnectorPointsOrthogonalSideCalculatorBase);t.ConnectorPointsOrthogonalSouthSideCalculator=s},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(37),f=i(27),s=function(n){function t(t){return n.call(this,t)||this}return e(t,n),t.prototype.getCorrectOriginPoint=function(n,t){return n.y>t.top&&(n=n.offset(0,t.top-n.y)),n},t.prototype.getSameShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:case r.ConnectionPointSide.West:case r.ConnectionPointSide.North:return[t.offset(0,-this.getMinOffset())];case r.ConnectionPointSide.South:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset())}},t.prototype.getOverlappedPointsOffsetPoints=function(n,t){switch(n){case r.ConnectionPointSide.South:return[t.offset(0,this.getMinOffset())];case r.ConnectionPointSide.North:return[t.offset(0,-this.getMinOffset())]}return[]},t.prototype.getBeginOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:return t.y>i.y?t.x>i.x?[]:[t.offset(0,-this.getMinOffset())]:t.y<this.endRect.top?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):[t.offset(0,-this.getMinOffset())];case r.ConnectionPointSide.West:return t.y>i.y?t.x<i.x?[]:[t.offset(0,-this.getMinOffset())]:t.y<this.endRect.top?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):[t.offset(0,-this.getMinOffset())];case r.ConnectionPointSide.North:return[t.offset(0,-this.getMinOffset())];case r.ConnectionPointSide.South:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),t.x<i.x)}},t.prototype.getEndOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:return i.y>t.y?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):t.x<i.x?[t.offset(0,-this.getMinOffset())]:[];case r.ConnectionPointSide.West:return i.y>t.y?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):t.x>i.x?[t.offset(0,-this.getMinOffset())]:[];case r.ConnectionPointSide.North:return[t.offset(0,-this.getMinOffset())];case r.ConnectionPointSide.South:var f=-this.getMinOffset();return this.beginRect.top<t.y&&(f-=t.y-this.beginRect.top),[t.offset(0,f)]}},t.prototype.getBeginOnSideOffsetPoints=function(n,t,i){return[t.offset(0,-this.getScaleableOffsetY(t,i,!1))]},t.prototype.getEndOnSideOffsetPoints=function(n,t,i){return[t.offset(0,-this.getScaleableOffsetY(t,i,!0))]},t.prototype.getBeginOffSideOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!1);break;case r.ConnectionPointSide.West:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!0);break;case r.ConnectionPointSide.North:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(t,i,u,!1);break;case r.ConnectionPointSide.Undefined:case r.ConnectionPointSide.South:return this.getScaleableAsideOffsetPoints(t,i,u,!1)}return[t.offset(0,-this.getScaleableOffsetY(t,i,!1))]},t.prototype.getEndOffSideOffsetPoints=function(n,t,i,u){if(n===r.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(t,i,u,!0);if(this.isBeginEndOverlappedX()){var f=this.beginRect.center.x>this.endRect.center.x;return this.getScaleableAsideOffsetPoints(t,i,u,!0,f)}return[t.offset(0,-this.getScaleableOffsetY(t,i,!0))]},t.prototype.getAsideOffsetPoints=function(n,t,i,r,u,f){var e=[];return void 0!==i&&(void 0===f&&(f=t.x<n.x),f?e.push(n.offset(-(n.x-i.left+u),-r)):e.push(n.offset(i.right-n.x+u,-r))),e.push(n.offset(0,-r)),e},t.prototype.getScaleableAsideOffsetPoints=function(n,t,i,r,u){var f=this.getScaleableOffsetY(n,t,r),e=this.getScaleableOffsetX(n,t,r);return this.getAsideOffsetPoints(n,t,i,f,e,u)},t.prototype.getScaleableOffsetX=function(n,t,i){if(this.beginRect&&this.endRect&&!i&&!this.isBeginEndOverlappedX()){var r=void 0;if((r=t.x<n.x?this.beginRect.left-this.endRect.right:this.endRect.left-this.beginRect.right)<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.getScaleableOffsetY=function(n,t,i){if(this.beginRect&&this.endRect){var r=i?n.y-this.beginRect.bottom:n.y-this.endRect.bottom;if(r>0&&r<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.isOnSidePoint=function(n,t){return t.y<n.y},t.prototype.isDirectConnectionAllowed=function(n){return n===r.ConnectionPointSide.South||n===r.ConnectionPointSide.Undefined},t.prototype.getDirectConnectionPoints=function(n,t){var i=t.y+(n.y-t.y)/2;return[new f.ConnectorRenderPoint(n.x,i),new f.ConnectorRenderPoint(t.x,i)]},t}(o.ConnectorPointsOrthogonalSideCalculatorBase);t.ConnectorPointsOrthogonalNorthSideCalculator=s},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(37),f=i(27),s=function(n){function t(t){return n.call(this,t)||this}return e(t,n),t.prototype.getCorrectOriginPoint=function(n,t){return n.x<t.right&&(n=n.offset(t.right-n.x,0)),n},t.prototype.getSameShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.North:case r.ConnectionPointSide.South:case r.ConnectionPointSide.East:return[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.West:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset())}},t.prototype.getOverlappedPointsOffsetPoints=function(n,t){switch(n){case r.ConnectionPointSide.East:return[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.West:return[t.offset(-this.getMinOffset(),0)]}return[]},t.prototype.getBeginOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.North:return t.x<i.x?t.y<i.y?[]:[t.offset(this.getMinOffset(),0)]:t.x>this.endRect.right?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.South:return t.x<i.x?t.y>i.y?[]:[t.offset(this.getMinOffset(),0)]:t.x>this.endRect.right?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.East:return[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.West:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),t.y<i.y)}},t.prototype.getEndOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:return[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.West:var f=this.getMinOffset();return this.beginRect.right>t.x&&(f+=this.beginRect.right-t.x),[t.offset(f,0)];case r.ConnectionPointSide.North:return i.x<t.x?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):t.y>i.y?[t.offset(this.getMinOffset(),0)]:[];case r.ConnectionPointSide.South:return i.x<t.x?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):t.y<i.y?[t.offset(this.getMinOffset(),0)]:[]}},t.prototype.getBeginOnSideOffsetPoints=function(n,t,i){return[t.offset(this.getScaleableOffsetX(t,i,!1),0)]},t.prototype.getEndOnSideOffsetPoints=function(n,t,i){return[t.offset(this.getScaleableOffsetX(t,i,!0),0)]},t.prototype.getBeginOffSideOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.South:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!1);break;case r.ConnectionPointSide.North:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!0);break;case r.ConnectionPointSide.East:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(t,i,u,!1);break;case r.ConnectionPointSide.Undefined:case r.ConnectionPointSide.West:return this.getScaleableAsideOffsetPoints(t,i,u,!1)}return[t.offset(this.getScaleableOffsetX(t,i,!1),0)]},t.prototype.getEndOffSideOffsetPoints=function(n,t,i,u){if(n===r.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(t,i,u,!0);if(this.isBeginEndOverlappedY()){var f=this.beginRect.center.y>this.endRect.center.y;return this.getScaleableAsideOffsetPoints(t,i,u,!0,f)}return[t.offset(this.getScaleableOffsetX(t,i,!0),0)]},t.prototype.getAsideOffsetPoints=function(n,t,i,r,u,f){var e=[];return void 0!==i&&(void 0===f&&(f=t.y<n.y),f?e.push(n.offset(r,-(n.y-i.top+u))):e.push(n.offset(r,i.bottom-n.y+u))),e.push(n.offset(r,0)),e},t.prototype.getScaleableAsideOffsetPoints=function(n,t,i,r,u){var f=this.getScaleableOffsetX(n,t,r),e=this.getScaleableOffsetY(n,t,r);return this.getAsideOffsetPoints(n,t,i,f,e,u)},t.prototype.getScaleableOffsetX=function(n,t,i){if(this.beginRect&&this.endRect){var r=i?this.beginRect.left-n.x:this.endRect.left-n.x;if(r>0&&r<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.getScaleableOffsetY=function(n,t,i){if(this.beginRect&&this.endRect&&!i&&!this.isBeginEndOverlappedY()){var r=void 0;if((r=t.y<n.y?this.beginRect.top-this.endRect.bottom:this.endRect.top-this.beginRect.bottom)<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.isOnSidePoint=function(n,t){return t.x>n.x},t.prototype.isDirectConnectionAllowed=function(n){return n===r.ConnectionPointSide.West||n===r.ConnectionPointSide.Undefined},t.prototype.getDirectConnectionPoints=function(n,t){var i=n.x+(t.x-n.x)/2;return[new f.ConnectorRenderPoint(i,n.y),new f.ConnectorRenderPoint(i,t.y)]},t}(o.ConnectorPointsOrthogonalSideCalculatorBase);t.ConnectorPointsOrthogonalEastSideCalculator=s},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(37),f=i(27),s=function(n){function t(t){return n.call(this,t)||this}return e(t,n),t.prototype.getCorrectOriginPoint=function(n,t){return n.x>t.left&&(n=n.offset(t.left-n.x,0)),n},t.prototype.getSameShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.North:case r.ConnectionPointSide.South:case r.ConnectionPointSide.West:return[t.offset(-this.getMinOffset(),0)];case r.ConnectionPointSide.East:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset())}},t.prototype.getOverlappedPointsOffsetPoints=function(n,t){switch(n){case r.ConnectionPointSide.East:return[t.offset(this.getMinOffset(),0)];case r.ConnectionPointSide.West:return[t.offset(-this.getMinOffset(),0)]}return[]},t.prototype.getBeginOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.North:return t.x>i.x?t.y<i.y?[]:[t.offset(-this.getMinOffset(),0)]:t.x<this.endRect.left?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):[t.offset(-this.getMinOffset(),0)];case r.ConnectionPointSide.South:return t.x>i.x?t.y>i.y?[]:[t.offset(-this.getMinOffset(),0)]:t.x<this.endRect.left?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):[t.offset(-this.getMinOffset(),0)];case r.ConnectionPointSide.West:return[t.offset(-this.getMinOffset(),0)];case r.ConnectionPointSide.East:return this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),t.y<i.y)}},t.prototype.getEndOverlappedShapeOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.East:var f=-this.getMinOffset();return this.beginRect.left<t.x&&(f-=t.x-this.beginRect.left),[t.offset(f,0)];case r.ConnectionPointSide.West:return[t.offset(-this.getMinOffset(),0)];case r.ConnectionPointSide.North:return i.x>t.x?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!0):t.y>i.y?[t.offset(-this.getMinOffset(),0)]:[];case r.ConnectionPointSide.South:return i.x>t.x?this.getAsideOffsetPoints(t,i,u,this.getMinOffset(),this.getMinOffset(),!1):t.y<i.y?[t.offset(-this.getMinOffset(),0)]:[]}},t.prototype.getBeginOnSideOffsetPoints=function(n,t,i){return[t.offset(-this.getScaleableOffsetX(t,i,!1),0)]},t.prototype.getEndOnSideOffsetPoints=function(n,t,i){return[t.offset(-this.getScaleableOffsetX(t,i,!0),0)]},t.prototype.getBeginOffSideOffsetPoints=function(n,t,i,u){switch(n){case r.ConnectionPointSide.South:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!1);break;case r.ConnectionPointSide.North:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(t,i,u,!1,!0);break;case r.ConnectionPointSide.West:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(t,i,u,!1);break;case r.ConnectionPointSide.Undefined:case r.ConnectionPointSide.East:return this.getScaleableAsideOffsetPoints(t,i,u,!1)}return[t.offset(-this.getScaleableOffsetX(t,i,!1),0)]},t.prototype.getEndOffSideOffsetPoints=function(n,t,i,u){if(n===r.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(t,i,u,!0);if(this.isBeginEndOverlappedY()){var f=this.beginRect.center.y>this.endRect.center.y;return this.getScaleableAsideOffsetPoints(t,i,u,!0,f)}return[t.offset(-this.getScaleableOffsetX(t,i,!0),0)]},t.prototype.getAsideOffsetPoints=function(n,t,i,r,u,f){var e=[];return void 0!==i&&(void 0===f&&(f=t.y<n.y),f?e.push(n.offset(-r,-(n.y-i.top+u))):e.push(n.offset(-r,i.bottom-n.y+u))),e.push(n.offset(-r,0)),e},t.prototype.getScaleableAsideOffsetPoints=function(n,t,i,r,u){var f=this.getScaleableOffsetX(n,t,r),e=this.getScaleableOffsetY(n,t,r);return this.getAsideOffsetPoints(n,t,i,f,e,u)},t.prototype.getScaleableOffsetX=function(n,t,i){if(this.beginRect&&this.endRect){var r=i?n.x-this.beginRect.right:n.x-this.endRect.right;if(r>0&&r<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.getScaleableOffsetY=function(n,t,i){if(this.beginRect&&this.endRect&&!i&&!this.isBeginEndOverlappedY()){var r=void 0;if((r=t.y<n.y?this.beginRect.top-this.endRect.bottom:this.endRect.top-this.beginRect.bottom)<2*this.getMinOffset())return r/2}return this.getMinOffset()},t.prototype.isOnSidePoint=function(n,t){return t.x<n.x},t.prototype.isDirectConnectionAllowed=function(n){return n===r.ConnectionPointSide.East||n===r.ConnectionPointSide.Undefined},t.prototype.getDirectConnectionPoints=function(n,t){var i=t.x+(n.x-t.x)/2;return[new f.ConnectorRenderPoint(i,n.y),new f.ConnectorRenderPoint(i,t.y)]},t}(o.ConnectorPointsOrthogonalSideCalculatorBase);t.ConnectorPointsOrthogonalWestSideCalculator=s},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0});i=function(){return function(n,t){this.position=n;this.value=t}}();t.ConnectorText=i;r=function(){function n(){this.items={}}return n.prototype.get=function(n){return this.items[n]},n.prototype.set=function(n,t){this.items[n]=t},n.prototype.remove=function(n){delete this.items[n]},n.prototype.map=function(n){var t=[];return this.forEach(function(i){return t.push(n(i))}),t},n.prototype.forEach=function(n){for(var t in this.items)this.items.hasOwnProperty(t)&&n(this.items[t])},n.prototype.clone=function(){var t=new n;return this.forEach(function(n){t.set(n.position,new i(n.position,n.value))}),t},n.prototype.toObject=function(){var n={},t=!1;return this.forEach(function(i){n[i.position]=i.value;t=!0}),t?n:null},n.prototype.fromObject=function(n){var t,r;for(t in n)n.hasOwnProperty(t)&&(r=parseFloat(t),isNaN(r)||"string"!=typeof n[t]||this.set(r,new i(r,n[t])))},n}();t.ConnectorTexts=r},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(18),u=function(){function n(){}return n.TrimStart=function(t){return n.trimInternal(t,!0,!1)},n.TrimEnd=function(t){return n.trimInternal(t,!1,!0)},n.Trim=function(t){return n.trimInternal(t,!0,!0)},n.EncodeHtml=function(t){return n.ApplyReplacement(t,[[/&amp;/g,"&ampx;"],[/&/g,"&amp;"],[/&quot;/g,"&quotx;"],[/"/g,"&quot;"],[/&lt;/g,"&ltx;"],[/</g,"&lt;"],[/&gt;/g,"&gtx;"],[/>/g,"&gt;"]])},n.trimInternal=function(t,i,r){var u=t.length,f,e;if(!u)return t;if(u<764833)return f=t,i&&(f=f.replace(/^\s+/,"")),r&&(f=f.replace(/\s+$/,"")),f;if(e=0,r)for(;u>0&&n.whiteSpaces[t.charCodeAt(u-1)];)u--;if(i&&u>0)for(;e<u&&n.whiteSpaces[t.charCodeAt(e)];)e++;return t.substring(e,u)},n.ApplyReplacement=function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n=n.replace(r[0],r[1]);return n},n.DecodeHtmlViaTextArea=function(n){var t=document.createElement("TEXTAREA");return r.setInnerHtmlInternal(t,n),t.value},n.whiteSpaces={9:1,10:1,11:1,12:1,13:1,32:1,133:1,160:1,5760:1,6158:1,8192:1,8193:1,8194:1,8195:1,8196:1,8197:1,8198:1,8199:1,8200:1,8201:1,8202:1,8203:1,8232:1,8233:1,8239:1,8287:1,12288:1},n}();t.Str=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(24),u=function(){function n(){}return n.SetAttribute=function(t,i,r){t.setAttribute?(n.isSourceResetRequired()&&"src"===i.toLowerCase()&&t.setAttribute(i,""),t.setAttribute(i,r)):t.setProperty&&t.setProperty(i,r,"")},n.GetAttribute=function(n,t){if(n.getAttribute)return n.getAttribute(t);if(n.getPropertyValue){if(r.Browser.Firefox)try{return n.getPropertyValue(t)}catch(i){return n[t]}return n.getPropertyValue(t)}return null},n.GetTabIndexAttributeName=function(){return r.Browser.IE?"tabIndex":"tabindex"},n.ChangeStyleAttribute=function(t,i,r){n.ChangeAttributeExtended(t.style,i,t,"saved"+i,r)},n.ChangeAttributeExtended=function(t,i,r,u,f){n.SaveAttribute(t,i,r,u);n.SetAttribute(t,i,f)},n.SaveAttribute=function(t,i,r,u){if(!n.IsExistsAttribute(r,u)){var f=n.IsExistsAttribute(t,i)?n.GetAttribute(t,i):n.EmptyObject;n.SetAttribute(r,u,f)}},n.RestoreAttributeExtended=function(t,i,r,u){if(n.IsExistsAttribute(r,u)){var f=n.GetAttribute(r,u);return f!=n.EmptyObject?n.SetAttribute(t,i,f):n.RemoveAttribute(t,i),n.RemoveAttribute(r,u),!0}return!1},n.RemoveAttribute=function(n,t){n.removeAttribute?n.removeAttribute(t):n.removeProperty&&n.removeProperty(t)},n.IsExistsAttribute=function(t,i){var r=n.GetAttribute(t,i);return null!=r&&""!==r},n.isSourceResetRequired=function(){return r.Browser.IE&&r.Browser.MajorVersion>=11},n.EmptyObject={},n.RestoreStyleAttribute=function(t,i){return n.RestoreAttributeExtended(t.style,i,t,"saved"+i)},n}();t.Attr=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o;Object.defineProperty(t,"__esModule",{value:!0});var f=i(12),s=i(88),h=i(19),c=i(4),e=function(n){function t(t,i,r,u,f){void 0===i&&(i="-0.05");void 0===r&&(r="-0.05");void 0===u&&(u="1.1");void 0===f&&(f="1.1");var e=n.call(this,t,i,r,u,f)||this;return e.id=t,e.x=i,e.y=r,e.width=u,e.height=f,e}return u(t,n),t.prototype.createChildElements=function(n){var i=document.createElementNS(f.svgNS,"feFlood"),t;n.appendChild(i);t=document.createElementNS(f.svgNS,"feComposite");t.setAttribute("in","SourceGraphic");t.setAttribute("operator","atop");n.appendChild(t)},t}(s.FilterPrimitive);t.TextFilterPrimitive=e;o=function(n){function t(t,i,r,u,f,e){void 0===r&&(r="-0.05");void 0===u&&(u="-0.05");void 0===f&&(f="1.1");void 0===e&&(e="1.1");var o=n.call(this,t,r,u,f,e)||this;return o.id=t,o.floodColor=i,o.x=r,o.y=u,o.width=f,o.height=e,o}return u(t,n),t.prototype.applyChildrenProperties=function(n){for(var t=void 0,i=0;t=n.childNodes[i];i++)if(t.nodeName&&"FEFLOOD"===t.nodeName.toUpperCase()){this.prepareFEFloodNode(t);break}},t.prototype.prepareFEFloodNode=function(n){var t=c.ColorHelper.colorToHash(this.floodColor);n.setAttribute("flood-color",t);n.setAttribute("class","text-filter-flood");this.floodColor!==h.DiagramModel.defaultPageColor?n.style.setProperty("flood-color",t):n.style.setProperty("flood-color","")},t}(e);t.TextFloodFilterPrimitive=o},function(n,t,i){"use strict";var f,u=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),h,o,s,c;Object.defineProperty(t,"__esModule",{value:!0});var l=i(0),r=i(2),e=function(){function n(n){this.style=n}return n.prototype.hasCommands=function(){return!0},n.prototype.needCreateSeparatePrimitive=function(){return!1},n.prototype.createPrimitive=function(){return new r.PathPrimitive([],this.getStyle(),this.getCssClass())},n.prototype.createCommands=function(){return[]},n.prototype.getStyle=function(){var n=this.style.clone();return n.resetStrokeDashArray(),n},n.prototype.getCssClass=function(){},n}();t.ConnectorLineEndingStrategy=e;h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.hasCommands=function(){return!1},t}(e);t.ConnectorLineEndingNoneStrategy=h;o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),Object.defineProperty(t.prototype,"arrowHeight",{get:function(){return 6*this.style.strokeWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"arrowWidth",{get:function(){return 2*this.style.strokeWidth},enumerable:!0,configurable:!0}),t.prototype.needCreateSeparatePrimitive=function(){return!this.style.isDefaultStrokeDashArray()},t.prototype.createCommands=function(n,t){var i=this.getArrowPoints(n,t),u=[new r.PathPrimitiveMoveToCommand(i.point1.x,i.point1.y),new r.PathPrimitiveLineToCommand(n.x,n.y),new r.PathPrimitiveLineToCommand(i.point2.x,i.point2.y)];return this.style.isDefaultStrokeDashArray()||(u=u.concat([new r.PathPrimitiveMoveToCommand(n.x,n.y),new r.PathPrimitiveLineToCommand(i.point3.x,i.point3.y)])),u},t.prototype.getArrowPoints=function(n,t){var r,i=this.arrowHeight;return n.x===t.x&&(r=Math.abs(n.y-t.y))<i&&(i=r),n.y===t.y&&(r=Math.abs(n.x-t.x))<i&&(i=r),l.GeometryUtils.getArrowPoints(n,t,i,this.arrowWidth)},t}(e);t.ConnectorLineEndingArrowStrategy=o;s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.needCreateSeparatePrimitive=function(){return!0},t.prototype.createCommands=function(n,t){var i=this.getArrowPoints(n,t);return[new r.PathPrimitiveMoveToCommand(i.point1.x,i.point1.y),new r.PathPrimitiveLineToCommand(n.x,n.y),new r.PathPrimitiveLineToCommand(i.point2.x,i.point2.y),new r.PathPrimitiveClosePathCommand]},t.prototype.getCssClass=function(){return"outlined-line-ending"},t}(o);t.ConnectorLineEndingOutlinedTriangleStrategy=s;c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getStyle=function(){var t=n.prototype.getStyle.call(this);return t.fill=t.stroke,t},t.prototype.getCssClass=function(){return"filled-line-ending"},t}(s);t.ConnectorLineEndingFilledTriangleStrategy=c},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(3),u=i(0),o=function(n){function t(t){var i=n.call(this)||this;return i.offset=t,i}return f(t,n),t.prototype.redo=function(n){this.oldSize=n.model.size.clone();this.backOffset=new u.Offset(-this.offset.left,-this.offset.top,-this.offset.right,-this.offset.bottom);var t=Math.max(this.oldSize.width+this.offset.left+this.offset.right,n.model.pageWidth),i=Math.max(this.oldSize.height+this.offset.top+this.offset.bottom,n.model.pageHeight);n.changeModelSize(new u.Size(t,i),this.offset)},t.prototype.undo=function(n){n.changeModelSize(this.oldSize,this.backOffset)},t}(e.HistoryItem);t.ModelResizeHistoryItem=o},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(3),u=i(11),f=i(6),s=function(n){function t(t,i){var r=n.call(this)||this;return r.offsetX=t,r.offsetY=i,r}return e(t,n),t.prototype.redo=function(n){var t=this;n.model.iterateItems(function(i){i instanceof u.Shape&&n.moveShape(i,i.position.offset(t.offsetX,t.offsetY));i instanceof f.Connector&&i.points.forEach(function(r,u){return n.moveConnectorPoint(i,u,r.offset(t.offsetX,t.offsetY))})})},t.prototype.undo=function(n){var t=this;n.model.iterateItems(function(i){i instanceof u.Shape&&n.moveShape(i,i.position.offset(-t.offsetX,-t.offsetY));i instanceof f.Connector&&i.points.forEach(function(r,u){return n.moveConnectorPoint(i,u,r.offset(-t.offsetX,-t.offsetY))})})},t}(o.HistoryItem);t.UpdatePositionsOnPageResizeHistoryItem=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.connectorKey=t,r.pointIndex=i,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.point=t.points[this.pointIndex].clone();n.deleteConnectorPoint(t,this.pointIndex)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.addConnectorPoint(t,this.pointIndex,this.point)},t}(i(3).HistoryItem);t.DeleteConnectorPointHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.shapeKey=t,u.position=i,u.size=r,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);this.oldPosition=t.position.clone();this.oldSize=t.size.clone();n.resizeShape(t,this.position,this.size)},t.prototype.undo=function(n){var t=n.model.findShape(this.shapeKey);n.resizeShape(t,this.oldPosition,this.oldSize)},t}(i(3).HistoryItem);t.ResizeShapeHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.connectorKey=t,i}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);this.connector=t.clone();n.deleteConnector(t)},t.prototype.undo=function(n){n.addConnector(this.connector,this.connector.key)},t}(i(3).HistoryItem);t.DeleteConnectorHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.containerKey=i.key,r.itemKey=t.key,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey),i=n.model.findShape(this.containerKey);n.insertToContainer(t,i)},t.prototype.undo=function(n){var t=n.model.findItem(this.itemKey);n.removeFromContainer(t)},t}(i(3).HistoryItem);t.InsertToContainerHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.itemKey=t.key,i}return f(t,n),t.prototype.redo=function(n){var t=n.model.findItem(this.itemKey);this.containerKey=t.container&&t.container.key;n.removeFromContainer(t)},t.prototype.undo=function(n){var t=n.model.findContainer(this.containerKey),i=n.model.findItem(this.itemKey);n.insertToContainer(i,t)},t}(i(3).HistoryItem);t.RemoveFromContainerHistoryItem=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(160),u=function(){function n(n,t){this.container=n;this.sourceGraph=t}return Object.defineProperty(n.prototype,"graph",{get:function(){return this._graph||(this._graph=this.getNodeInfoGraph())},enumerable:!0,configurable:!0}),n.prototype.getNodeInfoGraph=function(){return this.sourceGraph.cast(r.LayoutUtils.shapeToLayout)},n}();t.GraphInfo=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(54),u=function(){function n(){}return n.shapeToLayout=function(n){var t=new r.Margin(0),i=n.rectangle,u;return n.attachedConnectors.filter(function(n){return!n.beginItem||!n.endItem}).forEach(function(n){var r=n.rectangle;t.left=Math.max(t.left,i.left-r.left);t.right=Math.max(t.right,r.right-i.right);t.top=Math.max(t.top,i.top-r.top);t.bottom=Math.max(t.bottom,r.bottom-i.bottom)}),u=new r.NodeInfo(n.key,t,n.size.clone()),u.connectionPoints=n.description.getConnectionPoints(),u},n}();t.LayoutUtils=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this.control=n}return n.prototype.execute=function(n){var i=this.getState(),t;return i.enabled?(this.control.beginUpdate(),t=this.executeCore(i,n),this.control.endUpdate(),t&&this.updateControlState(),t):!1},n.prototype.updateControlState=function(){this.lockInputPositionUpdating()||this.control.selection.inputPosition.reset();this.lockUIUpdating()||this.control.barManager.updateItemsState()},n.prototype.lockUIUpdating=function(){return!1},n.prototype.lockInputPositionUpdating=function(){return!1},n}();t.CommandBase=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(n,t,i,r,u){this.visible=!0;this.denyUpdateValue=!1;this.enabled=n;this.value=t;this.items=r;this.visible=u;this.defaultValue=i}}();t.SimpleCommandState=i},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.executeCore=function(){return this.control.beginUpdate(!0),this.control.history.undo(),this.control.endUpdate(!0),!0},t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&this.control.history.canUndo()},t}(i(8).SimpleCommandBase);t.UndoCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.executeCore=function(){return this.control.beginUpdate(!0),this.control.history.redo(),this.control.endUpdate(!0),!0},t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&this.control.history.canRedo()},t}(i(8).SimpleCommandBase);t.RedoCommand=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(95);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.executeCore=function(n,t){var f=t.data?t.data:t,i=new u.Importer(this.control.shapeDescriptionManager,f),r;return!0===t.keepExistingItems?(i.importItemsData(this.control.model),this.control.importItemsData()):(r=i.import(),this.control.importModel(r)),!0},t}(i(44).ExportImportCommandBase);t.ImportCommand=f},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(16),e=i(1),o=function(n){function t(){return n.call(this,void 0,!0)||this}return u(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return e.ShapeTypes.Process},enumerable:!0,configurable:!0}),t}(f.RectangleShapeDescription);t.ProcessShapeDescription=o},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(96),o=i(1),s=i(0),u=i(9),h=function(n){function t(){return n.call(this,new s.Size(u.ShapeDefaultDimension,.75*u.ShapeDefaultDimension),!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Decision},enumerable:!0,configurable:!0}),t}(e.DiamondShapeDescription);t.DecisionShapeDescription=h},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=i(5),h=function(n){function t(){return n.call(this,void 0,!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.ManualInput},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,u=i.left,f=i.top,e=i.right,o=i.bottom,s=(i.width,f+i.height*t.slopeHeightRatio);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(u,s),new r.PathPrimitiveLineToCommand(e,f),new r.PathPrimitiveLineToCommand(e,o),new r.PathPrimitiveLineToCommand(u,o),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.processConnectionPoint=function(n,i){n.getConnectionPointSide(i)===s.ConnectionPointSide.North&&(i.y+=t.slopeHeightRatio/2*n.size.height)},t.slopeHeightRatio=.1,t}(e.RectangleShapeDescription);t.ManualInputShapeDescription=h},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(16),s=i(1),r=i(2),f=i(5),h=function(n){function t(){return n.call(this,void 0,!0)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.Data},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,u=i.left,f=i.top,e=i.right,o=i.bottom,h=i.width,c=i.height,s=Math.min(Math.max(0,c/Math.tan(t.slopeAngle)),h),l=u+s,a=e-s;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(l,f),new r.PathPrimitiveLineToCommand(e,f),new r.PathPrimitiveLineToCommand(a,o),new r.PathPrimitiveLineToCommand(u,o),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.processConnectionPoint=function(n,i){var r=n.size.height/Math.tan(t.slopeAngle),u=n.getConnectionPointSide(i);u===f.ConnectionPointSide.East?i.x-=r/2:u===f.ConnectionPointSide.West&&(i.x+=r/2)},t.slopeAngle=81*Math.PI/180,t}(o.RectangleShapeDescription);t.DataShapeDescription=h},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(16),s=i(1),r=i(2),h=i(0),f=i(9),c=function(n){function t(){return n.call(this,new h.Size(f.ShapeDefaultDimension,.5*f.ShapeDefaultDimension),!0)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.Terminator},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,u=i.left,f=i.top,o=i.right,e=i.bottom,h=i.width,c=(i.height,i.center.y),s=u+h*t.curveWidthRatio,l=u+h*(1-t.curveWidthRatio);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(s,f),new r.PathPrimitiveLineToCommand(l,f),new r.PathPrimitiveQuadraticCurveToCommand(o,f,o,c),new r.PathPrimitiveQuadraticCurveToCommand(o,e,l,e),new r.PathPrimitiveLineToCommand(s,e),new r.PathPrimitiveQuadraticCurveToCommand(u,e,u,c),new r.PathPrimitiveQuadraticCurveToCommand(u,f,s,f),new r.PathPrimitiveClosePathCommand],n.style)]},t.curveWidthRatio=.3,t}(o.RectangleShapeDescription);t.TerminatorShapeDescription=c},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f;Object.defineProperty(t,"__esModule",{value:!0});var o=i(16),s=i(1),h=i(28),c=i(22),l=i(0),r=i(2);t.PredefinedProcessEdgeParameterName="e";f=function(n){function i(){return n.call(this,void 0,!0)||this}return e(i,n),Object.defineProperty(i.prototype,"key",{get:function(){return s.ShapeTypes.PredefinedProcess},enumerable:!0,configurable:!0}),i.prototype.createShapePrimitives=function(i){var u=i.rectangle,h=u.left,f=u.top,c=u.right,e=u.bottom,o=(u.width,u.height,h+i.parameters.get(t.PredefinedProcessEdgeParameterName).value),s=c-i.parameters.get(t.PredefinedProcessEdgeParameterName).value;return n.prototype.createShapePrimitives.call(this,i).concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o,f),new r.PathPrimitiveLineToCommand(o,e),new r.PathPrimitiveMoveToCommand(s,f),new r.PathPrimitiveLineToCommand(s,e)],i.style)])},i.prototype.createParameters=function(n){n.add(new h.ShapeParameter(t.PredefinedProcessEdgeParameterName,.1*this.defaultSize.width))},i.prototype.normalizeParameters=function(n,r){this.changeParameterValue(r,t.PredefinedProcessEdgeParameterName,function(t){return Math.max(i.minEdge,Math.min(.3*n.size.width,t.value))})},i.prototype.modifyParameters=function(n,i,r){this.changeParameterValue(i,t.PredefinedProcessEdgeParameterName,function(n){return n.value+r});this.normalizeParameters(n,i)},i.prototype.getParameterPoints=function(n){return[new c.ShapeParameterPoint("c",new l.Point(n.normalizeX(n.position.x+n.parameters.get(t.PredefinedProcessEdgeParameterName).value),n.position.y))]},i.prototype.getTextRectangle=function(n){var r=n.rectangle,i=n.parameters.get(t.PredefinedProcessEdgeParameterName).value;return r.resize(-2*i,0).offset(i,0)},i.minEdge=72,i}(o.RectangleShapeDescription);t.PredefinedProcessShapeDescription=f},function(n,t,i){"use strict";var f,e=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),o=i(22),s=i(0),u=i(71),h=i(1),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return h.ShapeTypes.ArrowUpDown},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,e=t.left,s=t.top,o=t.right,h=t.bottom,p=t.width,c=(t.height,t.center.x),l=(p-n.parameters.get(u.ArrowVerticalLineWidthParameterName).value)/2,a=n.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value,v=n.normalizeX(e+l),i=n.normalizeY(s+a),y=n.normalizeX(o-l),f=n.normalizeY(h-a);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(c,s),new r.PathPrimitiveLineToCommand(o,i),new r.PathPrimitiveLineToCommand(y,i),new r.PathPrimitiveLineToCommand(y,f),new r.PathPrimitiveLineToCommand(o,f),new r.PathPrimitiveLineToCommand(c,h),new r.PathPrimitiveLineToCommand(e,f),new r.PathPrimitiveLineToCommand(v,f),new r.PathPrimitiveLineToCommand(v,i),new r.PathPrimitiveLineToCommand(e,i),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.normalizeParameters=function(n,t){this.changeParameterValue(t,u.ArrowVerticalTriangleHeightParameterName,function(t){return Math.max(0,Math.min(n.size.height/2-2*n.strokeWidth,t.value))});this.changeParameterValue(t,u.ArrowVerticalLineWidthParameterName,function(t){return Math.max(0,Math.min(n.size.width,t.value))})},t.prototype.modifyParameters=function(n,t,i,r){this.changeParameterValue(t,u.ArrowVerticalTriangleHeightParameterName,function(n){return n.value+r});this.changeParameterValue(t,u.ArrowVerticalLineWidthParameterName,function(n){return n.value-2*i});this.normalizeParameters(n,t)},t.prototype.getParameterPoints=function(n){return[new o.ShapeParameterPoint("c",new s.Point(n.normalizeX(n.position.x+(n.size.width-n.parameters.get(u.ArrowVerticalLineWidthParameterName).value)/2),n.normalizeY(n.position.y+n.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value)))]},t}(u.ArrowVerticalShapeDescription);t.ArrowUpDownShapeDescription=c},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(72),s=i(22),h=i(0),c=i(1),e=i(5),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return c.ShapeTypes.ArrowRight},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,f=t.left,e=t.top,l=t.right,o=t.bottom,a=t.width,v=t.height,y=t.center.y,p=a-n.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value,s=(v-n.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2,i=n.normalizeX(f+p),h=n.normalizeY(e+s),c=n.normalizeY(o-s);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(f,h),new r.PathPrimitiveLineToCommand(i,h),new r.PathPrimitiveLineToCommand(i,e),new r.PathPrimitiveLineToCommand(l,y),new r.PathPrimitiveLineToCommand(i,o),new r.PathPrimitiveLineToCommand(i,c),new r.PathPrimitiveLineToCommand(f,c),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.modifyParameters=function(n,t,i,r){this.changeParameterValue(t,u.ArrowVerticalTriangleWidthParameterName,function(n){return n.value-i});this.changeParameterValue(t,u.ArrowVerticalLineHeightParameterName,function(n){return n.value-2*r});this.normalizeParameters(n,t)},t.prototype.getParameterPoints=function(n){return[new s.ShapeParameterPoint("c",new h.Point(n.normalizeX(n.position.x+n.size.width-n.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value),n.normalizeY(n.position.y+(n.size.height-n.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2)))]},t.prototype.processConnectionPoint=function(t,i){var r=t.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value;if(i.x>t.position.x+t.size.width-r){var s=t.size.height/2/r,f=(i.x-(t.position.x+t.size.width-r))*s,o=t.getConnectionPointSide(i);o===e.ConnectionPointSide.North?i.y+=f:o===e.ConnectionPointSide.South&&(i.y-=f)}else n.prototype.processConnectionPoint.call(this,t,i)},t}(u.ArrowHorizontalShapeDescription);t.ArrowRightShapeDescription=l},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),s=i(22),h=i(0),u=i(71),c=i(1),e=i(5),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return c.ShapeTypes.ArrowUp},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,f=t.left,e=t.top,o=t.right,s=t.bottom,a=t.width,v=(t.height,t.center.x),h=(a-n.parameters.get(u.ArrowVerticalLineWidthParameterName).value)/2,y=n.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value,c=n.normalizeX(f+h),i=n.normalizeY(e+y),l=n.normalizeX(o-h);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(v,e),new r.PathPrimitiveLineToCommand(o,i),new r.PathPrimitiveLineToCommand(l,i),new r.PathPrimitiveLineToCommand(l,s),new r.PathPrimitiveLineToCommand(c,s),new r.PathPrimitiveLineToCommand(c,i),new r.PathPrimitiveLineToCommand(f,i),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.modifyParameters=function(n,t,i,r){this.changeParameterValue(t,u.ArrowVerticalTriangleHeightParameterName,function(n){return n.value+r});this.changeParameterValue(t,u.ArrowVerticalLineWidthParameterName,function(n){return n.value-2*i});this.normalizeParameters(n,t)},t.prototype.getParameterPoints=function(n){return[new s.ShapeParameterPoint("c",new h.Point(n.normalizeX(n.position.x+(n.size.width-n.parameters.get(u.ArrowVerticalLineWidthParameterName).value)/2),n.normalizeY(n.position.y+n.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value)))]},t.prototype.processConnectionPoint=function(t,i){var r=t.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value;if(i.y<t.position.y+r){var s=t.size.width/2/r,f=(t.position.y+r-i.y)*s,o=t.getConnectionPointSide(i);o===e.ConnectionPointSide.East?i.x-=f:o===e.ConnectionPointSide.West&&(i.x+=f)}else n.prototype.processConnectionPoint.call(this,t,i)},t}(u.ArrowVerticalShapeDescription);t.ArrowUpShapeDescription=l},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e;Object.defineProperty(t,"__esModule",{value:!0});var s=i(9),h=i(0),f=i(28),c=i(22),r=i(2),l=i(1);t.CrossHorizontalWidthParameterName="chw";t.CrossVerticalWidthParameterName="cvw";e=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return o(i,n),Object.defineProperty(i.prototype,"key",{get:function(){return l.ShapeTypes.Cross},enumerable:!0,configurable:!0}),i.prototype.createShapePrimitives=function(n){var i=n.rectangle,s=i.left,h=i.top,c=i.right,l=i.bottom,y=i.width,p=i.height,a=(y-n.parameters.get(t.CrossHorizontalWidthParameterName).value)/2,v=(p-n.parameters.get(t.CrossVerticalWidthParameterName).value)/2,u=n.normalizeX(s+a),f=n.normalizeY(h+v),e=n.normalizeX(c-a),o=n.normalizeY(l-v);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(s,f),new r.PathPrimitiveLineToCommand(u,f),new r.PathPrimitiveLineToCommand(u,h),new r.PathPrimitiveLineToCommand(e,h),new r.PathPrimitiveLineToCommand(e,f),new r.PathPrimitiveLineToCommand(c,f),new r.PathPrimitiveLineToCommand(c,o),new r.PathPrimitiveLineToCommand(e,o),new r.PathPrimitiveLineToCommand(e,l),new r.PathPrimitiveLineToCommand(u,l),new r.PathPrimitiveLineToCommand(u,o),new r.PathPrimitiveLineToCommand(s,o),new r.PathPrimitiveClosePathCommand],n.style)]},i.prototype.createParameters=function(n){n.addRange([new f.ShapeParameter(t.CrossHorizontalWidthParameterName,.2*this.defaultSize.width),new f.ShapeParameter(t.CrossVerticalWidthParameterName,.2*this.defaultSize.height)])},i.prototype.normalizeParameters=function(n,i){this.changeParameterValue(i,t.CrossHorizontalWidthParameterName,function(t){return Math.max(0,Math.min(n.size.width,t.value))});this.changeParameterValue(i,t.CrossVerticalWidthParameterName,function(t){return Math.max(0,Math.min(n.size.height,t.value))})},i.prototype.modifyParameters=function(n,i,r,u){this.changeParameterValue(i,t.CrossHorizontalWidthParameterName,function(n){return n.value-2*r});this.changeParameterValue(i,t.CrossVerticalWidthParameterName,function(n){return n.value-2*u});this.normalizeParameters(n,i)},i.prototype.getParameterPoints=function(n){return[new c.ShapeParameterPoint("c",new h.Point(n.normalizeX(n.position.x+(n.size.width-n.parameters.get(t.CrossHorizontalWidthParameterName).value)/2),n.normalizeY(n.position.y+(n.size.height-n.parameters.get(t.CrossVerticalWidthParameterName).value)/2)))]},i}(s.ShapeDescription);t.CrossShapeDescription=e},function(n,t,i){"use strict";var e,o=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}e(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=i(9),r=i(2),h=i(1),u=i(33),f=i(5),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return h.ShapeTypes.Heart},enumerable:!0,configurable:!0}),t.prototype.createConnectionPoints=function(){return[new u.ConnectionPoint(.5,.15,f.ConnectionPointSide.North),new u.ConnectionPoint(1,.25,f.ConnectionPointSide.East),new u.ConnectionPoint(.5,1,f.ConnectionPointSide.South),new u.ConnectionPoint(0,.25,f.ConnectionPointSide.West)]},t.prototype.createShapePrimitives=function(n){var o=n.rectangle,f=o.left,t=o.top,e=o.right,s=o.bottom,i=o.width,u=o.height;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(e-.25*i,t),new r.PathPrimitiveCubicCurveToCommand(e-.15*i,t,e,t+.1*u,e,t+.25*u),new r.PathPrimitiveCubicCurveToCommand(e,t+.3*u,e-.02*i,t+.35*u,e-.05*i,t+.4*u),new r.PathPrimitiveLineToCommand(o.center.x,s),new r.PathPrimitiveLineToCommand(f+.05*i,t+.4*u),new r.PathPrimitiveCubicCurveToCommand(f+.02*i,t+.35*u,f,t+.3*u,f,t+.25*u),new r.PathPrimitiveCubicCurveToCommand(f,t+.1*u,f+.15*i,t,f+.25*i,t),new r.PathPrimitiveCubicCurveToCommand(f+.3*i,t,f+.45*i,t+.03*u,f+.5*i,t+.15*u),new r.PathPrimitiveCubicCurveToCommand(e-.45*i,t+.03*u,e-.3*i,t,e-.25*i,t),new r.PathPrimitiveClosePathCommand],n.style)]},t}(s.ShapeDescription);t.HeartShapeDescription=c},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),e=i(1),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return e.ShapeTypes.Octagon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angleCount",{get:function(){return 8},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,i=t.left,u=t.top,o=t.right,s=t.bottom,h=t.width,c=t.height,l=Math.PI-this.angle,a=h/(1+2*Math.cos(l)),v=c/(1+2*Math.cos(l)),f=i+(h-a)/2,y=f+a,e=u+(c-v)/2,p=e+v;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(f,u),new r.PathPrimitiveLineToCommand(y,u),new r.PathPrimitiveLineToCommand(o,e),new r.PathPrimitiveLineToCommand(o,p),new r.PathPrimitiveLineToCommand(y,s),new r.PathPrimitiveLineToCommand(f,s),new r.PathPrimitiveLineToCommand(i,p),new r.PathPrimitiveLineToCommand(i,e),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.calculateHeight=function(n){return n},t}(i(73).PolygonShapeDescription);t.OctagonShapeDescription=o},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f;Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),o=i(1),s=i(98),h=i(28),c=i(22),l=i(0),a=i(5);t.StarConvexParameterName="sc";f=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return e(i,n),Object.defineProperty(i.prototype,"key",{get:function(){return o.ShapeTypes.Star},enumerable:!0,configurable:!0}),i.prototype.createShapePrimitives=function(n){var s=n.rectangle,a=s.left,o=s.top,l=s.right,e=s.bottom,v=s.width,y=s.height;e=this.getActualBottom(o,e,v,y);var i=s.center.x,c=o+(e-o)/2,b=y/v,k=Math.PI-this.angle,d=v/2*Math.tan(k/2)*b,h=o+d,g=(y-d)/Math.tan(k)/b,p=a+g,w=l-g,u=n.parameters.get(t.StarConvexParameterName).value,f=this.getInnerPointDistance(i,i,l,c,o,h);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(i,o),new r.PathPrimitiveLineToCommand(this.getInnerPointPos(i,i,l,u,f),this.getInnerPointPos(c,o,h,u,f)),new r.PathPrimitiveLineToCommand(l,h),new r.PathPrimitiveLineToCommand(this.getInnerPointPos(i,l,w,u,f),this.getInnerPointPos(c,h,e,u,f)),new r.PathPrimitiveLineToCommand(w,e),new r.PathPrimitiveLineToCommand(this.getInnerPointPos(i,w,p,u,f),this.getInnerPointPos(c,e,e,u,f)),new r.PathPrimitiveLineToCommand(p,e),new r.PathPrimitiveLineToCommand(this.getInnerPointPos(i,p,a,u,f),this.getInnerPointPos(c,e,h,u,f)),new r.PathPrimitiveLineToCommand(a,h),new r.PathPrimitiveLineToCommand(this.getInnerPointPos(i,a,i,u,f),this.getInnerPointPos(c,h,o,u,f)),new r.PathPrimitiveClosePathCommand],n.style)]},i.prototype.createParameters=function(n){n.addRange([new h.ShapeParameter(t.StarConvexParameterName,300)])},i.prototype.normalizeParameters=function(n,i){var r=n.rectangle,u=r.top,h=r.right,f=r.bottom,e=r.width,o=r.height;f=this.getActualBottom(u,f,e,o);var s=r.center.x,c=u+(f-u)/2,l=o/e,a=Math.PI-this.angle,v=u+e/2*Math.tan(a/2)*l,y=this.getInnerPointDistance(s,s,h,c,u,v);this.changeParameterValue(i,t.StarConvexParameterName,function(n){return Math.max(0,Math.min(y,n.value))})},i.prototype.modifyParameters=function(n,i,r,u){var f=Math.sqrt(Math.pow(r,2)+Math.pow(u,2));(r<0||u>0)&&(f=-f);this.changeParameterValue(i,t.StarConvexParameterName,function(n){return n.value+f});this.normalizeParameters(n,i)},i.prototype.getParameterPoints=function(n){var i=n.rectangle,r=i.top,o=i.right,f=i.bottom,e=i.width,s=i.height;f=this.getActualBottom(r,f,e,s);var u=i.center.x,h=r+(f-r)/2,p=s/e,w=Math.PI-this.angle,a=r+e/2*Math.tan(w/2)*p,v=n.parameters.get(t.StarConvexParameterName).value,y=this.getInnerPointDistance(u,u,o,h,r,a),b=this.getInnerPointPos(u,u,o,v,y),k=this.getInnerPointPos(h,r,a,v,y);return[new c.ShapeParameterPoint("c",new l.Point(b,k))]},i.prototype.processConnectionPoint=function(i,r){if(n.prototype.processConnectionPoint.call(this,i,r),i.getConnectionPointSide(r)===a.ConnectionPointSide.South){var u=i.rectangle,f=u.top,l=u.right,e=u.bottom,o=u.width,s=u.height;e=this.getActualBottom(f,e,o,s);var h=u.center.x,c=f+(e-f)/2,v=s/o,y=Math.PI-this.angle,p=f+o/2*Math.tan(y/2)*v,w=i.parameters.get(t.StarConvexParameterName).value,b=this.getInnerPointDistance(h,h,l,c,f,p);r.y=this.getInnerPointPos(c,e,e,w,b)}},i.prototype.getInnerPointDistanceByAxis=function(n,t,i){return Math.min(t,i)+Math.abs(t-i)/2-n},i.prototype.getInnerPointPos=function(n,t,i,r,u){var f=Math.min(1,r/u);return n+this.getInnerPointDistanceByAxis(n,t,i)*f},i.prototype.getInnerPointDistance=function(n,t,i,r,u,f){var e=this.getInnerPointDistanceByAxis(n,t,i),o=this.getInnerPointDistanceByAxis(r,u,f);return Math.sqrt(Math.pow(e,2)+Math.pow(o,2))},i.prototype.getActualBottom=function(t,i,r,u){var f=t+n.prototype.calculateHeight.call(this,r)*u/r;return f<i?f:i},i.prototype.calculateHeight=function(n){return n},i}(s.PentagonShapeDescription);t.StarShapeDescription=f},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),s=i(22),h=i(0),u=i(71),c=i(1),e=i(5),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return c.ShapeTypes.ArrowDown},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,e=t.left,f=t.top,o=t.right,l=t.bottom,a=t.width,v=t.height,y=t.center.x,s=(a-n.parameters.get(u.ArrowVerticalLineWidthParameterName).value)/2,p=v-n.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value,h=n.normalizeX(e+s),i=n.normalizeY(f+p),c=n.normalizeX(o-s);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(h,f),new r.PathPrimitiveLineToCommand(c,f),new r.PathPrimitiveLineToCommand(c,i),new r.PathPrimitiveLineToCommand(o,i),new r.PathPrimitiveLineToCommand(y,l),new r.PathPrimitiveLineToCommand(e,i),new r.PathPrimitiveLineToCommand(h,i),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.modifyParameters=function(n,t,i,r){this.changeParameterValue(t,u.ArrowVerticalTriangleHeightParameterName,function(n){return n.value-r});this.changeParameterValue(t,u.ArrowVerticalLineWidthParameterName,function(n){return n.value-2*i});this.normalizeParameters(n,t)},t.prototype.getParameterPoints=function(n){return[new s.ShapeParameterPoint("c",new h.Point(n.normalizeX(n.position.x+(n.size.width-n.parameters.get(u.ArrowVerticalLineWidthParameterName).value)/2),n.normalizeY(n.position.y+n.size.height-n.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value)))]},t.prototype.processConnectionPoint=function(t,i){var r=t.parameters.get(u.ArrowVerticalTriangleHeightParameterName).value;if(i.y>t.position.y+t.size.height-r){var s=t.size.width/2/r,f=(i.y-(t.position.y+t.size.height-r))*s,o=t.getConnectionPointSide(i);o===e.ConnectionPointSide.East?i.x-=f:o===e.ConnectionPointSide.West&&(i.x+=f)}else n.prototype.processConnectionPoint.call(this,t,i)},t}(u.ArrowVerticalShapeDescription);t.ArrowDownShapeDescription=l},function(n,t,i){"use strict";var f,e=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(72),o=i(22),s=i(0),h=i(1),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return h.ShapeTypes.ArrowLeftRight},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,s=t.left,e=t.top,h=t.right,o=t.bottom,p=(t.width,t.height),c=t.center.y,l=n.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value,a=(p-n.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2,i=n.normalizeX(s+l),v=n.normalizeY(e+a),f=n.normalizeX(h-l),y=n.normalizeY(o-a);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(s,c),new r.PathPrimitiveLineToCommand(i,e),new r.PathPrimitiveLineToCommand(i,v),new r.PathPrimitiveLineToCommand(f,v),new r.PathPrimitiveLineToCommand(f,e),new r.PathPrimitiveLineToCommand(h,c),new r.PathPrimitiveLineToCommand(f,o),new r.PathPrimitiveLineToCommand(f,y),new r.PathPrimitiveLineToCommand(i,y),new r.PathPrimitiveLineToCommand(i,o),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.normalizeParameters=function(n,t){this.changeParameterValue(t,u.ArrowVerticalTriangleWidthParameterName,function(t){return Math.max(0,Math.min(n.size.width/2-2*n.strokeWidth,t.value))});this.changeParameterValue(t,u.ArrowVerticalLineHeightParameterName,function(t){return Math.max(0,Math.min(n.size.height,t.value))})},t.prototype.modifyParameters=function(n,t,i,r){this.changeParameterValue(t,u.ArrowVerticalTriangleWidthParameterName,function(n){return n.value+i});this.changeParameterValue(t,u.ArrowVerticalLineHeightParameterName,function(n){return n.value-2*r});this.normalizeParameters(n,t)},t.prototype.getParameterPoints=function(n){return[new o.ShapeParameterPoint("c",new s.Point(n.normalizeX(n.position.x+n.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value),n.normalizeY(n.position.y+(n.size.height-n.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2)))]},t}(u.ArrowHorizontalShapeDescription);t.ArrowLeftRightShapeDescription=c},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(72),s=i(22),h=i(0),c=i(1),e=i(5),l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return c.ShapeTypes.ArrowLeft},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,f=t.left,e=t.top,o=t.right,s=t.bottom,a=(t.width,t.height),v=t.center.y,y=n.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value,h=(a-n.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2,i=n.normalizeX(f+y),c=n.normalizeY(e+h),l=n.normalizeY(s-h);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(f,v),new r.PathPrimitiveLineToCommand(i,e),new r.PathPrimitiveLineToCommand(i,c),new r.PathPrimitiveLineToCommand(o,c),new r.PathPrimitiveLineToCommand(o,l),new r.PathPrimitiveLineToCommand(i,l),new r.PathPrimitiveLineToCommand(i,s),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.modifyParameters=function(n,t,i,r){this.changeParameterValue(t,u.ArrowVerticalTriangleWidthParameterName,function(n){return n.value+i});this.changeParameterValue(t,u.ArrowVerticalLineHeightParameterName,function(n){return n.value-2*r});this.normalizeParameters(n,t)},t.prototype.getParameterPoints=function(n){return[new s.ShapeParameterPoint("c",new h.Point(n.normalizeX(n.position.x+n.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value),n.normalizeY(n.position.y+(n.size.height-n.parameters.get(u.ArrowVerticalLineHeightParameterName).value)/2)))]},t.prototype.processConnectionPoint=function(t,i){var r=t.parameters.get(u.ArrowVerticalTriangleWidthParameterName).value;if(i.x<t.position.x+r){var s=t.size.height/2/r,f=(t.position.x+r-i.x)*s,o=t.getConnectionPointSide(i);o===e.ConnectionPointSide.North?i.y+=f:o===e.ConnectionPointSide.South&&(i.y-=f)}else n.prototype.processConnectionPoint.call(this,t,i)},t}(u.ArrowHorizontalShapeDescription);t.ArrowLeftShapeDescription=l},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),r=i(2),f=i(101),s=i(56),h=i(15),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.MultipleDocuments},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n,i){var e=n.rectangle,r=n.rectangle,a=(r.left,r.top,r.right,r.bottom,r.width),v=r.height,s=i?t.documentsOffsetRatioForToolbox:t.documentsOffsetRatio,u=Math.ceil(a*s),f=Math.ceil(v*s),o=(e=e.inflate(-u,-f).offset(-u,-f)).offset(u,f),c=o.offset(u,f),l=h.RenderUtils.generateSvgElementId("clipRect");return[].concat(this.createDocumentPrimitives(e,n.style,l+"1",o)).concat(this.createDocumentPrimitives(o,n.style,l+"2",c)).concat(this.createDocumentPrimitives(c,n.style))},t.prototype.createDocumentPrimitives=function(n,t,i,u){var o=n.left,l=n.top,h=n.right,e=n.bottom,v=n.width,y=n.height,p=n.center.x,a=y*f.DocumentShapeDescription.curveOffsetRatio,c=[];return c=c.concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o,l),new r.PathPrimitiveLineToCommand(h,l),new r.PathPrimitiveLineToCommand(h,e),new r.PathPrimitiveQuadraticCurveToCommand(h-.25*v,e-2*a,p,e-a),new r.PathPrimitiveQuadraticCurveToCommand(o+.25*v,e+a,o,e-a),new r.PathPrimitiveClosePathCommand],t,void 0,u&&i)]),u&&i&&(c=c.concat([new s.ClipPathPrimitive(i,[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o-t.strokeWidth,l-t.strokeWidth),new r.PathPrimitiveLineToCommand(h+t.strokeWidth,l-t.strokeWidth),new r.PathPrimitiveLineToCommand(h+t.strokeWidth,u.top),new r.PathPrimitiveLineToCommand(u.left,u.top),new r.PathPrimitiveLineToCommand(u.left,e+t.strokeWidth),new r.PathPrimitiveLineToCommand(o-t.strokeWidth,e+t.strokeWidth),new r.PathPrimitiveClosePathCommand])])])),c},t.prototype.getTextRectangle=function(n){var i=n.rectangle,r=i.width*t.documentsOffsetRatio,u=i.height*t.documentsOffsetRatio;return(i=i.inflate(-r,-u).offset(-r,-u)).offset(2*r,2*u).resize(0,-i.height*f.DocumentShapeDescription.curveOffsetRatio)},t.documentsOffsetRatio=.1,t.documentsOffsetRatioForToolbox=.16,t}(f.DocumentShapeDescription);t.MultipleDocumentsShapeDescription=c},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(1),o=i(0),u=i(9),s=function(n){function t(){var t=n.call(this,!0)||this;return t.defaultSize=new o.Size(u.ShapeDefaultDimension,.75*u.ShapeDefaultDimension),t}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return e.ShapeTypes.Preparation},enumerable:!0,configurable:!0}),t}(i(99).HexagonShapeDescription);t.PreparationShapeDescription=s},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=i(43),h=function(n){function t(){return n.call(this,void 0,!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.HardDisk},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,h=i.left,f=i.top,o=i.right,e=i.bottom,c=i.width,l=(i.height,i.center.y),u=c*t.arcWidthRatio;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o-u/2,f),new r.PathPrimitiveLineToCommand(h+u/2,f),new r.PathPrimitiveArcToCommand(u/2,(e-f)/2,0,!1,!1,h+u/2,e),new r.PathPrimitiveLineToCommand(o-u/2,e)],n.style),new s.EllipsePrimitive(o-u/2,l,u/2,(e-f)/2,n.style)]},t.prototype.getTextRectangle=function(n){var i=n.rectangle,r=i.width*t.arcWidthRatio;return i.resize(-r,0)},t.arcWidthRatio=.2,t}(e.RectangleShapeDescription);t.HardDiskShapeDescription=h},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=i(43),h=function(n){function t(){var t=n.call(this,void 0,!0)||this;return t.defaultSize.width=t.defaultSize.height,t}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Database},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,f=i.left,o=i.top,e=i.right,h=i.bottom,c=(i.width,i.height),l=i.center.x,u=c*t.arcWidthRatio;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(e,o+u/2),new r.PathPrimitiveLineToCommand(e,h-u/2),new r.PathPrimitiveArcToCommand((e-f)/2,u/2,0,!1,!0,f,h-u/2),new r.PathPrimitiveLineToCommand(f,o+u/2)],n.style),new s.EllipsePrimitive(l,o+u/2,(e-f)/2,u/2,n.style)]},t.prototype.getTextRectangle=function(n){var i=n.rectangle,r=i.height*t.arcWidthRatio;return i.resize(0,-r).offset(0,r)},t.arcWidthRatio=.2,t}(e.RectangleShapeDescription);t.DatabaseShapeDescription=h},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e;Object.defineProperty(t,"__esModule",{value:!0});var s=i(16),h=i(1),f=i(28),c=i(22),l=i(0),r=i(2);t.InternalStorageHorizontalEdgeParameterName="he";t.InternalStorageVerticalEdgeParameterName="ve";e=function(n){function i(){return n.call(this,void 0,!0)||this}return o(i,n),Object.defineProperty(i.prototype,"key",{get:function(){return h.ShapeTypes.InternalStorage},enumerable:!0,configurable:!0}),i.prototype.createShapePrimitives=function(i){var u=i.rectangle,f=u.left,e=u.top,h=u.right,c=u.bottom,o=(u.width,u.height,f+i.parameters.get(t.InternalStorageHorizontalEdgeParameterName).value),s=e+i.parameters.get(t.InternalStorageVerticalEdgeParameterName).value;return n.prototype.createShapePrimitives.call(this,i).concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o,e),new r.PathPrimitiveLineToCommand(o,c),new r.PathPrimitiveMoveToCommand(f,s),new r.PathPrimitiveLineToCommand(h,s)],i.style)])},i.prototype.createParameters=function(n){n.addRange([new f.ShapeParameter(t.InternalStorageHorizontalEdgeParameterName,.1*this.defaultSize.width),new f.ShapeParameter(t.InternalStorageVerticalEdgeParameterName,.1*this.defaultSize.width)])},i.prototype.normalizeParameters=function(n,r){this.changeParameterValue(r,t.InternalStorageHorizontalEdgeParameterName,function(t){return Math.max(i.minEdge,Math.min(.3*n.size.width,t.value))});this.changeParameterValue(r,t.InternalStorageVerticalEdgeParameterName,function(t){return Math.max(i.minEdge,Math.min(.3*n.size.height,t.value))})},i.prototype.modifyParameters=function(n,i,r,u){this.changeParameterValue(i,t.InternalStorageHorizontalEdgeParameterName,function(n){return n.value+r});this.changeParameterValue(i,t.InternalStorageVerticalEdgeParameterName,function(n){return n.value+u});this.normalizeParameters(n,i)},i.prototype.getParameterPoints=function(n){return[new c.ShapeParameterPoint("c",new l.Point(n.normalizeX(n.position.x+n.parameters.get(t.InternalStorageHorizontalEdgeParameterName).value),n.normalizeY(n.position.y+n.parameters.get(t.InternalStorageVerticalEdgeParameterName).value)))]},i.prototype.getTextRectangle=function(n){var r=n.rectangle,i=n.parameters.get(t.InternalStorageHorizontalEdgeParameterName).value;return r.resize(-i,0).offset(i,0)},i.minEdge=72,i}(s.RectangleShapeDescription);t.InternalStorageShapeDescription=e},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(16),s=i(1),r=i(2),f=i(5),h=function(n){function t(){return n.call(this,void 0,!0)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.PaperTape},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){return this.createDocumentPrimitives(n.rectangle,n.style)},t.prototype.createDocumentPrimitives=function(n,i){var o=n.left,f=n.top,s=n.right,e=n.bottom,h=n.width,l=n.height,c=n.center.x,u=l*t.curveOffsetRatio;return[].concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o,f),new r.PathPrimitiveQuadraticCurveToCommand(o+.25*h,f+2*u,c,f+u),new r.PathPrimitiveQuadraticCurveToCommand(s-.25*h,f-u,s,f+u),new r.PathPrimitiveLineToCommand(s,e),new r.PathPrimitiveQuadraticCurveToCommand(s-.25*h,e-2*u,c,e-u),new r.PathPrimitiveQuadraticCurveToCommand(o+.25*h,e+u,o,e-u),new r.PathPrimitiveClosePathCommand],i)])},t.prototype.processConnectionPoint=function(n,i){var r=n.getConnectionPointSide(i);r===f.ConnectionPointSide.North&&(i.y+=n.size.height*t.curveOffsetRatio);r===f.ConnectionPointSide.South&&(i.y-=n.size.height*t.curveOffsetRatio)},t.prototype.getTextRectangle=function(n){var i=n.rectangle;return i.inflate(0,-i.height*t.curveOffsetRatio)},t.curveOffsetRatio=.1,t}(o.RectangleShapeDescription);t.PaperTapeShapeDescription=h},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(16),s=i(1),r=i(2),f=i(5),h=function(n){function t(){return n.call(this,void 0,!0)||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.ManualOperation},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var c=n.rectangle,i=n.rectangle,u=i.left,f=i.top,e=i.right,o=i.bottom,l=i.width,a=i.height,s=Math.min(Math.max(0,a/Math.tan(t.slopeAngle)),l),h=c.center.x,v=Math.min(u+s,h),y=Math.max(e-s,h);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(u,f),new r.PathPrimitiveLineToCommand(e,f),new r.PathPrimitiveLineToCommand(y,o),new r.PathPrimitiveLineToCommand(v,o),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.processConnectionPoint=function(n,i){var r=n.size.height/Math.tan(t.slopeAngle),u=n.getConnectionPointSide(i);u===f.ConnectionPointSide.East?i.x-=r/2:u===f.ConnectionPointSide.West&&(i.x+=r/2)},t.slopeAngle=81*Math.PI/180,t}(o.RectangleShapeDescription);t.ManualOperationShapeDescription=h},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=function(n){function t(){var t=n.call(this,void 0,!0)||this;return t.defaultSize.width=t.defaultSize.height,t}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Delay},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,i=t.left,u=t.top,o=t.right,f=t.bottom,e=t.center.x;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(i,u),new r.PathPrimitiveLineToCommand(e,u),new r.PathPrimitiveArcToCommand((o-i)/2,(f-u)/2,0,!1,!0,e,f),new r.PathPrimitiveLineToCommand(i,f),new r.PathPrimitiveClosePathCommand],n.style)]},t.arcWidthRatio=.2,t}(e.RectangleShapeDescription);t.DelayShapeDescription=s},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=function(n){function t(){return n.call(this,void 0,!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.StoredData},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,s=i.left,u=i.top,o=i.right,f=i.bottom,h=i.width,e=(i.height,i.center.y,h*t.arcWidthRatio);return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o,u),new r.PathPrimitiveLineToCommand(s+e/2,u),new r.PathPrimitiveArcToCommand(e/2,(f-u)/2,0,!1,!1,s+e/2,f),new r.PathPrimitiveLineToCommand(o,f),new r.PathPrimitiveArcToCommand(e/2,(f-u)/2,0,!1,!0,o,u)],n.style)]},t.prototype.getTextRectangle=function(n){var i=n.rectangle,r=i.width*t.arcWidthRatio;return i.resize(-r,0)},t.arcWidthRatio=.2,t}(e.RectangleShapeDescription);t.StoredDataShapeDescription=s},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(1),o=i(100),r=i(2),s=function(n){function t(){return n.call(this,!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return e.ShapeTypes.Merge},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var t=n.rectangle,u=t.left,i=t.top,f=t.right,e=t.bottom;return t.width,[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(u,i),new r.PathPrimitiveLineToCommand(f,i),new r.PathPrimitiveLineToCommand(t.center.x,e),new r.PathPrimitiveClosePathCommand],n.style)]},t.prototype.calculateHeight=function(n){return.75*n},t.prototype.getTextRectangle=function(n){var t=n.rectangle;return t.resize(0,.25*-t.width)},t}(o.TriangleShapeDescription);t.MergeShapeDescription=s},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(16),o=i(1),r=i(2),s=function(n){function t(){return n.call(this,void 0,!0)||this}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Display},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(n){var i=n.rectangle,e=i.left,f=i.top,o=i.right,s=i.bottom,h=i.width,c=(i.height,i.center.y),u=h*t.arcWidthRatio;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(o-u/2,f),new r.PathPrimitiveLineToCommand(e+u/2,f),new r.PathPrimitiveLineToCommand(e,c),new r.PathPrimitiveLineToCommand(e+u/2,s),new r.PathPrimitiveLineToCommand(o-u/2,s),new r.PathPrimitiveArcToCommand(u/2,(s-f)/2,0,!1,!1,o-u/2,f)],n.style)]},t.arcWidthRatio=.2,t}(e.RectangleShapeDescription);t.DisplayShapeDescription=s},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),s=i(0),f=i(9),h=i(55),r=i(2),c=function(n){function t(){var t=n.call(this,!0)||this;return t.defaultSize=new s.Size(.5*f.ShapeDefaultDimension,.5*f.ShapeDefaultDimension),t}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.Or},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableText",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(t){var i=t.rectangle,o=i.left,s=i.top,h=i.right,c=i.bottom,u=i.center,f=u.x,e=u.y;return[].concat(n.prototype.createShapePrimitives.call(this,t)).concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(f,s),new r.PathPrimitiveLineToCommand(f,c),new r.PathPrimitiveMoveToCommand(o,e),new r.PathPrimitiveLineToCommand(h,e)],t.style)])},t}(h.EllipseShapeDescription);t.OrShapeDescription=c},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),s=i(0),f=i(9),h=i(55),r=i(2),c=function(n){function t(){var t=n.call(this,!0)||this;return t.defaultSize=new s.Size(.5*f.ShapeDefaultDimension,.5*f.ShapeDefaultDimension),t}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.SummingJunction},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableText",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.createShapePrimitives=function(t){var i=t.rectangle,a=(i.left,i.top,i.right,i.bottom,i.width),v=i.height,s=i.center,f=s.x,e=s.y,h=a/2,c=v/2,l=Math.atan(c/h),u=1/Math.sqrt(1/Math.pow(h,2)+Math.pow(Math.tan(l),2)/Math.pow(c,2)),o=u*Math.tan(l);return[].concat(n.prototype.createShapePrimitives.call(this,t)).concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(f-u,e-o),new r.PathPrimitiveLineToCommand(f+u,e+o),new r.PathPrimitiveMoveToCommand(f-u,e+o),new r.PathPrimitiveLineToCommand(f+u,e-o)],t.style)])},t}(h.EllipseShapeDescription);t.SummingJunctionShapeDescription=c},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,null,o,void 0,s)||this;return h.x=t,h.y=i,h.width=r,h.height=u,h.createContent=f,h.data=e,h}return e(t,n),t.prototype.createMainElement=function(){return document.createElementNS(u.svgNS,"svg")},t.prototype.createChildElements=function(n){this.createContent(n,this.data)},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"x",this.x);this.setUnitAttribute(t,"y",this.y);this.setUnitAttribute(t,"width",this.width);this.setUnitAttribute(t,"height",this.height);this.setPositionCorrectionAttribute(t);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.SvgElementPrimitive=f},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(9),r=i(0),s=i(1),u=i(107),h=i(20),c=function(n){function t(){return n.call(this,new r.Size(2*e.ShapeDefaultDimension,1.5*e.ShapeDefaultDimension))||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.VerticalContainer},enumerable:!0,configurable:!0}),t.prototype.getExpandedSize=function(n){return new r.Size(n.size.width,n.expandedSize.height)},t.prototype.getCollapsedSize=function(n){return new r.Size(n.size.width,u.CONTAINER_HEADER_SIZE+2*n.strokeWidth)},t.prototype.allowResizeVertically=function(n){return n.expanded},t.prototype.createHeaderPrimitives=function(n,t){var u=n.rectangle,e=u.left,o=u.top,s=u.width,f=this.getHeaderSize(n,t),i=[];return i=i.concat([new h.RectanglePrimitive(e,o,s,f,n.style)]),t||(i=i.concat(this.createExpandButtonPrimitives(n,r.Rectangle.create(e,o,f,f)))),i},t.prototype.getClientRectangle=function(n){var t=n.rectangle,i=this.getHeaderSize(n);return new r.Rectangle(new r.Point(t.left,t.top+i),new r.Size(t.width,t.height-i))},t.prototype.getTextRectangle=function(n){var t=n.rectangle,i=this.getHeaderSize(n);return new r.Rectangle(new r.Point(t.left+i,t.top),new r.Size(t.width-i,i))},t.prototype.getHeaderSize=function(n,t){var i=n.rectangle;return t?i.height*u.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO:u.CONTAINER_HEADER_SIZE+2*n.strokeWidth},t}(u.ContainerDescription);t.VerticalContainerDescription=c},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(9),r=i(0),s=i(1),u=i(107),h=i(20),c=i(46),l=function(n){function t(){return n.call(this,new r.Size(2*e.ShapeDefaultDimension,1.5*e.ShapeDefaultDimension))||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.HorizontalContainer},enumerable:!0,configurable:!0}),t.prototype.getExpandedSize=function(n){return new r.Size(n.expandedSize.width,n.size.height)},t.prototype.getCollapsedSize=function(n){return new r.Size(u.CONTAINER_HEADER_SIZE+2*n.strokeWidth,n.size.height)},t.prototype.allowResizeHorizontally=function(n){return n.expanded},t.prototype.createHeaderPrimitives=function(n,t){var u=n.rectangle,e=u.left,o=u.top,s=u.height,f=this.getHeaderSize(n,t),i=[];return i=i.concat([new h.RectanglePrimitive(e,o,f,s,n.style)]),t||(i=i.concat(this.createExpandButtonPrimitives(n,r.Rectangle.create(e,o,f,f)))),i},t.prototype.getClientRectangle=function(n){var t=n.rectangle,i=this.getHeaderSize(n);return new r.Rectangle(new r.Point(t.left+i,t.top),new r.Size(t.width-i,t.height))},t.prototype.getTextRectangle=function(n){var t=n.rectangle,i=this.getHeaderSize(n);return new r.Rectangle(new r.Point(t.left,t.top+i),new r.Size(i,t.height-i))},t.prototype.getTextEditRectangle=function(n){var t=this.getTextRectangle(n);return new r.Rectangle(new r.Point(t.position.x,t.position.y+t.height),new r.Size(t.height,t.width))},t.prototype.getTextAngle=function(){return c.TextAngle.Angle270deg},t.prototype.getHeaderSize=function(n,t){var i=n.rectangle;return t?i.height*u.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO:u.CONTAINER_HEADER_SIZE+2*n.strokeWidth},t}(u.ContainerDescription);t.HorizontalContainerDescription=l},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(9),u=i(0),o=i(1),s=function(n){function t(){return n.call(this,new u.Size(1.5*f.ShapeDefaultDimension,.5*f.ShapeDefaultDimension))||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.CardWithImageOnLeft},enumerable:!0,configurable:!0}),t.prototype.getToolboxHeightToWidthRatio=function(){return 26/46},t.prototype.getRawImageSize=function(n,t){var i=Math.min(n.height,n.width)-2*this.getImageMargin(t);return new u.Size(i,i)},t.prototype.getTextBlockOffset=function(n,t){return new u.Offset(this.getImageSize(n,t).width,0,0,0)},t}(i(74).CardBaseDescription);t.CardWithImageOnLeftDescription=s},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e,o,s,h,c){void 0===f&&(f=0);void 0===e&&(e=0);var l=n.call(this,t,i,r,u,o,s,h,c)||this;return l.x=t,l.y=i,l.width=r,l.height=u,l.rx=f,l.ry=e,l}return e(t,n),t.prototype.createMainElement=function(){return document.createElementNS(u.svgNS,"rect")},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"rx",this.rx);this.setUnitAttribute(t,"ry",this.ry);n.prototype.applyElementProperties.call(this,t,i)},t}(i(20).RectanglePrimitive);t.RoundedRectanglePrimitive=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(9),u=i(0),o=i(1),s=function(n){function t(){return n.call(this,new u.Size(1.5*f.ShapeDefaultDimension,.5*f.ShapeDefaultDimension))||this}return e(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return o.ShapeTypes.CardWithImageOnRight},enumerable:!0,configurable:!0}),t.prototype.getToolboxHeightToWidthRatio=function(){return 26/46},t.prototype.getRawImageSize=function(n,t){var i=Math.min(n.height,n.width)-2*this.getImageMargin(t);return new u.Size(i,i)},t.prototype.getTextBlockOffset=function(n,t){return new u.Offset(0,0,this.getImageSize(n,t).width,0)},t}(i(74).CardBaseDescription);t.CardWithImageOnRightDescription=s},function(n,t,i){"use strict";var r,o=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(9),u=i(0),s=i(1),h=i(74),e=i(4),c=function(n){function t(){return n.call(this,new u.Size(.8*f.ShapeDefaultDimension,f.ShapeDefaultDimension))||this}return o(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return s.ShapeTypes.CardWithImageOnTop},enumerable:!0,configurable:!0}),t.prototype.getRawImageSize=function(n,t){var i=n.width/2,r;return e.UnitConverter.twipsToPixels(i)%2==1&&(i-=e.UnitConverter.pixelsToTwips(1)),r=Math.min(i,n.height-2*this.getImageMargin(t)),new u.Size(r,r)},t.prototype.getTextBlockOffset=function(n,t){return new u.Offset(0,this.getImageSize(n).height+this.getImageMargin(t),0,0)},t}(h.CardBaseDescription);t.CardWithImageOnTopDescription=c},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(1),o=i(0),u=i(9),s=function(n){function t(){var t=n.call(this,!1)||this;return t.defaultSize=new o.Size(.5*u.ShapeDefaultDimension,.5*u.ShapeDefaultDimension),t}return f(t,n),Object.defineProperty(t.prototype,"key",{get:function(){return e.ShapeTypes.Connector},enumerable:!0,configurable:!0}),t}(i(55).EllipseShapeDescription);t.ConnectorShapeDescription=s},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(57);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.executeCore=function(n,t){return t((new u.Exporter).export(this.control.model)),!0},t}(i(44).ExportImportCommandBase);t.ExportCommand=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"font-weight"},t.prototype.getStylePropertyValue=function(){return"bold"},t}(i(58).ToggleStyleTextPropertyCommand);t.ToggleFontBoldCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"font-style"},t.prototype.getStylePropertyValue=function(){return"italic"},t}(i(58).ToggleStyleTextPropertyCommand);t.ToggleFontItalicCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"text-decoration"},t.prototype.getStylePropertyValue=function(){return"underline"},t}(i(58).ToggleStyleTextPropertyCommand);t.ToggleFontUnderlineCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"font-family"},t}(i(76).ChangeStyleTextPropertyCommand);t.ChangeFontNameCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"font-size"},t}(i(76).ChangeStyleTextPropertyCommand);t.ChangeFontSizeCommand=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(76),e=i(4),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.processParameter=function(n){return e.ColorHelper.stringToHash(n)},t.prototype.getStyleProperty=function(){return"fill"},t}(f.ChangeStyleTextPropertyCommand);t.ChangeFontColorCommand=o},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(59),e=i(4),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.processParameter=function(n){return e.ColorHelper.stringToHash(n)},t.prototype.getStyleProperty=function(){return"fill"},t}(f.ChangeStylePropertyCommand);t.ChangeFillColorCommand=o},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(59),e=i(4),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.processParameter=function(n){return e.ColorHelper.stringToHash(n)},t.prototype.getStyleProperty=function(){return"stroke"},t}(f.ChangeStylePropertyCommand);t.ChangeStrokeColorCommand=o},function(n,t,i){"use strict";var f,u=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r,e,o,s;Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getStyleProperty=function(){return"text-anchor"},t}(i(58).ToggleStyleTextPropertyCommand);t.ChangeTextAlignCommand=r;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getStylePropertyValue=function(){return"start"},t}(r);t.TextLeftAlignCommand=e;o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getStylePropertyValue=function(){return"middle"},t}(r);t.TextCenterAlignCommand=o;s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getStylePropertyValue=function(){return"end"},t}(r);t.TextRightAlignCommand=s},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o;Object.defineProperty(t,"__esModule",{value:!0});var f=i(111),e=i(25),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getPropertyName=function(){return"startLineEnding"},t.prototype.getPropertyDefaultValue=function(){return e.ConnectorLineEnding.None},t}(f.ChangeConnectorPropertyCommand);t.ChangeConnectorStartLineEndingCommand=s;o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getPropertyName=function(){return"endLineEnding"},t.prototype.getPropertyDefaultValue=function(){return e.ConnectorLineEnding.Arrow},t}(f.ChangeConnectorPropertyCommand);t.ChangeConnectorEndLineEndingCommand=o},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(111),e=i(25),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getPropertyName=function(){return"lineOption"},t.prototype.getPropertyDefaultValue=function(){return e.ConnectorLineOption.Straight},t}(f.ChangeConnectorPropertyCommand);t.ChangeConnectorLineOptionCommand=o},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.executeCore=function(){var n=[];return this.control.model.iterateItems(function(t){return n.push(t.key)}),this.control.selection.set(n),!0},t}(i(8).SimpleCommandBase);t.SelectAllCommand=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(29),u=function(){function n(n,t){var u=this,i,r;this.childToParent={};this.root=n;this.parentToChildren=t;i=function(n){if(!t.hasOwnProperty(n))return"continue";t[n].forEach(function(t){return u.childToParent[t.key]=n})};for(r in t)i(r)}return n.prototype.getChildren=function(n){return n&&this.parentToChildren[n.key]?this.parentToChildren[n.key]:[]},n.prototype.hasChildren=function(n){return this.parentToChildren[n.key]&&this.parentToChildren[n.key].length>0},n.prototype.iterate=function(n){this.iterateCore(this.root,0,n)},n.createSpanningTree=function(t){var f=n.findRoot(t),i=t.createIterator(r.ConnectionMode.Outgoing),u={};return i.skipEdge=function(n){return void 0===n.to||i.isNodeVisited(n.to)},i.onNode=function(n){return u[n.key]=[]},i.onEdge=function(n){var i=t.getNode(n.to);i&&u[n.from].push(i)},i.iterate(f),new n(t.getNode(f),u)},n.prototype.iterateCore=function(n,t,i){var r=this;i(n,t);this.getChildren(n).forEach(function(n){return r.iterateCore(n,t+1,i)})},n.findRoot=function(n){return n.nodes.reduce(function(t,i){var u=n.getAdjacentEdges(i),r=u.filter(function(n){return n.to===i}).length,f=u.filter(function(n){return n.from===i}).length;return(void 0===t.candidate||0===r&&t.inc>0||0!==t.inc&&t.out-t.inc<f-r)&&(t.candidate=i,t.inc=r,t.out=f),t},{inc:-1,out:-1,candidate:void 0}).candidate},n}();t.Tree=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.executeCore=function(n,t){var i=void 0===t?!this.control.settings.snapToGrid:!!t;return this.control.settings.snapToGrid!==i&&(this.control.settings.snapToGrid=i,!0)},t.prototype.getValue=function(){return this.control.settings.snapToGrid},t}(i(8).SimpleCommandBase);t.ChangeSnapToGridCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,e,o;Object.defineProperty(t,"__esModule",{value:!0});u=i(8);e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.getModelUnit(this.control.settings.gridSize)},t.prototype.executeCore=function(n,t){return this.control.settings.gridSize=this.getModelUnitTwipsValue(t),!0},t.prototype.getItems=function(){var n=this;return this.control.settings.gridSizeItems.map(function(t){return{value:n.getModelUnit(t),text:n.getViewUnitText(t)}})},t}(u.SimpleCommandBase);t.ChangeGridSizeCommand=e;o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){var n=this;return this.control.settings.gridSizeItems.map(function(t){return n.getModelUnit(t)})},t.prototype.executeCore=function(n,t){var i=this;return this.control.settings.gridSizeItems=t.map(function(n){return i.getModelUnitTwipsValue(n)}),!0},t}(u.SimpleCommandBase);t.ChangeGridSizeItemsCommand=o},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(61),e=i(220),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.getValue=function(){return this.control.model.pageLandscape},t.prototype.createHistoryItems=function(n){return[new e.ChangePageLandscapeHistoryItem(n)]},t}(f.ChangePagePropertyCommand);t.ChangePageLandscapeCommand=o},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.value=t,i}return f(t,n),t.prototype.redo=function(n){this.oldValue=n.model.pageLandscape;n.changePageLandscape(this.value)},t.prototype.undo=function(n){n.changePageLandscape(this.oldValue)},t}(i(3).HistoryItem);t.ChangePageLandscapeHistoryItem=u},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e;Object.defineProperty(t,"__esModule",{value:!0});var o=i(61),r=i(0),s=i(222),h=i(8),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getValue=function(){return this.getModelUnitSize(this.control.model.pageSize)},t.prototype.createHistoryItems=function(n){return[new s.ChangePageSizeHistoryItem(new r.Size(this.getModelUnitTwipsValue(n.width),this.getModelUnitTwipsValue(n.height)))]},t.prototype.getItems=function(){var n=this;return this.control.settings.pageSizeItems.map(function(t){return{value:n.getModelUnitSize(t.size),text:t.text.replace("{width}",n.getViewUnitText(t.size.width)).replace("{height}",n.getViewUnitText(t.size.height))}})},t.prototype.getModelUnitSize=function(n){return new r.Size(this.getModelUnit(n.width),this.getModelUnit(n.height))},t}(o.ChangePagePropertyCommand);t.ChangePageSizeCommand=c;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabled=function(){return!0},t.prototype.getValue=function(){var n=this;return this.control.settings.pageSizeItems.map(function(t){return{size:new r.Size(n.getModelUnit(t.width),n.getModelUnit(t.height)),text:t.text}})},t.prototype.executeCore=function(n,t){var i=this;return this.control.settings.pageSizeItems=t.map(function(n){return{size:new r.Size(i.getModelUnitTwipsValue(n.width),i.getModelUnitTwipsValue(n.height)),text:n.text}}),!0},t}(h.SimpleCommandBase);t.ChangePageSizeItemsCommand=e},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.size=t,i}return f(t,n),t.prototype.redo=function(n){this.oldSize=n.model.pageSize;n.changePageSize(this.size)},t.prototype.undo=function(n){n.changePageSize(this.oldSize)},t}(i(3).HistoryItem);t.ChangePageSizeHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getExtension=function(){return"png"},t.prototype.getExportFunc=function(){return this.exporter.exportPng},t}(i(78).ExportImageCommand);t.ExportPngCommand=u},function(n,t,i){"use strict";var r,o=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})},h=this&&this.__generator||function(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===e[0]||2===e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(n){e=[6,n];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e};Object.defineProperty(t,"__esModule",{value:!0});var c=i(14),u=i(24),l=i(15),a=i(32),f=i(4),e=i(12),v=i(79),y=function(n){function t(t,i){var r=n.call(this,1,new v.ExportDOMManipulator(i))||this;return r.itemsContainer=t,r}return o(t,n),t.prototype.getSvgImage=function(n,t){var i=e.RenderHelper.createSvgElement(void 0,!0),v=n.transform(c.UnitConverter.twipsToPixelsF).transform(Math.ceil),o,s,h,r,a;for(l.RenderUtils.updateSvgElementSize(i,v.width,v.height,!0),i.style.backgroundColor=f.ColorHelper.colorToHash(t),this.createTextFloodFilter(void 0,i,t),o=this.getExportCssRules(),s=o&&!u.Browser.IE,s&&(h=document.createElementNS(e.svgNS,"style"),h.innerHTML=o,i.appendChild(h)),r=0;r<this.itemsContainer.childNodes.length;r++)a=this.itemsContainer.childNodes[r].cloneNode(!0),s||this.inlineStyle(a,this.itemsContainer.childNodes[r]),i.appendChild(a);return i},t.prototype.getSvgImageUrl=function(n,t){var i=this.getSvgImage(n,t);return this.getSvgBase64String(i)},t.prototype.getSvgString=function(n){return(new XMLSerializer).serializeToString(n)},t.prototype.getSvgBase64String=function(n){var i=this.getSvgString(n);return t.base64Start+this.getBase64EncodeUnicode(i)},t.prototype.getBase64EncodeUnicode=function(n){return btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,function(n,t){return String.fromCharCode(parseInt("0x"+t,16))}))},t.prototype.getExportCssRules=function(){for(var t,i,r,u,f,n=0;n<document.styleSheets.length;n++)if(t=this.getRules(document.styleSheets[n]),t){for(i="",r=0;r<t.length;r++)u=t[r],f=this.isCSSStyleRule(u)?u.selectorText:null,f&&this.checkSelector(f)&&(i+=u.cssText+"\n");if(i.length>0)return"\n"+i}},t.prototype.checkSelector=function(n){for(var i=0;i<t.exportStyleRules.length;i++)if(0===n.indexOf(t.exportStyleRules[i]))return!0;return!1},t.prototype.getRules=function(n){try{return this.isCSSStyleSheet(n)?n.rules||n.cssRules:null}catch(n){}},t.prototype.isCSSStyleSheet=function(n){return void 0!==n.rules},t.prototype.isCSSStyleRule=function(n){return void 0!==n.selectorText},t.prototype.inlineStyle=function(n,i){for(var u,e,f,o,r=0;r<n.childNodes.length;r++)if(u=n.childNodes[r],u.tagName)if("g"===u.tagName)this.inlineStyle(u,i.childNodes[r]);else if(u.style&&(e=window.getComputedStyle(i.childNodes[r]),void 0!==e))for(f=0;f<t.exportStyleAttributes.length;f++)o=t.exportStyleAttributes[f],u.style.setProperty(o,e.getPropertyValue(o))},t.prototype.exportSvgImage=function(n,t,i){i(this.getSvgImageUrl(n,t))},t.prototype.exportBinaryImage=function(n,t,i,r){var o=this.getAbsoluteSize(n).transform(Math.ceil),s=document.createElement("canvas"),h,e;s.width=o.width;s.height=o.height;h=s.getContext("2d");(h.fillStyle=f.ColorHelper.colorToHash(t),h.fillRect(0,0,o.width,o.height),u.Browser.IE&&"object"==typeof canvg)?this.exportBinaryImageCanvgAsync(n,t,s,h,i).then(function(n){return r(n)}):u.Browser.IE&&"function"==typeof canvg?this.exportBinaryImageCanvgOld(n,t,s,h,i,r):(e=new Image,e.width=o.width,e.height=o.height,e.setAttribute("crossOrigin","anonymous"),e.onload=function(){h.drawImage(e,0,0);r(s.toDataURL(i,1))},e.src=this.getSvgImageUrl(n,t))},t.prototype.exportBinaryImageCanvgOld=function(n,t,i,r,u,f){var e=this.getSvgImage(n,t),o=this.getSvgString(e);r.drawSvg(o,0,0,null,null,{renderCallback:function(){f(i.toDataURL(u,1))}})},t.prototype.exportBinaryImageCanvgAsync=function(n,t,i,r,u){return s(this,void 0,void 0,function(){var f,e;return h(this,function(o){switch(o.label){case 0:return f=this.getSvgImage(n,t),e=this.getSvgString(f),[4,canvg.Canvg.fromString(r,e).render()];case 1:return o.sent(),[2,i.toDataURL(u,1)]}})})},t.prototype.exportPngImage=function(n,t,i){this.exportBinaryImage(n,t,"image/png",i)},t.prototype.exportJpgImage=function(n,t,i){this.exportBinaryImage(n,t,"image/jpeg",i)},t.prototype.notifyModelChanged=function(){},t.prototype.notifyPageColorChanged=function(){},t.prototype.notifyPageSizeChanged=function(){},t.base64Start="data:image/svg+xml;base64,",t.exportStyleRules=[".dxdi-canvas .shape ",".dxdi-canvas .connector ",".dxdi-canvas text",".dxdi-canvas.export"],t.exportStyleAttributes=["fill","stroke","stroke-width","font-family","font-size","font-weight","font-style","text-decoration","text-anchor"],t}(a.CanvasManagerBase);t.CanvasExportManager=y},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getExtension=function(){return"svg"},t.prototype.getExportFunc=function(){return this.exporter.exportSvg},t}(i(78).ExportImageCommand);t.ExportSvgCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getExtension=function(){return"jpg"},t.prototype.getExportFunc=function(){return this.exporter.exportJpg},t}(i(78).ExportImageCommand);t.ExportJpgCommand=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(57);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty(!0)},t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.executeCore=function(){var n=(new u.Exporter).exportItems(this.control.selection.getSelectedItems(!0,!0));return this.setClipboardData(n),!0},t}(i(81).ClipboardCommand);t.CopySelectionCommand=f},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(57),e=i(7),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty()},t.prototype.executeCore=function(){var n=(new f.Exporter).exportItems(this.control.selection.getSelectedItems(!0,!0));return this.setClipboardData(n),e.ModelUtils.deleteSelection(this.control.history,this.control.model,this.control.selection),!0},t}(i(81).ClipboardCommand);t.CutSelectionCommand=o},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),r,f;Object.defineProperty(t,"__esModule",{value:!0});r=i(117);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.getShapeNewPosition=function(n){return r.PasteSelectionCommandBase.getShapeNewPosition(this.control.model,n)},t.prototype.changeConnectorPoints=function(n){r.PasteSelectionCommandBase.changeConnectorPoints(this.control.model,n)},t}(r.PasteSelectionCommandBase);t.PasteSelectionCommand=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.shape=t,i}return f(t,n),t.prototype.redo=function(n){this.shapeKey=this.shape.key;n.insertShape(this.shape)},t.prototype.undo=function(n){n.removeShape(n.model.findShape(this.shapeKey))},t}(i(3).HistoryItem);t.ImportShapeHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.connector=t,i}return f(t,n),t.prototype.redo=function(n){this.connectorKey=this.connector.key;n.insertConnector(this.connector)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.removeConnector(t)},t}(i(3).HistoryItem);t.ImportConnectorHistoryItem=u},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=i(233),r=i(7),h=i(42),c=i(0),f=i(6),l=i(50),e=i(35),a=i(62),v=i(17),y=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.executeCore=function(n,t){var i=new s.BPMNImporter(t).import();return this.updateModel(i),!0},t.prototype.updateModel=function(n){var t=this,i={},u=[],o=[],s;this.control.history.beginTransaction();n.items.forEach(function(n){var r=new h.AddShapeHistoryItem(t.getShapeDescription(n.type),new c.Point(0,0),n.text,n.key),f;t.control.history.addAndRedo(r);i[n.key]=r.shapeKey;f=t.control.model.findShape(r.shapeKey);u.push(f)});n.edges.forEach(function(n){var u=t.control.model.findShape(i[n.from]),s=t.control.model.findShape(i[n.to]),h=new l.AddConnectorHistoryItem([u.getConnectionPointPosition(0),s.getConnectionPointPosition(0)]),r;t.control.history.addAndRedo(h);r=t.control.model.findConnector(h.connectorKey);t.control.history.addAndRedo(new e.AddConnectionHistoryItem(r,u,0,f.ConnectorPosition.Begin));t.control.history.addAndRedo(new e.AddConnectionHistoryItem(r,s,0,f.ConnectorPosition.End));o.push(r)});s=new v.LayoutSettings;r.ModelUtils.getGraphInfoByItems(this.control.model,u,o).forEach(function(n){var i=new a.SugiyamaLayoutBuilder(s,n.graph).build(),f=r.ModelUtils.getNonGraphItems(t.control.model,n.container,i.nodeToLayout,u,o);r.ModelUtils.applyLayout(t.control.history,t.control.model,void 0,n.graph,i,f,s,t.control.settings.snapToGrid,t.control.settings.gridSize,!1)});r.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model);this.control.history.endTransaction()},t.prototype.getShapeDescription=function(n){return this.control.shapeDescriptionManager.get(n)},t}(i(44).ExportImportCommandBase);t.ImportBPMNCommand=y},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f,e;Object.defineProperty(t,"__esModule",{value:!0});var s=i(51),r=i(1),h=i(29),c=i(75),l=function(){function n(n){this.doc=c.ImportUtils.createDocument(n);this.graph=new s.Graph([],[])}return n.prototype.import=function(){for(var n=void 0,t=0;n=this.doc.children[t];t++)"DEFINITIONS"===n.nodeName.toUpperCase()&&this.onDefinitionsElement(n);return this.validate(),this.graph},n.prototype.validate=function(){var i={},n,t;for(this.graph.nodes.forEach(function(n){return i[n]=!0}),n=0,t=void 0;t=this.graph.edges[n];n++)i[t.from]&&i[t.to]||(this.graph.edges.splice(n,1),n--)},n.prototype.onDefinitionsElement=function(n){this.dataSourceKey=n.getAttribute("id");for(var t=void 0,i=0;t=n.children[i];i++)"PROCESS"===t.nodeName.toUpperCase()&&this.onProcessElement(t)},n.prototype.onProcessElement=function(n){for(var t=void 0,i=0;t=n.children[i];i++)switch(t.nodeName.toUpperCase()){case"STARTEVENT":this.onStartEventElement(t);break;case"SEQUENCEFLOW":this.onSequenceFlowElement(t);break;case"SCRIPTTASK":this.onScriptTaskElement(t);break;case"USERTASK":this.onUserTaskElement(t);break;case"SERVICETASK":this.onServiceTaskElement(t);break;case"SENDTASK":this.onSendTaskElement(t);break;case"EXCLUSIVEGATEWAY":this.onExclusiveGateway(t);break;case"ENDEVENT":this.onEndEventGateway(t)}},n.prototype.onStartEventElement=function(n){var t=this.createNode(n);t.type=r.ShapeTypes.Ellipse;t.text=n.getAttribute("name");this.graph.addNode(t)},n.prototype.onSequenceFlowElement=function(n){var i=n.getAttribute("sourceRef"),r=n.getAttribute("targetRef"),t=this.createEdge(n,i,r);n.hasAttribute("name")&&(t.text=n.getAttribute("name"));this.graph.addEdge(t)},n.prototype.onScriptTaskElement=function(n){var t=this.createNode(n);t.text=n.getAttribute("name");this.graph.addNode(t)},n.prototype.onUserTaskElement=function(n){var t=this.createNode(n);t.text=n.getAttribute("name");this.graph.addNode(t)},n.prototype.onServiceTaskElement=function(n){var t=this.createNode(n);t.text=n.getAttribute("name");this.graph.addNode(t)},n.prototype.onSendTaskElement=function(n){var t=this.createNode(n);t.text=n.getAttribute("name");this.graph.addNode(t)},n.prototype.onExclusiveGateway=function(n){var t=this.createNode(n);t.text=n.getAttribute("name");t.type=r.ShapeTypes.Decision;this.graph.addNode(t)},n.prototype.onEndEventGateway=function(n){var t=this.createNode(n);t.text=n.getAttribute("name");t.type=r.ShapeTypes.Ellipse;this.graph.addNode(t)},n.prototype.createNode=function(n){return new f(this.dataSourceKey,n.getAttribute("id"))},n.prototype.createEdge=function(n,t,i){return new e(this.dataSourceKey,n.getAttribute("id"),t,i)},n}();t.BPMNImporter=l;f=function(){return function(n,t){this.sourceKey=n;this.key=t;this.type=r.ShapeTypes.Rectangle}}();t.BPMNNode=f;e=function(n){function t(t,i,r,u){var f=n.call(this,i,r,u)||this;return f.sourceKey=t,f}return o(t,n),t}(h.Edge)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(51),r=i(29),f=i(67),e=function(){function n(){}return n.removeCycles=function(n){var t=this.getFeedbackSet(n);return this.reverseEdges(n,t)},n.getFeedbackSet=function(n){for(var r=this,t={},i=this.getNonTrivialStronglyConnectedComponents(n);i.length;)i.forEach(function(n){var i=r.getMaxCyclicEdges(n);i.forEach(function(n){return delete t[n.reverse().getHashKey()]});i.forEach(function(n){return t[n.getHashKey()]=!0})}),i=this.getNonTrivialStronglyConnectedComponents(this.reverseEdges(n,t).graph);return t},n.getMaxCyclicEdges=function(n){var s={},u={},i={},e=[],h=[],t=n.createIterator(r.ConnectionMode.Outgoing),o;return t.visitEachEdgeOnce=!1,t.onNode=function(n){u[n.key]=!0},t.skipNode=function(n){var f,r,t;if(u[n.key]){for(f=[],r=0;r<e.length;r++)if(t=e[r],void 0===i[t.key]&&(i[t.key]=0),i[t.key]++,f.push(t),t.from===n.key)break;h.push(f)}return u[n.key]||s[n.key]},t.skipEdge=function(){return!1},t.onEdge=function(n){e.splice(0,0,n)},t.onAfterEdge=function(){e.splice(0,1)},t.onAllEdges=function(n){s[n.key]=!0;u[n.key]=!1},t.iterate(n.nodes[0]),o=new f.HashSet([],function(n){return n.key}),h.forEach(function(n){o.tryPush(n.reduce(function(n,t){return i[t.key]>i[n.key]?t:n},n[0]))}),o.list()},n.reverseEdges=function(n,t){var r=new f.HashSet([],function(n){return n.getHashKey()}),i={},e={};return n.edges.forEach(function(n){t[n.getHashKey()]&&(n=n.reverse(),i[n.key]=!0);r.tryPush(n)||(e[n.key]=!0,delete i[n.key])}),{graph:new u.Graph(n.nodes.map(function(t){return n.getNode(t)}),r.list()),reversedEdges:i,removedEdges:e}},n.getNonTrivialStronglyConnectedComponents=function(n){return this.getStronglyConnectedComponents(n).filter(function(n){return n.edges.length})},n.getStronglyConnectedComponents=function(n){for(var l,t,a=this,h=[],u=0,f={},i={},e={},c=[],o={},s=0;s<n.nodes.length;s++)l=n.nodes[s],t=n.createIterator(r.ConnectionMode.Outgoing),t.visitEachEdgeOnce=!1,t.visitEachNodeOnce=!1,t.onNode=function(n){o[n.key]=!0;h.push(n);e[n.key]=!0;i[n.key]=u;f[n.key]=u;u++},t.skipNode=function(n){return o[n.key]},t.skipEdge=function(n){var t=o[n.to];return t&&e[n.to]&&(i[n.from]=Math.min(i[n.from],f[n.to])),t},t.onAfterEdge=function(n){i[n.from]=Math.min(i[n.from],i[n.to])},t.onAllEdges=function(t,r){r&&i[t.key]===f[t.key]&&c.push(a.getStronglyConnectedComponent(n,t,h,e))},t.iterate(l);return c},n.getStronglyConnectedComponent=function(n,t,i,f){var e,o={},s=[],h=[];do e=i.pop(),o[e.key]||s.push(e),o[e.key]=!0,f[e.key]=!1;while(e!==t);return s.forEach(function(t){var i=n.getAdjacentEdges(t.key,r.ConnectionMode.Outgoing);h.push.apply(h,i.filter(function(n){return!o[n.key]&&o[n.to]}));i.forEach(function(n){return o[n.key]=!0})}),new u.Graph(s,h)},n}();t.CycleRemover=e},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(82);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabled=function(){var t=this.control.selection.getSelectedItems();return n.prototype.isEnabled.call(this)&&t.length>0&&this.needSendToBack(t)},t.prototype.executeCore=function(){var n=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedItems().forEach(function(t){var i=n.control.model.getIntersectItemsMinZIndex(t)-1;n.control.history.addAndRedo(new u.ChangeZindexHistoryItem(t,i))}),this.control.history.endTransaction(),!0},t.prototype.needSendToBack=function(n){for(var i,r=this,f=function(t){var f=u.control.model.getIntersectItemsMinZIndex(n[t]),i;return f<n[t].zIndex?{value:!0}:f===n[t].zIndex?(i=!1,u.control.model.getIntersectItems(n[t]).filter(function(i){return i.zIndex===n[t].zIndex}).forEach(function(u){r.control.model.getItemIndex(u)<r.control.model.getItemIndex(n[t])&&(i=!0)}),{value:i}):void 0},u=this,t=0;t<n.length;t++)if(i=f(t),"object"==typeof i)return i.value;return!1},t}(i(8).SimpleCommandBase);t.SendToBackCommand=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(82);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabled=function(){var t=this.control.selection.getSelectedItems();return n.prototype.isEnabled.call(this)&&t.length>0&&this.needBringToFront(t)},t.prototype.executeCore=function(){var n=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedItems().forEach(function(t){var i=n.control.model.getIntersectItemsMaxZIndex(t)+1;n.control.history.addAndRedo(new u.ChangeZindexHistoryItem(t,i))}),this.control.history.endTransaction(),!0},t.prototype.needBringToFront=function(n){for(var i,r=this,f=function(t){var f=u.control.model.getIntersectItemsMaxZIndex(n[t]),i;return f>n[t].zIndex?{value:!0}:f===n[t].zIndex?(i=!1,u.control.model.getIntersectItems(n[t]).filter(function(i){return i.zIndex===n[t].zIndex}).forEach(function(u){r.control.model.getItemIndex(u)>r.control.model.getItemIndex(n[t])&&(i=!0)}),{value:i}):void 0},u=this,t=0;t<n.length;t++)if(i=f(t),"object"==typeof i)return i.value;return!1},t}(i(8).SimpleCommandBase);t.BringToFrontCommand=f},function(n,t,i){"use strict";var s,r=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}s(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),h,c,l,a,v,y,p,w;Object.defineProperty(t,"__esModule",{value:!0});var e=i(0),f=i(7),o=i(14),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty()},t.prototype.executeCore=function(){var n=this;return this.control.history.beginTransaction(),this.control.selection.getSelectedShapes().forEach(function(t){var i=n.getPosition(t.position);f.ModelUtils.setShapePosition(n.control.history,n.control.model,t,i);f.ModelUtils.updateShapeAttachedConnectors(n.control.history,n.control.model,t)}),this.control.selection.getSelectedConnectors().forEach(function(t){for(var r,u=t.beginItem?1:0,e=t.endItem?t.points.length-2:t.points.length-1,i=u;i<=e;i++)r=n.getPosition(t.points[i]),f.ModelUtils.setConnectorPoint(n.control.history,n.control.model,t,i,r)}),f.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.endTransaction(),!0},t}(i(8).SimpleCommandBase);t.MoveCommand=u;h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return n.offset(-o.UnitConverter.pixelsToTwips(1),0)},t}(u);t.MoveLeftCommand=h;c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return this.control.settings.snapToGrid?new e.Point(f.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,n.x-(this.control.settings.gridSize/2+2),!0),n.y):n.offset(-this.control.settings.gridSize,0)},t}(u);t.MoveStepLeftCommand=c;l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return n.offset(o.UnitConverter.pixelsToTwips(1),0)},t}(u);t.MoveRightCommand=l;a=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return this.control.settings.snapToGrid?new e.Point(f.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,n.x+(this.control.settings.gridSize/2+2),!0),n.y):n.offset(this.control.settings.gridSize,0)},t}(u);t.MoveStepRightCommand=a;v=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return n.offset(0,-o.UnitConverter.pixelsToTwips(1))},t}(u);t.MoveUpCommand=v;y=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return this.control.settings.snapToGrid?new e.Point(n.x,f.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,n.y-(this.control.settings.gridSize/2+2),!1)):n.offset(0,-this.control.settings.gridSize)},t}(u);t.MoveStepUpCommand=y;p=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return n.offset(0,o.UnitConverter.pixelsToTwips(1))},t}(u);t.MoveDownCommand=p;w=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getPosition=function(n){return this.control.settings.snapToGrid?new e.Point(n.x,f.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,n.y+(this.control.settings.gridSize/2+2),!1)):n.offset(0,this.control.settings.gridSize)},t}(u);t.MoveStepDownCommand=w},function(n,t,i){"use strict";var s,r=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}s(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),l,f,a,v,y,p,w,b,k,d,c,g,nt,o,tt,it,rt;Object.defineProperty(t,"__esModule",{value:!0});var e=i(8),u=i(34),h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.view.getZoom()},t.prototype.executeCore=function(n,t){return this.control.settings.zoomLevel=t,this.control.settings.autoZoom=u.AutoZoomMode.Disabled,this.control.updateLayout(!0),!0},t.prototype.getItems=function(){return this.control.settings.zoomLevelItems.map(function(n){return{value:n,text:100*n+"%"}})},t}(e.SimpleCommandBase);t.ChangeZoomLevelCommand=h;l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.executeCore=function(t,i){return n.prototype.executeCore.call(this,t,i/100)},t.prototype.getValue=function(){return 100*this.control.view.getZoom()},t}(h);t.ChangeZoomLevelInPercentageCommand=l;f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getValue=function(){return this.control.view.getZoom()===this.exactValue},t.prototype.executeCore=function(t){return n.prototype.executeCore.call(this,t,this.exactValue),!0},t.prototype.getItems=function(){},t}(h);a=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=.25,t}return r(t,n),t}(f);t.ChangeZoomLevelTo25Command=a;v=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=.5,t}return r(t,n),t}(f);t.ChangeZoomLevelTo50Command=v;y=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=.75,t}return r(t,n),t}(f);t.ChangeZoomLevelTo75Command=y;p=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=1,t}return r(t,n),t}(f);t.ChangeZoomLevelTo100Command=p;w=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=1.25,t}return r(t,n),t}(f);t.ChangeZoomLevelTo125Command=w;b=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=1.5,t}return r(t,n),t}(f);t.ChangeZoomLevelTo150Command=b;k=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.exactValue=2,t}return r(t,n),t}(f);t.ChangeZoomLevelTo200Command=k;d=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.zoomLevelItems},t.prototype.executeCore=function(n,t){return this.control.settings.zoomLevelItems=t,!0},t}(e.SimpleCommandBase);t.ChangeZoomLevelItemsCommand=d;c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!!this.control.render},t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.executeCore=function(){var n=this.getZoomLevel();return this.control.settings.zoomLevel=n,this.control.settings.autoZoom=u.AutoZoomMode.Disabled,this.control.updateLayout(!0),!0},t}(e.SimpleCommandBase);g=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getZoomLevel=function(){return this.control.render.view.getActualAutoZoomLevel(u.AutoZoomMode.FitContent)},t}(c);t.FitToScreenCommand=g;nt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getZoomLevel=function(){return this.control.render.view.getActualAutoZoomLevel(u.AutoZoomMode.FitToWidth)},t}(c);t.FitToWidthCommand=nt;o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.autoZoom},t.prototype.executeCore=function(n,t){return t=parseInt(t),this.control.settings.autoZoom!==t&&(t===u.AutoZoomMode.Disabled&&(this.control.settings.zoomLevel=this.control.view.getZoom()),this.control.settings.autoZoom=t,this.control.updateLayout(!0),!0)},t}(e.SimpleCommandBase);t.SwitchAutoZoomCommand=o;tt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getValue=function(){return this.control.settings.autoZoom===u.AutoZoomMode.FitContent},t.prototype.executeCore=function(t){return n.prototype.executeCore.call(this,t,u.AutoZoomMode.FitContent)},t}(o);t.ToggleAutoZoomToContentCommand=tt;it=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getValue=function(){return this.control.settings.autoZoom===u.AutoZoomMode.FitToWidth},t.prototype.executeCore=function(t){return n.prototype.executeCore.call(this,t,u.AutoZoomMode.FitToWidth)},t}(o);t.ToggleAutoZoomToWidthCommand=it;rt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!!this.control.render},t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.autoZoom},t.prototype.executeCore=function(n,t){var i;return i=void 0===t?this.control.settings.autoZoom===u.AutoZoomMode.Disabled?u.AutoZoomMode.FitContent:u.AutoZoomMode.Disabled:t?u.AutoZoomMode.FitContent:u.AutoZoomMode.Disabled,this.control.settings.autoZoom!==i&&(i||(this.control.settings.zoomLevel=this.control.view.getZoom()),this.control.settings.autoZoom=i,this.control.updateLayout(!0),!0)},t}(e.SimpleCommandBase);t.ToggleAutoZoomCommand=rt},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(7),e=i(240),o=i(119),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.performImportData=function(n){var t=this.control.createDocumentDataSource(n.nodeDataSource,n.edgeDataSource,n.dataParameters,n.nodeDataImporter,n.edgeDataImporter),i;t.beginChangesNotification();i=n.layoutParameters?new o.DataLayoutParameters(n.layoutParameters):void 0;this.control.history.beginTransaction();f.ModelUtils.deleteAllItems(this.control.history,this.control.model,this.control.selection);this.createItems(t,i);this.control.history.endTransaction();this.control.history.clear();t.endChangesNotification(!0)},t}(e.ImportDataCommandBase);t.BindDocumentCommand=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.executeCore=function(n,t){if(!t||!Array.isArray(t.nodeDataSource))throw Error("Format exception");return this.performImportData(t),this.control.updateLayout(!0),!0},t.prototype.createItems=function(n,t){n.createModelItems(this.control.history,this.control.model,this.control.shapeDescriptionManager,this.control.selection,t,this.control.settings.snapToGrid,this.control.settings.gridSize)},t}(i(8).SimpleCommandBase);t.ImportDataCommandBase=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(7);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.executeCore=function(){return this.control.deleteDocumentDataSource(),u.ModelUtils.deleteAllItems(this.control.history,this.control.model,this.control.selection),this.control.history.clear(),!0},t}(i(8).SimpleCommandBase);t.UnbindDocumentCommand=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getLockState=function(){return!0},t}(i(122).ChangeLockedCommand);t.LockCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getLockState=function(){return!1},t}(i(122).ChangeLockedCommand);t.UnLockCommand=u},function(n,t,i){"use strict";var f,r=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e,o,s,h;Object.defineProperty(t,"__esModule",{value:!0});var c=i(19),l=i(7),u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.isEnabled=function(){return n.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty()},t.prototype.executeCore=function(){var n=c.DiagramModel.getRectangle(this.control.selection.getSelectedItems());return l.ModelUtils.cloneSelectionToOffset(this.control.history,this.control.model,this.control.selection,this.getOffsetX(n),this.getOffsetY(n)),!0},t.prototype.getOffsetX=function(){return 0},t.prototype.getOffsetY=function(){return 0},t}(i(8).SimpleCommandBase);t.CloneCommand=u;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getOffsetX=function(n){return-n.width},t}(u);t.CloneLeftCommand=e;o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getOffsetX=function(n){return n.width},t}(u);t.CloneRightCommand=o;s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getOffsetY=function(n){return-n.height},t}(u);t.CloneUpCommand=s;h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return r(t,n),t.prototype.getOffsetY=function(n){return n.height},t}(u);t.CloneDownCommand=h},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e;Object.defineProperty(t,"__esModule",{value:!0});var o=i(61),s=i(246),h=i(8),r=i(4),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.model.units},t.prototype.createHistoryItems=function(n){return[new s.ChangeUnitsHistoryItem(n)]},t.prototype.getItems=function(){return Object.keys(r.DiagramLocalizationService.unitItems).map(function(n){return{value:parseInt(n),text:r.DiagramLocalizationService.unitItems[n]}})},t}(o.ChangePagePropertyCommand);t.ChangeUnitsCommand=c;e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.viewUnits},t.prototype.executeCore=function(n,t){return this.control.settings.viewUnits=t,!0},t.prototype.getItems=function(){return Object.keys(r.DiagramLocalizationService.unitItems).map(function(n){return{value:parseInt(n),text:r.DiagramLocalizationService.unitItems[n]}})},t}(h.SimpleCommandBase);t.ChangeViewUnitsCommand=e},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f;Object.defineProperty(t,"__esModule",{value:!0});f=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.setValue=function(n,t){return n.units=t},t.getValue=function(n){return n.units},t}return u(t,n),t}(function(n){function t(t){var i=n.call(this)||this;return i.value=t,i}return u(t,n),t.prototype.redo=function(n){var t=this;this.oldValue=this.getValue(n.model);n.changePageProperty(function(n){return t.setValue(n,t.value)})},t.prototype.undo=function(n){var t=this;n.changePageProperty(function(n){return t.setValue(n,t.oldValue)})},t}(i(3).HistoryItem));t.ChangeUnitsHistoryItem=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(61),o=i(248),u=i(4),s=i(19),h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getValue=function(){return u.ColorHelper.colorToHash(this.control.model.pageColor)},t.prototype.getDefaultValue=function(){return u.ColorHelper.colorToHash(s.DiagramModel.defaultPageColor)},t.prototype.createHistoryItems=function(n){return[new o.ChangePageColorHistoryItem(u.ColorHelper.stringToColor(n))]},t}(e.ChangePagePropertyCommand);t.ChangePageColorCommand=h},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.value=t,i}return f(t,n),t.prototype.redo=function(n){this.oldValue=n.model.pageColor;n.changePageColor(this.value)},t.prototype.undo=function(n){n.changePageColor(this.oldValue)},t}(i(3).HistoryItem);t.ChangePageColorHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.executeCore=function(n,t){var i=void 0===t?!this.control.settings.showGrid:!!t;return this.control.settings.showGrid!==i&&(this.control.settings.showGrid=i,!0)},t.prototype.getValue=function(){return this.control.settings.showGrid},t}(i(8).SimpleCommandBase);t.ChangeShowGridCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.fullscreen},t.prototype.executeCore=function(n,t){var i="boolean"==typeof t?t:!n.value;return this.control.settings.fullscreen!==i&&(this.control.settings.fullscreen=!n.value,this.control.notifyToggleFullscreen(this.control.settings.fullscreen)),!0},t}(i(8).SimpleCommandBase);t.ToggleFullscreenCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.simpleView},t.prototype.executeCore=function(n,t){return"boolean"==typeof t?this.control.settings.simpleView=t:void 0===t&&(this.control.settings.simpleView=!n.value),this.control.updateLayout(!0),!0},t}(i(8).SimpleCommandBase);t.ToggleSimpleViewCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabledInReadOnlyMode=function(){return!0},t.prototype.getValue=function(){return this.control.settings.readOnly},t.prototype.executeCore=function(n,t){return"boolean"==typeof t?this.control.settings.readOnly=t:void 0===t&&(this.control.settings.readOnly=!n.value),!0},t}(i(8).SimpleCommandBase);t.ToggleReadOnlyCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabled=function(){var t=this.getSelectedShape();return n.prototype.isEnabled.call(this)&&!t.image.isEmpty},t}(i(83).EditShapeImageCommandBase);t.EditShapeImageCommand=u},function(n,t,i){"use strict";var r,o=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(117),f=i(11),e=i(6),s=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.calculateSelectionOffset=function(n,t){var i=n.reduce(function(n,t){return{x:Math.min(n.x,t instanceof f.Shape?t.position.x:t instanceof e.Connector?t.getMinX():Number.MAX_VALUE),y:Math.min(n.y,t instanceof f.Shape?t.position.y:t instanceof e.Connector?t.getMinY():Number.MAX_VALUE)}},{x:Number.MAX_VALUE,y:Number.MAX_VALUE}),r=this.control.render.getModelPointByEventPoint(t.x,t.y);this.offsetX=r.x-i.x;this.offsetY=r.y-i.y},t.prototype.getShapeNewPosition=function(n){var t=n.offset(this.offsetX,this.offsetY);return u.PasteSelectionCommandBase.getShapeNewPosition(this.control.model,t)},t.prototype.changeConnectorPoints=function(n){var t=this;n.points.forEach(function(n){n.x+=t.offsetX;n.y+=t.offsetY});u.PasteSelectionCommandBase.changeConnectorPoints(this.control.model,n)},t}(u.PasteSelectionCommandBase);t.PasteSelectionInPositionCommand=s},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(256);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.executeCore=function(n,t){var i=new u.XmlImporter(this.control.shapeDescriptionManager,t).import();return this.control.importModel(i),!0},t}(i(44).ExportImportCommandBase);t.ImportXMLCommand=f},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=i(6),h=i(11),c=i(108),u=i(4),r=i(1),l=i(70),e=i(0),a=i(75),v=i(36),y=function(n){function t(t,i){var r=n.call(this,t)||this;return r.doc=a.ImportUtils.createDocument(i),r}return o(t,n),t.prototype.getObject=function(){return this.doc},t.prototype.getPageObject=function(){var n=this.doc.querySelectorAll("[ItemKind='DiagramRoot']");return n&&n[0]},t.prototype.getShapeObjects=function(){var n=[];return this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramShape']").forEach(function(t){n.push(t)}),this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramContainer']").forEach(function(t){n.push(t)}),n},t.prototype.getConnectorObjects=function(){var n=[];return this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramConnector']").forEach(function(t){n.push(t)}),n},t.prototype.importPageSettings=function(n,t){if(t){var r=t.getAttribute("PageSize"),i=this.getSize(r);i&&(n.size=i.clone(),n.pageSize=i.clone())}},t.prototype.importShape=function(n){var e=n.getAttribute("Position"),o=this.getPoint(e),s=n.getAttribute("Shape"),c=this.getShapeType(s),a=this.shapeDescriptionManager.get(c),t=new h.Shape(a||l.ShapeDescriptionManager.default,o),f,i,r,u;return t.key=this.getItemKey(n),f=n.getAttribute("Size"),i=this.getSize(f),i&&(t.size=i),r=n.getAttribute("Content"),"string"==typeof r?t.text=r:(u=n.getAttribute("Header"),"string"==typeof u&&(t.text=u)),this.importStyle(n,t),t},t.prototype.importShapeChildren=function(n,t){var u=[],r,f,e,i,o;if(n.setAttribute("dxDiagram",""),this.doc.querySelectorAll("[dxDiagram] > Children > [ItemKind='DiagramShape']").forEach(function(n){u.push(n)}),this.doc.querySelectorAll("[dxDiagram] > Children > [ItemKind='DiagramContainer']").forEach(function(n){u.push(n)}),n.removeAttribute("dxDiagram"),r=[],!u)return r;for(f=0;f<u.length;f++)e=u[f],i=this.importShape(e),i.key=t.key+","+i.key,o=t.clientRectangle,i.position=i.position.offset(o.left,o.top),t.childKeys||(t.childKeys=[]),t.childKeys.push(i.key),r.push(i),r=r.concat(this.importShapeChildren(e,i));return r},t.prototype.importConnector=function(n){var y=this,i=[],p=n.getAttribute("BeginPoint"),c=this.getPoint(p),l,f,t,a,e,v,o,r,u,h;return c&&i.push(c),n.getAttribute("Points").split(" ").forEach(function(n){var t=y.getPoint(n);t&&i.push(t)}),l=n.getAttribute("EndPoint"),f=this.getPoint(l),f&&i.push(f),t=new s.Connector(i),t.key=this.getItemKey(n),a=n.getAttribute("EndItemPointIndex"),e=parseInt(a),t.endConnectionPointIndex=isNaN(e)?-1:e,v=n.getAttribute("BeginItemPointIndex"),o=parseInt(v),t.beginConnectionPointIndex=isNaN(o)?-1:o,r=n.getAttribute("EndItem"),void 0!==r&&this.assert(r,"string"),u=n.getAttribute("BeginItem"),void 0!==u&&this.assert(u,"string"),t.endItemKey=r,t.beginItemKey=u,h=n.getAttribute("Content"),"string"==typeof h&&t.setText(h),this.importStyle(n,t),t},t.prototype.importStyle=function(n,t){var o=n.getAttribute("Background"),r,u,f,e,i;"string"==typeof o&&(t.style.fill=this.getColor(o));r=n.getAttribute("Stroke");"string"==typeof r&&(t.style.stroke=this.getColor(r));u=n.getAttribute("Foreground");"string"==typeof u&&(t.styleText.fill=this.getColor(u));f=n.getAttribute("FontFamily");"string"==typeof f&&(t.styleText["font-family"]=f);e=n.getAttribute("FontSize");"string"==typeof e&&(t.styleText["font-size"]=e);"Bold"===n.getAttribute("FontWeight")&&(t.styleText["font-weight"]="bold");"Italic"===n.getAttribute("FontStyle")&&(t.styleText["font-style"]="italic");"Underline"===n.getAttribute("TextDecorations")&&(t.styleText["text-decoration"]="underline");i=n.getAttribute("TextAlignment");"Left"===i?t.styleText["text-anchor"]="start":"Right"===i?t.styleText["text-anchor"]="end":"Right"===i&&(t.styleText["text-anchor"]="middle")},t.prototype.getShapeType=function(n){return t.shapeTypes[n]?t.shapeTypes[n]:n&&n.toLowerCase().indexOf("container")>-1?r.ShapeTypes.VerticalContainer:r.ShapeTypes.Rectangle},t.prototype.getItemKey=function(n){return(parseInt(n.tagName.replace("Item",""))-1).toString()},t.prototype.getNumbers=function(n){var t=n.split(",");return t&&t.length?t.map(function(n){return+n}):[]},t.prototype.getSize=function(n){if(n){var t=this.getNumbers(n);if(t.length>=2)return this.assert(t[0],"number"),this.assert(t[1],"number"),new e.Size(u.UnitConverter.pixelsToTwips(t[0]),u.UnitConverter.pixelsToTwips(t[1]))}},t.prototype.getPoint=function(n){if(n){var t=this.getNumbers(n);if(t.length>=2)return this.assert(t[0],"number"),this.assert(t[1],"number"),new e.Point(u.UnitConverter.pixelsToTwips(t[0]),u.UnitConverter.pixelsToTwips(t[1]))}},t.prototype.getColor=function(n){n="#"==n.charAt(0)?n.substr(1):n;var t=parseInt(n,16);if(!isNaN(t))return v.ColorHelper.colorToHash(t)},t.shapeTypes={"BasicShapes.Rectangle":r.ShapeTypes.Rectangle,"BasicShapes.Ellipse":r.ShapeTypes.Ellipse,"BasicShapes.Triangle":r.ShapeTypes.Triangle,"BasicShapes.Pentagon":r.ShapeTypes.Pentagon,"BasicShapes.Hexagon":r.ShapeTypes.Hexagon,"BasicShapes.Octagon":r.ShapeTypes.Octagon,"BasicShapes.Diamond":r.ShapeTypes.Diamond,"BasicShapes.Cross":r.ShapeTypes.Cross,"BasicShapes.Star5":r.ShapeTypes.Star,"BasicFlowchartShapes.StartEnd":r.ShapeTypes.Terminator,"BasicFlowchartShapes.Data":r.ShapeTypes.Data,"BasicFlowchartShapes.Database":r.ShapeTypes.Database,"BasicFlowchartShapes.ExternalData":r.ShapeTypes.StoredData,"BasicFlowchartShapes.Process":r.ShapeTypes.Process,"BasicFlowchartShapes.Decision":r.ShapeTypes.Decision,"BasicFlowchartShapes.Subprocess":r.ShapeTypes.PredefinedProcess,"BasicFlowchartShapes.Document":r.ShapeTypes.Document,"BasicFlowchartShapes.Custom1":r.ShapeTypes.ManualInput,"BasicFlowchartShapes.Custom2":r.ShapeTypes.ManualOperation,"ArrowShapes.SimpleArrow":r.ShapeTypes.ArrowLeft,"ArrowShapes.SimpleDoubleArrow":r.ShapeTypes.ArrowLeftRight},t}(c.ImporterBase);t.XmlImporter=y},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabled=function(){var t=this.getSelectedShape();return n.prototype.isEnabled.call(this)&&t.image.isEmpty},t}(i(83).EditShapeImageCommandBase);t.InsertShapeImageCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.isEnabled=function(){var t=this.getSelectedShape();return n.prototype.isEnabled.call(this)&&!t.image.isEmpty},t.prototype.executeCore=function(t){return n.prototype.executeCore.call(this,t,void 0)},t}(i(83).EditShapeImageCommandBase);t.DeleteShapeImageCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"stroke-dasharray"},t}(i(59).ChangeStylePropertyCommand);t.ChangeStrokeStyleCommand=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.getStyleProperty=function(){return"stroke-width"},t}(i(59).ChangeStylePropertyCommand);t.ChangeStrokeWidthCommand=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(17);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.createLayoutSettings=function(){var t=n.prototype.createLayoutSettings.call(this);return t.direction=u.LogicalDirectionKind.Backward,t},t}(i(112).AutoLayoutTreeVerticalCommand);t.AutoLayoutTreeVerticalBottomToTopCommand=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(17);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.createLayoutSettings=function(){var t=n.prototype.createLayoutSettings.call(this);return t.direction=u.LogicalDirectionKind.Backward,t},t}(i(120).AutoLayoutTreeHorizontalCommand);t.AutoLayoutTreeHorizontalRightToLeftCommand=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(17);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.createLayoutSettings=function(){var t=n.prototype.createLayoutSettings.call(this);return t.direction=u.LogicalDirectionKind.Backward,t},t}(i(121).AutoLayoutLayeredVerticalCommand);t.AutoLayoutLayeredVerticalBottomToTopCommand=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(17);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.createLayoutSettings=function(){var t=n.prototype.createLayoutSettings.call(this);return t.direction=u.LogicalDirectionKind.Backward,t},t}(i(118).AutoLayoutLayeredHorizontalCommand);t.AutoLayoutLayeredHorizontalRightToLeftCommand=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(266),e=i(45),o=i(267),u=i(19),s=i(297),h=i(300),c=i(301),l=i(302),a=i(70),v=i(310),y=i(34),p=i(314),r=i(7),w=i(315),b=i(0),k=i(4),d=i(318),g=function(){function n(){this.processDataChangesNeeded=!1;this.settings=new y.DiagramSettings;this.shapeDescriptionManager=new a.ShapeDescriptionManager;this.model=new u.DiagramModel;this.selection=new s.Selection(this.model);this.modelManipulator=new f.ModelManipulator(this.model);this.history=new h.History(this.modelManipulator);this.onNativeAction=new k.EventDispatcher;this.view=new p.ViewController(this.settings);this.commandManager=new e.CommandManager(this);this.barManager=new c.BarManager(this);this.eventManager=new o.EventManager(this);this.settings.onReadOnlyChanged.add(this.eventManager.mouseHandler);this.settings.onReadOnlyChanged.add(this.eventManager.visualizersManager);this.selection.onChanged.add(this.barManager);this.modelManipulator.onLoad();this.history.onChanged.add(this);this.toolboxManager=new w.ToolboxManager(this.shapeDescriptionManager);this.apiController=new d.ApiController(this.onNativeAction,this.selection,this.model);this.selection.onChanged.add(this.apiController)}return n.prototype.cleanMarkup=function(){this.toolboxManager.clean();this.render&&(this.render.clean(),this.render=void 0)},n.prototype.createDocument=function(n,t){this.render?this.render.replaceParent(n,t):(this.render=new l.RenderManager(n,this.eventManager,{pageColor:this.model.pageColor,modelSize:this.model.size,pageLandscape:this.model.pageLandscape,pageSize:this.model.pageSize,simpleView:this.settings.simpleView,readOnly:this.settings.readOnly,gridSize:this.settings.gridSize,gridVisible:this.settings.showGrid,zoomLevel:this.settings.zoomLevel,autoZoom:this.settings.autoZoom,rectangle:this.model.getRectangle(!0),scrollView:t}),this.settings.onZoomChanged.add(this.render.view),this.settings.onViewChanged.add(this.render.page),this.settings.onViewChanged.add(this.render.view),this.settings.onReadOnlyChanged.add(this.render),this.settings.onReadOnlyChanged.add(this.render.selection),this.eventManager.onTextInputOperation.add(this.render.input),this.eventManager.onTextInputOperation.add(this.render.items),this.eventManager.onTextInputOperation.add(this.render.selection),this.eventManager.onTextInputOperation.add(this),this.eventManager.onMouseOperation.add(this.render.items),this.eventManager.onMouseOperation.add(this.render.selection),this.eventManager.onMouseOperation.add(this.render.view),this.eventManager.onMouseOperation.add(this.render),this.eventManager.onVisualizersUpdate.add(this.render.selection),this.modelManipulator.onModelSizeChanged.add(this.render.view),this.modelManipulator.onModelSizeChanged.add(this.render.page),this.modelManipulator.onModelChanged.add(this.render.items),this.modelManipulator.onModelChanged.add(this.render.page),this.modelManipulator.onModelChanged.add(this.render.selection),this.selection.onChanged.add(this.render.selection),this.render.update(!1),this.render.onNewModel(this.model.items),this.modelManipulator.onLoad(),this.view.initialize(this.render.view),this.selection.onLoad())},n.prototype.createToolbox=function(n,t,i,r){var u=this.toolboxManager.create(n,this.settings.readOnly,!0,t,i,r);this.settings.onReadOnlyChanged.add(u);u.onDragOperation.add(this);this.eventManager.registerToolbox(u)},n.prototype.createContextToolbox=function(n,t,i,r,u){this.contextToolbox&&this.cleanContextToolbox(n);this.contextToolbox=this.toolboxManager.create(n,this.settings.readOnly,!1,t,i,r);this.contextToolbox.onClickOperation.add(this);this.contextToolboxOnClick=u},n.prototype.cleanContextToolbox=function(){this.contextToolbox&&(this.toolboxManager.clean(this.contextToolbox),this.contextToolbox=void 0)},n.prototype.applyToolboxFilter=function(n,t){return this.toolboxManager.applyFilter(n,t)},n.prototype.notifyToolboxClick=function(n){this.contextToolboxOnClick&&this.contextToolboxOnClick(n)},n.prototype.updateLayout=function(n){void 0===n&&(n=!1);this.render&&this.render.update(!n)},n.prototype.captureFocus=function(){this.render&&this.render.input.captureFocus()},n.prototype.isFocused=function(){return!this.render||this.render.input.isFocused()},n.prototype.registerBar=function(n){this.barManager.registerBar(n)},n.prototype.updateBarItemsState=function(n,t){this.barManager.updateBarItemsState(n,t)},n.prototype.getCommand=function(n){return this.commandManager.getCommand(n)},n.prototype.setInitialStyleProperties=function(n){this.selection.inputPosition.setInitialStyleProperties(n)},n.prototype.setInitialTextStyleProperties=function(n){this.selection.inputPosition.setInitialTextStyleProperties(n)},n.prototype.setInitialConnectorProperties=function(n){this.selection.inputPosition.setInitialConnectorProperties(n)},n.prototype.addCustomShapes=function(n){var t=this;n.forEach(function(n){n.defaultWidth&&(n.defaultWidth=r.ModelUtils.getTwipsValue(t.model.units,n.defaultWidth));n.defaultHeight&&(n.defaultHeight=r.ModelUtils.getTwipsValue(t.model.units,n.defaultHeight));n.minWidth&&(n.minWidth=r.ModelUtils.getTwipsValue(t.model.units,n.minWidth));n.minHeight&&(n.minHeight=r.ModelUtils.getTwipsValue(t.model.units,n.minHeight));n.maxWidth&&(n.maxWidth=r.ModelUtils.getTwipsValue(t.model.units,n.maxWidth));n.maxHeight&&(n.maxHeight=r.ModelUtils.getTwipsValue(t.model.units,n.maxHeight));t.shapeDescriptionManager.registerCustomShape(n)})},n.prototype.removeCustomShapes=function(n){var t=this;n.forEach(function(n){t.shapeDescriptionManager.unregisterCustomShape(n)})},n.prototype.importModel=function(n){this.model=n;this.apiController.model=n;this.importData()},n.prototype.importItemsData=function(){this.model.invalidateItems();this.importData()},n.prototype.importData=function(){this.render&&(this.render.clear(),this.render.onNewModel(this.model.items));this.selection.initialize(this.model);this.modelManipulator.load(this.model);this.history.clear();this.eventManager.initialize();this.modelManipulator.onLoad();this.processChanges()},n.prototype.createDocumentDataSource=function(n,t,i,r,u){return this.documentDataSource=new v.DocumentDataSource(this,n,t,i,r,u),this.apiController.setDataSource(this.documentDataSource),this.documentDataSource},n.prototype.deleteDocumentDataSource=function(){this.apiController.setDataSource(null);delete this.documentDataSource},n.prototype.beginUpdate=function(n){this.barManager.beginUpdate();n&&this.render&&this.render.items.beginUpdate();this.apiController.beginUpdate();this.eventManager.beginUpdate()},n.prototype.endUpdate=function(n){n&&this.render&&this.render.items.endUpdate();this.barManager.endUpdate();this.apiController.endUpdate();this.eventManager.endUpdate()},n.prototype.notifyEdgeInserted=function(n,t,i){this.onEdgeInserted&&this.onEdgeInserted(n,t,i)},n.prototype.notifyEdgeUpdated=function(n,t,i,r){this.onEdgeUpdated&&this.onEdgeUpdated(n,t,i,r)},n.prototype.notifyEdgeRemoved=function(n,t,i,r){this.onEdgeUpdated&&this.onEdgeRemoved(n,t,i,r)},n.prototype.notifyNodeInserted=function(n,t,i){this.onNodeInserted&&this.onNodeInserted(n,t,i)},n.prototype.notifyNodeUpdated=function(n,t,i,r){this.onNodeUpdated&&this.onNodeUpdated(n,t,i,r)},n.prototype.notifyNodeRemoved=function(n,t,i,r){this.onNodeRemoved&&this.onNodeRemoved(n,t,i,r)},n.prototype.checkProcessDataChanges=function(){this.documentDataSource.isUpdateLocked()?this.processDataChangesNeeded=!0:this.processDataChanges()},n.prototype.processDataChanges=function(n){void 0===n&&(n=!0);(n||this.processDataChangesNeeded)&&(this.documentDataSource.updateItemsByModel(this.model),this.processDataChangesNeeded=!1);this.documentDataSource.isUpdateLocked()||this.raiseOnChanged()},n.prototype.processChanges=function(){this.settings.readOnly||(this.documentDataSource?this.checkProcessDataChanges():this.raiseOnChanged())},n.prototype.notifyHistoryChanged=function(){this.processChanges()},n.prototype.raiseOnChanged=function(){this.onChanged&&this.onChanged()},n.prototype.notifyToolboxDragStart=function(){this.onToolboxDragStart&&this.onToolboxDragStart()},n.prototype.notifyToolboxDragEnd=function(){this.onToolboxDragEnd&&this.onToolboxDragEnd()},n.prototype.notifyTextInputStart=function(){this.onTextInputStart&&this.onTextInputStart()},n.prototype.notifyTextInputEnd=function(){this.onTextInputEnd&&this.onTextInputEnd()},n.prototype.notifyToggleFullscreen=function(n){this.onToggleFullscreen&&this.onToggleFullscreen(n)},n.prototype.getPastePosition=function(){return this.contextMenuPosition},n.prototype.notifyShowContextMenu=function(n,t){var i,r;if(this.onShowContextMenu&&this.render){if(i=void 0,this.selection.getSelectedItems(!0).length>0){var f=u.DiagramModel.getRectangle(this.selection.getSelectedItems(!0)),e=this.render.getEventPointByModelPoint(f.position),o=this.render.view.getAbsoluteSize(f.size);i={x:e.x,y:e.y,width:o.width,height:o.height}}n?(this.onShowContextMenu(n.x,n.y,i),this.contextMenuPosition=new b.Point(n.x,n.y)):t&&(r=this.render.getEventPointByModelPoint(t),this.onShowContextMenu(r.x,r.y,i),this.contextMenuPosition=r.clone())}},n.prototype.notifyHideContextMenu=function(){this.onHideContextMenu&&this.render&&this.onHideContextMenu()},n.prototype.notifyShowContextToolbox=function(n,t,i,r){if(this.onShowContextToolbox&&this.render){var u=this.render.getEventPointByModelPoint(n);this.onShowContextToolbox(u.x,u.y,t,i,r)}},n.prototype.notifyHideContextToolbox=function(){this.onHideContextToolbox&&this.render&&this.onHideContextToolbox()},n}();t.DiagramControl=g},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(116),u=i(0),f=i(6),o=i(47),s=i(106),e=i(64),h=function(){function n(n){this.onModelChanged=new u.EventDispatcher;this.onModelSizeChanged=new u.EventDispatcher;this.model=n;this.imageLoader=new s.ImageLoader(this.updateShapeImage.bind(this))}return n.prototype.load=function(n){this.model=n;this.model.loadAllImages(this.imageLoader);this.updateModelSize();this.raisePageSizeChanged(n.pageSize.clone(),n.pageLandscape);this.raiseModelSizeChanged(n.size.clone());this.raisePageColorChanged(n.pageColor);this.raiseModelRectangleChanged(u.GeometryUtils.getCommonRectangle(n.items.map(function(n){return n.rectangle})))},n.prototype.onLoad=function(){var n=[];this.model.iterateItems(function(t){n.push(new r.ItemChange(t,r.ItemChangeType.Create))});e.Diagnostics.timer("new model: model changes");this.raiseModelChanged(n);e.Diagnostics.endTimer()},n.prototype.insertToContainer=function(n,t){if(n.container&&t&&n.container.key!==t.key)throw Error("To insert an item to a container it's necessary to remove it from the current container.");t&&(t.children.push(n),n.container=t,this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)]))},n.prototype.removeFromContainer=function(n){if(n.container){var t=n.container.children.indexOf(n);n.container.children.splice(t,1);n.container=void 0;this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])}},n.prototype.changeStyle=function(n,t,i){this.changeStyleCore(n,n.style,t,i)},n.prototype.changeStyleText=function(n,t,i){this.changeStyleCore(n,n.styleText,t,i)},n.prototype.changeStyleCore=function(n,t,i,u){void 0!==u?t[i]=u:delete t[i];n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.changeZIndex=function(n,t){n.zIndex=t;this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.changeLocked=function(n,t){n.locked=t;this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.addShape=function(n,t){if(n.attachedConnectors.length)throw Error("A creating shape should not contain existing connectors.");return n.key=void 0!==t?t:this.model.getNextKey(),this.insertShape(n)},n.prototype.insertShape=function(n){return this.model.pushItem(n),this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Create)]),this.model.loadAllImages(this.imageLoader),n},n.prototype.resizeShape=function(n,t,i){n.position=t;n.size=i;n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.moveShape=function(n,t){n.position=t;n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.changeShapeParameters=function(n,t){n.parameters.forEach(function(n){var i=t.get(n.key);i&&(n.value=i.value)});n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.changeShapeText=function(n,t){n.text=t;n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.UpdateStructure)])},n.prototype.changeShapeImage=function(n,t){n.image=t;var i=o.ImageCache.instance.createUnloadedInfoByShapeImageInfo(t);this.imageLoader.load(i);n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.UpdateStructure)])},n.prototype.changeShapeExpanded=function(n,t){n.expanded=t;n.toggleExpandedSize();n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.UpdateStructure)])},n.prototype.deleteShape=function(n){if(n.attachedConnectors.length)throw Error("A removing shape should not contain existing connectors.");this.removeShape(n)},n.prototype.removeShape=function(n){this.model.removeItem(n);this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Remove)])},n.prototype.updateShapeImage=function(n){if(n.imageUrl){var i=this.model.findShapesByImageUrl(n.imageUrl),t=[];i.forEach(function(i){n.base64?i.image.loadBase64Content(n.base64):i.image.setUnableToLoadFlag();i.invalidatePrimitives();t.push(new r.ItemChange(i,r.ItemChangeType.UpdateStructure))});t.length>0&&this.raiseModelChanged(t)}},n.prototype.addConnector=function(n,t){if(n.beginItem||n.endItem)throw Error("Creating connector should not contain begin/end items");return n.key=void 0!==t?t:this.model.getNextKey(),this.insertConnector(n)},n.prototype.insertConnector=function(n){return this.model.pushItem(n),n.invalidateRenderPoints(),this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Create)]),n},n.prototype.deleteConnector=function(n){if(n.beginItem||n.endItem)throw Error("Creating connector should not contain begin/end items");this.removeConnector(n)},n.prototype.removeConnector=function(n){this.model.removeItem(n);this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Remove)])},n.prototype.moveConnectorPoint=function(n,t,i){n.points[t]=i;n.invalidateRenderPoints();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.addConnectorPoint=function(n,t,i){n.points.splice(t,0,i);n.invalidateRenderPoints();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.deleteConnectorPoint=function(n,t){n.points.splice(t,1);n.invalidateRenderPoints();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.addConnection=function(n,t,i,u){var e=n.getExtremeItem(u),o=n.getExtremeConnectionPointIndex(u);if(e!==t||o!==i){if(e)throw Error("Connector is already connected");t.attachedConnectors.push(n);u===f.ConnectorPosition.Begin?(n.beginItem=t,n.beginConnectionPointIndex=i):(n.endItem=t,n.endConnectionPointIndex=i);n.invalidateRenderPoints();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])}},n.prototype.setConnectionPointIndex=function(n,t,i){if(!n.getExtremeItem(i))throw Error("Connection should be connected");i===f.ConnectorPosition.Begin?n.beginConnectionPointIndex=t:n.endConnectionPointIndex=t;n.invalidateRenderPoints();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.deleteConnection=function(n,t){var i=n.getExtremeItem(t);i&&(i.attachedConnectors.splice(i.attachedConnectors.indexOf(n),1),t===f.ConnectorPosition.Begin?(n.beginItem=null,n.beginConnectionPointIndex=-1):(n.endItem=null,n.endConnectionPointIndex=-1),n.invalidateRenderPoints(),this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)]))},n.prototype.changeConnectorProperty=function(n,t,i){n.properties[t]=i;n.invalidateRenderPoints();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.changeConnectorText=function(n,t,i){n.setText(t,i);n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.UpdateStructure)])},n.prototype.changeConnectorTextPosition=function(n,t,i){var u=n.getText(t);n.setText(null,t);n.setText(u,i);n.invalidatePrimitives();this.raiseModelChanged([new r.ItemChange(n,r.ItemChangeType.Update)])},n.prototype.changeModelSize=function(n,t){this.model.size.width=n.width;this.model.size.height=n.height;this.raiseModelSizeChanged(this.model.size.clone(),t);(t.left||t.top)&&(this.model.snapStartPoint=this.model.snapStartPoint.offset(t.left,t.top),this.raiseSnapPointChange(this.model.snapStartPoint))},n.prototype.changePageSize=function(n){this.model.pageSize.equals(n)||(this.model.pageSize=n,this.model.size=new u.Size(this.model.pageWidth,this.model.pageHeight),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageSizeChanged(this.model.pageSize,this.model.pageLandscape))},n.prototype.changePageLandscape=function(n){this.model.pageLandscape!==n&&(this.model.pageLandscape=n,this.model.pageSize.width!==this.model.pageSize.height&&(this.model.size=new u.Size(this.model.pageWidth,this.model.pageHeight),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageSizeChanged(this.model.pageSize,this.model.pageLandscape)))},n.prototype.changePageColor=function(n){this.model.pageColor!==n&&(this.model.pageColor=n,this.raisePageColorChanged(n))},n.prototype.changePageProperty=function(n){n(this.model)},n.prototype.getModelSizeUpdateOffset=function(){var t=this.model.getRectangle(!1),n=this.model.getRectangle(!0);n.equals(t)||this.raiseModelRectangleChanged(n);var i=-Math.floor(n.left/this.model.pageWidth),r=-Math.floor(n.top/this.model.pageHeight),f=-Math.floor((this.model.size.width-n.right)/this.model.pageWidth),e=-Math.floor((this.model.size.height-n.bottom)/this.model.pageHeight);return new u.Offset(i*this.model.pageWidth,r*this.model.pageHeight,f*this.model.pageWidth,e*this.model.pageHeight)},n.prototype.updateModelSize=function(){var n=this.getModelSizeUpdateOffset(),t,i;n.isEmpty()||(t=Math.max(this.model.size.width+n.left+n.right,this.model.pageWidth),i=Math.max(this.model.size.height+n.top+n.bottom,this.model.pageHeight),this.model.size=new u.Size(t,i))},n.prototype.raiseModelChanged=function(n){this.onModelChanged.raise1(function(t){return t.notifyModelChanged(n)})},n.prototype.raisePageColorChanged=function(n){this.onModelChanged.raise1(function(t){return t.notifyPageColorChanged(n)})},n.prototype.raisePageSizeChanged=function(n,t){this.onModelChanged.raise1(function(i){return i.notifyPageSizeChanged(n,t)})},n.prototype.raiseModelSizeChanged=function(n,t){this.onModelSizeChanged.raise1(function(i){return i.notifyModelSizeChanged(n,t)})},n.prototype.raiseModelRectangleChanged=function(n){this.onModelSizeChanged.raise1(function(t){return t.notifyModelRectangleChanged(n)})},n.prototype.raiseSnapPointChange=function(n){this.onModelSizeChanged.raise1(function(t){return t.notifySnapPointPositionChanged(n)})},n}();t.ModelManipulator=h},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(268),r=i(0),e=i(287),o=i(131),u=i(4),s=i(289),h=i(132),c=i(295),l=i(296),a=function(){function n(n){this.onMouseOperation=new r.EventDispatcher;this.onTextInputOperation=new r.EventDispatcher;this.toolboxes=[];this.control=n;this.visualizersManager=u.Browser.TouchUI?new c.VisualizerTouchManager(n.selection,n.model,this,n.settings):new h.VisualizerManager(n.selection,n.model,this,n.settings);this.onMouseOperation.add(this.visualizersManager);this.contextMenuHandler=u.Browser.TouchUI?new s.ContextMenuTouchHandler(n.selection):new o.ContextMenuHandler;this.contextMenuHandler.onVisibilityChanged.add(n);this.onMouseOperation.add(this.contextMenuHandler);this.contextToolboxHandler=new l.ContextToolboxHandler;this.contextToolboxHandler.onVisibilityChanged.add(n);this.contextToolboxHandler.onVisibilityChanged.add(this.contextMenuHandler);this.mouseHandler=new f.MouseHandler(n.history,n.selection,n.model,this,n.settings.readOnly,n.view,this.visualizersManager,this.contextToolboxHandler,n.shapeDescriptionManager,n.settings,n.barManager);this.textInputHandler=new e.TextInputHandler(n)}return Object.defineProperty(n.prototype,"onVisualizersUpdate",{get:function(){return this.visualizersManager.onVisualizersUpdate},enumerable:!0,configurable:!0}),n.prototype.registerToolbox=function(n){this.toolboxes.push(n)},n.prototype.initialize=function(){this.visualizersManager.initialize(this.control.model);this.mouseHandler.initialize(this.control.model)},n.prototype.beginUpdate=function(){this.contextMenuHandler.beginUpdate();this.visualizersManager.beginUpdate()},n.prototype.endUpdate=function(){this.contextMenuHandler.endUpdate();this.visualizersManager.endUpdate()},n.prototype.onMouseDown=function(n){this.mouseHandler.onMouseDown(n);this.contextMenuHandler.onMouseDown(n);this.visualizersManager.onMouseDown(n);this.contextToolboxHandler.onMouseDown(n)},n.prototype.onMouseMove=function(n){this.processDragging(n);this.mouseHandler.onMouseMove(n)},n.prototype.onMouseUp=function(n){this.contextToolboxHandler.onMouseUp(n);this.mouseHandler.onMouseUp(n);this.contextMenuHandler.onMouseUp(n);this.visualizersManager.onMouseUp(n);this.processDragging(n)},n.prototype.onMouseEnter=function(n){this.visualizersManager.onMouseEnter(n)},n.prototype.onMouseLeave=function(n){this.visualizersManager.onMouseLeave(n)},n.prototype.onDblClick=function(n){this.mouseHandler.onMouseDblClick(n);this.textInputHandler.onDblClick(n);this.control.apiController.notifyDblClick(n)},n.prototype.onClick=function(n){this.mouseHandler.onMouseClick(n);this.control.apiController.notifyClick(n)},n.prototype.onContextMenu=function(n){this.contextMenuHandler.onContextMenu(n)},n.prototype.onLongTouch=function(n){this.mouseHandler.onLongTouch(n);this.contextMenuHandler.onLongTouch(n)},n.prototype.onBlur=function(n){this.contextMenuHandler.onBlur(n);this.contextToolboxHandler.onBlur(n);this.visualizersManager.onBlur(n)},n.prototype.onFocus=function(n){this.contextMenuHandler.onFocus(n);this.contextToolboxHandler.onFocus(n);this.visualizersManager.onFocus(n)},n.prototype.onKeyDown=function(n){var t=n.getShortcutCode();this.onShortcut(t)&&(this.visualizersManager.updateConnectionPoints(),n.preventDefault=!0);this.contextMenuHandler.onKeyDown(n);this.contextToolboxHandler.onKeyDown(n)},n.prototype.onTextInputBlur=function(n){this.textInputHandler.onBlur(n);this.contextMenuHandler.onTextInputBlur(n)},n.prototype.onTextInputFocus=function(n){this.textInputHandler.onFocus(n);this.contextMenuHandler.onTextInputFocus(n)},n.prototype.onTextInputKeyDown=function(n){this.textInputHandler.onKeyDown(n)},n.prototype.onShortcut=function(n){return!!this.control.commandManager.processShortcut(n)||!!this.mouseHandler.onShortcut(n)||void 0},n.prototype.onPaste=function(n){!this.textInputHandler.isTextInputActive()&&this.control.commandManager.processPaste(n.clipboardData)&&(this.visualizersManager.updateConnectionPoints(),n.preventDefault=!0)},n.prototype.onMouseWheel=function(n){this.mouseHandler.onWheel(n)&&(n.preventDefault=!0)},n.prototype.isFocused=function(){return this.control.isFocused()},n.prototype.processDragging=function(n){var t=this.getDraggingEvent();t&&!this.draggingEvent?(this.draggingEvent=t,this.mouseHandler.onDragStart(this.draggingEvent),this.control.apiController.notifyToolboxDragStart(),this.control.captureFocus()):!t&&this.draggingEvent&&(delete this.draggingEvent,this.mouseHandler.onDragEnd(n),this.control.apiController.notifyToolboxDragEnd())},n.prototype.getDraggingEvent=function(){return this.toolboxes.filter(function(n){return n.draggingObject}).map(function(n){return n.draggingObject.evt})[0]},n.prototype.onDocumentDragStart=function(n){this.control.beginUpdate();this.control.captureFocus();this.onMouseOperation.raise("notifyDragStart",n)},n.prototype.onDocumentDragEnd=function(n){this.onMouseOperation.raise("notifyDragEnd",n);this.control.endUpdate();this.control.barManager.updateItemsState()},n.prototype.onDocumentDragScrollStart=function(){this.onMouseOperation.raise1(function(n){return n.notifyDragScrollStart()})},n.prototype.onDocumentDragScrollEnd=function(){this.onMouseOperation.raise1(function(n){return n.notifyDragScrollEnd()})},n.prototype.onDocumentClick=function(){this.control.beginUpdate();this.control.endUpdate();this.control.barManager.updateItemsState()},n.prototype.raiseTextInputStart=function(n,t,i,r){this.onTextInputOperation.raise("notifyTextInputStart",n,t,i,r)},n.prototype.raiseTextInputEnd=function(n){this.onTextInputOperation.raise("notifyTextInputEnd",n)},n}();t.EventManager=a},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i(124),r=i(0),o=i(13),u=i(7),s=i(84),f=i(4),h=i(284),c=i(130),l=i(285),a=function(){function n(n,t,i,r,u,f,e,o,s,h,c){this.history=n;this.selection=t;this.model=i;this.eventManager=r;this.readOnly=u;this.view=f;this.visualizerManager=e;this.contextToolboxManager=o;this.shapeDescriptionManager=s;this.settings=h;this.bars=c;this.initialize(i)}return n.prototype.initialize=function(n){this.model=n;this.initializeDefaultState()},n.prototype.initializeDefaultState=function(){this.defaultState=this.readOnly?f.Browser.TouchUI?new h.MouseHandlerDefaultReadOnlyTouchState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings,this.bars):new c.MouseHandlerDefaultReadOnlyState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings,this.bars):f.Browser.TouchUI?new l.MouseHandlerDefaultTouchState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings,this.bars):new e.MouseHandlerDefaultState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings,this.bars);this.switchToDefaultState()},n.prototype.onMouseDown=function(n){this.mouseDownEvent=n;this.state.onMouseDown(n)},n.prototype.onMouseMove=function(n){this.state.onMouseMove(n)},n.prototype.onMouseUp=function(n){this.state.onMouseUp(n)},n.prototype.onMouseDblClick=function(n){this.state.onMouseDblClick(n)},n.prototype.onMouseClick=function(n){this.state.onMouseClick(n)},n.prototype.onLongTouch=function(n){if(n.touches&&!(n.touches.length>1)){var t=n.source.key;void 0===t?this.selection.clear():this.selection.hasKey(t)?this.selection.remove(t):this.selection.add(t)}},n.prototype.onShortcut=function(n){return this.state.onShortcut(n)},n.prototype.onWheel=function(n){return this.state.onMouseWheel(n)},n.prototype.onDragStart=function(n){this.state.onDragStart(n)},n.prototype.onDragEnd=function(n){this.state.onDragEnd(n)},n.prototype.showContextToolbox=function(n,t,i,r){this.contextToolboxManager.showContextToolbox(n,t,i,r)},n.prototype.hideContextToolbox=function(){this.contextToolboxManager.hideContextToolbox()},n.prototype.getSnappedPos=function(n,t,i){return!this.settings.snapToGrid||n.modifiers&o.ModifierKey.Ctrl?t:u.ModelUtils.getSnappedPos(this.model,this.settings.gridSize,t,i)},n.prototype.getSnappedPoint=function(n,t,i){var u=this.getSnappedPos(n,t.x,!0),f=this.getSnappedPos(n,t.y,!1);return void 0===i?new r.Point(u,f):Math.pow(t.x-u,2)+Math.pow(t.y-f,2)<Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)?new r.Point(u,f):i},n.prototype.tryUpdateModelSize=function(n){u.ModelUtils.tryUpdateModelSize(this.history,this.model,n)},n.prototype.raiseDragStart=function(n){this.eventManager.onDocumentDragStart(n)},n.prototype.raiseDragEnd=function(n){this.eventManager.onDocumentDragEnd(n)},n.prototype.raiseDragScrollStart=function(){this.eventManager.onDocumentDragScrollStart()},n.prototype.raiseDragScrollEnd=function(){this.eventManager.onDocumentDragScrollEnd()},n.prototype.raiseClick=function(n){this.eventManager.onDocumentClick(n)},n.prototype.switchToDefaultState=function(){this.switchState(this.defaultState)},n.prototype.switchToMoveClonedShapeState=function(n){this.switchState(new s.MouseHandlerMoveClonedShapeState(this,this.history,this.model,this.selection,this.visualizerManager,n))},n.prototype.switchState=function(n){this.state&&this.state.finish();this.state=n;this.state.start()},n.prototype.notifyReadOnlyChanged=function(n){this.readOnly=n;this.initializeDefaultState()},n}();t.MouseHandler=a},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(125),u=i(6),o=i(7),s=i(0),h=i(25),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.onMouseDown=function(t){this.connector=this.model.findConnector(t.source.key);this.pointIndex=parseInt(t.source.value);0===this.pointIndex?this.pointPosition=u.ConnectorPosition.Begin:this.pointIndex===this.connector.points.length-1&&(this.pointPosition=u.ConnectorPosition.End);n.prototype.onMouseDown.call(this,t)},t.prototype.onApplyChanges=function(t){this.connector.properties.lineOption===h.ConnectorLineOption.Orthogonal&&0!==this.pointIndex&&this.pointIndex!==this.connector.points.length-1||n.prototype.onApplyChanges.call(this,t)},t.prototype.onFinishWithChanges=function(){n.prototype.onFinishWithChanges.call(this);o.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector)},t.prototype.getSnappedPoint=function(n,t){var r=this.connector.points,i=this.pointIndex;if(0<i&&i<r.length-1){var f=(r[i+1].y-r[i-1].y)/(r[i+1].x-r[i-1].x),u=t.x,e=r[i+1].y-(r[i+1].x-u)*f;return this.handler.getSnappedPoint(n,t,new s.Point(u,e))}return this.handler.getSnappedPoint(n,t)},t}(e.MouseHandlerMoveConnectorPointStateBase);t.MouseHandlerMoveConnectorPointState=c},function(n,t,i){"use strict";var f,h=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),r=i(10),c=i(13),l=i(26),o=i(19),e=i(7),s=i(9),a=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i)||this;return e.model=r,e.selection=u,e.visualizerManager=f,e.startScrollLeft=0,e.startScrollTop=0,e.rotation=0,e}return h(t,n),t.prototype.start=function(){n.prototype.start.call(this)},t.prototype.finish=function(){this.visualizerManager.resetResizeInfo();this.visualizerManager.resetExtensionLines();n.prototype.finish.call(this)},t.prototype.onMouseDown=function(t){var i=parseInt(t.source.value);this.resizeEventSource=i;this.startPoint=t.modelPoint;this.lockH=i==r.ResizeEventSource.ResizeBox_S||i==r.ResizeEventSource.ResizeBox_N;this.lockV=i==r.ResizeEventSource.ResizeBox_E||i==r.ResizeEventSource.ResizeBox_W;this.sideH=i==r.ResizeEventSource.ResizeBox_E||i==r.ResizeEventSource.ResizeBox_NE||i==r.ResizeEventSource.ResizeBox_SE;this.sideV=i==r.ResizeEventSource.ResizeBox_SE||i==r.ResizeEventSource.ResizeBox_S||i==r.ResizeEventSource.ResizeBox_SW;this.shapes=this.selection.getSelectedShapes();0!==this.shapes.length?(this.connectors=this.selection.getSelectedConnectors(),this.startRectangle=o.DiagramModel.getRectangle(this.shapes),this.startShapeSizes=this.shapes.map(function(n){return n.size.clone()}),this.startShapePositions=this.shapes.map(function(n){return n.position.clone()}),this.startConnectorPoints=this.connectors.map(function(n){return n.points.map(function(n){return n.clone()})}),this.lockAspectRatio=!!(t.modifiers&c.ModifierKey.Shift),n.prototype.onMouseDown.call(this,t)):this.handler.switchToDefaultState()},t.prototype.onMouseMove=function(t){n.prototype.onMouseMove.call(this,t);var i=this.selection.getSelectedShapes();this.visualizerManager.setExtensionLines(i)},t.prototype.onApplyChanges=function(n){var t=this,c=o.DiagramModel.getRectangle(this.shapes),l=1===this.shapes.length?this.shapes[0].minWidth:s.ShapeMinDimension,a=1===this.shapes.length?this.shapes[0].minWidth:s.ShapeMinDimension,v=1===this.shapes.length?this.shapes[0].maxWidth:void 0,y=1===this.shapes.length?this.shapes[0].maxWidth:void 0,r=this.getSize(n,c.position,this.startRectangle.size,l,a,v,y),i=this.getPosition(n,r,this.startRectangle.size,this.startRectangle.position),f=r.width/this.startRectangle.width,h=r.height/this.startRectangle.height;this.shapes.forEach(function(n,r){var s=t.startShapeSizes[r].width*(n.allowResizeHorizontally?f:1),o,c,l;s=t.getNormalizedSize(s,n.minWidth,n.maxWidth);o=t.startShapeSizes[r].height*(n.allowResizeVertically?h:1);o=t.getNormalizedSize(o,n.minHeight,n.maxHeight);c=n.allowResizeHorizontally?i.x+(t.startShapePositions[r].x-t.startRectangle.left)*f:t.startShapePositions[r].x;l=n.allowResizeVertically?i.y+(t.startShapePositions[r].y-t.startRectangle.top)*h:t.startShapePositions[r].y;e.ModelUtils.setShapeSize(t.history,t.model,n,new u.Point(c,l),new u.Size(s,o))});this.connectors.forEach(function(n,r){for(var s,c=n.beginItem?1:0,l=n.endItem?n.points.length-2:n.points.length-1,o=c;o<=l;o++)s=new u.Point(i.x+(t.startConnectorPoints[r][o].x-t.startRectangle.left)*f,i.y+(t.startConnectorPoints[r][o].y-t.startRectangle.top)*h),e.ModelUtils.setConnectorPoint(t.history,t.model,n,o,s)});this.selection.getSelectedShapes(!1,!0).forEach(function(n){e.ModelUtils.updateShapeAttachedConnectors(t.history,t.model,n)});this.tryUpdateModelSize();this.visualizerManager.setResizeInfo(this.shapes)},t.prototype.tryUpdateModelSize=function(){var n=this;this.handler.tryUpdateModelSize(function(t,i){n.startShapePositions.forEach(function(n){n.x+=t;n.y+=i});n.startConnectorPoints.forEach(function(n){n.forEach(function(n){n.x+=t;n.y+=i})});n.startRectangle.position.x+=t;n.startRectangle.position.y+=i;n.startPoint.x+=t;n.startPoint.y+=i})},t.prototype.getDraggingElementKeys=function(){return this.shapes.map(function(n){return n.key})},t.prototype.getNormalizedSize=function(n,t,i){return void 0!==t&&(n=Math.max(n,t)),void 0!==i&&(n=Math.min(n,i)),n},t.prototype.getSize=function(n,t,i,r,f,e,o){var c,l,a=n.modelPoint.x-(this.startScrollLeft-n.scrollX)-this.startPoint.x,v=n.modelPoint.y-(this.startScrollTop-n.scrollY)-this.startPoint.y,s=a*Math.cos(this.rotation)- -v*Math.sin(this.rotation),h=-(a*Math.sin(this.rotation)+-v*Math.cos(this.rotation));return h=!this.sideV&&h>0?Math.min(i.height+1,h):h,s=!this.sideH&&s>0?Math.min(i.width+1,s):s,this.lockH||this.lockV||!this.lockAspectRatio?(s=this.lockH?0:s,h=this.lockV?0:h,c=this.getNormalizedSize(this.sideH?i.width+s:i.width-s,r,e),l=this.getNormalizedSize(this.sideV?i.height+h:i.height-h,f,o)):Math.abs(s)>Math.abs(h)?(c=this.getNormalizedSize(this.sideH?i.width+s:i.width-s,r,e),l=i.height*(c/i.width)):(l=this.getNormalizedSize(this.sideV?i.height+h:i.height-h,f,o),c=i.width*(l/i.height)),this.lockH||(c=this.handler.getSnappedPos(n,t.x+c,!0)-t.x),this.lockV||(l=this.handler.getSnappedPos(n,t.y+l,!1)-t.y),new u.Size(c,l)},t.prototype.getPosition=function(n,t,i,f){var e=f.x,o=f.y,s,h;return(this.resizeEventSource===r.ResizeEventSource.ResizeBox_N||this.resizeEventSource===r.ResizeEventSource.ResizeBox_NE||this.resizeEventSource===r.ResizeEventSource.ResizeBox_NW)&&(o+=i.height-t.height,s=this.handler.getSnappedPos(n,o,!1),t.height+=o-s,o=s),(this.resizeEventSource===r.ResizeEventSource.ResizeBox_W||this.resizeEventSource===r.ResizeEventSource.ResizeBox_NW||this.resizeEventSource===r.ResizeEventSource.ResizeBox_SW)&&(e+=i.width-t.width,h=this.handler.getSnappedPos(n,e,!0),t.width+=e-h,e=h),new u.Point(e,o)},t}(l.MouseHandlerDraggingState);t.MouseHandlerResizeShapeState=a},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(26),e=i(126),o=i(49),s=i(7),h=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.model=r,u}return u(t,n),t.prototype.onMouseDown=function(t){this.startPoint=t.modelPoint;this.connectorKey=t.source.key;this.pointIndex=parseInt(t.source.value)+1;n.prototype.onMouseDown.call(this,t)},t.prototype.onApplyChanges=function(n){var t=this.getSnappedPoint(n,n.modelPoint);this.pointCreated?this.history.addAndRedo(new o.MoveConnectorPointHistoryItem(this.connectorKey,this.pointIndex,t)):(this.history.addAndRedo(new e.AddConnectorPointHistoryItem(this.connectorKey,this.pointIndex,t)),this.pointCreated=!0);this.handler.tryUpdateModelSize()},t.prototype.onFinishWithChanges=function(){s.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.model.findConnector(this.connectorKey))},t.prototype.getDraggingElementKeys=function(){return[this.connectorKey]},t}(f.MouseHandlerDraggingState);t.MouseHandlerMoveConnectorSideState=h},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(26),e=i(92),o=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.model=r,u.startScrollLeft=0,u.startScrollTop=0,u}return u(t,n),t.prototype.onMouseDown=function(t){this.startPoint=t.modelPoint;this.shape=this.model.findShape(t.source.key);this.parameterPointKey=t.source.value;this.startParameters=this.shape.parameters.clone();n.prototype.onMouseDown.call(this,t)},t.prototype.onApplyChanges=function(n){var i=this.handler.getSnappedPos(n,n.modelPoint.x-this.startPoint.x,!0),r=this.handler.getSnappedPos(n,n.modelPoint.y-this.startPoint.y,!1),t=this.startParameters.clone();this.shape.description.modifyParameters(this.shape,t,i,r);this.history.addAndRedo(new e.ChangeShapeParametersHistoryItem(this.shape.key,t))},t.prototype.getDraggingElementKeys=function(){return[this.shape.key]},t}(f.MouseHandlerDraggingState);t.MouseHandlerDragParameterPointState=o},function(n,t,i){"use strict";var f,h=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(6),o=i(35),c=i(50),r=i(5),l=i(125),s=i(41),a=i(42),u=i(7),v=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,i,r,u)||this;return s.shapeDescriptionManager=f,s.selection=e,s.connectionPointIndex=o,s}return h(t,n),t.prototype.onMouseDown=function(t){void 0===this.connectionPointIndex&&(this.connectionPointIndex=parseInt(t.source.value));this.connectedItem=this.model.findItem(t.source.key);this.pointIndex=1;this.pointPosition=e.ConnectorPosition.End;n.prototype.onMouseDown.call(this,t)},t.prototype.onMouseUp=function(t){this.connector&&!this.connector.endItem&&this.createNewShapeAtConnectorEnd(t);n.prototype.onMouseUp.call(this,t)},t.prototype.onApplyChanges=function(t){var r=this.getSnappedPoint(t,t.modelPoint),i;this.connector?n.prototype.onApplyChanges.call(this,t):(i=new c.AddConnectorHistoryItem([this.connectedItem.getConnectionPointPosition(this.connectionPointIndex,r),r]),this.history.addAndRedo(i),this.connector=this.model.findConnector(i.connectorKey),this.history.addAndRedo(new o.AddConnectionHistoryItem(this.connector,this.connectedItem,this.connectionPointIndex,e.ConnectorPosition.Begin)),u.ModelUtils.updateNewConnectorProperties(this.history,this.selection,this.connector.key))},t.prototype.onFinishWithChanges=function(){n.prototype.onFinishWithChanges.call(this);this.history.addAndRedo(new s.SetSelectionHistoryItem(this.selection,[this.connector.key]))},t.prototype.createNewShapeAtConnectorEnd=function(n){var t=this,r=this.connector&&this.connector.beginItem;if(r){var i=this.getNewShapeSide(this.connector),f=this.getSnappedPoint(n,n.modelPoint),h=this.shapeDescriptionManager.getCategoryByDescription(r.description);this.handler.showContextToolbox(f,i,h,function(r){var c,h,l,v;r&&(t.history.beginTransaction(),c=new a.AddShapeHistoryItem(t.shapeDescriptionManager.get(r),f),t.history.addAndRedo(c),h=t.model.findShape(c.shapeKey),l=t.targetItem&&t.model.findContainer(t.targetItem.key),l&&u.ModelUtils.insertToContainer(t.history,t.model,h,l),v=t.getNewShapePosition(h,i),u.ModelUtils.setShapePosition(t.history,t.model,h,t.getSnappedPoint(n,v)),u.ModelUtils.updateNewShapeProperties(t.history,t.selection,h.key),t.history.addAndRedo(new o.AddConnectionHistoryItem(t.connector,h,h.getConnectionPointIndexForSide(i),e.ConnectorPosition.End)),u.ModelUtils.updateShapeAttachedConnectors(t.history,t.model,h),u.ModelUtils.tryUpdateModelSize(t.history,t.model),t.history.addAndRedo(new s.SetSelectionHistoryItem(t.selection,[h.key])),t.history.endTransaction(),t.handler.hideContextToolbox())})}},t.prototype.getNewShapePosition=function(n,t){switch(t){case r.ConnectionPointSide.North:return n.position.offset(-n.size.width/2,0);case r.ConnectionPointSide.South:return n.position.offset(-n.size.width/2,-n.size.height);case r.ConnectionPointSide.East:return n.position.offset(-n.size.width,-n.size.height/2);case r.ConnectionPointSide.West:return n.position.offset(0,-n.size.height/2)}},t.prototype.getNewShapeSide=function(n){var i=n.getRenderPoints();return t.getNewShapeSideByConnectorPoints(i[i.length-1],i[i.length-2])},t.getNewShapeSideByConnectorPoints=function(n,t){return n.x==t.x?n.y>t.y?r.ConnectionPointSide.North:r.ConnectionPointSide.South:n.x>t.x?n.y===t.y?r.ConnectionPointSide.West:n.y>t.y?Math.abs(n.x-t.x)>Math.abs(n.y-t.y)?r.ConnectionPointSide.West:r.ConnectionPointSide.North:Math.abs(n.x-t.x)>Math.abs(n.y-t.y)?r.ConnectionPointSide.West:r.ConnectionPointSide.South:n.y===t.y?r.ConnectionPointSide.East:n.y>t.y?Math.abs(n.x-t.x)>Math.abs(n.y-t.y)?r.ConnectionPointSide.East:r.ConnectionPointSide.North:Math.abs(n.x-t.x)>Math.abs(n.y-t.y)?r.ConnectionPointSide.East:r.ConnectionPointSide.South},t}(l.MouseHandlerMoveConnectorPointStateBase);t.MouseHandlerCreateConnectorState=v},function(n,t,i){"use strict";var u,h=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),c=i(6),l=i(26),e=i(126),o=i(49),s=i(7),r=i(5),a=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.model=r,u}return h(t,n),t.prototype.onMouseDown=function(t){this.startPoint=t.modelPoint;this.connector=this.model.findConnector(t.source.key);var r=t.source.value.split("_"),u=parseInt(r[0]),f=parseInt(r[1]),i=this.connector.getRenderPoints(!0);this.renderPoint1=i[u].clone();this.renderPoint2=i[f].clone();this.isVerticalOrientation=this.renderPoint1.x===this.renderPoint2.x;-1!==this.renderPoint1.pointIndex?(this.pointIndex1=this.renderPoint1.pointIndex,0===this.pointIndex1?(this.pointIndex1++,this.correctEdgePoint(this.renderPoint1,this.renderPoint2,this.connector.beginItem,this.connector.beginConnectionPointIndex)):this.point1=this.connector.points[this.pointIndex1]):this.pointIndex1=this.findPointIndex(i,u,!1)+1;-1!==this.renderPoint2.pointIndex?(this.pointIndex2=this.renderPoint2.pointIndex,this.pointIndex2===this.connector.points.length-1?this.correctEdgePoint(this.renderPoint2,this.renderPoint1,this.connector.endItem,this.connector.endConnectionPointIndex):this.point2=this.connector.points[this.pointIndex2]):this.pointIndex2=this.findPointIndex(i,f,!0);n.prototype.onMouseDown.call(this,t)},t.prototype.onApplyChanges=function(n){var i=this,r,u,t;this.pointCreated||(r=void 0,u=void 0,void 0===this.point1&&(this.point1=new f.Point(this.renderPoint1.x,this.renderPoint1.y),this.history.addAndRedo(new e.AddConnectorPointHistoryItem(this.connector.key,this.pointIndex1,this.point1)),r=this.point1,this.pointIndex2++),void 0===this.point2&&(this.point2=new f.Point(this.renderPoint2.x,this.renderPoint2.y),this.history.addAndRedo(new e.AddConnectorPointHistoryItem(this.connector.key,this.pointIndex2,this.point2)),u=this.point2),s.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector,[r,u],function(n){n<i.pointIndex1&&i.pointIndex1--;n<i.pointIndex2&&i.pointIndex2--}),this.pointCreated=!0);t=this.getSnappedPoint(n,n.modelPoint);this.isVerticalOrientation?(this.point1.x=t.x,this.point2.x=t.x):(this.point1.y=t.y,this.point2.y=t.y);this.history.addAndRedo(new o.MoveConnectorPointHistoryItem(this.connector.key,this.pointIndex1,this.point1));this.history.addAndRedo(new o.MoveConnectorPointHistoryItem(this.connector.key,this.pointIndex2,this.point2));this.handler.tryUpdateModelSize()},t.prototype.onFinishWithChanges=function(){s.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector)},t.prototype.findPointIndex=function(n,t,i){for(var r;r=n[t];){if(-1!==r.pointIndex)return r.pointIndex;t+=i?1:-1}},t.prototype.correctEdgePoint=function(n,t,i,u){var f=0,o,e;if(void 0!==i){o=i.getConnectionPointSideByIndex(u);e=i.rectangle;switch(f=c.Connector.minOffset,o){case r.ConnectionPointSide.South:f+=e.bottom-n.y;break;case r.ConnectionPointSide.North:f+=n.y-e.top;break;case r.ConnectionPointSide.East:f+=e.right-n.x;break;case r.ConnectionPointSide.West:f+=n.x-e.left}}this.isVerticalOrientation?n.y>t.y?n.y-=Math.min(f,n.y-t.y):n.y+=Math.min(f,t.y-n.y):n.x>t.x?n.x-=Math.min(f,n.x-t.x):n.x+=Math.min(f,t.x-n.x)},t.prototype.getDraggingElementKeys=function(){return[this.connector.key]},t}(l.MouseHandlerDraggingState);t.MouseHandlerMoveConnectorOrthogonalSideState=a},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),e;Object.defineProperty(t,"__esModule",{value:!0});var u=i(10),s=i(0),h=i(42),c=i(41),l=i(26),a=i(91),r=i(7),v=i(31),y=300,p=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t)||this;return o.history=i,o.model=r,o.selection=u,o.visualizerManager=f,o.shapeDescriptionManager=e,o.isModelEmpty=0===r.items.length,o}return o(t,n),t.prototype.cancelChanges=function(){this.tryRemoveTimer()},t.prototype.onDragStart=function(n){this.dragging=n},t.prototype.onDragEnd=function(){this.cancelChanges();this.handler.switchToDefaultState()},t.prototype.onMouseMove=function(n){var t=this;n.source.type>u.MouseEventElementType.Background?(this.tryRemoveTimer(),this.switchToDraggingState(n,!1)):n.source.type!==u.MouseEventElementType.Background||this.isModelEmpty?void 0!==this.nonPageAreaTimer&&this.tryRemoveTimer():(this.savedEvt=n,void 0===this.nonPageAreaTimer&&(this.nonPageAreaTimer=setTimeout(function(){return t.switchToDraggingState(t.savedEvt,!0)},500)))},t.prototype.switchToDraggingState=function(n,t){this.handler.switchState(new e(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.shapeDescriptionManager,t));this.handler.state.onDragStart(this.dragging);this.handler.state.onMouseMove(n)},t.prototype.tryRemoveTimer=function(){void 0!==this.nonPageAreaTimer&&(clearTimeout(this.nonPageAreaTimer),delete this.nonPageAreaTimer)},t.prototype.finish=function(){this.tryRemoveTimer()},t}(v.MouseHandlerCancellableState);t.MouseHandlerBeforeToolboxDraggingState=p;e=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,i)||this;return s.model=r,s.selection=u,s.visualizerManager=f,s.shapeDescriptionManager=e,o||(s.updatePageSizeTimer=setTimeout(function(){s.handler.tryUpdateModelSize();delete s.updatePageSizeTimer},y)),s}return o(t,n),t.prototype.onMouseMove=function(t){var i,u;n.prototype.onMouseMove.call(this,t);i=this.model.findShape(this.shapeKey);i&&(this.visualizerManager.setExtensionLines([i]),u=r.ModelUtils.findContainerByEventKey(this.model,this.selection,t.source.key),u&&r.ModelUtils.canInsertToContainer(this.model,i,u)?this.visualizerManager.setContainerTarget(u,t.source.type):this.visualizerManager.resetContainerTarget())},t.prototype.getDraggingElementKeys=function(){return void 0===this.shapeKey?[]:[this.shapeKey]},t.prototype.onApplyChanges=function(n){var i=this,t,e,f;n.source.type===u.MouseEventElementType.Undefined?(this.dragging.onCaptured(!1),void 0===this.shapeKey||this.deleteHistoryItem)||(t=this.model.findShape(this.shapeKey),r.ModelUtils.detachConnectors(this.history,t),r.ModelUtils.removeFromContainer(this.history,this.model,t),this.deleteHistoryItem=new a.DeleteShapeHistoryItem(this.shapeKey),this.history.addAndRedo(this.deleteHistoryItem)):(this.dragging.onCaptured(!0),void 0===this.shapeKey&&(this.startPoint=n.modelPoint,this.shapeKey=this.insertToolboxItem(n)),this.deleteHistoryItem&&(this.history.undoTransactionTo(this.deleteHistoryItem),delete this.deleteHistoryItem),e=this.getPosition(n,this.startShapePosition),t=this.model.findShape(this.shapeKey),r.ModelUtils.setShapePosition(this.history,this.model,t,e),r.ModelUtils.updateMovingShapeConnections(this.history,t,this.connectorsWithoutBeginItemInfo,this.connectorsWithoutEndItemInfo,function(){i.visualizerManager.resetConnectionTarget();i.visualizerManager.resetConnectionPoints()},function(n,t){i.visualizerManager.setConnectionTarget(n,u.MouseEventElementType.Shape);i.visualizerManager.setConnectionPoints(n,u.MouseEventElementType.Shape,t,!0)}),r.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,t),f=r.ModelUtils.findContainerByEventKey(this.model,this.selection,n.source.key),t&&f&&r.ModelUtils.canInsertToContainer(this.model,t,f)?r.ModelUtils.insertToContainer(this.history,this.model,t,f):r.ModelUtils.removeFromContainer(this.history,this.model,t),void 0===this.updatePageSizeTimer&&this.handler.tryUpdateModelSize(function(n,t){i.connectorsWithoutBeginItemInfo.forEach(function(i){i.point.x+=n;i.point.y+=t});i.connectorsWithoutEndItemInfo.forEach(function(i){i.point.x+=n;i.point.y+=t})}))},t.prototype.onFinishWithChanges=function(){this.deleteHistoryItem||this.history.addAndRedo(new c.SetSelectionHistoryItem(this.selection,[this.shapeKey]))},t.prototype.onDragStart=function(n){this.dragging=n;this.connectorsWithoutBeginItemInfo=r.ModelUtils.getConnectorsWithoutBeginItemInfo(this.model);this.connectorsWithoutEndItemInfo=r.ModelUtils.getConnectorsWithoutEndItemInfo(this.model)},t.prototype.onDragEnd=function(n){void 0!==this.shapeKey&&n.source.type===u.MouseEventElementType.Undefined&&this.cancelChanges();this.handler.switchToDefaultState()},t.prototype.finish=function(){this.visualizerManager.resetExtensionLines();this.visualizerManager.resetContainerTarget();this.visualizerManager.resetConnectionTarget();this.visualizerManager.resetConnectionPoints();this.dragging.onFinishDragging();n.prototype.finish.call(this)},t.prototype.insertToolboxItem=function(n){var i=this.shapeDescriptionManager.get(this.dragging.data),t;return this.startShapePosition=this.getSnappedPoint(n,new s.Point(n.modelPoint.x-i.defaultSize.width/2,n.modelPoint.y-i.defaultSize.height/2)),t=new h.AddShapeHistoryItem(i,this.startShapePosition),this.history.addAndRedo(t),r.ModelUtils.updateNewShapeProperties(this.history,this.selection,t.shapeKey),t.shapeKey},t.prototype.getPosition=function(n,t){return this.getSnappedPoint(n,new s.Point(t.x+n.modelPoint.x-this.startPoint.x,t.y+n.modelPoint.y-this.startPoint.y))},t}(l.MouseHandlerDraggingState);t.MouseHandlerToolboxDraggingState=e},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(26),o=i(277),u=i(53),s=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.model=r,u}return f(t,n),t.prototype.onMouseDown=function(t){this.connector=this.model.findConnector(t.source.key);this.position=parseFloat(t.source.value);this.text=this.connector.getText(this.position);this.savedText="";n.prototype.onMouseDown.call(this,t)},t.prototype.onApplyChanges=function(n){var t=this.connector.getTextPositionByPoint(n.modelPoint),i;t!=this.position&&(i=this.connector.getText(t),""!==i&&i!==this.text&&(this.history.addAndRedo(new u.ChangeConnectorTextHistoryItem(this.connector,t,"")),this.savedText=i),this.history.addAndRedo(new o.ChangeConnectorTextPositionHistoryItem(this.connector,this.position,t)),""!==this.savedText&&this.savedText!==i&&(this.history.addAndRedo(new u.ChangeConnectorTextHistoryItem(this.connector,this.position,this.savedText)),this.savedText=""),this.position=t)},t.prototype.getDraggingElementKeys=function(){return[this.connector.key]},t}(e.MouseHandlerDraggingState);t.MouseHandlerMoveConnectorTextState=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r){var u=n.call(this)||this;return u.connectorKey=t.key,u.position=i,u.newPosition=r,u}return f(t,n),t.prototype.redo=function(n){var t=n.model.findConnector(this.connectorKey);n.changeConnectorTextPosition(t,this.position,this.newPosition)},t.prototype.undo=function(n){var t=n.model.findConnector(this.connectorKey);n.changeConnectorTextPosition(t,this.newPosition,this.position)},t}(i(3).HistoryItem);t.ChangeConnectorTextPositionHistoryItem=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(31),o=i(279),u=i(7),s=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.history=i,f.model=r,f.selection=u,f}return f(t,n),t.prototype.onMouseUp=function(n){var t=this.model.findShape(n.source.key);t&&!t.isLocked&&(this.history.beginTransaction(),this.history.addAndRedo(new o.ToggleShapeExpandedHistoryItem(t)),u.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,t),u.ModelUtils.updateContainerConnectorsAttachedPoints(this.history,this.model,t),u.ModelUtils.updateSelection(this.history,this.selection),this.handler.tryUpdateModelSize(),this.history.endTransaction(),this.handler.raiseClick([t.key]));this.handler.switchToDefaultState()},t}(e.MouseHandlerStateBase);t.MouseHandlerToggleShapeExpandedState=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.shapeKey=t.key,i.expanded=t.expanded,i}return f(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);n.changeShapeExpanded(t,!this.expanded)},t.prototype.undo=function(n){var t=n.model.findShape(this.shapeKey);n.changeShapeExpanded(t,this.expanded)},t}(i(3).HistoryItem);t.ToggleShapeExpandedHistoryItem=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(10),e=i(0),o=function(n){function t(t,i,r){var u=n.call(this,t)||this;return u.selection=i,u.visualizerManager=r,u}return u(t,n),t.prototype.finish=function(){this.handler.raiseDragEnd([]);this.visualizerManager.resetSelectionRectangle();n.prototype.finish.call(this)},t.prototype.cancelChanges=function(){},t.prototype.onMouseDown=function(n){this.startPoint=n.modelPoint;this.handler.raiseDragStart([])},t.prototype.onMouseMove=function(n){n.button!==f.MouseButton.Left?this.handler.switchToDefaultState():(this.rectangle=e.Rectangle.createByPoints(this.startPoint,n.modelPoint),this.visualizerManager.setSelectionRectangle(this.rectangle))},t.prototype.onMouseUp=function(){void 0!==this.rectangle?this.selection.selectRect(this.rectangle):this.selection.set([]);this.rectangle=void 0;this.handler.switchToDefaultState()},t}(i(31).MouseHandlerCancellableState);t.MouseHandlerSelectionState=o},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(31),s=i(10),h=i(13),f=i(4),u=i(45),c=function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.settings=i,f.view=r,f.bars=u,f}return e(t,n),t.prototype.onMouseWheel=function(n){return this.trySwitchToDefault(n)?this.handler.state.onMouseWheel(n):(this.settings.zoomLevel=this.view.getNextStepZoom(n.deltaY<0),this.bars.updateItemsState([u.DiagramCommand.ZoomLevel]),n.source.type===s.MouseEventElementType.Background?this.view.resetScroll():(this.view.scrollTo(n.modelPoint,n.offsetPoint),this.view.normalize()),n.preventDefault=!0,!0)},t.prototype.onMouseUp=function(n){this.handler.switchToDefaultState();this.handler.state.onMouseUp(n)},t.prototype.onMouseDown=function(n){this.handler.switchToDefaultState();this.handler.state.onMouseDown(n)},t.prototype.onMouseMove=function(n){this.trySwitchToDefault(n)&&this.handler.state.onMouseMove(n)},t.prototype.trySwitchToDefault=function(n){if(!(n.modifiers&h.ModifierKey.Ctrl))return this.handler.switchToDefaultState(),!0},t.prototype.start=function(){n.prototype.start.call(this);this.settings.zoomLevel=this.view.getZoom();this.settings.autoZoom!==f.AutoZoomMode.Disabled&&(this.settings.autoZoom=f.AutoZoomMode.Disabled,this.bars.updateItemsState([u.DiagramCommand.SwitchAutoZoom,u.DiagramCommand.ToggleAutoZoom]))},t}(o.MouseHandlerStateBase);t.MouseHandlerZoomOnWheelState=c},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(84);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.onMouseMove=function(t){n.prototype.onMouseMove.call(this,t);this.switchToMoveClonedShapeState(t)},t.prototype.switchToMoveClonedShapeState=function(n){u.MouseHandlerMoveClonedShapeState.isMoveClonedShapeEvent(n)&&(this.cancelChanges(),this.handler.switchToMoveClonedShapeState(this.startPoint),this.handler.onMouseDown(n))},t}(i(283).MouseHandlerMoveShapeOrthogonallyState);t.MouseHandlerMoveShapeState=f},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(13);f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.onApplyChanges=function(t){this.calculateFixedPosition(t);n.prototype.onApplyChanges.call(this,t)},t.prototype.getXPosition=function(t,i){return this.fixedX?i:n.prototype.getXPosition.call(this,t,i)},t.prototype.getYPosition=function(t,i){return this.fixedY?i:n.prototype.getYPosition.call(this,t,i)},t.prototype.calculateFixedPosition=function(n){(this.fixedX=!1,this.fixedY=!1,n.modifiers&u.ModifierKey.Shift)&&(Math.abs(this.startPoint.x-n.modelPoint.x)<Math.abs(this.startPoint.y-n.modelPoint.y)?this.fixedX=!0:this.fixedY=!0)},t}(i(127).MouseHandlerMoveShapeStateBase);t.MouseHandlerMoveShapeOrthogonallyState=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.canDragObjectOnMouseDown=function(){return!1},t.prototype.canExpandContainerOnMouseDown=function(){return!1},t.prototype.canClearSelectionOnMouseDown=function(){return!0},t.prototype.processOnMouseMoveAfterLimit=function(n){this.startScrolling(n)},t.prototype.canSelectOnMouseUp=function(n){return!this.inSelection(n)},t.prototype.canClearSelectionOnMouseUp=function(){return!1},t}(i(130).MouseHandlerDefaultReadOnlyState);t.MouseHandlerDefaultReadOnlyTouchState=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(124),e=i(286),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.updateConnectionsOnMouseMove=function(){},t.prototype.canDragObjectOnMouseDown=function(n){return this.inSelection(n)},t.prototype.canExpandContainerOnMouseDown=function(){return!0},t.prototype.canClearSelectionOnMouseDown=function(){return!0},t.prototype.processOnMouseMoveAfterLimit=function(n){n.touches.length>1?this.startZooming(n):this.startScrolling(n)},t.prototype.startZooming=function(){this.handler.switchState(new e.MouseHandlerZoomOnPinchState(this.handler,this.selection,this.settings,this.view,this.bars))},t.prototype.canSelectOnMouseUp=function(n){return!this.inSelection(n)},t.prototype.canClearSelectionOnMouseUp=function(){return!1},t}(f.MouseHandlerDefaultState);t.MouseHandlerDefaultTouchState=o},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(34),f=i(45),r=i(0),s=i(129),h=function(n){function t(t,i,r,u,f){var e=n.call(this,t,u,i)||this;return e.selection=i,e.settings=r,e.view=u,e.bars=f,e}return o(t,n),t.prototype.onMouseDown=function(t){n.prototype.onMouseDown.call(this,t);t.touches.length>1&&(this.startDistance=this.getTouchDistance(t),this.startZoomLevel=this.settings.zoomLevel,this.prevDistance=this.startDistance)},t.prototype.onMouseMove=function(t){if(t.touches.length>1){var i=this.getTouchDistance(t);Math.abs(this.prevDistance-i)>1&&(this.settings.zoomLevel=this.startZoomLevel*(i/this.startDistance),this.bars.updateItemsState([f.DiagramCommand.ZoomLevel]),this.view.scrollTo(this.getMiddleLayoutPoint(t),this.getMiddleAbsPoint(t)),this.view.normalize(),this.prevDistance=i)}n.prototype.onMouseMove.call(this,t)},t.prototype.onMouseUp=function(n){0===n.touches.length&&setTimeout(function(){this.handler.switchToDefaultState()}.bind(this),1)},t.prototype.start=function(){n.prototype.start.call(this);this.settings.zoomLevel=this.view.getZoom();this.settings.autoZoom!==e.AutoZoomMode.Disabled&&(this.settings.autoZoom=e.AutoZoomMode.Disabled,this.bars.updateItemsState([f.DiagramCommand.SwitchAutoZoom,f.DiagramCommand.ToggleAutoZoom]))},t.prototype.getTouchDistance=function(n){var t=new r.Point(n.touches[0].offsetPoint.x,n.touches[0].offsetPoint.y),i=new r.Point(n.touches[1].offsetPoint.x,n.touches[1].offsetPoint.y);return r.GeometryUtils.getDistance(t,i)},t.prototype.getPointByEvent=function(n){return this.getMiddleAbsPoint(n)},t.prototype.getMiddleAbsPoint=function(n){return n.touches.length>1?t.getMiddlePointByEvent(n,function(n){return n.offsetPoint}):n.offsetPoint},t.prototype.getMiddleLayoutPoint=function(n){return n.touches.length>1?t.getMiddlePointByEvent(n,function(n){return n.modelPoint}):n.modelPoint},t.getMiddlePointByEvent=function(n,t){if(n.touches.length>1)return new r.Point((t(n.touches[0]).x+t(n.touches[1]).x)/2,(t(n.touches[0]).y+t(n.touches[1]).y)/2)},t}(s.MouseHandlerScrollingState);t.MouseHandlerZoomOnPinchState=h},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i(288),r=i(10),o=i(13),u=i(11),f=i(6),s=i(53),h=function(){function n(n){this.control=n}return n.prototype.startTextInput=function(n,t){if(!n.isLocked&&n.enableText&&n.allowEditText&&!this.control.settings.readOnly){if(this.control.beginUpdate(),this.textInputItem=n,this.textInputItem instanceof u.Shape){var i=this.textInputItem.textEditRectangle;this.control.eventManager.raiseTextInputStart(this.textInputItem,this.textInputItem.text,i.position,i.size)}this.textInputItem instanceof f.Connector&&(this.textInputPosition=t,this.control.eventManager.raiseTextInputStart(this.textInputItem,this.textInputItem.getText(this.textInputPosition),this.textInputItem.getTextPoint(this.textInputPosition)))}},n.prototype.endTextInput=function(){var n=this.textInputItem;delete this.textInputItem;this.control.eventManager.raiseTextInputEnd(n);this.control.endUpdate();this.control.barManager.updateItemsState()},n.prototype.applyTextInput=function(n){var t=this.textInputItem,i=this.textInputPosition;this.endTextInput();t instanceof u.Shape?t.text!==n&&this.control.history.addAndRedo(new e.ChangeShapeTextHistoryItem(t,n)):t instanceof f.Connector&&t.getText(i)!==n&&this.control.history.addAndRedo(new s.ChangeConnectorTextHistoryItem(t,i,n))},n.prototype.cancelTextInput=function(){this.endTextInput()},n.prototype.isTextInputActive=function(){return void 0!==this.textInputItem},n.prototype.processDblClick=function(n){var u,t,i;n.source.type===r.MouseEventElementType.Shape?(u=this.control.model.findShape(n.source.key),this.startTextInput(u)):n.source.type===r.MouseEventElementType.Connector?(t=(i=this.control.model.findConnector(n.source.key)).getTextPositionByPoint(n.modelPoint),this.startTextInput(i,t)):n.source.type===r.MouseEventElementType.ConnectorText&&(i=this.control.model.findConnector(n.source.key),t=parseFloat(n.source.value),this.startTextInput(i,t))},n.prototype.onDblClick=function(n){this.processDblClick(n)},n.prototype.onKeyDown=function(n){this.isTextInputActive()&&(13===n.keyCode&&n.modifiers&o.ModifierKey.Ctrl&&(n.preventDefault=!0,this.applyTextInput(n.inputText)),27===n.keyCode&&this.cancelTextInput())},n.prototype.onBlur=function(n){this.isTextInputActive()&&this.applyTextInput(n.inputText)},n.prototype.onFocus=function(){},n}();t.TextInputHandler=h},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i){var r=n.call(this)||this;return r.shapeKey=t.key,r.text=i,r}return f(t,n),t.prototype.redo=function(n){var t=n.model.findShape(this.shapeKey);this.oldText=t.text;n.changeShapeText(t,this.text)},t.prototype.undo=function(n){var t=n.model.findShape(this.shapeKey);n.changeShapeText(t,this.oldText)},t}(i(3).HistoryItem);t.ChangeShapeTextHistoryItem=u},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(10),e=i(19),o=i(131),s=function(n){function t(t){var i=n.call(this)||this;return i.selection=t,i.contextToolboxVisible=!1,i.selection.onChanged.add(i),i}return u(t,n),t.prototype.onMouseDown=function(n){void 0===n.source.key&&this.hideContextMenu()},t.prototype.onMouseUp=function(){},t.prototype.onFocus=function(){var n=this;setTimeout(function(){n.showContextMenuAtSelection()},1)},t.prototype.onBlur=function(){var n=this;setTimeout(function(){n.hideContextMenu()},1)},t.prototype.onTextInputFocus=function(){var n=this;setTimeout(function(){n.hideContextMenu()},1)},t.prototype.onTextInputBlur=function(){var n=this;setTimeout(function(){n.showContextMenuAtSelection()},1)},t.prototype.onLongTouch=function(n){n.source.type===f.MouseEventElementType.Document&&this.showContextMenuAtEmptySelection(n.modelPoint)},t.prototype.getSelectedItems=function(){return this.selection.getSelectedItems(!0)},t.prototype.showContextMenuAtSelection=function(){if(!this.contextToolboxVisible){var n=this.getSelectedItems();0!==n.length&&this.showContextMenu(void 0,e.DiagramModel.getRectangle(n).position)}},t.prototype.showContextMenuAtEmptySelection=function(n){this.contextToolboxVisible||0===this.getSelectedItems().length&&this.showContextMenu(void 0,n)},t.prototype.notifyDragStart=function(){this.hideContextMenu()},t.prototype.notifyDragEnd=function(){this.showContextMenuAtSelection()},t.prototype.notifySelectionChanged=function(){this.isUpdateLocked()?this.registerOccurredEvent(1):this.raiseSelectionChanged()},t.prototype.raiseSelectionChanged=function(){0!==this.getSelectedItems().length?this.showContextMenuAtSelection():this.hideContextMenu()},t.prototype.onUpdateUnlocked=function(n){1&n&&this.raiseSelectionChanged()},t.prototype.notifyShowContextToolbox=function(){this.contextToolboxVisible=!0;this.hideContextMenu()},t.prototype.notifyHideContextToolbox=function(){this.contextToolboxVisible=!1;this.showContextMenuAtSelection()},t}(o.ContextMenuHandler);t.ContextMenuTouchHandler=s},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){return n.call(this,t)||this}return f(t,n),t.prototype.raiseShow=function(){var n=this;this.dispatcher.raise1(function(t){return t.notifyConnectionTargetShow(n.key,n.targetRect,n.targetStrokeWidth)})},t.prototype.raiseHide=function(){this.dispatcher.raise1(function(n){return n.notifyConnectionTargetHide()})},t}(i(133).TargetVisualizerBase);t.ConnectionTargetVisualizer=u},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){return n.call(this,t)||this}return f(t,n),t.prototype.raiseShow=function(){var n=this;this.dispatcher.raise1(function(t){return t.notifyContainerTargetShow(n.key,n.targetRect,n.targetStrokeWidth)})},t.prototype.raiseHide=function(){this.dispatcher.raise1(function(n){return n.notifyContainerTargetHide()})},t}(i(133).TargetVisualizerBase);t.ContainerTargetVisualizer=u},function(n,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0});i=function(){return function(n,t){this.point=n;this.side=t}}();t.ConnectionPointInfo=i;r=function(){function n(n){this.dispatcher=n}return n.prototype.getKey=function(){return this.key},n.prototype.setPoints=function(n,t,i,r){this.key===n&&this.pointIndex===i||(this.key=n,this.points=t,this.pointIndex=i,this.outsideRectangle=r,this.raiseShow())},n.prototype.setPointIndex=function(n){0<=n&&n<this.points.length&&this.pointIndex!==n&&(this.pointIndex=n,this.raiseShow())},n.prototype.update=function(){this.raiseShow()},n.prototype.reset=function(){"-1"!==this.key&&(this.key="-1",this.points=[],this.pointIndex=-1,this.outsideRectangle=void 0,this.raiseHide())},n.prototype.raiseShow=function(){var n=this;this.dispatcher.raise1(function(t){return t.notifyConnectionPointsShow(n.key,n.points,n.pointIndex,n.outsideRectangle)})},n.prototype.raiseHide=function(){this.dispatcher.raise1(function(n){return n.notifyConnectionPointsHide()})},n}();t.ConnectionPointsVisualizer=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this.dispatcher=n}return n.prototype.set=function(n,t){this.point=n;this.text=t;this.raiseShow()},n.prototype.reset=function(){void 0!==this.point&&(this.point=void 0,this.text=void 0,this.raiseHide())},n.prototype.raiseShow=function(){var n=this;this.dispatcher.raise1(function(t){return t.notifyResizeInfoShow(n.point,n.text)})},n.prototype.raiseHide=function(){this.dispatcher.raise1(function(n){return n.notifyResizeInfoHide()})},n}();t.ResizeInfoVisualizer=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this.dispatcher=n}return n.prototype.setRectangle=function(n){this.rect=n;this.raiseShow()},n.prototype.reset=function(){this.rect=void 0;this.raiseHide()},n.prototype.raiseShow=function(){var n=this;this.dispatcher.raise1(function(t){return t.notifySelectionRectShow(n.rect)})},n.prototype.raiseHide=function(){this.dispatcher.raise1(function(n){return n.notifySelectionRectHide()})},n}();t.SelectionRectVisualizer=i},function(n,t,i){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var f=i(132),e=i(10),o=function(n){function t(t,i,r,u,f){void 0===f&&(f=u.readOnly);var e=n.call(this,t,i,r,u,f)||this;return t.onChanged.add(e),e}return u(t,n),t.prototype.onBlur=function(){var n=this;setTimeout(function(){n.hideConnections()},1)},t.prototype.onFocus=function(){var n=this;setTimeout(function(){n.showConnections()},1)},t.prototype.hideConnections=function(){this.readOnly||this.resetConnectionPoints()},t.prototype.showConnections=function(){if(!this.readOnly&&this.needShowConnections()){var n=this.selection.getSelectedShapes();1===n.length&&this.setConnectionPoints(n[0],e.MouseEventElementType.ShapeConnectionPoint,-1,!n[0].allowResizeHorizontally&&!n[0].allowResizeVertically||n[0].isLocked)}},t.prototype.needShowConnections=function(){var n=this.selection.getSelectedItems(),t=this.selection.getSelectedShapes();return 1===n.length&&1===t.length},t.prototype.notifySelectionChanged=function(){this.isUpdateLocked()?this.registerOccurredEvent(1):this.raiseSelectionChanged()},t.prototype.raiseSelectionChanged=function(){this.needShowConnections()?this.showConnections():this.hideConnections()},t.prototype.onUpdateUnlocked=function(n){1&n&&this.raiseSelectionChanged()},t.prototype.notifyDragStart=function(){this.hideConnections()},t.prototype.notifyDragEnd=function(){this.showConnections()},t}(f.VisualizerManager);t.VisualizerTouchManager=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),u=i(10),f=i(13),e=function(){function n(){this.contextToolboxVisible=!1;this.onVisibilityChanged=new r.EventDispatcher}return n.prototype.onMouseDown=function(n){n.source.type!==u.MouseEventElementType.Undefined&&this.hideContextToolbox()},n.prototype.onMouseUp=function(n){n.source.type===u.MouseEventElementType.Undefined&&r.Browser.TouchUI||this.hideContextToolbox()},n.prototype.onFocus=function(){},n.prototype.onBlur=function(){},n.prototype.onKeyDown=function(n){n.keyCode===f.KeyCode.Esc&&this.hideContextToolbox()},n.prototype.showContextToolbox=function(n,t,i,r){this.onVisibilityChanged.raise1(function(u){return u.notifyShowContextToolbox(n,t,i,r)});this.contextToolboxVisible=!0},n.prototype.hideContextToolbox=function(){this.contextToolboxVisible&&(this.onVisibilityChanged.raise1(function(n){return n.notifyHideContextToolbox()}),this.contextToolboxVisible=!1)},n}();t.ContextToolboxHandler=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),f=i(298),r=i(11),e=i(6),o=i(38),s=function(){function n(n){this.onChanged=new u.EventDispatcher;this.inputPosition=new f.InputPosition(this);this.onChanged.add(this.inputPosition);this.initialize(n)}return n.prototype.initialize=function(n){this.model=n;this.keys=[];this.inputPosition.initialize()},n.prototype.add=function(n){this.keys.indexOf(n)<0&&(this.keys.push(n),this.raiseSelectionChanged())},n.prototype.remove=function(n){this.keys.indexOf(n)>=0&&(this.keys.splice(this.keys.indexOf(n),1),this.raiseSelectionChanged())},n.prototype.clear=function(){this.keys.length>0&&(this.keys=[],this.raiseSelectionChanged())},n.prototype.set=function(n,t){!t&&o.Data.ArrayEqual(n,this.keys)||(this.keys=n,this.raiseSelectionChanged())},n.prototype.getKeys=function(){return this.keys},n.prototype.getKey=function(n){return this.keys[n]},n.prototype.getSelectedItemsInsideContainers=function(n){var t=this,i=n.slice();return n.forEach(function(n){n instanceof r.Shape&&t.getSelectedItemsInsideContainers(t.model.getChildren(n)).forEach(function(n){-1!==i.indexOf(n)||t.hasKey(n.key)||i.push(n)})}),i},n.prototype.getSelectedItemsCore=function(n){var t=this;return this.keys.map(function(n){return t.model.findItem(n)}).filter(function(t){return t&&(n||!t.isLocked)})},n.prototype.getSelectedItems=function(n,t){return t?this.getSelectedItemsInsideContainers(this.getSelectedItemsCore(n)):this.getSelectedItemsCore(n)},n.prototype.getSelectedShapes=function(n,t){var u=this,i;return t?(i=this.getSelectedItemsCore(n),this.getSelectedItemsInsideContainers(i).map(function(n){if(n instanceof r.Shape)return n}).filter(function(n){return n})):this.keys.map(function(n){return u.model.findShape(n)}).filter(function(t){return t&&(n||!t.isLocked)})},n.prototype.getSelectedConnectors=function(n,t){var i=this,r;return t?(r=this.keys.map(function(n){return i.model.findItem(n)}),this.getSelectedItemsInsideContainers(r).map(function(n){if(n instanceof e.Connector)return n}).filter(function(n){return n})):this.keys.map(function(n){return i.model.findConnector(n)}).filter(function(t){return t&&(n||!t.isLocked)})},n.prototype.hasKey=function(n){return this.keys.indexOf(n)>=0},n.prototype.isEmpty=function(n){return!this.getSelectedItems(n).length},n.prototype.selectRect=function(n){var t=[];this.model.iterateItems(function(i){i.intersectedByRect(n)&&t.push(i.key)});this.set(t)},n.prototype.onLoad=function(){this.raiseSelectionChanged()},n.prototype.raiseSelectionChanged=function(){this.onChanged.raise("notifySelectionChanged",this)},n}();t.Selection=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(299),u=i(38),f=function(){function n(n){this.selection=n;this.initialProperties=new r.InputPositionProperties(this.selection);this.defaultProperties=new r.InputPositionProperties(this.selection,this.initialProperties);this.currentProperties=new r.InputPositionProperties(this.selection,this.defaultProperties)}return n.prototype.initialize=function(){this.reset();this.defaultProperties.reset()},n.prototype.reset=function(){this.currentProperties.reset()},n.prototype.getDefaultConnectorProperties=function(){return this.defaultProperties.getConnectorProperties()},n.prototype.getDefaultConnectorPropertyValue=function(n){return this.defaultProperties.getConnectorPropertyValue(n)},n.prototype.getCurrentConnectorPropertyValue=function(n){return this.currentProperties.getConnectorPropertyValue(n)},n.prototype.setConnectorPropertyValue=function(n,t){this.currentProperties.setConnectorPropertyValue(n,t);this.selection.isEmpty(!0)&&this.defaultProperties.setConnectorPropertyValue(n,t)},n.prototype.setInitialConnectorProperties=function(n){for(var t in this.defaultProperties.reset(),this.currentProperties.reset(),n)n.hasOwnProperty(t)&&this.initialProperties.setConnectorPropertyValue(t,n[t])},n.prototype.getDefaultStyle=function(){return this.defaultProperties.getStyle()},n.prototype.getDefaultStylePropertyValue=function(n){return this.defaultProperties.getStylePropertyValue(n)},n.prototype.getDefaultTextStyle=function(){return this.defaultProperties.getTextStyle()},n.prototype.getDefaultTextStylePropertyValue=function(n){return this.defaultProperties.getTextStylePropertyValue(n)},n.prototype.getCurrentStylePropertyValue=function(n){return this.currentProperties.getStylePropertyValue(n)},n.prototype.getCurrentTextStylePropertyValue=function(n){return this.currentProperties.getTextStylePropertyValue(n)},n.prototype.setStylePropertyValue=function(n,t){this.currentProperties.setStylePropertyValue(n,t);this.selection.isEmpty(!0)&&this.defaultProperties.setStylePropertyValue(n,t)},n.prototype.setTextStylePropertyValue=function(n,t){this.currentProperties.setTextStylePropertyValue(n,t);this.selection.isEmpty(!0)&&this.defaultProperties.setTextStylePropertyValue(n,t)},n.prototype.setInitialStyleProperties=function(n){var t,i;this.defaultProperties.reset();this.currentProperties.reset();t="string"==typeof n?u.Data.cssTextToObject(n):n;for(i in t)t.hasOwnProperty(i)&&this.initialProperties.setStylePropertyValue(i,t[i])},n.prototype.setInitialTextStyleProperties=function(n){var t,i;this.defaultProperties.reset();this.currentProperties.reset();t="string"==typeof n?u.Data.cssTextToObject(n):n;for(i in t)t.hasOwnProperty(i)&&this.initialProperties.setTextStylePropertyValue(i,t[i])},n.prototype.notifySelectionChanged=function(){this.reset()},n}();t.InputPosition=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(25),r=i(23),f=function(){function n(n,t){this.selection=n;this.baseProperties=t;this.selection=n}return n.prototype.reset=function(){this.connectorProperties=null;this.style=null;this.textStyle=null},n.prototype.getConnectorProperties=function(){return this.connectorProperties||(this.connectorProperties=this.baseProperties?this.baseProperties.getConnectorProperties().clone():new u.ConnectorProperties,this.updateConnectorProperties(this.connectorProperties)),this.connectorProperties},n.prototype.getConnectorPropertyValue=function(n){return this.getConnectorProperties()[n]},n.prototype.setConnectorPropertyValue=function(n,t){this.getConnectorProperties()[n]=t},n.prototype.getStyle=function(){return this.style||(this.style=this.baseProperties?this.baseProperties.getStyle().clone():new r.Style,this.updateStyle(this.style,"style")),this.style},n.prototype.getStylePropertyValue=function(n){return this.getStyle()[n]},n.prototype.setStylePropertyValue=function(n,t){this.getStyle()[n]=t},n.prototype.getTextStyle=function(){return this.textStyle||(this.textStyle=this.baseProperties?this.baseProperties.getTextStyle().clone():new r.TextStyle,this.updateStyle(this.textStyle,"styleText")),this.textStyle},n.prototype.getTextStylePropertyValue=function(n){return this.getTextStyle()[n]},n.prototype.setTextStylePropertyValue=function(n,t){this.getTextStyle()[n]=t},n.prototype.updateConnectorProperties=function(n){var t=this,i=this.selection.getSelectedConnectors(!0);n.forEach(function(r){t.updatePropertyValue(n,i,function(n){return n.properties},r)})},n.prototype.updateStyle=function(n,t){var i=this,r=this.selection.getSelectedItems(!0);n.forEach(function(u){i.updatePropertyValue(n,r,function(n){return n[t]},u)})},n.prototype.updatePropertyValue=function(n,t,i,r){var u=void 0,f=!1;t.forEach(function(n){var t=i(n)[r];if(void 0===u&&null!=t)u=t,f=!0;else if(f&&u!==t)return void(u=void 0)});f&&(n[r]=u)},n}();t.InputPositionProperties=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(3),u=i(4),f=function(){function n(n){this.historyItems=[];this.currentIndex=-1;this.incrementalId=-1;this.transactionLevel=-1;this.unmodifiedIndex=-1;this.currTransactionId=0;this.onChanged=new u.EventDispatcher;this.modelManipulator=n}return n.prototype.isModified=function(){if(this.unmodifiedIndex==this.currentIndex)return!1;for(var t=Math.min(this.unmodifiedIndex,this.currentIndex),i=Math.max(this.unmodifiedIndex,this.currentIndex),n=t+1;n<=i;n++)if(this.historyItems[n].changeModified())return!0;return!1},n.prototype.undo=function(){this.canUndo()&&(this.historyItems[this.currentIndex].undo(this.modelManipulator),this.currentIndex--,this.raiseChanged())},n.prototype.redo=function(){this.canRedo()&&(this.currentIndex++,this.historyItems[this.currentIndex].redo(this.modelManipulator),this.raiseChanged())},n.prototype.canUndo=function(){return this.currentIndex>=0},n.prototype.canRedo=function(){return this.currentIndex<this.historyItems.length-1},n.prototype.beginTransaction=function(){return this.transactionLevel++,0==this.transactionLevel&&(this.transaction=new r.CompositionHistoryItem),this.currTransactionId++},n.prototype.endTransaction=function(){if(!(--this.transactionLevel>=0)){var n=this.transaction.historyItems.length;n>1?this.addInternal(this.transaction):1==n&&this.addInternal(this.transaction.historyItems.pop());n>0&&this.raiseChanged();delete this.transaction}},n.prototype.addAndRedo=function(n){this.add(n);n.redo(this.modelManipulator);this.raiseChanged()},n.prototype.add=function(n){this.transactionLevel>=0?this.transaction.add(n):this.addInternal(n)},n.prototype.addInternal=function(n){this.currentIndex<this.historyItems.length-1&&(this.historyItems.splice(this.currentIndex+1),this.unmodifiedIndex=Math.min(this.unmodifiedIndex,this.currentIndex));this.historyItems.push(n);this.currentIndex++;this.deleteOldItems()},n.prototype.deleteOldItems=function(){var t=this.historyItems.length-n.MAX_HISTORY_ITEM_COUNT;t>0&&this.currentIndex>t&&(this.historyItems.splice(0,t),this.currentIndex-=t)},n.prototype.getNextId=function(){return this.incrementalId++,this.incrementalId},n.prototype.clear=function(){this.currentIndex=-1;this.unmodifiedIndex=-1;this.incrementalId=-1;this.historyItems=[];delete this.transaction;this.transactionLevel=-1},n.prototype.resetModified=function(){this.unmodifiedIndex=this.currentIndex},n.prototype.getCurrentItemId=function(){if(-1==this.currentIndex)return-1;var n=this.historyItems[this.currentIndex];return-1==n.uniqueId&&(n.uniqueId=this.getNextId()),n.uniqueId},n.prototype.undoTransaction=function(){for(var n=this.transaction.historyItems;n.length;)n.pop().undo(this.modelManipulator);this.raiseChanged()},n.prototype.undoTransactionTo=function(n){for(var i,t=this.transaction.historyItems;t.length;)if(i=t.pop(),i.undo(this.modelManipulator),i===n)return;this.raiseChanged()},n.prototype.raiseChanged=function(){-1===this.transactionLevel&&this.onChanged.raise("notifyHistoryChanged")},n.MAX_HISTORY_ITEM_COUNT=100,n}();t.History=f},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t){var i=n.call(this)||this;return i.bars=[],i.control=t,i}return f(t,n),t.prototype.registerBar=function(n){this.bars.push(n);n.onChanged.add(this);this.updateBarItemsState(n)},t.prototype.updateItemsState=function(n){if(!this.isUpdateLocked())for(var t,i=0;t=this.bars[i];i++)this.updateBarItemsState(t,n)},t.prototype.updateBarItemsState=function(n,t){var i,u,f,r;if(!this.isUpdateLocked()&&n.isVisible())for(i=void 0,t?(u=n.getCommandKeys().reduce(function(n,t){return n[t]=!0,n},{}),i=t.filter(function(n){return u[n]})):i=n.getCommandKeys(),f=i.length,r=0;r<f;r++)this.updateBarItem(n,i[r])},t.prototype.updateBarItem=function(n,t){var r=this.control.commandManager.getCommand(t),i,u;r&&(i=r.getState(),(n.setItemVisible(t,i.visible),i.visible&&(n.setItemEnabled(t,i.enabled),!i.denyUpdateValue))&&(u=this.getItemValue(i.value),i.items&&n.setItemSubItems(t,i.items),n.setItemValue(t,u,this.getDefaultItemValue(i.defaultValue))))},t.prototype.setEnabled=function(n){for(var t,i=0;t=this.bars[i];i++)t.setEnabled(n)},t.prototype.notifyBarCommandExecuted=function(n,t){this.control.commandManager.getCommand(n).execute(t)||this.updateItemsState([n])},t.prototype.notifyBarUpdateRequested=function(){this.updateItemsState()},t.prototype.notifySelectionChanged=function(){this.updateItemsState()},t.prototype.onUpdateUnlocked=function(){},t.prototype.getItemValue=function(n){return n},t.prototype.getDefaultItemValue=function(n){return n},t}(i(63).BatchUpdatableObject);t.BarManager=u},function(n,t,i){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0});var f=i(10),e=i(39),c=i(0),s=i(18),l=i(13),o=i(24),u=i(15),h=i(65),v=i(115),y=i(303),p=i(34),w=i(304),b=i(305),k=i(307),d=i(135),g=i(309),nt=i(80),r=i(12),tt=i(79);t.LONG_TOUCH_TIMEOUT=500;t.DBL_CLICK_TIMEOUT=500;a=function(){function n(n,t,i){this.moveLocked=!1;this.lockMouseMoveTimer=-1;this.lastClickElement=void 0;this.longTouchTimer=void 0;this.dblTouchTimer=void 0;var u=r.RenderHelper.createMainElement(n),f=r.RenderHelper.createSvgElement(u);this.scroll=i.scrollView||new y.NativeScrollView(n);this.measurer=new nt.TextMeasurer(n);this.dom=new tt.DOMManipulator(this.measurer);this.view=new k.CanvasViewManager(this.scroll,f,i.modelSize,i.zoomLevel,i.autoZoom,i.simpleView,i.rectangle,this.dom);this.input=new w.InputManager(u,this.view,t,i.zoomLevel);this.items=new v.CanvasItemsManager(this.view.canvasElement,i.zoomLevel,this.dom);this.page=new b.CanvasPageManager(this.view.pageElement,i,this.dom);this.selection=new d.CanvasSelectionManager(this.view.canvasElement,i.zoomLevel,i.readOnly,this.dom);this.view.onViewChanged.add(this.page);this.view.onViewChanged.add(this.items);this.view.onViewChanged.add(this.selection);this.view.onViewChanged.add(this.input);this.autoScroll=new g.AutoScrollController(this.scroll,u,f,this.view);this.attachEvents(f);this.mainElement=u;this.svgElement=f;this.events=t}return n.prototype.clean=function(){this.killLockMouseMoveTimer();this.detachEvents(this.svgElement);this.scroll.detachEvents();this.input.detachEvents();this.dom.cancelAnimation();u.RenderUtils.removeElement(this.mainElement)},n.prototype.replaceParent=function(n,t){this.mainElement&&this.mainElement.parentNode!==n&&n.appendChild(this.mainElement);t&&t!==this.scroll&&(this.scroll&&this.scroll.detachEvents(),this.scroll=t);this.measurer.replaceParent(n)},n.prototype.update=function(n){this.view.adjust({horizontal:!n,vertical:!n});this.page.redraw()},n.prototype.onNewModel=function(n){this.measurer.onNewModel(n,this.dom)},n.prototype.clear=function(){this.items.clear();this.selection.clear()},n.prototype.attachEvents=function(n){this.onMouseDownHandler=this.onMouseDown.bind(this);this.onMouseEnterHandler=this.onMouseEnter.bind(this);this.onMouseLeaveHandler=this.onMouseLeave.bind(this);this.onMouseWheelHandler=this.onMouseWheel.bind(this);this.onMouseDblClickHandler=this.onMouseDblClick.bind(this);this.onContextMenuHandler=this.onContextMenu.bind(this);this.onMouseMoveHandler=this.onMouseMove.bind(this);this.onMouseUpHandler=this.onMouseUp.bind(this);this.onWindowResizelHandler=this.onWindowResize.bind(this);this.onOrientationChangeHandler=this.onOrientationChange.bind(this);this.onMouseClickHandler=this.onMouseClick.bind(this);r.RenderHelper.addEventListener(n,h.TouchUIHelper.touchMouseDownEventName,this.onMouseDownHandler);r.RenderHelper.addEventListener(n,"mouseenter",this.onMouseEnterHandler);r.RenderHelper.addEventListener(n,"mouseleave",this.onMouseLeaveHandler);r.RenderHelper.addEventListener(n,"wheel",this.onMouseWheelHandler);r.RenderHelper.addEventListener(n,"dblclick",this.onMouseDblClickHandler);r.RenderHelper.addEventListener(n,"click",this.onMouseClickHandler);r.RenderHelper.addEventListener(n,"contextmenu",this.onContextMenuHandler);r.RenderHelper.addEventListener(document,h.TouchUIHelper.touchMouseMoveEventName,this.onMouseMoveHandler);r.RenderHelper.addEventListener(document,h.TouchUIHelper.touchMouseUpEventName,this.onMouseUpHandler);r.RenderHelper.addEventListener(window,"resize",this.onWindowResizelHandler);r.RenderHelper.addEventListener(window,"orientationchange",this.onOrientationChangeHandler);this.input.mouseWheelHandler=this.onMouseWheelHandler},n.prototype.detachEvents=function(n){r.RenderHelper.removeEventListener(n,h.TouchUIHelper.touchMouseDownEventName,this.onMouseDownHandler);r.RenderHelper.removeEventListener(n,"mouseenter",this.onMouseEnterHandler);r.RenderHelper.removeEventListener(n,"mouseleave",this.onMouseLeaveHandler);r.RenderHelper.removeEventListener(n,"wheel",this.onMouseWheelHandler);r.RenderHelper.removeEventListener(n,"dblclick",this.onMouseDblClickHandler);r.RenderHelper.removeEventListener(n,"contextmenu",this.onContextMenuHandler);r.RenderHelper.removeEventListener(n,"click",this.onMouseClickHandler);r.RenderHelper.removeEventListener(document,h.TouchUIHelper.touchMouseMoveEventName,this.onMouseMoveHandler);r.RenderHelper.removeEventListener(document,h.TouchUIHelper.touchMouseUpEventName,this.onMouseUpHandler);r.RenderHelper.removeEventListener(window,"resize",this.onWindowResizelHandler);r.RenderHelper.removeEventListener(window,"orientationchange",this.onOrientationChangeHandler)},n.prototype.onMouseDown=function(n){var r=this,t,i;return this.lockMouseMove(),this.input.lockFocus(),this.autoScroll.onMouseDown(n),u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return r.events.onMouseDown(n)}),this.input.captureFocus(),o.Browser.TouchUI&&this.processTouchDown(n),t=e.Evt.GetEventSource(n),i=t&&t.tagName,o.Browser.TouchUI||"img"===i.toLowerCase()||"image"===i.toLowerCase()?e.Evt.PreventEventAndBubble(n):void 0},n.prototype.onMouseMove=function(n){var t=this;this.moveLocked||(this.autoScroll.onMouseMove(n,function(){return t.onMouseMoveCore(n)}),this.onMouseMoveCore(n),o.Browser.IE&&this.lockMouseMove(),o.Browser.TouchUI&&this.processTouchMove(n))},n.prototype.onMouseMoveCore=function(n){var t=this;u.raiseEvent(n,this.createDiagramMouseEvent(n,o.Browser.TouchUI),function(n){return t.events.onMouseMove(n)})},n.prototype.onMouseUp=function(n){var i=this,t;this.lockMouseMove();t=this.createDiagramMouseEvent(n);u.raiseEvent(n,t,function(n){return i.events.onMouseUp(n)});this.autoScroll.onMouseUp(n);t.source.type!==f.MouseEventElementType.Undefined&&this.input.captureFocus();o.Browser.TouchUI&&this.processTouchUp(n)},n.prototype.onMouseEnter=function(n){var t=this;this.autoScroll.onMouseEnter(n);u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return t.events.onMouseEnter(n)})},n.prototype.onMouseLeave=function(n){var t=this;u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return t.events.onMouseLeave(n)})},n.prototype.onMouseDblClick=function(n){var t=this;u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return t.events.onDblClick(n)})},n.prototype.onMouseClick=function(n){var t=this;u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return t.events.onClick(n)})},n.prototype.onContextMenu=function(n){var t=this;return u.raiseEvent(n,this.createDiagramContextMenuEvent(n),function(n){return t.events.onContextMenu(n)}),this.input.captureFocus(),e.Evt.PreventEventAndBubble(n)},n.prototype.processTouchDown=function(n){var i=this;this.touchPosition=new c.Point(n.clientX,n.clientY);this.resetLongTouch();this.longTouchTimer=setTimeout(function(){u.raiseEvent(n,i.createDiagramMouseEvent(n),function(n){return i.events.onLongTouch(n)});i.resetLongTouch();i.resetDblClick()},t.LONG_TOUCH_TIMEOUT)},n.prototype.processTouchMove=function(t){this.touchPosition&&(Math.abs(this.touchPosition.x-t.clientX)>n.touchPositionLimit||Math.abs(this.touchPosition.y-t.clientY)>n.touchPositionLimit)&&(this.resetLongTouch(),this.resetDblClick())},n.prototype.processTouchUp=function(n){var i=this,r;void 0!==this.longTouchTimer&&(u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return i.events.onClick(n)}),r=e.Evt.GetEventSource(n),void 0!==this.dblTouchTimer&&this.lastClickElement===r?(u.raiseEvent(n,this.createDiagramMouseEvent(n),function(n){return i.events.onDblClick(n)}),this.resetDblClick()):(this.resetDblClick(),this.dblTouchTimer=setTimeout(function(){return i.dblTouchTimer=void 0},t.DBL_CLICK_TIMEOUT)),this.lastClickElement=r);this.resetLongTouch();this.touchPosition=void 0},n.prototype.resetLongTouch=function(){void 0!==this.longTouchTimer&&clearTimeout(this.longTouchTimer);this.longTouchTimer=void 0},n.prototype.resetDblClick=function(){void 0!==this.dblTouchTimer&&clearTimeout(this.dblTouchTimer);this.dblTouchTimer=void 0},n.prototype.onOrientationChange=function(){var n=this;setTimeout(function(){return n.onWindowResize()},100)},n.prototype.onWindowResize=function(){var t={horizontal:!1,vertical:!1},i,n;this.view.autoZoom!==p.AutoZoomMode.Disabled?(t.horizontal=!0,t.vertical=!0):(i=this.view.checkFitToCanvas(),n=this.view.checkFitToCanvas(this.scroll.getSize()),t={horizontal:i.horizontal!==n.horizontal||n.horizontal,vertical:i.vertical!==n.vertical||n.vertical});this.view.adjust(t)},n.prototype.onMouseWheel=function(n){var t=this;u.raiseEvent(n,this.createDiagramWheelEvent(n),function(n){return t.events.onMouseWheel(n)})},n.prototype.notifyModelSizeChanged=function(n,t){this.view.notifyModelSizeChanged(n,t)},n.prototype.notifyModelRectangleChanged=function(n){this.view.notifyModelRectangleChanged(n)},n.prototype.notifyReadOnlyChanged=function(n){s.ToggleElementClassName(this.mainElement,"dxdi-read-only",n)},n.prototype.notifyDragStart=function(){},n.prototype.notifyDragEnd=function(){},n.prototype.notifyDragScrollStart=function(){this.autoScroll.onDragScrollStart()},n.prototype.notifyDragScrollEnd=function(){this.autoScroll.onDragScrollEnd()},n.prototype.createDiagramMouseEvent=function(n,t){var r=l.getKeyModifiers(n),u=function(n){return o.Browser.MSTouchUI?2!=n.button:e.Evt.IsLeftButtonPressed(n)}(n)?f.MouseButton.Left:f.MouseButton.Right,i=this.getOffsetPointByEvent(n),s=this.getModelPoint(i),h=this.getEventSource(n,t),c=this.createDiagramMouseEventTouches(n);return new f.DiagramMouseEvent(r,u,i,s,h,c)},n.prototype.createDiagramMouseEventTouches=function(n){var i=[],t;if(n.touches)for(t=0;t<n.touches.length;t++){var u=n.touches[t].clientX,e=n.touches[t].clientY,r=this.getOffsetPointByEventPoint(u,e),o=this.getModelPoint(r);i.push(new f.DiagramMouseEventTouch(r,o))}return i},n.prototype.createDiagramContextMenuEvent=function(n){var t=l.getKeyModifiers(n),i=new c.Point(n.pageX,n.pageY),r=this.getOffsetPointByEvent(n),u=this.getModelPoint(r);return new f.DiagramContextMenuEvent(t,i,u)},n.prototype.createDiagramWheelEvent=function(n){var i=l.getKeyModifiers(n),t=this.getOffsetPointByEvent(n),r=this.view.getModelPoint(t),u=this.getEventSource(n),e=n.deltaX||n.originalEvent&&n.originalEvent.deltaX,o=n.deltaY||n.originalEvent&&n.originalEvent.deltaY;return new f.DiagramWheelEvent(i,e,o,t,r,u)},n.prototype.getEventSource=function(n,t){for(var r,o,i=e.Evt.GetEventSource(n,t);i&&!this.isDocumentContainer(i);){if(r=u.RenderUtils.getElementEventData(i),void 0!==r)return r;if(this.input.isTextInputElement(i))return new f.MouseEventSource(f.MouseEventElementType.Document);i=i.parentNode}return o=new f.MouseEventSource(f.MouseEventElementType.Undefined),i&&this.isDocumentContainer(i)&&(o.type=f.MouseEventElementType.Background),o},n.prototype.isDocumentContainer=function(n){return s.ElementHasCssClass(n,"dxdi-control")},n.prototype.lockMouseMove=function(){var n=this;this.moveLocked=!0;this.lockMouseMoveTimer=setTimeout(function(){n.moveLocked=!1;n.lockMouseMoveTimer=-1},10)},n.prototype.killLockMouseMoveTimer=function(){-1!=this.lockMouseMoveTimer&&(clearTimeout(this.lockMouseMoveTimer),this.lockMouseMoveTimer=-1)},n.prototype.getModelPoint=function(n){return this.view.getModelPoint(n)},n.prototype.getOffsetPointByEvent=function(n){var t=e.Evt.GetEventX(n),i=e.Evt.GetEventY(n);return this.getOffsetPointByEventPoint(t,i)},n.prototype.getOffsetPointByEventPoint=function(n,t){var i=this.scroll.getScrollContainer(),r=s.GetAbsolutePositionX(i),u=s.GetAbsolutePositionY(i);return new c.Point(n-r,t-u)},n.prototype.getModelPointByEventPoint=function(n,t){var i=this.getOffsetPointByEventPoint(n,t);return this.view.getModelPoint(i)},n.prototype.getEventPointByModelPoint=function(n){var t=this.view.getAbsolutePoint(n),i=this.scroll.getScrollContainer();return new c.Point(s.GetAbsolutePositionX(i)+t.x,s.GetAbsolutePositionY(i)+t.y)},n.touchPositionLimit=4,n}();t.RenderManager=a},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=i(18),u=i(4),e=function(){function n(n){this.onScroll=new r.EventDispatcher;this.scrollBarWidth=f.GetVerticalScrollBarWidth();this.mainElement=n;this.attachEvents()}return n.prototype.attachEvents=function(){var n=this;this.onScrollHandler=function(){return n.onScroll.raise1(function(t){return t.notifyScrollChanged(function(){return n.getScroll()})})};u.RenderHelper.addEventListener(this.mainElement,"scroll",this.onScrollHandler)},n.prototype.detachEvents=function(){u.RenderHelper.removeEventListener(this.mainElement,"scroll",this.onScrollHandler)},n.prototype.getScrollContainer=function(){return this.mainElement},n.prototype.setScroll=function(n,t){this.mainElement.style.overflow="scroll";this.mainElement.scrollLeft=n;this.mainElement.scrollTop=t;this.mainElement.style.overflow=""},n.prototype.offsetScroll=function(n,t){n&&(this.mainElement.scrollLeft+=n);t&&(this.mainElement.scrollTop+=t)},n.prototype.getScroll=function(){return new r.Point(this.mainElement.scrollLeft,this.mainElement.scrollTop)},n.prototype.getSize=function(){var n=this.mainElement.getBoundingClientRect();return new r.Size(Math.floor(n.width),Math.floor(n.height))},n.prototype.getScrollBarWidth=function(){return this.scrollBarWidth},n}();t.NativeScrollView=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(18),r=i(4),u=i(15),f=i(10),s=i(11),h=i(6),e=i(39),c=i(13),l=function(){function n(n,t,i,r){this.mainElement=n;this.layoutPointResolver=t;this.eventManager=i;this.actualZoom=r;this.focused=!1;this.focusLocked=!1;this.createInputElements(this.mainElement)}return n.prototype.detachEvents=function(){this.detachInputElementEvents();this.detachTextInputElementEvents()},n.prototype.isFocused=function(){return this.focused},n.prototype.captureFocus=function(n,t){var i=n||this.inputElement;i.focus({preventScroll:!0});t&&window.setTimeout(function(){if(window.getSelection){var n=window.getSelection(),t=document.createRange();t.selectNodeContents(i);n.removeAllRanges();n.addRange(t)}},100)},n.prototype.setClipboardData=function(n){this.clipboardInputElement.value=n;this.clipboardInputElement.focus({preventScroll:!0});this.clipboardInputElement.select();document.execCommand("copy");this.captureFocus()},n.prototype.getClipboardData=function(n){var t=this;navigator&&navigator.clipboard?navigator.clipboard.readText().then(function(i){n(i);t.captureFocus()}).catch(function(){n("");t.captureFocus()}):r.Browser.IE&&(this.clipboardInputElement.value="",this.clipboardInputElement.focus({preventScroll:!0}),this.clipboardInputElement.select(),document.execCommand("Paste"),n(this.clipboardInputElement.value),this.captureFocus())},n.prototype.isPasteSupportedByBrowser=function(){return r.Browser.IE||r.Browser.WebKitFamily&&navigator&&void 0!==navigator.clipboard},n.prototype.createInputElements=function(n){this.createFocusInputElement(n);this.createTextInputElement(n);this.createClipboardInputElement(n);this.attachInputElementEvents()},n.prototype.setInputElementFocusHandlerMode=function(){this.textInputElementContainer.setAttribute("class","dxdi-text-input-container");this.captureFocus()},n.prototype.setInputElementTextInputMode=function(n,t,i,u,f,e){this.textInputElementContainer.setAttribute("class","dxdi-text-input-container "+f);this.textInputElement.innerText=n;!r.Browser.Firefox||n&&""!==n||(this.textInputElement.innerHTML="&nbsp;");this.setTextInputElementBounds(t,i,e);this.setTextInputElementStyle(u);this.captureFocus(this.textInputElement,!0)},n.prototype.setTextInputElementBounds=function(n,t,i){var f,u;this.savedTextInputPosition=n;this.savedTextInputSize=t;this.savedTextInputAngle=i;f=this.layoutPointResolver.getAbsolutePoint(n,!0);t=t&&t.transform(r.UnitConverter.twipsToPixels);this.textInputElementContainer.style.left=f.x+"px";this.textInputElementContainer.style.top=f.y+"px";this.textInputElementContainer.style.width=t&&t.width+"px"||"0px";this.textInputElementContainer.style.height=t&&t.height+"px"||"0px";u=[];this.textInputElementContainer.style.transform="";1!==this.actualZoom&&u.push("scale("+this.actualZoom+")");i&&u.push("rotate("+i+"deg)");this.textInputElementContainer.style.transform=u.join(" ");this.textInputElement.style.width=t&&t.width+"px"||"";this.textInputElement.style.height=t&&t.height+"px"||"auto"},n.prototype.setTextInputElementStyle=function(n){u.RenderUtils.applyStyleToElement(n,this.textInputElement)},n.prototype.createFocusInputElement=function(n){this.inputElement=document.createElement("textarea");this.inputElement.readOnly=r.Browser.TouchUI;this.inputElement.setAttribute("class","dxdi-focus-input");n.appendChild(this.inputElement)},n.prototype.attachInputElementEvents=function(){this.onInputBlurHandler=this.onInputBlur.bind(this);this.onInputFocusHandler=this.onInputFocus.bind(this);this.onInputKeyDownHandler=this.onInputKeyDown.bind(this);this.onPasteHandler=this.onPaste.bind(this);r.RenderHelper.addEventListener(this.inputElement,"blur",this.onInputBlurHandler);r.RenderHelper.addEventListener(this.inputElement,"focus",this.onInputFocusHandler);r.RenderHelper.addEventListener(this.inputElement,"keydown",this.onInputKeyDownHandler);r.RenderHelper.addEventListener(this.inputElement,"paste",this.onPasteHandler)},n.prototype.detachInputElementEvents=function(){r.RenderHelper.removeEventListener(this.inputElement,"blur",this.onInputBlurHandler);r.RenderHelper.removeEventListener(this.inputElement,"focus",this.onInputFocusHandler);r.RenderHelper.removeEventListener(this.inputElement,"keydown",this.onInputKeyDownHandler);r.RenderHelper.removeEventListener(this.inputElement,"paste",this.onPasteHandler)},n.prototype.createTextInputElement=function(n){this.textInputElementContainer=document.createElement("div");this.textInputElementContainer.setAttribute("class","dxdi-text-input-container");n.appendChild(this.textInputElementContainer);this.textInputElement=document.createElement("div");this.textInputElement.setAttribute("class","dxdi-text-input");this.textInputElement.setAttribute("contenteditable","true");this.attachTextInputElementEvents();this.textInputElementContainer.appendChild(this.textInputElement)},n.prototype.attachTextInputElementEvents=function(){this.onTextInputBlurHandler=this.onTextInputBlur.bind(this);this.onTextInputFocusHandler=this.onTextInputFocus.bind(this);this.onTextInputKeyDownHandler=this.onTextInputKeyDown.bind(this);this.onTextInputMouseWheelHandler=this.onTextInputMouseWheel.bind(this);this.onTextInputMouseUpHandler=this.onTextInputMouseUp.bind(this);r.RenderHelper.addEventListener(this.textInputElement,"mousewheel",this.onTextInputMouseWheelHandler);r.RenderHelper.addEventListener(this.textInputElement,"mouseup",this.onTextInputMouseUpHandler);r.RenderHelper.addEventListener(this.textInputElement,"blur",this.onTextInputBlurHandler);r.RenderHelper.addEventListener(this.textInputElement,"focus",this.onTextInputFocusHandler);r.RenderHelper.addEventListener(this.textInputElement,"keydown",this.onTextInputKeyDownHandler)},n.prototype.detachTextInputElementEvents=function(){r.RenderHelper.removeEventListener(this.textInputElement,"mousewheel",this.onTextInputMouseWheelHandler);r.RenderHelper.removeEventListener(this.textInputElement,"mouseup",this.onTextInputMouseUpHandler);r.RenderHelper.removeEventListener(this.textInputElement,"blur",this.onTextInputBlurHandler);r.RenderHelper.removeEventListener(this.textInputElement,"focus",this.onTextInputFocusHandler);r.RenderHelper.removeEventListener(this.textInputElement,"keydown",this.onTextInputKeyDownHandler)},n.prototype.createClipboardInputElement=function(n){this.clipboardInputElement=document.createElement("textarea");this.clipboardInputElement.setAttribute("class","dxdi-clipboard-input");n.appendChild(this.clipboardInputElement)},n.prototype.blurControl=function(){this.focusLocked||(this.focused=!1,o.RemoveClassNameFromElement(this.mainElement,"focused"))},n.prototype.focusControl=function(){this.focused=!0;this.focusLocked=!1;o.AddClassNameToElement(this.mainElement,"focused")},n.prototype.onInputBlur=function(n){var t=this;this.blurControl();u.raiseEvent(n,this.getDiagramFocusEvent(n),function(n){return t.eventManager.onBlur(n)})},n.prototype.onInputFocus=function(n){var t=this;this.focusControl();u.raiseEvent(n,this.getDiagramFocusEvent(n),function(n){return t.eventManager.onFocus(n)})},n.prototype.onInputKeyDown=function(n){var t=this;u.raiseEvent(n,this.getDiagramKeyboardEvent(n),function(n){return t.eventManager.onKeyDown(n)})},n.prototype.onTextInputBlur=function(n){var t=this;this.blurControl();u.raiseEvent(n,this.getDiagramFocusEvent(n),function(n){return t.eventManager.onTextInputBlur(n)})},n.prototype.onTextInputFocus=function(n){var t=this;this.focusControl();u.raiseEvent(n,this.getDiagramFocusEvent(n),function(n){return t.eventManager.onTextInputFocus(n)})},n.prototype.onTextInputKeyDown=function(n){var t=this;u.raiseEvent(n,this.getDiagramKeyboardEvent(n),function(n){return t.eventManager.onTextInputKeyDown(n)})},n.prototype.onPaste=function(n){var t=this;u.raiseEvent(n,this.getDiagramClipboardEvent(n),function(n){return t.eventManager.onPaste(n)})},n.prototype.onTextInputMouseWheel=function(n){this.mouseWheelHandler&&this.mouseWheelHandler(n)},n.prototype.onTextInputMouseUp=function(n){e.Evt.CancelBubble(n)},n.prototype.getDiagramKeyboardEvent=function(n){return new f.DiagramKeyboardEvent(c.getKeyModifiers(n),e.Evt.GetKeyCode(n),e.Evt.GetEventSource(n).innerText)},n.prototype.getDiagramFocusEvent=function(n){return new f.DiagramFocusEvent(n.target.innerText)},n.prototype.getDiagramClipboardEvent=function(n){var t,i=n.clipboardData||n.originalEvent&&n.originalEvent.clipboardData;return t=void 0!==i?i.getData("text/plain"):window.clipboardData.getData("Text"),new f.DiagramClipboardEvent(t)},n.prototype.isTextInputElement=function(n){return"string"==typeof n.className&&n.className.indexOf("dxdi-text-input")>-1},n.prototype.lockFocus=function(){var n=this;this.focusLocked=!0;setTimeout(function(){return n.focusLocked=!1},10)},n.prototype.notifyViewAdjusted=function(){},n.prototype.notifyActualZoomChanged=function(n){this.actualZoom=n;this.savedTextInputPosition&&this.savedTextInputSize&&this.setTextInputElementBounds(this.savedTextInputPosition,this.savedTextInputSize,this.savedTextInputAngle)},n.prototype.notifyTextInputStart=function(n,t,i,r){var f,u="";n instanceof s.Shape?(u="shape-text",f=n.textAngle):n instanceof h.Connector&&(u="connector-text");this.setInputElementTextInputMode(t,i,r,n.styleText,u,f)},n.prototype.notifyTextInputEnd=function(){this.setInputElementFocusHandlerMode()},n}();t.InputManager=l},function(n,t,i){"use strict";var s,l=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}s(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var u=i(4),h=i(23),o=i(20),r=i(2),c=i(306),a=i(56),v=i(32),f=i(0),e=i(15),y=function(n){function t(t,i,r){var u=n.call(this,i.zoomLevel,r)||this;return u.snapPoint=new f.Point(0,0),u.gridPatternId=e.RenderUtils.generateSvgElementId("gridPattern"),u.pagesGridPatternId=e.RenderUtils.generateSvgElementId("pagesGridPattern"),u.pagesGridClipId=e.RenderUtils.generateSvgElementId("pagesGridClip"),u.pageColor=i.pageColor,u.modelSize=i.modelSize,u.simpleView=i.simpleView,u.gridSize=i.gridSize,u.gridVisible=i.gridVisible,u.pageSize=i.pageLandscape?new f.Size(i.pageSize.height,i.pageSize.width):i.pageSize,u.canvasViewOffset=new f.Point(0,0),u.initContainers(t),u}return l(t,n),t.prototype.initContainers=function(n){this.backgroundContainer=n},t.prototype.redraw=function(){this.redrawPage(this.pageColor);this.redrawGrid()},t.prototype.redrawPage=function(n){var t=new h.Style;t.fill=u.ColorHelper.colorToHash(n);this.getOrCreateElement("page-bg",new o.RectanglePrimitive(0,0,"100%","100%",t,"page"),this.backgroundContainer);this.createTextFloodFilter("page-bg-textflood-filter",this.backgroundContainer,n)},t.prototype.redrawGrid=function(){this.updateGridElements(this.gridVisible,u.UnitConverter.twipsToPixelsF(this.gridSize)*this.actualZoom);this.updatePagesGridElements(this.simpleView,this.getAbsoluteSize(this.pageSize))},t.prototype.getGridRectElement=function(n){return void 0===this.gridRectElement&&(this.gridRectElement=this.createPrimitiveElement(n,this.backgroundContainer)),this.gridRectElement},t.prototype.getGridPatternElement=function(n){return void 0===this.gridPatternElement&&(this.gridPatternElement=this.createPrimitiveElement(n,this.backgroundContainer)),this.gridPatternElement},t.prototype.updateGridElements=function(n,t){var w=this,v=new o.RectanglePrimitive("0","0","100%","100%",null,"grid",null,function(n){n.style.setProperty("fill",e.RenderUtils.GetUrlPathById(w.gridPatternId))}),a=this.getGridRectElement(v);if(n){a.style.display="";this.changePrimitiveElement(v,a);for(var i=[0,1,2,3,4].map(function(n){return Math.round(t*n)}),b=[new r.PathPrimitiveMoveToCommand(i[4].toString(),"0"),new r.PathPrimitiveLineToCommand(i[4].toString(),i[4].toString()),new r.PathPrimitiveLineToCommand("0",i[4].toString())],l=[],u=1;u<=3;u++)l.push(new r.PathPrimitiveMoveToCommand(i[u].toString(),"0")),l.push(new r.PathPrimitiveLineToCommand(i[u].toString(),i[4].toString()));for(u=1;u<=3;u++)l.push(new r.PathPrimitiveMoveToCommand("0",i[u].toString())),l.push(new r.PathPrimitiveLineToCommand(i[4].toString(),i[u].toString()));var s=4*t,y=this.simpleView?this.canvasViewOffset:f.Point.empty(),p=new c.PatternPrimitive(this.gridPatternId,[new r.PathPrimitive(b,h.StrokeStyle.default1pxNegativeOffsetInstance,"grid-outer-line"),new r.PathPrimitive(l,h.StrokeStyle.default1pxNegativeOffsetInstance,"grid-inner-line")],(((y.x+this.snapPoint.x)*this.actualZoom%s-s)%s).toString(),(((y.y+this.snapPoint.y)*this.actualZoom%s-s)%s).toString(),s.toString(),s.toString());this.changePrimitiveElement(p,this.getGridPatternElement(p))}else a.style.display="none"},t.prototype.getPagesGridRectElement=function(n){return this.getOrCreateElement("grid-pages-rect",n,this.backgroundContainer)},t.prototype.getPagesGridClipPathElement=function(n){return void 0===this.pagesGridClipPathElement&&(this.pagesGridClipPathElement=this.createPrimitiveElement(n,this.backgroundContainer)),this.pagesGridClipPathElement},t.prototype.getPagesGridPatternElement=function(n){return void 0===this.pagesGridPatternElement&&(this.pagesGridPatternElement=this.createPrimitiveElement(n,this.backgroundContainer)),this.pagesGridPatternElement},t.prototype.updatePagesGridElements=function(n,t){var h=this,l=new o.RectanglePrimitive("0","0","100%","100%",null,"grid-page",this.pagesGridClipId,function(t){t.style.setProperty("fill",e.RenderUtils.GetUrlPathById(h.pagesGridPatternId));t.style.setProperty("display",n?"none":"")}),i;if(this.getPagesGridRectElement(l),!n){var f=this.modelSize.multiply(this.actualZoom),v=[new r.PathPrimitiveMoveToCommand((t.width-1).toString(),"0"),new r.PathPrimitiveLineToCommand((t.width-1).toString(),(t.height-1).toString()),new r.PathPrimitiveLineToCommand("0",(t.height-1).toString())],s=new c.PatternPrimitive(this.pagesGridPatternId,[new r.PathPrimitive(v,null,"pages-grid-line")],0,0,t.width.toString(),t.height.toString());this.changePrimitiveElement(s,this.getPagesGridPatternElement(s));i=new a.ClipPathPrimitive(this.pagesGridClipId,[new o.RectanglePrimitive(0,0,(u.UnitConverter.twipsToPixelsF(f.width)-4).toString(),(u.UnitConverter.twipsToPixelsF(f.height)-4).toString())]);this.changePrimitiveElement(i,this.getPagesGridClipPathElement(i))}},t.prototype.notifyModelSizeChanged=function(n){this.modelSize=n.clone();this.redraw()},t.prototype.notifyModelRectangleChanged=function(){},t.prototype.notifySnapPointPositionChanged=function(n){this.snapPoint=n.transform(u.UnitConverter.twipsToPixelsF);this.redrawGrid()},t.prototype.notifyPageColorChanged=function(n){this.pageColor=n;this.redrawPage(this.pageColor)},t.prototype.notifyModelChanged=function(){},t.prototype.notifyPageSizeChanged=function(n,t){this.pageSize=t?new f.Size(n.height,n.width):n.clone();this.redraw()},t.prototype.notifyActualZoomChanged=function(n){this.actualZoom=n;this.redraw()},t.prototype.notifyViewAdjusted=function(n){this.canvasViewOffset.equals(n)||(this.canvasViewOffset=n,this.simpleView&&this.redraw())},t.prototype.notifyViewChanged=function(n){this.simpleView=n;this.redraw()},t.prototype.notifyGridChanged=function(n,t){this.gridVisible=n;this.gridSize=t;this.redraw()},t}(v.CanvasManagerBase);t.CanvasPageManager=y},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(12);f=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,o)||this;return s.id=t,s.x=r,s.y=u,s.width=f,s.height=e,s.children=i,s}return e(t,n),t.prototype.createMainElement=function(){var n=document.createElementNS(u.svgNS,"pattern");return n.setAttribute("patternUnits","userSpaceOnUse"),n.setAttribute("id",this.id),n},t.prototype.applyElementProperties=function(t,i){this.setUnitAttribute(t,"x",this.x);this.setUnitAttribute(t,"y",this.y);this.setUnitAttribute(t,"width",this.width);this.setUnitAttribute(t,"height",this.height);this.setPositionCorrectionAttribute(t);n.prototype.applyElementProperties.call(this,t,i)},t}(i(21).SvgPrimitive);t.PatternPrimitive=f},function(n,t,i){"use strict";var e,l=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}e(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c;Object.defineProperty(t,"__esModule",{value:!0});var a=i(32),o=i(34),r=i(0),u=i(4),s=i(30),v=i(56),h=i(20),f=i(15),y=i(308),p=i(23);t.CANVAS_MIN_PADDING=8;t.CROP_OFFSET=40;c=function(n){function i(t,i,e,o,s,h,c,l){var a=n.call(this,o,l)||this;return a.svgElement=i,a.paddings=new r.Offset(0,0,0,0),a.scroll=new r.Point(0,0),a.crop=r.Offset.empty(),a.lockAutoZoom=!1,a.autoScrollLocker=0,a.pageClipPathId=f.RenderUtils.generateSvgElementId("page-clip"),a.pageShadowId=f.RenderUtils.generateSvgElementId("page-shadow"),a.onViewChanged=new u.EventDispatcher,t.onScroll.add(a),e=e.transform(u.UnitConverter.twipsToPixelsF),a.scrollView=t,a.modelSize=e,a.simpleView=h,a.fixedZoomLevel=o,a.autoZoom=s,a.crop=a.rectangleToCrop(c,e),a.updateElements(e.multiply(o),r.Point.empty(),h),a.getOrCreateElement("shadow",new y.ShadowFilterPrimitive(a.pageShadowId),a.svgElement),a.containerSize=t.getSize(),a}return l(i,n),i.prototype.adjust=function(n){var t=void 0;n||(n={vertical:!1,horizontal:!1},t=r.Offset.empty());this.containerSize=this.scrollView.getSize();this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,this.simpleView,this.crop,n,this.containerSize,t);this.tryNormalizePaddings()},i.prototype.notifyModelSizeChanged=function(n,t){n=n.transform(u.UnitConverter.twipsToPixelsF);var i={horizontal:!t,vertical:!t};this.adjustCore(n,this.fixedZoomLevel,this.autoZoom,this.simpleView,this.crop,i,this.containerSize,t&&t.transform(u.UnitConverter.twipsToPixelsF));this.modelSize=n},i.prototype.notifyModelRectangleChanged=function(n){var t=this.rectangleToCrop(n,this.modelSize,this.crop);this.crop&&this.crop.equals(t)||(this.simpleView&&this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,this.simpleView,t,{horizontal:!1,vertical:!1},this.containerSize,r.Offset.empty()),this.crop=t)},i.prototype.notifySnapPointPositionChanged=function(){},i.prototype.notifyZoomChanged=function(n,t){this.adjustCore(this.modelSize,n,t,this.simpleView,this.crop,{horizontal:!1,vertical:!1},this.containerSize);this.fixedZoomLevel=n;this.autoZoom=t},i.prototype.notifyViewChanged=function(n){this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,n,this.crop,{vertical:!0,horizontal:!0},this.containerSize);this.simpleView=n},i.prototype.notifyGridChanged=function(){},i.prototype.notifyDragStart=function(){this.lockAutoZoom=!0;var n=this.svgElement.getAttribute("class")+" dxdi-drag-item";this.svgElement.setAttribute("class",n)},i.prototype.notifyDragEnd=function(){this.lockAutoZoom=!1;var n=this.svgElement.getAttribute("class").replace(" dxdi-drag-item","");this.svgElement.setAttribute("class",n);this.autoZoom&&this.adjust({horizontal:!0,vertical:!0})},i.prototype.notifyDragScrollStart=function(){var n=this.svgElement.getAttribute("class")+" dxdi-drag-scroll";this.svgElement.setAttribute("class",n)},i.prototype.notifyDragScrollEnd=function(){var n=this.svgElement.getAttribute("class").replace(" dxdi-drag-scroll","");this.svgElement.setAttribute("class",n)},i.prototype.notifyScrollChanged=function(n){this.scroll=n()},i.prototype.checkFitToCanvas=function(n){var i,u,f;return n=n||this.containerSize,i=this.scrollView.getScrollBarWidth(),n=n.offset(2*-t.CANVAS_MIN_PADDING,2*-t.CANVAS_MIN_PADDING),u=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).multiply(this.actualZoom),f=this.checkScrollBars(n,i,u,r.Offset.empty()),{vertical:(n=n.offset(f.vertical?-i:0,f.horizontal?-i:0)).height>=u.height,horizontal:n.width>=u.width}},i.prototype.rectangleToCrop=function(n,t){var i=n.transform(u.UnitConverter.twipsToPixelsF);return new r.Offset(this.correctCrop(i.left),this.correctCrop(i.top),this.correctCrop(t.width-i.right),this.correctCrop(t.height-i.bottom))},i.prototype.correctCrop=function(n){return t.CROP_OFFSET*Math.floor(n/t.CROP_OFFSET)},i.prototype.setActualZoom=function(n){this.actualZoom!==n&&(this.actualZoom=n,this.onViewChanged.raise1(function(t){return t.notifyActualZoomChanged(n)}))},i.prototype.getActualAutoZoomLevel=function(n){if(n===o.AutoZoomMode.Disabled)return this.actualZoom;var t=this.containerSize,i=this.scrollView.getScrollBarWidth(),r=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop);return this.getActualAutoZoom(t,i,r,n)},i.prototype.getActualZoom=function(n,t,i,r,u){return this.lockAutoZoom?this.actualZoom:u===o.AutoZoomMode.Disabled?r:this.getActualAutoZoom(n,t,i,u)},i.prototype.getActualAutoZoom=function(n,i,r,u){return u===o.AutoZoomMode.FitContent?Math.min((n.width-2*t.CANVAS_MIN_PADDING)/r.width,(n.height-2*t.CANVAS_MIN_PADDING)/r.height,1):Math.min((n.width-2*t.CANVAS_MIN_PADDING-i)/r.width,1)},i.prototype.tryNormalizePaddings=function(){var u=this.scrollView.getScrollBarWidth(),i=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).multiply(this.actualZoom),n=new r.Point(this.paddings.left,this.paddings.top),f=new r.Size(this.paddings.right,this.paddings.bottom),t=this.getTailSpace(n,this.scroll,i,this.containerSize,u);t.equals(f)||this.applyChanges(new r.Offset(n.x,n.y,t.width,t.height),i,this.simpleView,this.crop)},i.prototype.scrollBy=function(n){var o,s,h,i=this.scroll,e=this.containerSize,c=this.scrollView.getScrollBarWidth(),f=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).multiply(this.actualZoom),l=this.checkScrollBars(e,c,f,this.paddings),t=new r.Point(this.paddings.left,this.paddings.top),u=new r.Size(this.paddings.right,this.paddings.bottom);return i=(o=this.changeScrollByOffset(t,i,u,f,n,e,l)).scroll,n=o.offset,t=(s=this.changeTranslateByOffset(t,u,n,l)).translate,n=s.offset,t=(h=this.cropHiddenHead(t,i)).translate,i=h.scroll,u=this.getTailSpace(t,i,f,e,c),this.applyChanges(new r.Offset(t.x,t.y,u.width,u.height),f,this.simpleView,this.crop,i),n},i.prototype.changeScrollByOffset=function(n,t,i,r,u,f,e){var o=t.clone(),s=u.clone();return u.x&&e.horizontal&&(o.x-=s.x=-this.getScrollDeltaByOffset(u.x,t.x,n.x+r.width+i.width,f.width,e.vertical)),u.y&&e.vertical&&(o.y-=s.y=-this.getScrollDeltaByOffset(u.y,t.y,n.y+r.height+i.height,f.height,e.horizontal)),{scroll:o,offset:s}},i.prototype.changeTranslateByOffset=function(n,t,i,r){var u=n.clone(),f=i.clone();return i.x&&!r.horizontal&&(u.x+=f.x=this.getTranslateDeltaByOffset(i.x,u.x,t.width)),i.y&&!r.vertical&&(u.y+=f.y=this.getTranslateDeltaByOffset(i.y,u.y,t.height)),{translate:u,offset:f}},i.prototype.getScrollDeltaByOffset=function(n,t,i,r,u){if(n>0)return-Math.min(t,n);var f=i-(r-(u?this.scrollView.getScrollBarWidth():0));return Math.min(f-t,-n)},i.prototype.getTranslateDeltaByOffset=function(n,i,r){return n?n<0?-Math.min(i-t.CANVAS_MIN_PADDING,-n):Math.min(r-t.CANVAS_MIN_PADDING,n):0},i.prototype.getActualModelSizeWithoutZoom=function(n,t,i){return t&&i?n.offset(-i.horizontal,-i.vertical):n},i.prototype.setScrollTo=function(n,i){var e=this.containerSize,s=this.getVisibileAreaAbsShift(),f=n.transform(u.UnitConverter.twipsToPixelsF).multiply(this.actualZoom).offset(s.x,s.y),r=this.scroll,o;i?(r.x+=f.x-i.x,r.y+=f.y-i.y):(f.x<0&&(r.x+=f.x-t.CANVAS_MIN_PADDING),f.y<0&&(r.y+=f.y-t.CANVAS_MIN_PADDING),f.x>e.width&&(r.x+=f.x-e.width+t.CANVAS_MIN_PADDING),f.y>e.height&&(r.y+=f.y-e.height+t.CANVAS_MIN_PADDING));o=this.modelSize.multiply(this.actualZoom);r.x=Math.max(0,Math.min(r.x,o.width+this.paddings.horizontal-e.width));r.y=Math.max(0,Math.min(r.y,o.height+this.paddings.vertical-e.height));this.scrollView.setScroll(r.x,r.y)},i.prototype.updateElements=function(n,t,i){this.updatePageElement(n,t,i);this.updateCanvasElement(t)},i.prototype.updateCanvasElement=function(n){this.canvasElement=this.getOrCreateElement("dxdi-main",new s.GroupPrimitive([],"dxdi-main",null,null,function(t){t.setAttribute("transform","translate("+Math.round(n.x)+", "+Math.round(n.y)+")")}),this.svgElement)},i.prototype.updatePageElement=function(n,t,i){i||this.getOrCreateElement("pageShadowRect",new h.RectanglePrimitive(t.x.toString(),t.y.toString(),n.width.toString(),n.height.toString(),new p.EmptyStyle({filter:f.RenderUtils.GetUrlPathById(this.pageShadowId)}),"dxdi-page-shadow"),this.svgElement);this.pageElement=this.getOrCreateElement("page",new s.GroupPrimitive([],"dxdi-page",null,i?"":this.pageClipPathId,function(n){n.setAttribute("transform","translate("+(i?0:Math.round(t.x))+", "+(i?0:Math.round(t.y))+")")}),this.svgElement);this.getOrCreateElement("pageClip",this.createPageClipPathPrimitive(n),this.svgElement)},i.prototype.createPageClipPathPrimitive=function(n){var t=[];return t.push(new h.RectanglePrimitive(0,0,n.width.toString(),n.height.toString())),new v.ClipPathPrimitive(this.pageClipPathId,t)},i.prototype.adjustCore=function(n,t,i,u,f,e,o,s){var c=this.getActualModelSizeWithoutZoom(n,u,f),l,h;this.lockAutoZoom||!i&&s&&this.modelSize?this.resizeView(c,this.actualZoom,o,u,f,s):(l=this.scrollView.getScrollBarWidth(),h=this.getActualZoom(o,l,c,t,i),!i||h!==this.actualZoom||e.horizontal&&e.vertical?(this.resetView(c,h,o,u,f,e),this.setActualZoom(h)):this.resizeView(c,h,o,u,f,s||r.Offset.empty()))},i.prototype.resetView=function(n,i,u,f,e,o){var h=n.multiply(i),s=r.Offset.fromNumber(t.CANVAS_MIN_PADDING),l,a;!(o=o||{horizontal:!0,vertical:!0}).horizontal&&this.paddings&&(s.left=this.paddings.left,s.right=this.paddings.right);!o.vertical&&this.paddings&&(s.top=this.paddings.top,s.bottom=this.paddings.bottom);var v=this.checkScrollBars(u,this.scrollView.getScrollBarWidth(),h,s),y=this.scrollView.getScrollBarWidth(),c=o.horizontal||o.vertical?this.scroll:void 0;o.horizontal&&(l=Math.max((u.width-(v.vertical?y:0)-h.width)/2,t.CANVAS_MIN_PADDING),s.left=l,s.right=l,c.x=0);o.vertical&&(a=Math.max((u.height-(v.horizontal?y:0)-h.height)/2,t.CANVAS_MIN_PADDING),s.top=a,s.bottom=a,c.y=0);this.applyChanges(s,h,f,e.multiply(i),c)},i.prototype.resizeView=function(n,t,i,u,f,e){var c,l,p=this.actualZoom,w=this.simpleView&&this.crop?this.crop.multiply(p):r.Offset.empty(),a=n.multiply(t),h,y;e=e.multiply(t);var v=u&&f?f.multiply(t):r.Offset.empty(),o=new r.Point(this.paddings.left,this.paddings.top),s=this.scroll;o=(c=this.applyOffset(o,s,w,v,e)).translate;s=c.scroll;o=(l=this.cropHiddenHead(o,s)).translate;s=l.scroll;h=this.getTailSpace(o,s,a,i,this.scrollView.getScrollBarWidth());y=new r.Offset(o.x,o.y,h.width,h.height);this.applyChanges(y,a,u,v,s)},i.prototype.applyChanges=function(n,t,i,u,f){var o=this,e=new r.Point(n.left,n.top);i&&u&&(e=e.offset(-u.left,-u.top));this.updateElements(t,e,i);this.setSvgSize(t.width+n.horizontal,t.height+n.vertical);this.onViewChanged.raise1(function(n){return n.notifyViewAdjusted(new r.Point(e.x,e.y))});f&&(this.lockAutoScroll(),f&&this.dom.changeByFunc(this.scrollView,function(n){n.setScroll(f.x,f.y);o.unlockAutoScroll()}),this.scroll=f);this.paddings=n},i.prototype.isAutoScrollLocked=function(){return 0!==this.autoScrollLocker},i.prototype.lockAutoScroll=function(){this.autoScrollLocker++},i.prototype.unlockAutoScroll=function(){this.autoScrollLocker--},i.prototype.applyOffset=function(n,i,r,u,f){var e=n.clone(),s=i.clone(),o=this.getActualOffset(r,u,f);return o.left&&(e.x=Math.max(t.CANVAS_MIN_PADDING,e.x-o.left),s.x+=o.left-(n.x-e.x)),o.top&&(e.y=Math.max(t.CANVAS_MIN_PADDING,e.y-o.top),s.y+=o.top-(n.y-e.y)),{translate:e,scroll:s}},i.prototype.cropHiddenHead=function(n,i){var u=i.clone(),r=n.clone(),f;return u.x&&r.x>t.CANVAS_MIN_PADDING&&(f=r.x-Math.max(t.CANVAS_MIN_PADDING,r.x-u.x),r.x-=f,u.x-=f),u.y&&r.y>t.CANVAS_MIN_PADDING&&(f=r.y-Math.max(t.CANVAS_MIN_PADDING,r.y-u.y),r.y-=f,u.y-=f),{translate:r,scroll:u}},i.prototype.getTailSpace=function(n,i,u,f,e){var o=n.clone(),c=i.clone(),s=Math.max(f.width+c.x-(o.x+u.width),t.CANVAS_MIN_PADDING),h=Math.max(f.height+c.y-(o.y+u.height),t.CANVAS_MIN_PADDING),l=this.checkScrollBars(f,e,u,new r.Offset(o.x,o.y,s,h));return l.vertical&&(s=Math.max(t.CANVAS_MIN_PADDING,s-e)),l.horizontal&&(h=Math.max(t.CANVAS_MIN_PADDING,h-e)),new r.Size(s,h)},i.prototype.getActualOffset=function(n,t,i){return new r.Offset(-(t.left-n.left)+i.left,-(t.top-n.top)+i.top,-(t.right-n.right)+i.right,-(t.bottom-n.bottom)+i.bottom)},i.prototype.checkScrollBars=function(n,t,i,r){var u=n.width<i.width+r.horizontal,f=n.height<i.height+r.vertical;return u&&!f&&(f=n.height-t<i.height+r.vertical),f&&!u&&(u=n.width-t<i.width+r.horizontal),{horizontal:u,vertical:f}},i.prototype.setSvgSize=function(n,t){n===this.lastWidth&&t===this.lastHeight||(this.dom.changeByFunc(this.svgElement,function(i){return f.RenderUtils.updateSvgElementSize(i,n,t)}),this.lastWidth=n,this.lastHeight=t)},i.prototype.getVisibileAreaAbsShift=function(n){var t=this.scroll,i=this.paddings.clone(),u=this.simpleView,f=u&&this.crop?this.crop.left*this.actualZoom:0,e=u&&this.crop?this.crop.top*this.actualZoom:0;return new r.Point(i.left-f-(n?0:t.x),i.top-e-(n?0:t.y))},i.prototype.getModelPoint=function(n,t){var f=this.getVisibileAreaAbsShift(),i=n.offset(-f.x,-f.y).multiply(1/this.actualZoom),r;return t&&((r=this.containerSize,n.x<0||n.y<0||n.x>r.width||n.y>r.height)||i.x<0||i.y<0||i.x>this.modelSize.width||i.y>this.modelSize.height)?null:i.transform(u.UnitConverter.pixelsToTwips)},i.prototype.getAbsolutePoint=function(n,t,i){var e=this.getVisibileAreaAbsShift(t),r=n.transform(u.UnitConverter.twipsToPixelsF).multiply(this.actualZoom).offset(e.x,e.y),f;return i&&(r.x<0||r.y<0||(f=this.containerSize,r.x>f.width||r.y>f.height))?null:r},i}(a.CanvasManagerBase);t.CanvasViewManager=c},function(n,t,i){"use strict";var u,f=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var e=i(88),r=i(12),o=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return f(t,n),t.prototype.createChildElements=function(n){var u=document.createElementNS(r.svgNS,"feGaussianBlur"),t,i,e,f;u.setAttribute("in","SourceGraphic");u.setAttribute("stdDeviation","4.6");n.appendChild(u);t=document.createElementNS(r.svgNS,"feOffset");t.setAttribute("dx","0");t.setAttribute("dy","0");n.appendChild(t);i=document.createElementNS(r.svgNS,"feMerge");n.appendChild(i);e=document.createElementNS(r.svgNS,"feMergeNode");i.appendChild(e);f=document.createElementNS(r.svgNS,"feMergeNode");f.setAttribute("in","SourceGraphic");i.appendChild(f)},t}(e.FilterPrimitive);t.ShadowFilterPrimitive=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(39),u=i(18),f=i(12),e=i(0),o=function(){function n(n,t,i,r){this.scroll=n;this.mainElement=t;this.svgElement=i;this.view=r;this.leftButtonPressed=!1;this.scrollDragging=!1;this.scrollTimer=-1;this.scrollBarWidth=u.GetVerticalScrollBarWidth()}return n.prototype.onMouseMove=function(n,t){this.clearScrollTimer();r.Evt.IsLeftButtonPressed(n)||(this.leftButtonPressed=!1);this.canAutoScroll()&&this.changeScrollPosition(n,t,!1)},n.prototype.onMouseDown=function(n){this.leftButtonPressed=!!r.Evt.IsLeftButtonPressed(n)},n.prototype.onMouseUp=function(){this.clearScrollTimer();this.leftButtonPressed=!1},n.prototype.onMouseEnter=function(n){var t=this;r.Evt.IsLeftButtonPressed(n)&&setTimeout(function(){t.leftButtonPressed=!0},500)},n.prototype.onDragScrollStart=function(){this.scrollDragging=!0},n.prototype.onDragScrollEnd=function(){this.scrollDragging=!1},n.prototype.canAutoScroll=function(){return this.leftButtonPressed&&!this.scrollDragging},n.prototype.changeScrollPosition=function(n,t,i){var v=this,r=!1,h;if(!this.view.isAutoScrollLocked()){var l=this.scroll.getScrollContainer(),f=n.pageX-u.GetAbsolutePositionX(l),o=n.pageY-u.GetAbsolutePositionY(l),s=this.scroll.getSize(),a=new e.Size(parseFloat(this.svgElement.style.width),parseFloat(this.svgElement.style.height)),c=s.width;s.width<a.width&&(c-=this.scrollBarWidth);h=s.height;s.height<a.height&&(h-=this.scrollBarWidth);f<=40?(this.scroll.offsetScroll(-this.getScrollingOffset(f),0),r=!0):c-40<=f&&(this.scroll.offsetScroll(this.getScrollingOffset(c-f),0),r=!0);o<=40?(this.scroll.offsetScroll(0,-this.getScrollingOffset(o)),r=!0):h-40<=o&&(this.scroll.offsetScroll(0,this.getScrollingOffset(h-o)),r=!0)}(r||this.view.isAutoScrollLocked())&&(this.scrollTimer=window.setTimeout(function(){return v.changeScrollPosition(n,t,r)},50));i&&t()},n.prototype.clearScrollTimer=function(){this.scrollTimer>-1&&(window.clearTimeout(this.scrollTimer),this.scrollTimer=-1)},n.prototype.getScrollingOffset=function(n){var t=Math.pow((40-n)/5,2);return Math.min(t,5)},n.createMainElement=function(n){var t=document.createElement("div");return t.setAttribute("class","dxdi-control"),n.appendChild(t),t},n.createSvgElement=function(n,t){void 0===t&&(t=!1);var i=document.createElementNS(f.svgNS,"svg");return i.className.baseVal="dxdi-canvas"+(t?" export":""),n.appendChild(i),i},n}();t.AutoScrollController=o},function(n,t,i){"use strict";var f,o=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),h=i(11),c=i(6),e=i(311),r=i(7),u=i(38),l=function(n){function t(t,i,r,u,f,e){var o=n.call(this,"Document",i,r,u,f,e)||this;return o.changesListener=t,o.updateLockCount=0,o}return o(t,n),t.prototype.createModelItems=function(n,t,i,r,u,f,o){e.DataSource.createModelItems(n,t,i,r,this,u,!0,!1,f,o)},t.prototype.updateItemsByModel=function(n){var t=this;this.deleteNodes(n);this.deleteEdges(n);n.items.forEach(function(i){i instanceof h.Shape&&t.updateNode(n,i);i instanceof c.Connector&&t.updateEdge(n,i)})},t.prototype.isItemObjectModified=function(n,t,i){var r=i.setLocked&&t.locked!==n.locked||i.setZIndex&&t.zIndex!==n.zIndex,u,f;return!r&&i.setStyle&&(u=n.style.getDefaultInstance(),n.style.forEach(function(i){n.style[i]!==u[i]&&n.style[i]!==(t.style&&t.style[i])&&(r=!0)})),!r&&i.setStyleText&&(f=n.styleText.getDefaultInstance(),n.styleText.forEach(function(i){n.styleText[i]!==f[i]&&n.styleText[i]!==(t.styleText&&t.styleText[i])&&(r=!0)})),r},t.prototype.setDataObjectKeyRelatedProperty=function(n,t,i,r){(r||void 0===this.autoGeneratedDataKeys[i])&&n(t,i)},t.prototype.updateItemObjectProperties=function(n,t,i){var r,f;(i.setLocked&&(n.locked=t.locked,n.dataObj&&void 0!==n.locked&&i.setLocked(n.dataObj,t.locked)),i.setStyle)&&(r=t.style.toObject(),n.style=r,n.dataObj&&void 0!==n.style&&i.setStyle(n.dataObj,u.Data.objectToCssText(r)));i.setStyleText&&(f=t.styleText.toObject(),n.styleText=f,n.dataObj&&void 0!==n.styleText&&i.setStyleText(n.dataObj,u.Data.objectToCssText(f)));i.setZIndex&&(n.zIndex=t.zIndex,n.dataObj&&void 0!==n.zIndex&&i.setZIndex(n.dataObj,t.zIndex))},t.prototype.deleteItems=function(n,t,i,r){n.slice().forEach(function(n){if(void 0!==n.key&&null!==n.key&&!t(n.key)){var u=i(n),f=u.indexOf(n.dataObj);u.splice(f,1);r(n,f>-1)}})},t.prototype.updateNode=function(n,t){var r=this,i=this.findNode(t.dataKey),u;i?this.isNodeObjectModified(t,i,n.units)?(this.updateNodeObjectProperties(t,i,n.units),this.updateNodeObjectConnectedProperties(t,i),this.beginChangesNotification(),this.changesListener.notifyNodeUpdated.call(this.changesListener,this.nodeDataImporter.getKey(i.dataObj||i.key),i.dataObj,function(){r.endChangesNotification()},function(){r.endChangesNotification()})):this.updateNodeObjectConnectedProperties(t,i,this.changesListener):(u={},i=this.addNodeInternal(u,t.description.key,t.text),this.nodeDataSource.push(i.dataObj),this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setKey,u,i.key,this.addInternalKeyOnInsert),this.updateNodeObjectProperties(t,i,n.units),this.updateNodeObjectConnectedProperties(t,i),this.updateNodeObjectKey(t,i,i.dataObj),this.beginChangesNotification(),this.changesListener.notifyNodeInserted.call(this.changesListener,i.dataObj,function(n){r.updateNodeObjectKey(t,i,n);r.endChangesNotification()},function(){r.endChangesNotification()}))},t.prototype.isNodeObjectModified=function(n,t,i){return this.isItemObjectModified(n,t,this.nodeDataImporter)||t.type!==n.description.key&&!(void 0===t.type&&n.description.key===s.ShapeTypes.Rectangle)||!this.compareStrings(t.text,n.text)||this.nodeDataImporter.setImage&&t.image!==n.image.actualUrl||this.nodeDataImporter.setLeft&&t.left!==r.ModelUtils.getlUnitValue(i,n.position.x)||this.nodeDataImporter.setTop&&t.top!==r.ModelUtils.getlUnitValue(i,n.position.y)||this.nodeDataImporter.setWidth&&t.width!==r.ModelUtils.getlUnitValue(i,n.size.width)||this.nodeDataImporter.setHeight&&t.height!==r.ModelUtils.getlUnitValue(i,n.size.height)},t.prototype.updateNodeObjectProperties=function(n,t,i){var u,f,e,o;(this.updateItemObjectProperties(t,n,this.nodeDataImporter),this.nodeDataImporter.setType&&(t.type=n.description.key,this.nodeDataImporter.setType(t.dataObj,n.description.key)),this.nodeDataImporter.setText&&(t.text=n.text,this.nodeDataImporter.setText(t.dataObj,n.text)),this.nodeDataImporter.setImage&&(t.image=n.image.actualUrl,this.nodeDataImporter.setImage(t.dataObj,n.image.actualUrl)),this.nodeDataImporter.setLeft)&&(u=r.ModelUtils.getlUnitValue(i,n.position.x),t.left=u,this.nodeDataImporter.setLeft(t.dataObj,u));this.nodeDataImporter.setTop&&(f=r.ModelUtils.getlUnitValue(i,n.position.y),t.top=f,this.nodeDataImporter.setTop(t.dataObj,f));this.nodeDataImporter.setWidth&&(e=r.ModelUtils.getlUnitValue(i,n.size.width),t.width=e,this.nodeDataImporter.setWidth(t.dataObj,e));this.nodeDataImporter.setHeight&&(o=r.ModelUtils.getlUnitValue(i,n.size.height),t.height=o,this.nodeDataImporter.setHeight(t.dataObj,o))},t.prototype.updateNodeObjectConnectedProperties=function(n,t,i){var r,u,f,e;this.useNodeParentId&&void 0!==this.nodeDataImporter.setParentKey&&(r=this.getParentItemKey(n),u=this.findNode(r),this.updateNodeObjectParentKey(t,u,i));this.useNodeContainerId&&void 0!==this.nodeDataImporter.setContainerKey&&(f=this.getContainerShapeKey(n),e=this.findNode(f),this.updateNodeObjectContainerKey(t,e,i));this.useNodeItems&&void 0!==this.nodeDataImporter.setItems&&(r=this.getParentItemKey(n),u=this.findNode(r),this.updateNodeObjectItems(t,u,i));this.useNodeChildren&&void 0!==this.nodeDataImporter.setChildren&&(f=this.getContainerShapeKey(n),e=this.findNode(f),this.updateNodeObjectChildren(t,e,i))},t.prototype.updateNodeObjectParentKey=function(n,t,i){var u=this,f=this.nodeDataImporter.getParentKey(n.dataObj),r=t?this.nodeDataImporter.getKey(t.dataObj):void 0;f===r||this.isRootParentKey(f)&&this.isRootParentKey(r)||(this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setParentKey,n.dataObj,r,!1),i&&(this.beginChangesNotification(),i.notifyNodeUpdated.call(i,this.nodeDataImporter.getKey(n.dataObj)||n.key,n.dataObj,function(){u.endChangesNotification()},function(){u.endChangesNotification()})))},t.prototype.updateNodeObjectContainerKey=function(n,t,i){var u=this,f=this.nodeDataImporter.getContainerKey(n.dataObj),r=t?this.nodeDataImporter.getKey(t.dataObj):void 0;f===r||this.isRootParentKey(f)&&this.isRootParentKey(r)||(this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setContainerKey,n.dataObj,r,!1),i&&(this.beginChangesNotification(),i.notifyNodeUpdated.call(i,this.nodeDataImporter.getKey(n.dataObj)||n.key,n.dataObj,function(){u.endChangesNotification()},function(){u.endChangesNotification()})))},t.prototype.isRootParentKey=function(n){return null==n||!this.findNode(n)},t.prototype.updateNodeObjectItems=function(n,t,i){var f=this,r,e,u;(!t||n.parentDataObj===t.dataObj)&&(t||!n.parentDataObj)||t&&this.checkNodeCyrcleItems(n.dataObj,t.dataObj)||(r=n.parentDataObj?this.nodeDataImporter.getItems(n.parentDataObj):this.nodeDataSource,e=r.indexOf(n.dataObj),r.splice(e,1),u=t?this.nodeDataImporter.getItems(t.dataObj):this.nodeDataSource,u?u.push(n.dataObj):this.nodeDataImporter.setItems(t.dataObj,[n.dataObj]),n.parentDataObj=t&&t.dataObj,i&&(this.beginChangesNotification(),i.notifyNodeUpdated.call(i,this.nodeDataImporter.getKey(n.dataObj)||n.key,n.dataObj,function(){f.endChangesNotification()},function(){f.endChangesNotification()})))},t.prototype.updateNodeObjectChildren=function(n,t,i){var f=this,r,e,u;(t&&n.containerDataObj!==t.dataObj||!t&&n.containerDataObj)&&(r=n.containerDataObj?this.nodeDataImporter.getChildren(n.containerDataObj):this.nodeDataSource,e=r.indexOf(n.dataObj),r.splice(e,1),u=t?this.nodeDataImporter.getChildren(t.dataObj):this.nodeDataSource,u?u.push(n.dataObj):this.nodeDataImporter.setChildren(t.dataObj,[n.dataObj]),n.containerDataObj=t&&t.dataObj,i&&(this.beginChangesNotification(),i.notifyNodeUpdated.call(i,this.nodeDataImporter.getKey(n.dataObj)||n.key,n.dataObj,function(){f.endChangesNotification()},function(){f.endChangesNotification()})))},t.prototype.checkNodeCyrcleItems=function(n,t){var u=this,i=!1,r=this.nodeDataImporter.getItems(n);return r&&r.forEach(function(n){i=i||n===t||u.checkNodeCyrcleItems(n,t)}),i},t.prototype.updateNodeObjectKey=function(n,t,i){var r=this.nodeDataImporter.getKey(i),u,f;(null!=r&&r!==t.key&&(delete this.autoGeneratedDataKeys[t.key],t.key=r,this.updateNodeKeyRelatedObjects(n,t)),n.dataKey=t.key,t.dataObj!==i)&&(u=this.getNodeArray(t),f=u.indexOf(t.dataObj),u.splice(f,1,i),t.dataObj=i)},t.prototype.updateNodeKeyRelatedObjects=function(n,t){var i=this;this.useNodeParentId&&void 0!==this.nodeDataImporter.setParentKey&&this.getChildItems(n).forEach(function(n){var r=i.findNode(n.dataKey);r&&i.updateNodeObjectParentKey(r,t,i.changesListener)});this.useNodeContainerId&&void 0!==this.nodeDataImporter.setContainerKey&&n.children.forEach(function(n){var r=i.findNode(n.dataKey);r&&i.updateNodeObjectContainerKey(r,t,i.changesListener)});this.useEdgesArray()&&n.attachedConnectors.forEach(function(r){var u=i.findEdge(r.dataKey);u&&(n===r.beginItem&&i.updateEdgeObjectFromProperty(t,u),n===r.endItem&&i.updateEdgeObjectToProperty(t,u))})},t.prototype.deleteNodes=function(n){var t=this;this.deleteItems(this.nodes,function(t){return n.findShapeByDataKey(t)},function(n){return t.getNodeArray(n)},function(n,i){var r=n.dataObj&&t.nodeDataImporter.getKey(n.dataObj)||n.key,u=t.findNode(r);u&&t.nodes.splice(t.nodes.indexOf(u),1);i&&(t.beginChangesNotification(),t.changesListener.notifyNodeRemoved.call(t.changesListener,r,n.dataObj,function(){t.endChangesNotification()},function(){t.endChangesNotification()}))})},t.prototype.getParentItem=function(n){for(var t=0;t<n.attachedConnectors.length;t++)if(n.attachedConnectors[t].endItem===n)return n.attachedConnectors[t].beginItem},t.prototype.getParentItemKey=function(n){var t=this.getParentItem(n);return t&&t.dataKey},t.prototype.getNodeArray=function(n){var t;return this.useNodeItems&&n.parentDataObj?t=this.nodeDataImporter.getItems(n.parentDataObj):n.containerDataObj&&(t=this.nodeDataImporter.getChildren(n.containerDataObj)),t||this.nodeDataSource},t.prototype.getContainerShapeKey=function(n){return n.container&&n.container.dataKey},t.prototype.getChildItems=function(n){for(var i=[],t=0;t<n.attachedConnectors.length;t++)n.attachedConnectors[t].beginItem===n&&n.attachedConnectors[t].endItem&&i.push(n.attachedConnectors[t].endItem);return i},t.prototype.updateEdge=function(n,t){var r=this,f=t.beginItem?t.beginItem.dataKey:void 0,e=t.endItem?t.endItem.dataKey:void 0,i=this.findEdge(t.dataKey),u;i?this.isEdgeObjectModified(t,i,n.units)&&(this.updateEdgeObjectProperties(t,i,n.units),i.dataObj&&(this.beginChangesNotification(),this.changesListener.notifyEdgeUpdated.call(this.changesListener,this.edgeDataImporter.getKey(i.dataObj)||i.key,i.dataObj,function(){r.endChangesNotification()},function(){r.endChangesNotification()}))):(u=this.useEdgesArray()&&this.canUpdateEdgeDataSource?{}:void 0,i=this.addEdgeInternal(u,f,e),u&&(this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setKey,u,i.key,this.addInternalKeyOnInsert),this.edgeDataSource.push(i.dataObj)),this.updateEdgeObjectProperties(t,i,n.units),this.updateEdgeObjectKey(t,i,i.dataObj),u&&(this.beginChangesNotification(),this.changesListener.notifyEdgeInserted.call(this.changesListener,i.dataObj,function(n){r.updateEdgeObjectKey(t,i,n);r.endChangesNotification()},function(){r.endChangesNotification()})))},t.prototype.isEdgeObjectModified=function(n,t,i){return this.isItemObjectModified(n,t,this.edgeDataImporter)||t.from!==(n.beginItem?n.beginItem.dataKey:void 0)||t.to!==(n.endItem?n.endItem.dataKey:void 0)||this.edgeDataImporter.setFromPointIndex&&t.fromPointIndex!==n.beginConnectionPointIndex||this.edgeDataImporter.setToPointIndex&&t.toPointIndex!==n.endConnectionPointIndex||this.edgeDataImporter.setPoints&&(!t.points||!u.Data.ArrayEqual(t.points.map(function(n){return n.x}),n.points.map(function(n){return r.ModelUtils.getlUnitValue(i,n.x)}))||!u.Data.ArrayEqual(t.points.map(function(n){return n.y}),n.points.map(function(n){return r.ModelUtils.getlUnitValue(i,n.y)})))||this.edgeDataImporter.setText&&!this.compareStrings(t.text,n.getText())||this.edgeDataImporter.setLineOption&&t.lineOption!==n.properties.lineOption||this.edgeDataImporter.setStartLineEnding&&t.startLineEnding!==n.properties.startLineEnding||this.edgeDataImporter.setEndLineEnding&&t.endLineEnding!==n.properties.endLineEnding},t.prototype.updateEdgeObjectFromProperty=function(n,t,i){var r=this,u;(t.from=n&&n.key,t.dataObj)&&(u=n&&n.dataObj&&this.nodeDataImporter.getKey(n.dataObj),this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setFrom,t.dataObj,u,!1),i&&(this.beginChangesNotification(),i.notifyEdgeUpdated.call(i,this.nodeDataImporter.getKey(t.dataObj)||t.key,t.dataObj,function(){r.endChangesNotification()},function(){r.endChangesNotification()})))},t.prototype.updateEdgeObjectToProperty=function(n,t,i){var r=this,u;(t.to=n&&n.key,t.dataObj)&&(u=n&&n.dataObj&&this.nodeDataImporter.getKey(n.dataObj),this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setTo,t.dataObj,u,!1),i&&(this.beginChangesNotification(),i.notifyEdgeUpdated.call(i,this.nodeDataImporter.getKey(t.dataObj)||t.key,t.dataObj,function(){r.endChangesNotification()},function(){r.endChangesNotification()})))},t.prototype.updateEdgeObjectProperties=function(n,t,i){var e,o,u,f;(this.updateItemObjectProperties(t,n,this.edgeDataImporter),this.edgeDataImporter.setFrom)&&(e=this.findNode(n.beginItem&&n.beginItem.dataKey),this.updateEdgeObjectFromProperty(e,t));this.edgeDataImporter.setTo&&(o=this.findNode(n.endItem&&n.endItem.dataKey),this.updateEdgeObjectToProperty(o,t));(this.edgeDataImporter.setFromPointIndex&&(t.fromPointIndex=n.beginConnectionPointIndex,t.dataObj&&this.edgeDataImporter.setFromPointIndex(t.dataObj,n.beginConnectionPointIndex)),this.edgeDataImporter.setToPointIndex&&(t.toPointIndex=n.endConnectionPointIndex,t.dataObj&&this.edgeDataImporter.setToPointIndex(t.dataObj,n.endConnectionPointIndex)),this.edgeDataImporter.setPoints)&&(u=n.points.map(function(n){return{x:r.ModelUtils.getlUnitValue(i,n.x),y:r.ModelUtils.getlUnitValue(i,n.y)}}),t.points=u,t.dataObj&&this.edgeDataImporter.setPoints(t.dataObj,u));this.edgeDataImporter.setText&&(f=n.getText(),t.text=f,t.dataObj&&this.edgeDataImporter.setText(t.dataObj,f));this.edgeDataImporter.setLineOption&&(t.lineOption=n.properties.lineOption,t.dataObj&&this.edgeDataImporter.setLineOption(t.dataObj,n.properties.lineOption));this.edgeDataImporter.setStartLineEnding&&(t.startLineEnding=n.properties.startLineEnding,t.dataObj&&this.edgeDataImporter.setStartLineEnding(t.dataObj,n.properties.startLineEnding));this.edgeDataImporter.setEndLineEnding&&(t.endLineEnding=n.properties.endLineEnding,t.dataObj&&this.edgeDataImporter.setEndLineEnding(t.dataObj,n.properties.endLineEnding))},t.prototype.updateEdgeObjectKey=function(n,t,i){var r=i&&this.edgeDataImporter.getKey(i),u,f;(null!=r&&r!==t.key&&(delete this.autoGeneratedDataKeys[t.key],t.key=r),n.dataKey=t.key,t.dataObj!==i)&&(u=this.edgeDataSource,f=u.indexOf(t.dataObj),u.splice(f,1,i),t.dataObj=i)},t.prototype.deleteEdges=function(n){var t=this;this.deleteItems(this.edges,function(t){return n.findConnectorByDataKey(t)},function(){return t.edgeDataSource},function(n,i){var r=n.dataObj&&t.edgeDataImporter.getKey(n.dataObj)||n.key,u=t.findEdge(r);u&&t.edges.splice(t.edges.indexOf(u),1);i&&(t.beginChangesNotification(),t.changesListener.notifyEdgeRemoved.call(t.changesListener,r,n.dataObj,function(){t.endChangesNotification()},function(){t.endChangesNotification()}))})},t.prototype.compareStrings=function(n,t){return"string"==typeof n&&"string"==typeof t?n===t:this.isEmptyString(n)&&this.isEmptyString(t)},t.prototype.isEmptyString=function(n){return""===n||null==n},t.prototype.beginChangesNotification=function(){this.updateLockCount++},t.prototype.endChangesNotification=function(n){this.updateLockCount--;this.isUpdateLocked()||n||setTimeout(function(){this.changesListener.processDataChanges.call(this.changesListener,!1)}.bind(this),0)},t.prototype.isUpdateLocked=function(){return this.updateLockCount>0},t}(e.DataSource);t.DocumentDataSource=l},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i(1),r=i(7),o=i(312),s=i(313),u=i(6),h=i(0),y=i(42),p=i(50),c=i(35),w=i(41),b=i(123),k=i(82),d=i(68),g=i(52),f=i(69),nt=i(53),tt=i(94),l=i(36),a=i(85),v=i(38),it=function(){function n(n,t,i,r,u,f){if(this.key=n,this.nodes=[],this.edges=[],this.autoGeneratedDataKeys={},this.addInternalKeyOnInsert=!1,this.useNodeParentId=!1,this.useNodeContainerId=!1,this.useNodeChildren=!1,this.useNodeItems=!1,this.canUpdateEdgeDataSource=!1,this.containers=null,null==n)throw new Error("DataSource key must be specified");this.key=n.toString();this.loadParameters(r||{});this.nodeDataImporter=this.createNodeDataImporter(u);this.edgeDataImporter=this.createEdgeDataImporter(f);this.nodeDataSource=t||[];this.edgeDataSource=i||[];this.canUpdateEdgeDataSource=!!i;this.fetchData()}return n.prototype.loadParameters=function(n){this.addInternalKeyOnInsert=!!n.addInternalKeyOnInsert},n.prototype.isAutoGeneratedKey=function(n){return n&&!!this.autoGeneratedDataKeys[n]},n.prototype.createNodeDataImporter=function(n){var t=new o.DataSourceNodeDataImporter;return n&&this.assignNodeDataImporterProperties(n,t),t},n.prototype.createEdgeDataImporter=function(n){var t=new o.DataSourceEdgeDataImporter;return n&&this.assignEdgeDataImporterProperties(n,t),t},n.prototype.assignItemDataImporterProperties=function(n,t){n.getKey&&(t.getKey=n.getKey);n.setKey&&(t.setKey=n.setKey);n.getLocked&&(t.getLocked=n.getLocked);n.setLocked&&(t.setLocked=n.setLocked);n.getStyle&&(t.getStyle=n.getStyle);n.setStyle&&(t.setStyle=n.setStyle);n.getStyleText&&(t.getStyleText=n.getStyleText);n.setStyleText&&(t.setStyleText=n.setStyleText);n.getZIndex&&(t.getZIndex=n.getZIndex);n.setZIndex&&(t.setZIndex=n.setZIndex)},n.prototype.assignNodeDataImporterProperties=function(n,t){this.assignItemDataImporterProperties(n,t);n.getType&&(t.getType=n.getType);n.setType&&(t.setType=n.setType);n.getImage&&(t.getImage=n.getImage);n.setImage&&(t.setImage=n.setImage);n.getText&&(t.getText=n.getText);n.setText&&(t.setText=n.setText);n.getLeft&&(t.getLeft=n.getLeft);n.setLeft&&(t.setLeft=n.setLeft);n.getTop&&(t.getTop=n.getTop);n.setTop&&(t.setTop=n.setTop);n.getWidth&&(t.getWidth=n.getWidth);n.setWidth&&(t.setWidth=n.setWidth);n.getHeight&&(t.getHeight=n.getHeight);n.setHeight&&(t.setHeight=n.setHeight);n.getChildren&&(t.getChildren=n.getChildren);n.setChildren&&(t.setChildren=n.setChildren);n.getParentKey&&(t.getParentKey=n.getParentKey);n.setParentKey&&(t.setParentKey=n.setParentKey);n.getItems&&(t.getItems=n.getItems);n.setItems&&(t.setItems=n.setItems);n.getContainerKey&&(t.getContainerKey=n.getContainerKey);n.setContainerKey&&(t.setContainerKey=n.setContainerKey)},n.prototype.assignEdgeDataImporterProperties=function(n,t){this.assignItemDataImporterProperties(n,t);n.getFrom&&(t.getFrom=n.getFrom);n.setFrom&&(t.setFrom=n.setFrom);n.getFromPointIndex&&(t.getFromPointIndex=n.getFromPointIndex);n.setFromPointIndex&&(t.setFromPointIndex=n.setFromPointIndex);n.getTo&&(t.getTo=n.getTo);n.setTo&&(t.setTo=n.setTo);n.getToPointIndex&&(t.getToPointIndex=n.getToPointIndex);n.setToPointIndex&&(t.setToPointIndex=n.setToPointIndex);n.getPoints&&(t.getPoints=n.getPoints);n.setPoints&&(t.setPoints=n.setPoints);n.getText&&(t.getText=n.getText);n.setText&&(t.setText=n.setText);n.getLineOption&&(t.getLineOption=n.getLineOption);n.setLineOption&&(t.setLineOption=n.setLineOption);n.getStartLineEnding&&(t.getStartLineEnding=n.getStartLineEnding);n.setStartLineEnding&&(t.setStartLineEnding=n.setStartLineEnding);n.getEndLineEnding&&(t.getEndLineEnding=n.getEndLineEnding);n.setEndLineEnding&&(t.setEndLineEnding=n.setEndLineEnding)},n.prototype.fetchData=function(){var n=this;if(this.useNodeParentId=void 0!==this.nodeDataImporter.getParentKey,this.useNodeContainerId=void 0!==this.nodeDataImporter.getContainerKey,this.useNodeItems=void 0!==this.nodeDataImporter.getItems,this.useNodeChildren=void 0!==this.nodeDataImporter.getChildren,this.useEdgesArray()&&this.useNodeParentId)throw new Error("You cannot use edges array and parentKey simultaneously.");if(this.useEdgesArray()&&this.useNodeItems)throw new Error("You cannot use edges array and items array simultaneously.");if(this.useNodeParentId&&this.useNodeItems)throw new Error("You cannot use parentKey and items array simultaneously.");if(this.useNodeContainerId&&this.useNodeChildren)throw new Error("You cannot use containerKey and children array simultaneously.");this.nodeDataSource.forEach(function(t){n.addNode(t)});this.useEdgesArray()?this.edgeDataSource.forEach(function(t){n.addEdge(t)}):this.nodes.forEach(function(t){n.addNodeEdgesByParentId(t)})},n.prototype.isContainer=function(n){var t=this;return!this.containers&&this.useNodeContainerId&&(this.containers=this.nodeDataSource.map(function(n){return t.nodeDataImporter.getContainerKey(n)}).filter(function(n){return null!=n}).reduce(function(n,t){return n[t]=!0,n},{})),this.containers&&this.containers[n]},n.prototype.useEdgesArray=function(){return Array.isArray(this.edgeDataSource)&&(this.edgeDataSource.length||!(this.useNodeParentId||this.useNodeItems))},n.prototype.addNode=function(n,t,i,r){var s=this,u=this.nodeDataImporter.getChildren&&this.nodeDataImporter.getChildren(n),h=u&&Array.isArray(u)&&u.length,c=h||this.isContainer(this.nodeDataImporter.getKey(n)),l=this.nodeDataImporter.getType&&this.nodeDataImporter.getType(n)||c&&e.ShapeTypes.VerticalContainer||e.ShapeTypes.Rectangle,a=this.nodeDataImporter.getText&&(this.nodeDataImporter.getText(n)||""),f=this.addNodeInternal(n,l,a,t,i,r),o;return(this.assignNodeProperties(f,n),h&&u.forEach(function(t){s.addNode(t,void 0,f.key,n)}),this.useNodeItems)&&(o=this.nodeDataImporter.getItems(n),Array.isArray(o)&&o.length&&o.forEach(function(t){var u=s.addNode(t,n,i,r);s.addEdgeInternal(void 0,f.key,u.key)})),f},n.prototype.addNodeEdgesByParentId=function(n){if(this.useNodeParentId){var t=this.nodeDataImporter.getParentKey(n.dataObj);null!=t&&this.addEdgeInternal(void 0,this.getNodeKey(n.dataObj,this.nodeDataImporter.getParentKey),this.getNodeKey(n.dataObj,this.nodeDataImporter.getKey))}},n.prototype.addNodeInternal=function(n,t,i,u,f,e){var o=this.nodeDataImporter.getKey(n),h=null!=o?o:r.ModelUtils.getGuidItemKey(),c=new s.DataSourceNodeItem(this.key,h,n,t,i,u,f,e);return this.nodes.push(c),null==o&&(o=h,this.autoGeneratedDataKeys[h]=!0),c},n.prototype.addEdge=function(n){var t=this.addEdgeInternal(n,this.getNodeKey(n,this.edgeDataImporter.getFrom),this.getNodeKey(n,this.edgeDataImporter.getTo));return this.assignEdgeProperties(t,n),t},n.prototype.addEdgeInternal=function(n,t,i){var u=n&&this.edgeDataImporter.getKey(n),f=null!=u?u:r.ModelUtils.getGuidItemKey(),e=new s.DataSourceEdgeItem(this.key,f,n,t,i);return this.edges.push(e),null==u&&(u=f,this.autoGeneratedDataKeys[f]=!0),e},n.prototype.assignItemProperties=function(n,t,i){if(i.getLocked&&(n.locked=i.getLocked(t)),i.getStyle){var r=i.getStyle(t);n.style="string"==typeof r?v.Data.cssTextToObject(r):r}i.getStyleText&&(r=i.getStyleText(t),n.styleText="string"==typeof r?v.Data.cssTextToObject(r):r);i.getZIndex&&(n.zIndex=i.getZIndex(t))},n.prototype.assignNodeProperties=function(n,t){this.assignItemProperties(n,t,this.nodeDataImporter);this.nodeDataImporter.getImage&&(n.image=this.nodeDataImporter.getImage(t));this.nodeDataImporter.getLeft&&(n.left=this.nodeDataImporter.getLeft(t));this.nodeDataImporter.getTop&&(n.top=this.nodeDataImporter.getTop(t));this.nodeDataImporter.getWidth&&(n.width=this.nodeDataImporter.getWidth(t));this.nodeDataImporter.getHeight&&(n.height=this.nodeDataImporter.getHeight(t));this.nodeDataImporter.getContainerKey&&(n.containerKey=this.nodeDataImporter.getContainerKey(t))},n.prototype.assignEdgeProperties=function(n,t){this.assignItemProperties(n,t,this.edgeDataImporter);this.edgeDataImporter.getFromPointIndex&&(n.fromPointIndex=this.edgeDataImporter.getFromPointIndex(t));this.edgeDataImporter.getToPointIndex&&(n.toPointIndex=this.edgeDataImporter.getToPointIndex(t));this.edgeDataImporter.getPoints&&(n.points=this.edgeDataImporter.getPoints(t));this.edgeDataImporter.getText&&(n.text=this.edgeDataImporter.getText(t));this.edgeDataImporter.getLineOption&&(n.lineOption=this.edgeDataImporter.getLineOption(t));this.edgeDataImporter.getStartLineEnding&&(n.startLineEnding=this.edgeDataImporter.getStartLineEnding(t));this.edgeDataImporter.getEndLineEnding&&(n.endLineEnding=this.edgeDataImporter.getEndLineEnding(t))},n.prototype.findNode=function(n){return this.nodes.filter(function(t){return void 0!==n&&t.key===n})[0]},n.prototype.findEdge=function(n){return this.edges.filter(function(t){return void 0!==n&&t.key===n})[0]},n.prototype.getNodeKey=function(n,t){return t(n)},n.prototype.createModelItems=function(t,i,r,u,f,e,o){n.createModelItems(t,i,r,u,this,f,!1,!0,e,o)},n.createModelItems=function(t,i,u,f,e,o,s,c,l,a){var k=0,b=0,v={},y=[],p=[],d;(t.beginTransaction(),e.nodes.forEach(function(r){var o=new h.Point(2e3*b++,2e3*k),e=n.createShapeByNode(t,i,f,u,r,o,s);void 0!==r.key&&(v[r.key]=e.key);b>4&&(b=0,k++);y.push(e)}),e.nodes.forEach(function(n){if(void 0!==n.containerKey&&null!==n.containerKey){var f=v[n.key],e=i.findShape(f),o=v[n.containerKey],u=i.findShape(o);u&&r.ModelUtils.insertToContainer(t,i,e,u)}}),e.edges.forEach(function(u){var o=i.findShape(v[u.to]),h=i.findShape(v[u.from]),e=n.createConnectorByEdge(t,i,f,u,o,h,s);e&&(p.push(e),r.ModelUtils.updateConnectorContainer(t,i,e))}),void 0!==o)&&r.ModelUtils.getGraphInfoByItems(i,y,p).forEach(function(n){var u=o.getLayoutBuilder(n.graph).build(),f=r.ModelUtils.getNonGraphItems(i,n.container,u.nodeToLayout,y,p);r.ModelUtils.applyLayout(t,i,n.container,n.graph,u,f,o.layoutSettings,l,a,o.skipPointIndices)});c&&(d=p.map(function(n){return n.key}).concat(y.map(function(n){return n.key})),t.addAndRedo(new w.SetSelectionHistoryItem(f,d)));r.ModelUtils.tryUpdateModelSize(t,i);t.endTransaction()},n.createShapeByNode=function(n,t,i,u,f,e,o){var l=o?f.key:void 0,h,s,c;return void 0!==f.left&&(e.x=r.ModelUtils.getTwipsValue(t.units,f.left)),void 0!==f.top&&(e.y=r.ModelUtils.getTwipsValue(t.units,f.top)),h=new y.AddShapeHistoryItem(u.get(f.type),e,f.text,l),n.addAndRedo(h),s=t.findShape(h.shapeKey),c=s.size.clone(),void 0!==f.width&&(c.width=r.ModelUtils.getTwipsValue(t.units,f.width)),void 0!==f.height&&(c.height=r.ModelUtils.getTwipsValue(t.units,f.height)),r.ModelUtils.setShapeSize(n,t,s,e,c),void 0!==f.image&&n.addAndRedo(new b.ChangeShapeImageHistoryItem(s,f.image)),r.ModelUtils.updateNewShapeProperties(n,i,h.shapeKey),this.changeItemByDataItem(n,s,f),s},n.createConnectorByEdge=function(n,t,i,e,o,s,l){var a,k=l?e.key:void 0,v=[],y,w,b;return(Array.isArray(e.points)&&e.points.length>1?v=e.points.map(function(n){if(void 0!==n.x&&void 0!==n.y)return new h.Point(r.ModelUtils.getTwipsValue(t.units,n.x),r.ModelUtils.getTwipsValue(t.units,n.y))}).filter(function(n){return n}):(s&&v.push(s.position.clone()),o&&v.push(o.position.clone())),v.length>1)&&(y=new p.AddConnectorHistoryItem(v,k),(n.addAndRedo(y),a=t.findConnector(y.connectorKey),s)&&(w=void 0!==e.fromPointIndex?e.fromPointIndex:-1,n.addAndRedo(new c.AddConnectionHistoryItem(a,s,w,u.ConnectorPosition.Begin))),o&&(b=void 0!==e.toPointIndex?e.toPointIndex:-1,n.addAndRedo(new c.AddConnectionHistoryItem(a,o,b,u.ConnectorPosition.End))),r.ModelUtils.updateConnectorAttachedPoints(n,t,a),void 0!==e.text&&n.addAndRedo(new nt.ChangeConnectorTextHistoryItem(a,u.CONNECTOR_DEFAULT_TEXT_POSITION,e.text)),r.ModelUtils.updateNewConnectorProperties(n,i,y.connectorKey),void 0!==e.lineOption&&n.addAndRedo(new f.ChangeConnectorPropertyHistoryItem(a.key,"lineOption",e.lineOption)),void 0!==e.startLineEnding&&n.addAndRedo(new f.ChangeConnectorPropertyHistoryItem(a.key,"startLineEnding",e.startLineEnding)),void 0!==e.endLineEnding&&n.addAndRedo(new f.ChangeConnectorPropertyHistoryItem(a.key,"endLineEnding",e.endLineEnding)),this.changeItemByDataItem(n,a,e)),a},n.changeItemByDataItem=function(n,t,i){var u,r;if(void 0!==i.zIndex&&n.addAndRedo(new k.ChangeZindexHistoryItem(t,i.zIndex)),void 0!==i.style)for(r in i.style)i.style.hasOwnProperty(r)&&(u=a.isColorProperty(r)?l.ColorHelper.stringToHash(i.style[r]):i.style[r],n.addAndRedo(new d.ChangeStyleHistoryItem(t.key,r,u)));if(void 0!==i.styleText)for(r in i.styleText)i.styleText.hasOwnProperty(r)&&(u=a.isColorProperty(r)?l.ColorHelper.stringToHash(i.styleText[r]):i.styleText[r],n.addAndRedo(new g.ChangeStyleTextHistoryItem(t.key,r,u)));void 0!==i.locked&&n.addAndRedo(new tt.ChangeLockedHistoryItem(t,i.locked))},n}();t.DataSource=it},function(n,t){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i,f,e;Object.defineProperty(t,"__esModule",{value:!0});i=function(){return function(){this.getKey=function(n){return n.id};this.setKey=function(n,t){n.id=t};this.getLocked=void 0;this.setLocked=void 0;this.getStyle=void 0;this.setStyle=void 0;this.getStyleText=void 0;this.setStyleText=void 0;this.getZIndex=void 0;this.setZIndex=void 0}}();t.DataSourceItemDataImporter=i;f=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.getType=void 0,t.setType=void 0,t.getText=void 0,t.setText=void 0,t.getImage=void 0,t.setImage=void 0,t.getLeft=void 0,t.setLeft=void 0,t.getTop=void 0,t.setTop=void 0,t.getWidth=void 0,t.setWidth=void 0,t.getHeight=void 0,t.setHeight=void 0,t.getChildren=void 0,t.setChildren=void 0,t.getParentKey=void 0,t.setParentKey=void 0,t.getItems=void 0,t.setItems=void 0,t.getContainerKey=void 0,t.setContainerKey=void 0,t}return u(t,n),t}(i);t.DataSourceNodeDataImporter=f;e=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.getFrom=function(n){return n.from},t.setFrom=function(n,t){n.from=t},t.getFromPointIndex=void 0,t.setFromPointIndex=void 0,t.getTo=function(n){return n.to},t.setTo=function(n,t){n.to=t},t.getToPointIndex=void 0,t.setToPointIndex=void 0,t.getPoints=void 0,t.setPoints=void 0,t.getText=void 0,t.setText=void 0,t.getLineOption=void 0,t.setLineOption=void 0,t.getStartLineEnding=void 0,t.setStartLineEnding=void 0,t.getEndLineEnding=void 0,t.setEndLineEnding=void 0,t}return u(t,n),t}(i);t.DataSourceEdgeDataImporter=e},function(n,t){"use strict";var r,u=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i,f,e;Object.defineProperty(t,"__esModule",{value:!0});i=function(){return function(n,t,i){this.sourceKey=n;this.key=t;this.dataObj=i}}();t.DataSourceItem=i;f=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r)||this;return h.type=u,h.text=f,h.parentDataObj=e,h.containerKey=o,h.containerDataObj=s,h}return u(t,n),t}(i);t.DataSourceNodeItem=f;e=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i,r)||this;return e.sourceKey=t,e.from=u,e.to=f,e}return u(t,n),t}(i);t.DataSourceEdgeItem=e},function(n,t){"use strict";function f(n){var t=Math.log(n);return Math.round((t-i)*(r-1)/(u-i))}Object.defineProperty(t,"__esModule",{value:!0});var i=Math.log(.05),u=Math.log(3),r=40,e=f(1),o=function(){function n(n){this.settings=n}return n.prototype.initialize=function(n){this.view=n},n.prototype.scrollTo=function(n,t){this.view&&this.view.setScrollTo(n,t)},n.prototype.scrollBy=function(n){return!this.view||0===n.x&&0===n.y?n:this.view.scrollBy(n)},n.prototype.normalize=function(){this.view.tryNormalizePaddings()},n.prototype.getNextStepZoom=function(n){var o=this.getNearestCurrentZoomStep(),s=n?1:-1,t=Math.min(r-1,Math.max(0,o+s)),f;return t!==e?(f=i+(u-i)*t/(r-1),Math.exp(f)):1},n.prototype.getNearestCurrentZoomStep=function(){return f(this.getZoom())},n.prototype.getZoom=function(){return this.view?this.view.actualZoom:this.settings.zoomLevel},n.prototype.resetScroll=function(){this.view.adjust({horizontal:!0,vertical:!0})},n}();t.ViewController=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(316),u=i(317),f=i(80),e=i(18),o=function(){function n(n){this.shapeDescriptionManager=n;this.toolboxes=[];this.measurers={}}return n.prototype.create=function(n,t,i,f,e,o){var h=Array.isArray(e)?e:this.shapeDescriptionManager.getTypesByCategory(e),s=f?new r.TextToolbox(n,t,i,this.shapeDescriptionManager,h):new u.IconToolbox(n,t,i,this.shapeDescriptionManager,h,o,this.getOrCreateMeasurer(n));return s.render(),this.toolboxes.push(s),s},n.prototype.clean=function(n){if(n)n.clean(),this.toolboxes.splice(this.toolboxes.indexOf(n),1);else{for(var t=0;t<this.toolboxes.length;t++)this.toolboxes[t].clean();this.toolboxes=[]}},n.prototype.applyFilter=function(n,t){var i=this;return this.toolboxes.reduce(function(r,u,f){return("number"!=typeof t||f===t)&&u.render(function(t){return i.searchFilter(t,n,f)})&&r.push(f),r},[])},n.prototype.searchFilter=function(n,t,i,r){if(!t||r&&-1===r.indexOf(i))return!0;t=t.toLowerCase();var u=this.shapeDescriptionManager.get(n);return u.getTitle().toLowerCase().indexOf(t)>-1||u.getDefaultText().toLowerCase().indexOf(t)>-1},n.prototype.getOrCreateMeasurer=function(n){var t=n.getAttribute("data-dxdiMeasurerID");return t&&this.measurers[t]||(t=e.CreateGuid(),this.measurers[t]=new f.TextMeasurer(n),n.setAttribute("data-dxdiMeasurerID",t)),this.measurers[t]},n}();t.ToolboxManager=o},function(n,t,i){"use strict";var r,f=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});u=function(n){function t(t,i,r,u,f){return n.call(this,t,i,r,u,f)||this}return f(t,n),t.prototype.createElements=function(n,t){var i=this;t.forEach(function(t){var u=i.shapeDescriptionManager.get(t),r=document.createElement("div");r.setAttribute("class","toolbox-text-item");r.setAttribute("data-tb-type",t);r.innerHTML=u.getDefaultText()||u.getTitle();n.appendChild(r)})},t.prototype.createDraggingElement=function(n){var t=document.createElement("DIV"),i;return t.setAttribute("class","dxdi-toolbox-drag-text-item"),i=this.shapeDescriptionManager.get(n.evt.data),t.innerHTML=i.getDefaultText()||i.getTitle(),document.body.appendChild(t),t},t}(i(136).Toolbox);t.TextToolbox=u},function(n,t,i){"use strict";var f,s=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var h=i(136),e=i(12),c=i(11),r=i(14),l=i(0),o=i(97),u=i(23),a=i(102),v=i(20),y=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,i,r,u,f)||this;return s.options=e,s.measurer=o,s}return s(t,n),t.prototype.createElements=function(n,t){var i=document.createElementNS(e.svgNS,"svg");i.className.baseVal="dxdi-canvas";n.appendChild(i);this.drawShapeIcons(i,t,this.options.toolboxWidth||i.getBoundingClientRect().width)},t.prototype.drawShapeIcons=function(n,t,i){var o=this,s=u.DEFAULT_STROKE_WIDTH,l=i-2*s,f=this.options.shapeIconSize,a,e;if(!f&&this.options.shapeIconSpacing&&this.options.shapeIconCountInRow&&(f=Math.floor((i-(this.options.shapeIconCountInRow-1)*this.options.shapeIconSpacing)/this.options.shapeIconCountInRow)),f||(f=32),a=f,e=this.options.shapeIconCountInRow,!e)for(e=1;a<l;)(a+=this.options.shapeIconSpacing+f)<l&&e++;var v=e>1?(l-f*e)/(e-1):0,h=s,c=s,y=r.UnitConverter.pixelsToTwips(f);t.forEach(function(t,i){var l,u,a;i>0&&i%e==0&&(h=s,c+=f+v);l=o.shapeDescriptionManager.get(t);u=o.createShape(l,h,c);o.updateShapeIconBounds(u,f);a=o.drawShape(n,u);o.drawSelector(a,r.UnitConverter.pixelsToTwips(h),r.UnitConverter.pixelsToTwips(c),y);h+=f+v});n.style.height=c+f+s+"px";n.style.width=i+"px"},t.prototype.drawShape=function(n,t){var u=this,f=t.description.createPrimitives(t,!0),i=document.createElementNS(e.svgNS,"g"),r;if(i.setAttribute("data-tb-type",t.description.key.toString()),i.setAttribute("class","toolbox-item"),i.setAttribute("title",t.description.getTitle()),this.options.shapeIconAttributes)for(r in this.options.shapeIconAttributes)this.options.shapeIconAttributes.hasOwnProperty(r)&&i.setAttribute(r,this.options.shapeIconAttributes[r]);return n.appendChild(i),f.forEach(function(n){var t=n.createElement();i.appendChild(t);n.applyElementProperties(t,u.measurer)}),i},t.prototype.drawSelector=function(n,t,i,r){var u=new v.RectanglePrimitive(t,i,r,r,void 0,"selector"),f=u.createElement();u.applyElementProperties(f,this.measurer);n.appendChild(f)},t.prototype.createShape=function(n,t,i){var f=r.UnitConverter.pixelsToTwips(t),e=r.UnitConverter.pixelsToTwips(i),u=new c.Shape(n,new l.Point(f,e));return this.needResetShapeText(n)&&(u.text=""),u},t.prototype.needResetShapeText=function(n){return!(n instanceof o.TextShapeDescription)&&!(n instanceof a.CustomShapeDescription&&n.baseDescription instanceof o.TextShapeDescription)},t.prototype.updateShapeIconBounds=function(n,t){var i=r.UnitConverter.pixelsToTwips(t),u;(n.size.height=n.size.width*n.getToolboxHeightToWidthRatio(),n.size.width>n.size.height)?(u=n.size.height/n.size.width,n.size.width=i,n.size.height=i*u,n.position.y=n.position.y+(i-n.size.height)/2,n.parameters.forEach(function(t){t.value=t.value*i/n.description.defaultSize.width})):n.size.width<n.size.height?(u=n.size.width/n.size.height,n.size.height=i,n.size.width=i*u,n.position.x=n.position.x+(i-n.size.width)/2,n.parameters.forEach(function(t){t.value=t.value*i/n.description.defaultSize.height})):(n.size.width=i,n.size.height=i,n.parameters.forEach(function(t){t.value=t.value*i/n.description.defaultSize.width}))},t.prototype.createDraggingElement=function(n){var t=document.createElement("DIV"),i,o,f;return t.setAttribute("class","dxdi-toolbox-drag-item"),document.body.appendChild(t),i=document.createElementNS(e.svgNS,"svg"),i.className.baseVal="dxdi-canvas",t.appendChild(i),o=this.shapeDescriptionManager.get(n.evt.data),f=this.createShape(o,u.DEFAULT_STROKE_WIDTH,u.DEFAULT_STROKE_WIDTH),this.drawShape(i,f),t.style.width=r.UnitConverter.twipsToPixels(f.size.width)+2*u.DEFAULT_STROKE_WIDTH+"px",t.style.height=r.UnitConverter.twipsToPixels(f.size.height)+2*u.DEFAULT_STROKE_WIDTH+"px",t},t}(h.Toolbox);t.IconToolbox=y},function(n,t,i){"use strict";var u,e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r,o=i(63),f=i(10),s=function(n){function t(t,i,r){var u=n.call(this)||this;return u.events=t,u.model=r,u.selection=i,u}return e(t,n),t.prototype.notifySelectionChanged=function(){this.isUpdateLocked()?this.registerOccurredEvent(r.SelectionChanged):this.raiseSelectionChanged()},t.prototype.notifyToolboxDragStart=function(){this.events.raise("notifyToolboxItemDragStart")},t.prototype.notifyToolboxDragEnd=function(){this.events.raise("notifyToolboxItemDragEnd")},t.prototype.notifyClick=function(n){var t=this;this.tryRaiseUserAction(n,function(n){return t.events.raise("notifyItemClick",n)})},t.prototype.notifyDblClick=function(n){var t=this;this.tryRaiseUserAction(n,function(n){return t.events.raise("notifyItemDblClick",n)})},t.prototype.setDataSource=function(n){this.dataSource=n},t.prototype.tryRaiseUserAction=function(n,t){var r=this,i;this.isUserAction(n)&&(i=this.model.findItem(n.source.key),i&&this.events.raise1(function(){return t(r.cleanupNativeItem(i.toNative()))}))},t.prototype.isUserAction=function(n){return n.source&&(n.source.type===f.MouseEventElementType.Shape||n.source.type===f.MouseEventElementType.Connector)},t.prototype.onUpdateUnlocked=function(n){n&r.SelectionChanged&&this.raiseSelectionChanged()},t.prototype.raiseSelectionChanged=function(){var n=this,t=this.selection.getKeys().map(function(t){return n.cleanupNativeItem(n.model.findItem(t).toNative())});this.events.raise1(function(n){return n.notifySelectionChanged(t)})},t.prototype.cleanupNativeItem=function(n){var t=this.dataSource;return t&&(t.isAutoGeneratedKey(n.fromKey)&&(n.fromKey=void 0),t.isAutoGeneratedKey(n.key)&&(n.key=void 0),t.isAutoGeneratedKey(n.toKey)&&(n.toKey=void 0)),n},t}(o.BatchUpdatableObject);t.ApiController=s,function(n){n[n.SelectionChanged=1]="SelectionChanged"}(r||(r={}))},function(){},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(19),u=i(1),r=function(){function n(){}return n.unitItems={},n.formatUnit=function(n){return n.toString()},n.shapeTexts={},n}();t.DiagramLocalizationService=r;r.unitItems[f.DiagramUnit.In]="in";r.unitItems[f.DiagramUnit.Cm]="cm";r.unitItems[f.DiagramUnit.Px]="px";r.shapeTexts[u.ShapeTypes.Text]="Text";r.shapeTexts[u.ShapeTypes.Rectangle]="Rectangle";r.shapeTexts[u.ShapeTypes.Ellipse]="Ellipse";r.shapeTexts[u.ShapeTypes.Cross]="Cross";r.shapeTexts[u.ShapeTypes.Triangle]="Triangle";r.shapeTexts[u.ShapeTypes.Diamond]="Diamond";r.shapeTexts[u.ShapeTypes.Heart]="Heart";r.shapeTexts[u.ShapeTypes.Pentagon]="Pentagon";r.shapeTexts[u.ShapeTypes.Hexagon]="Hexagon";r.shapeTexts[u.ShapeTypes.Octagon]="Octagon";r.shapeTexts[u.ShapeTypes.Star]="Star";r.shapeTexts[u.ShapeTypes.ArrowLeft]="Left Arrow";r.shapeTexts[u.ShapeTypes.ArrowUp]="Up Arrow";r.shapeTexts[u.ShapeTypes.ArrowRight]="Right Arrow";r.shapeTexts[u.ShapeTypes.ArrowDown]="Down Arrow";r.shapeTexts[u.ShapeTypes.ArrowUpDown]="Up Down Arrow";r.shapeTexts[u.ShapeTypes.ArrowLeftRight]="Left Right Arrow";r.shapeTexts[u.ShapeTypes.Process]="Process";r.shapeTexts[u.ShapeTypes.Decision]="Decision";r.shapeTexts[u.ShapeTypes.Terminator]="Terminator";r.shapeTexts[u.ShapeTypes.PredefinedProcess]="Predefined Process";r.shapeTexts[u.ShapeTypes.Document]="Document";r.shapeTexts[u.ShapeTypes.MultipleDocuments]="Multiple Documents";r.shapeTexts[u.ShapeTypes.ManualInput]="Manual Input";r.shapeTexts[u.ShapeTypes.Preparation]="Preparation";r.shapeTexts[u.ShapeTypes.Data]="Data";r.shapeTexts[u.ShapeTypes.Database]="Database";r.shapeTexts[u.ShapeTypes.HardDisk]="Hard Disk";r.shapeTexts[u.ShapeTypes.InternalStorage]="Internal Storage";r.shapeTexts[u.ShapeTypes.PaperTape]="Paper Tape";r.shapeTexts[u.ShapeTypes.ManualOperation]="Manual Operation";r.shapeTexts[u.ShapeTypes.Delay]="Delay";r.shapeTexts[u.ShapeTypes.StoredData]="Stored Data";r.shapeTexts[u.ShapeTypes.Display]="Display";r.shapeTexts[u.ShapeTypes.Merge]="Merge";r.shapeTexts[u.ShapeTypes.Connector]="Connector";r.shapeTexts[u.ShapeTypes.Or]="Or";r.shapeTexts[u.ShapeTypes.SummingJunction]="Summing Junction";r.shapeTexts[u.ShapeTypes.Container]="Container";r.shapeTexts[u.ShapeTypes.VerticalContainer]="Vertical Container";r.shapeTexts[u.ShapeTypes.HorizontalContainer]="Horizontal Container";r.shapeTexts[u.ShapeTypes.Card]="Person's Name";r.shapeTexts[u.ShapeTypes.CardWithImageOnLeft]="Card with Image on the Left";r.shapeTexts[u.ShapeTypes.CardWithImageOnTop]="Card with Image on the Top";r.shapeTexts[u.ShapeTypes.CardWithImageOnRight]="Card with Image on the Right"}])});